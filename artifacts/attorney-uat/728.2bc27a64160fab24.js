"use strict";(self.webpackChunkattorney=self.webpackChunkattorney||[]).push([[728],{95614:(Ee,Ne,Q)=>{Q.d(Ne,{L6:()=>b});var x=Q(24280),W=Q(39646),R=Q(60515),j=Q(63900),K=Q(54004),se=Q(18505),g=Q(11365),B=Q(70262),S=Q(84264),h=Q(94650),L=Q(73602),ce=Q(30144),e=Q(71873),V=Q(4523),E=Q(56869),ie=Q(88821);class X extends ie.T_{constructor(v){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=v}Do(v){return this.businessProvider=v,this.serviceContext=v.serviceContext,this.loggingService=v.loggingService,this.execute(),this.response}}var U=Q(26177);class I extends X{constructor(v,T,O,D,z,re){super("ValidateAppointmentExcelDataAction"),this.valid=!1,this.excelData=v,this.locations=T,this.patients=O,this.clinicalProviders=D,this.legalCases=z,this.appointmentStatuses=re}preValidateAction(){const v=[];this.excelData.map((T,O)=>{v.push(T.name),this.validationContext.addRule(new U.mi(`locationName_${O}_is_valid}`,"Location Is Not Valid","location.name",T.location,this.locations,!0)),this.validationContext.addRule(new U.mi(`patientName_${O}_is_valid}`,"Patient Is Not Valid","patient.name",T.patient,this.patients,!0)),this.validationContext.addRule(new U.mi(`clinicalProviderName_${O}_is_valid}`,"Clinical Provider Is Not Valid","clinicalProvider.name",T.clinicalProvider,this.clinicalProviders,!0)),this.validationContext.addRule(new U.mi(`legalCaseName_${O}_is_valid}`,"Legal Case Is Not Valid","legalCase.name",T.legalCase,this.legalCases,!0)),this.validationContext.addRule(new U.mi(`appointmentStatusName_${O}_is_valid}`,"Appointment Status Is Not Valid","appointmentStatus.name",T.appointmentStatus,this.appointmentStatuses,!0))}),this.validationContext.addRule(new U.cL("nameIsUnique","Name should be unique",v,!0))}performAction(){}finish(){super.finish();const v={};let T=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(O=>{O instanceof U.mi?O.isValid||(v[O.columnName]?v[O.columnName].newNames.includes(O.newName)||v[O.columnName].newNames.push(O.newName):v[O.columnName]={options:O.possibleValueList.map(D=>D.name),newNames:[O.newName]}):O instanceof U.cL&&(O.isValid||(T=O.conflicts))})):this.valid=!0,this.response=(0,W.of)({valid:this.valid,excelData:this.excelData,conflictNames:T,unknownNames:v})}}var F=Q(28234);class ye extends U.wS{constructor(v,T,O,D,z){super(v,T,O,D,z,!0)}}class f extends U.ul{constructor(v,T,O,D=!1){super(v,T,D),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=O,this.configureRules()}configureRules(){this.rules.push(new U.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new ye("name","The appointment name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class Ae extends X{constructor(v){super("CreateAppointmentAction"),this.input=v}preValidateAction(){this.validationContext.addRule(new f("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages)),this.validationContext.addRule(new U.pt("AppointmentDateTimeIsBeforeCheckInDateTime","CheckIn DateTime should be after Appointment DateTime",this.input.appointmentDateAndTime,this.input.checkedInDateTime))}performAction(){this.response=this.businessProvider.data.userCreateAppointment({input:this.input}).pipe((0,j.w)(v=>(0,F.of)(v.data.created)))}}class de extends X{constructor(v){super("UpdateAppointmentsAction"),this.appointments=v}preValidateAction(){this.validationContext.addRule(new U.DJ("Input","Input should have values",this.appointments,!0))}performAction(){this.response=this.businessProvider.data.userUpdateAppointments({input:{appointments:this.appointments}}).pipe((0,j.w)(v=>(0,W.of)(v.data.updated)))}}class Te extends X{constructor(v,T){super("UpdateAppointmentAction"),this.appointment=v,this.appointmentId=T}preValidateAction(){this.validationContext.addRule(new U.DJ("Input","Input should have values",this.appointment,!0)).addRule(new U.xF("Id","Id should be a CUID and not null",this.appointmentId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateAppointment({appointmentId:this.appointmentId,input:this.appointment}).pipe((0,j.w)(v=>(0,W.of)(v.data.updated)))}}class Fe extends X{constructor(v){super("CheckInAppointmentAction"),this.appointment=v}preValidateAction(){var v;this.validationContext.addRule(new U.DJ("Input","Input should have values",this.appointment,!0)).addRule(new U.xF("Id","Id should be a CUID and not null",this.appointment.id,!0)).addRule(new U.qJ("currentStatus","You can only check confirmed appointments in",null===(v=this.appointment.appointmentStatus)||void 0===v?void 0:v.name,"Confirmed",!0))}performAction(){this.response=this.businessProvider.data.userCheckInAppointment({appointmentId:this.appointment.id}).pipe((0,j.w)(v=>(0,W.of)(v.data.updated)))}}class ne extends X{constructor(v){super("RequestRescheduleAppointmentAction"),this.appointment=v}preValidateAction(){var v;this.validationContext.addRule(new U.DJ("Input","Input should have values",this.appointment,!0)).addRule(new U.xF("Id","Id should be a CUID and not null",this.appointment.id,!0)).addRule(new U.qJ("currentStatus","You can only request reschedule for cancelled appointments",null===(v=this.appointment.appointmentStatus)||void 0===v?void 0:v.name,"Cancelled",!0))}performAction(){this.response=this.businessProvider.data.userRequestReschedule({appointmentId:this.appointment.id}).pipe((0,j.w)(v=>(0,W.of)(v.data.updated)))}}class M extends X{constructor(v,T){super("RescheduleAppointmentAction"),this.appointment=v,this.rescheduleDate=T}preValidateAction(){this.validationContext.addRule(new U.DJ("Input","Input should have values",this.appointment,!0)).addRule(new U.xF("Id","Id should be a CUID and not null",this.appointment.id,!0))}performAction(){this.response=this.businessProvider.data.userRescheduleAppointment({appointmentId:this.appointment.id,rescheduleDate:this.rescheduleDate}).pipe((0,j.w)(v=>(0,W.of)(v.data.created)))}}class N extends X{constructor(v){super("ConfirmAppointmentAction"),this.appointment=v}preValidateAction(){var v;this.validationContext.addRule(new U.DJ("Input","Input should have values",this.appointment,!0)).addRule(new U.xF("Id","Id should be a CUID and not null",this.appointment.id,!0)).addRule(new U.qJ("currentStatus","You can confirm only pending appointments",null===(v=this.appointment.appointmentStatus)||void 0===v?void 0:v.name,"Pending",!0))}performAction(){this.response=this.businessProvider.data.userConfirmAppointment({appointmentId:this.appointment.id}).pipe((0,j.w)(v=>(0,W.of)(v.data.updated)))}}class y extends X{constructor(v){super("CancelAppointmentAction"),this.appointment=v}preValidateAction(){this.validationContext.addRule(new U.DJ("Input","Input should have values",this.appointment,!0)).addRule(new U.xF("Id","Id should be a CUID and not null",this.appointment.id,!0))}performAction(){this.response=this.businessProvider.data.userCancelAppointment({appointmentId:this.appointment.id}).pipe((0,j.w)(v=>(0,W.of)(v.data.updated)))}}class P extends X{constructor(v){super("HideAppointmentAction"),this.appointment=v}preValidateAction(){var v;this.validationContext.addRule(new U.DJ("Input","Input should have values",this.appointment,!0)).addRule(new U.xF("Id","Id should be a CUID and not null",this.appointment.id,!0)).addRule(new U.HN("currentStatus","You can only hide non-pending appointments",null===(v=this.appointment.appointmentStatus)||void 0===v?void 0:v.name,"Pending",!0))}performAction(){this.response=this.businessProvider.data.userHideAppointment({appointmentId:this.appointment.id}).pipe((0,j.w)(v=>(0,W.of)(v.data.updated)))}}let ee=(()=>{class C extends ie.nH{constructor(T,O,D){super("NotificationService.AppointmentBusinessProviderService",T,D),this.data=O}createAppointment(T){const O=new Ae(T);return O.Do(this),O.response}updateAppointment(T,O){const D=new Te(T,O);return D.Do(this),D.response}checkInAppointment(T){const O=new Fe(T);return O.Do(this),O.response}requestRescheduleAppointment(T){const O=new ne(T);return O.Do(this),O.response}rescheduleAppointment(T,O){const D=new M(T,O);return D.Do(this),D.response}confirmAppointment(T){const O=new N(T);return O.Do(this),O.response}cancelAppointment(T){const O=new y(T);return O.Do(this),O.response}hideAppointment(T){const O=new P(T);return O.Do(this),O.response}importAppointments(T){const O=new de(T);return O.Do(this),O.response}validateAppointmentExcelData(T,O,D,z,re,ue){const $=new I(T,O,D,z,re,ue);return $.Do(this),$.response}}return C.\u0275fac=function(T){return new(T||C)(h.LFG(E.ed),h.LFG(L.q),h.LFG(ie.oI))},C.\u0275prov=h.Yz7({token:C,factory:C.\u0275fac,providedIn:"root"}),C})(),Z=(()=>{class C extends ie.nH{constructor(T,O,D){super("AppointmentService",D,T),this.businessProvider=O}createAppointment(T){const O=Object.fromEntries(Object.entries(T).filter(([D,z])=>null!==z));return this.businessProvider.createAppointment(O)}updateAppointment(T,O){return this.businessProvider.updateAppointment(T,O)}checkInAppointment(T){return this.businessProvider.checkInAppointment(T)}requestRescheduleAppointment(T){return this.businessProvider.requestRescheduleAppointment(T)}rescheduleAppointment(T,O){return this.businessProvider.rescheduleAppointment(T,O)}confirmAppointment(T){return this.businessProvider.confirmAppointment(T)}cancelAppointment(T){return this.businessProvider.cancelAppointment(T)}hideAppointment(T){return this.businessProvider.hideAppointment(T)}importAppointments(T){return this.businessProvider.importAppointments(T)}validateAppointmentExcelData(T,O,D,z,re,ue){return this.businessProvider.validateAppointmentExcelData(T,O,D,z,re,ue)}}return C.\u0275fac=function(T){return new(T||C)(h.LFG(ee,8),h.LFG(ee),h.LFG(E.ed))},C.\u0275prov=h.Yz7({token:C,factory:C.\u0275fac,providedIn:"root"}),C})();const te={Pending:"#ffbc03","Checked In":"#49c204","Claim Submitted":"#50fe93",Approved:"green",Rejected:"red",Rescheduled:"#ffbc03",Personal:"orange","Provider Paid":"blue","No Showed":"#ff1d1a",Confirmed:"#49c204",Processing:"#50fe93",Cancelled:"red"},Ce={Pending:"assets/icons/pending.png","Checked In":"assets/icons/checkedin.png",Rescheduled:"assets/icons/rescheduled.png","No Showed":"assets/icons/noshow.png",Confirmed:"assets/icons/confirmed.png",Cancelled:"assets/icons/cancel.png",Approved:"assets/icons/pending.png",Rejected:"assets/icons/pending.png",Personal:"assets/icons/pending.png",Processing:"assets/icons/pending.png","Provider Paid":"assets/icons/pending.png","Claim Submitted":"assets/icons/pending.png"};let b=(()=>{class C extends x.m1{constructor(T,O,D,z,re,ue){if(super({loading:!1,appointments:[],done:!1,searchQuery:"",id:void 0,formName:void 0,locationId:void 0,patientId:void 0,clinicalProviderId:void 0,attorneyId:void 0,firmId:void 0,legalCaseId:void 0,appointmentStatusId:void 0,visitKindId:void 0,medicalRecordStatusId:void 0,medicalRecordStatusOptions:void 0,paging:{limit:1e4,skip:0}}),this.data=T,this.router=O,this.route=D,this.toast=z,this.formService=re,this.appointmentService=ue,this.medicalRecordStatuses$=this.data.userMedicalRecordStatuses({input:{}}).pipe((0,j.w)($=>{var G;return(0,W.of)(null===(G=$.data.items)||void 0===G?void 0:G.map(q=>({id:q?.id,title:q?.name})).filter(q=>"Test Status"!=q.title&&"Medical Records Complete"!=q.title))})),this.dateFilter$=this.select($=>$.dateFilter),this.errors$=this.select($=>$.errors),this.loading$=this.select($=>$.loading),this.done$=this.select($=>$.done),this.item$=this.select($=>{var G,q,k,be;return Object.assign(Object.assign({},$.item),{firstSpecialty:null===(k=null===(q=null===(G=$.item)||void 0===G?void 0:G.clinicalProvider)||void 0===q?void 0:q.clinicalProviderSpecialties)||void 0===k?void 0:k.at(0),color:null!==(be=$.item)&&void 0!==be&&be.appointmentStatus?te[$.item.appointmentStatus.name]:"red"})}),this.appointments$=this.select($=>$.appointments),this.locations$=this.select($=>$.locations||[]),this.patients$=this.select($=>$.patients||[]),this.clinicalProviders$=this.select($=>$.clinicalProviders||[]),this.legalCases$=this.select($=>$.legalCases||[]),this.appointmentStatuses$=this.select($=>$.appointmentStatuses||[]),this.visitKinds$=this.select($=>$.visitKinds||[]),this.locationId$=this.select($=>$.locationId),this.patientId$=this.select($=>$.patientId),this.attorneyId$=this.select($=>$.attorneyId),this.firmId$=this.select($=>$.firmId),this.clinicalProviderId$=this.select($=>$.clinicalProviderId),this.legalCaseId$=this.select($=>$.legalCaseId),this.appointmentCount$=this.select($=>$.appointmentCount),this.appointmentStatusId$=this.select($=>$.appointmentStatusId),this.medicalRecordStatusId$=this.select($=>$.medicalRecordStatusId),this.medicalRecordStatusOptions$=this.select($=>$.medicalRecordStatusOptions),this.visitKindId$=this.select($=>$.visitKindId),this.paging$=this.select($=>$.paging),this.searchQuery$=this.select($=>$.searchQuery),this.formName$=this.select($=>$.formName),this.actionResult$=this.select(this.item$,this.done$,($,G)=>({item:$,done:G}),{debounce:!0}),this.formattedAppointments$=this.select(this.appointments$,$=>$.map(G=>{var q,k,be,Pe,me,we,Ie,pe,$e,Le,Re,je,Je;let Ue="- -(-min)";if(G.start){let Me=G.duration||"0 min";G.duration&&(G.duration<60?Me=`${G.duration}min`:(G.duration>60&&(Me=Math.floor(G.duration/60)+"h "+G.duration%60+"min"),G.duration%60==0&&(Me=Math.floor(G.duration/60)+"h"))),Ue=`${(0,S.YZ)(G.start)} (${Me})`}const xe=[{title:"View"},{title:"Edit"}];"No Showed"!==(null===(q=G.appointmentStatus)||void 0===q?void 0:q.name)&&xe.unshift({title:"No Show"});let We=!1;return(null===(k=G.clinicalProvider)||void 0===k?void 0:k.clinicalProviderSpecialties)?.forEach(Me=>{var Qe;("Chiropractor"===(null===(Qe=Me.specialty)||void 0===Qe?void 0:Qe.name)||"Home Health"===Me?.name)&&(We=!0)}),We&&xe.push({title:"Request More Visits"}),Object.assign(Object.assign({},G),{timeAndDuration:Ue,canRequestVisits:We,otherActions:xe,providerImage:null===(Pe=null===(be=G.clinicalProvider)||void 0===be?void 0:be.profileImage)||void 0===Pe?void 0:Pe.id,firstSpecialty:null===(we=null===(me=G.clinicalProvider)||void 0===me?void 0:me.clinicalProviderSpecialties)||void 0===we?void 0:we.at(0),patientImage:null!=(null===(Ie=G.patient)||void 0===Ie?void 0:Ie.users)&&null!=(null===(pe=G.patient)||void 0===pe?void 0:pe.users)?null===(Le=null===($e=G.patient)||void 0===$e?void 0:$e.users[0])||void 0===Le?void 0:Le.avatarUrl:"",providerSpecialties:null===(Re=G.clinicalProvider)||void 0===Re?void 0:Re.clinicalProviderSpecialties,color:G.appointmentStatus&&null!==(je=te[G.appointmentStatus.name])&&void 0!==je?je:"red",icon:G.appointmentStatus&&null!==(Je=Ce[G.appointmentStatus.name])&&void 0!==Je?Je:"assets/icons/rescheduled.png"})})),this.formattedAppointmentsForProvider$=this.select(this.formattedAppointments$,$=>$.map(G=>{var q,k,be;const Pe=[{title:"Check In",color:null!==(q=te["Checked In"])&&void 0!==q?q:"red",icon:Ce["Checked In"]},{title:"Cancel",color:null!==(k=te.Cancelled)&&void 0!==k?k:"red",icon:Ce.Cancelled},{title:"No Show",color:null!==(be=te["No Showed"])&&void 0!==be?be:"red",icon:Ce["No Showed"]}];return Object.assign(Object.assign({},G),{actions:Pe,canChangeStatus:!0})})),this.formattedAppointmentsForPatient$=this.select(this.formattedAppointments$,$=>$.map(G=>{var q,k,be,Pe;const me={Pending:[{title:"Confirm",color:null!==(q=te.Confirmed)&&void 0!==q?q:"red",icon:Ce.Confirmed},{title:"Cancel",color:null!==(k=te.Cancelled)&&void 0!==k?k:"red",icon:Ce.Cancelled}],"Checked In":[],Rescheduled:[{title:"Confirm",color:null!==(be=te.Confirmed)&&void 0!==be?be:"red",icon:Ce.Confirmed},{title:"Cancel",color:null!==(Pe=te.Cancelled)&&void 0!==Pe?Pe:"red",icon:Ce.Cancelled}],"No Showed":[],Confirmed:[],Cancelled:[]},we=G.appointmentStatus?me[G.appointmentStatus.name]:[];return Object.assign(Object.assign({},G),{actions:we,canChangeStatus:we.length>0})})),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.formattedAppointments$,this.locations$,this.patients$,this.clinicalProviders$,this.legalCases$,this.appointmentStatuses$,this.visitKinds$,this.medicalRecordStatuses$,($,G,q,k,be,Pe,me,we,Ie,pe,$e,Le)=>({errors:$,loading:G,item:q,formName:k,appointments:be,locations:Pe,patients:me,clinicalProviders:we,legalCases:Ie,appointmentStatuses:pe,visitKinds:$e,medicalRecordStatuses:Le}),{debounce:!0}),this.input$=this.select(this.paging$,this.locationId$,this.dateFilter$,this.patientId$,this.clinicalProviderId$,this.legalCaseId$,this.appointmentStatusId$,this.visitKindId$,this.searchQuery$,this.attorneyId$,this.firmId$,this.medicalRecordStatusId$,this.medicalRecordStatusOptions$,($,G,q,k,be,Pe,me,we,Ie,pe,$e,Le,Re)=>({limit:$.limit,skip:$.skip,name:Ie,locationId:G,patientId:k,clinicalProviderId:be,legalCaseId:Pe,appointmentStatusId:me,visitKindId:we,total:$.total,attorneyId:pe,firmId:$e,dateFilter:q,medicalRecordStatusId:Le,medicalRecordStatusOptions:Re})),this.setFormName=this.updater(($,G)=>Object.assign(Object.assign({},$),{formName:G})),this.setAttorneyId=this.updater(($,G)=>Object.assign(Object.assign({},$),{attorneyId:G})),this.setProviderId=this.updater(($,G)=>Object.assign(Object.assign({},$),{providerId:G})),this.setFirmId=this.updater(($,G)=>Object.assign(Object.assign({},$),{firmId:G})),this.setLocationId=this.updater(($,G)=>Object.assign(Object.assign({},$),{locationId:G})),this.setId=this.updater(($,G)=>Object.assign(Object.assign({},$),{id:G})),this.setPatientId=this.updater(($,G)=>Object.assign(Object.assign({},$),{patientId:G})),this.setClinicalProviderId=this.updater(($,G)=>Object.assign(Object.assign({},$),{clinicalProviderId:G})),this.setLegalCaseId=this.updater(($,G)=>Object.assign(Object.assign({},$),{legalCaseId:G})),this.setAppointmentStatusId=this.updater(($,G)=>Object.assign(Object.assign({},$),{appointmentStatusId:G})),this.setMedicalRecordStatusId=this.updater(($,G)=>Object.assign(Object.assign({},$),{medicalRecordStatusId:G})),this.setMedicalRecordStatusOptions=this.updater(($,G)=>Object.assign(Object.assign({},$),{medicalRecordStatusOptions:G})),this.setVisitKindId=this.updater(($,G)=>Object.assign(Object.assign({},$),{visitKindId:G})),this.setDateFilter=this.updater(($,G)=>Object.assign(Object.assign({},$),{dateFilter:G})),this.setSkip=this.updater(($,G)=>Object.assign(Object.assign({},$),{paging:Object.assign(Object.assign({},$.paging),{skip:G})})),this.setLimit=this.updater(($,G)=>Object.assign(Object.assign({},$),{paging:Object.assign(Object.assign({},$.paging),{limit:G})})),this.filterLocations=$=>this.data.userSelectLocations({input:{name:$}}).pipe((0,x._b)(G=>{const q=G.data.items;return this.patchState({locations:q}),q},G=>this.patchState({errors:G.graphQLErrors?G.graphQLErrors:G})),(0,K.U)(G=>G.data.items)),this.filterPatients=$=>this.data.userSelectPatients({input:{name:$}}).pipe((0,x._b)(G=>{const q=G.data.items;return this.patchState({patients:q}),q},G=>this.patchState({errors:G.graphQLErrors?G.graphQLErrors:G})),(0,K.U)(G=>G.data.items)),this.filterClinicalProviders=$=>this.data.userSelectClinicalProviders({input:{name:$}}).pipe((0,x._b)(G=>{const q=G.data.items;return this.patchState({clinicalProviders:q}),q},G=>this.patchState({errors:G.graphQLErrors?G.graphQLErrors:G})),(0,K.U)(G=>G.data.items)),this.filterLegalCases=$=>this.data.userSelectLegalCases({input:{name:$}}).pipe((0,x._b)(G=>{const q=G.data.items;return this.patchState({legalCases:q}),q},G=>this.patchState({errors:G.graphQLErrors?G.graphQLErrors:G})),(0,K.U)(G=>G.data.items)),this.filterAppointmentStatuses=$=>this.data.userSelectAppointmentStatuses({input:{name:$}}).pipe((0,x._b)(G=>{const q=G.data.items;return this.patchState({appointmentStatuses:q}),q},G=>this.patchState({errors:G.graphQLErrors?G.graphQLErrors:G})),(0,K.U)(G=>G.data.items)),this.filterVisitKinds=$=>this.data.userSelectVisitKinds({input:{name:$}}).pipe((0,x._b)(G=>{const q=G.data.items;return this.patchState({visitKinds:q}),q},G=>this.patchState({errors:G.graphQLErrors?G.graphQLErrors:G})),(0,K.U)(G=>G.data.items)),this.addLocation=this.updater(($,G)=>Object.assign(Object.assign({},$),{locations:$.locations.concat(G)})),this.addPatient=this.updater(($,G)=>Object.assign(Object.assign({},$),{patients:$.patients.concat(G)})),this.addClinicalProvider=this.updater(($,G)=>Object.assign(Object.assign({},$),{clinicalProviders:$.clinicalProviders.concat(G)})),this.addLegalCase=this.updater(($,G)=>Object.assign(Object.assign({},$),{legalCases:$.legalCases.concat(G)})),this.addAppointmentStatus=this.updater(($,G)=>Object.assign(Object.assign({},$),{appointmentStatuses:$.appointmentStatuses.concat(G)})),this.addVisitKind=this.updater(($,G)=>Object.assign(Object.assign({},$),{visitKinds:$.visitKinds.concat(G)})),this.deleteAppointment=this.updater(($,G)=>Object.assign(Object.assign({},$),{appointments:$.appointments.filter(q=>q.id!==G.id)})),this.setItem=this.updater(($,G)=>Object.assign(Object.assign({},$),{item:G})),this.addNewAppointment=this.updater(($,G)=>Object.assign(Object.assign({},$),{appointments:[...$.appointments,G]})),this.updateAppointment=this.updater(($,G)=>Object.assign(Object.assign({},$),{appointments:$.appointments.map(q=>q.id===G.id?G:q)})),this.addAppointments=this.updater(($,G)=>Object.assign(Object.assign({},$),{appointments:$.appointments.concat(G)})),this.updateAppointments=this.updater(($,G)=>Object.assign(Object.assign({},$),{appointments:$.appointments.map(q=>G.find(be=>be.id===q.id)||q)})),this.setSearchQuery=this.updater(($,G)=>Object.assign(Object.assign({},$),{searchQuery:G})),this.loadAppointmentEffect=this.effect($=>$.pipe((0,se.b)(()=>this.patchState({loading:!0})),(0,j.w)(G=>this.data.userAppointment({appointmentId:G}).pipe((0,x._b)(q=>this.patchState({item:q.data.item,errors:q.errors,loading:!1}),q=>this.patchState({loading:!1,errors:q.graphQLErrors?q.graphQLErrors:q})))))),this.loadAppointmentsEffect=this.effect($=>$.pipe((0,se.b)(()=>this.patchState({loading:!0})),(0,g.M)(this.input$),(0,j.w)(([G,q])=>(console.log("appointment input",q),this.data.userAppointments({input:q}).pipe((0,x._b)(k=>this.patchState({paging:{limit:q.limit,skip:q.skip,total:k.data.count.total},appointments:k.data.items,errors:k.errors,loading:!1}),k=>this.patchState({loading:!1,errors:k.graphQLErrors?k.graphQLErrors:k}))))))),this.uploadBillEffect=this.effect($=>$.pipe((0,se.b)(()=>this.patchState({loading:!0})),(0,j.w)(G=>(console.log("appointment input",G),this.data.userUploadBill({input:G}).pipe((0,x._b)(q=>this.patchState({item:Object.assign(Object.assign({},G),{bill:q.data.updated.bill}),errors:q.errors,loading:!1}),q=>this.patchState({loading:!1,errors:q.graphQLErrors?q.graphQLErrors:q}))))))),this.createAppointmentEffect=this.effect($=>$.pipe((0,se.b)(()=>this.patchState({loading:!0})),(0,j.w)(G=>this.appointmentService.createAppointment(Object.assign({},G)).pipe((0,x._b)(q=>{this.addNewAppointment(q),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:q,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},q=>{q.graphQLErrors?(this.toast.error(q.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:q.graphQLErrors?q.graphQLErrors:q})):(this.toast.error(q.Message),this.formService.setErrors(q.Data))}))))),this.updateAppointmentEffect=this.effect($=>$.pipe((0,se.b)(()=>this.patchState({loading:!0})),(0,g.M)(this.item$),(0,j.w)(([G,q])=>this.appointmentService.updateAppointment(G,G.id).pipe((0,x._b)(k=>{this.updateAppointment(k),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:k,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},k=>{k.graphQLErrors?(this.toast.error(k.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:k.graphQLErrors?k.graphQLErrors:k})):(this.toast.error(k.Message),this.formService.setErrors(k.Data))}))))),this.deleteAppointmentEffect=this.effect($=>$.pipe((0,se.b)(()=>this.patchState({loading:!0})),(0,g.M)(this.item$),(0,j.w)(([G,q])=>this.data.userDeleteAppointment({appointmentId:q.id}).pipe((0,x._b)(k=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:k.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},k=>{k.graphQLErrors?(this.toast.error(k.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:k.graphQLErrors?k.graphQLErrors:k})):(this.toast.error(k.Message),this.formService.setErrors(k.Data))}))))),this.importExcelEffect=this.effect($=>$.pipe((0,se.b)(()=>this.patchState({loading:!0})),(0,j.w)(G=>this.appointmentService.importAppointments(G).pipe((0,B.K)(q=>{var k;return this.toast.error(null!==(k=q.Message)&&void 0!==k?k:"Failed to save",{duration:3e3}),R.E}),(0,se.b)(q=>{const k=JSON.parse(q.created),be=JSON.parse(q.updated),Pe=JSON.parse(q.failed),me=k.length+be.length+Pe.length;this.addAppointments(k),this.updateAppointments(be),this.toast.success(`${k.length} created, ${be.length} updated, ${Pe.length} failed of total ${me}`,{duration:3e3})}))))),this.deleteSpecificAppointmentEffect=this.effect($=>$.pipe((0,j.w)(G=>this.data.userDeleteAppointment({appointmentId:G.id}).pipe((0,x._b)(q=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:q.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},q=>{q.graphQLErrors?(this.toast.error(q.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:q.graphQLErrors?q.graphQLErrors:q})):(this.toast.error(q.Message),this.formService.setErrors(q.Data))}))))),this.checkInAppointmentEffect=this.effect($=>$.pipe((0,se.b)(()=>this.patchState({loading:!0})),(0,g.M)(this.item$),(0,j.w)(([G,q])=>(console.log("checkIn store appointment",G),this.appointmentService.checkInAppointment(G).pipe((0,x._b)(k=>{this.updateAppointment(k),this.toast.success("Checked In Successfully!"),setTimeout(()=>this.patchState({item:k,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},k=>{k.graphQLErrors?(this.toast.error(k.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:k.graphQLErrors?k.graphQLErrors:k})):(this.toast.error(k.Message),this.formService.setErrors(k.Data))})))))),this.confirmAppointmentEffect=this.effect($=>$.pipe((0,se.b)(()=>this.patchState({loading:!0})),(0,g.M)(this.item$),(0,j.w)(([G,q])=>this.appointmentService.confirmAppointment(G).pipe((0,x._b)(k=>{this.updateAppointment(k),this.toast.success("Confirmed Successfully!"),setTimeout(()=>this.patchState({item:k,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},k=>{k.graphQLErrors?(this.toast.error(k.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:k.graphQLErrors?k.graphQLErrors:k})):(this.toast.error(k.Message),this.formService.setErrors(k.Data))}))))),this.requestRescehduleAppointmentEffect=this.effect($=>$.pipe((0,se.b)(()=>this.patchState({loading:!0})),(0,g.M)(this.item$),(0,j.w)(([G,q])=>this.appointmentService.requestRescheduleAppointment(G).pipe((0,x._b)(k=>{this.updateAppointment(k),this.toast.success("Requested Reschedule Successfully!"),setTimeout(()=>this.patchState({item:k,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},k=>{k.graphQLErrors?(this.toast.error(k.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:k.graphQLErrors?k.graphQLErrors:k})):(this.toast.error(k.Message),this.formService.setErrors(k.Data))}))))),this.rescehduleAppointmentEffect=this.effect($=>$.pipe((0,se.b)(()=>this.patchState({loading:!0})),(0,g.M)(this.item$),(0,j.w)(([{appointment:G,rescheduleDate:q},k])=>this.appointmentService.rescheduleAppointment(G,q).pipe((0,x._b)(be=>{this.updateAppointment(be),this.toast.success("Rescheduled Successfully!"),setTimeout(()=>this.patchState({item:be,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},be=>{be.graphQLErrors?(this.toast.error(be.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:be.graphQLErrors?be.graphQLErrors:be})):(this.toast.error(be.Message),this.formService.setErrors(be.Data))}))))),this.cancelAppointmentEffect=this.effect($=>$.pipe((0,se.b)(()=>this.patchState({loading:!0})),(0,g.M)(this.item$),(0,j.w)(([G,q])=>this.appointmentService.cancelAppointment(G).pipe((0,x._b)(k=>{this.updateAppointment(k),this.toast.success("Cancelled Successfully!"),setTimeout(()=>this.patchState({item:k,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},k=>{k.graphQLErrors?(this.toast.error(k.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:k.graphQLErrors?k.graphQLErrors:k})):(this.toast.error(k.Message),this.formService.setErrors(k.Data))}))))),this.hideAppointmentEffect=this.effect($=>$.pipe((0,se.b)(()=>this.patchState({loading:!0})),(0,g.M)(this.item$),(0,j.w)(([G,q])=>this.appointmentService.hideAppointment(G).pipe((0,x._b)(k=>{this.updateAppointment(k),this.toast.success("Hided Successfully!"),setTimeout(()=>this.patchState({item:k,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},k=>{k.graphQLErrors?(this.toast.error(k.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:k.graphQLErrors?k.graphQLErrors:k})):(this.toast.error(k.Message),this.formService.setErrors(k.Data))}))))),this.route.snapshot.paramMap.has("appointmentId")){const $=this.route.snapshot.paramMap.get("appointmentId");this.setId($),this.setFormName("appointment_edit")}else this.setFormName("appointment_create");if(this.route.snapshot.paramMap.has("locationId")){const $=this.route.snapshot.paramMap.get("locationId");this.setLocationId($)}if(this.route.snapshot.paramMap.has("patientId")){const $=this.route.snapshot.paramMap.get("patientId");this.setPatientId($)}if(this.route.snapshot.paramMap.has("clinicalProviderId")){const $=this.route.snapshot.paramMap.get("clinicalProviderId");this.setClinicalProviderId($)}if(this.route.snapshot.paramMap.has("legalCaseId")){const $=this.route.snapshot.paramMap.get("legalCaseId");this.setLegalCaseId($)}if(this.route.snapshot.paramMap.has("appointmentStatusId")){const $=this.route.snapshot.paramMap.get("appointmentStatusId");this.setAppointmentStatusId($)}if(this.route.snapshot.paramMap.has("visitKindId")){const $=this.route.snapshot.paramMap.get("visitKindId");this.setVisitKindId($)}if(this.route.snapshot.paramMap.has("attorneyId")){const $=this.route.snapshot.paramMap.get("attorneyId");this.setAttorneyId($)}if(this.route.snapshot.paramMap.has("firmId")){const $=this.route.snapshot.paramMap.get("firmId");this.setFirmId($)}}validateImportData(T){return this.vm$.pipe((0,j.w)(O=>this.appointmentService.validateAppointmentExcelData(T,O.locations,O.patients,O.clinicalProviders,O.legalCases,O.appointmentStatuses)))}setAssignUserModalCtrl(T){this.assignUserModalCtrl=T}openAssignUserModal(T){var O;null===(O=this.assignUserModalCtrl)||void 0===O||O.open(T,{},this)}filterByMedicalRecordStatus(T){T&&(this.setMedicalRecordStatusOptions(T),this.loadAppointmentsEffect())}assignAppointmentToUser(T){const{id:O,name:D,assignedToId:z}=T,re=this.actionResult$.subscribe(ue=>{var $;const{done:G}=ue;G&&(re.unsubscribe(),null===($=this.assignUserModalCtrl)||void 0===$||$.close())});this.updateAppointmentEffect({id:O,name:D,assignedToId:z})}}return C.\u0275fac=function(T){return new(T||C)(h.LFG(L.q),h.LFG(ce.F0),h.LFG(ce.gz),h.LFG(e.F),h.LFG(V.o),h.LFG(Z))},C.\u0275prov=h.Yz7({token:C,factory:C.\u0275fac}),C})()},30269:(Ee,Ne,Q)=>{Q.d(Ne,{I:()=>ne});var x=Q(24280),W=Q(60515),R=Q(54004),j=Q(18505),K=Q(63900),se=Q(11365),g=Q(70262),B=Q(94650),S=Q(73602),h=Q(30144),L=Q(71873),ce=Q(4523),e=Q(56869),V=Q(88821),E=Q(39646);class ie extends V.T_{constructor(N){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=N}Do(N){return this.businessProvider=N,this.serviceContext=N.serviceContext,this.loggingService=N.loggingService,this.execute(),this.response}}var X=Q(26177);class U extends ie{constructor(N,y,P,ee){super("ValidateAttorneyExcelDataAction"),this.valid=!1,this.excelData=N,this.firms=y,this.attorneyStatuses=P,this.attorneyTypes=ee}preValidateAction(){const N=[];this.excelData.map((y,P)=>{N.push(y.name),this.validationContext.addRule(new X.mi(`firmName_${P}_is_valid}`,"Firm Is Not Valid","firm.name",y.firm,this.firms,!0)),this.validationContext.addRule(new X.mi(`attorneyStatusName_${P}_is_valid}`,"Attorney Status Is Not Valid","attorneyStatus.name",y.attorneyStatus,this.attorneyStatuses,!0)),this.validationContext.addRule(new X.mi(`attorneyTypeName_${P}_is_valid}`,"Attorney Type Is Not Valid","attorneyType.name",y.attorneyType,this.attorneyTypes,!0))}),this.validationContext.addRule(new X.cL("nameIsUnique","Name should be unique",N,!0))}performAction(){}finish(){super.finish();const N={};let y=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(P=>{P instanceof X.mi?P.isValid||(N[P.columnName]?N[P.columnName].newNames.includes(P.newName)||N[P.columnName].newNames.push(P.newName):N[P.columnName]={options:P.possibleValueList.map(ee=>ee.name),newNames:[P.newName]}):P instanceof X.cL&&(P.isValid||(y=P.conflicts))})):this.valid=!0,this.response=(0,E.of)({valid:this.valid,excelData:this.excelData,conflictNames:y,unknownNames:N})}}var I=Q(28234);class F extends X.wS{constructor(N,y,P,ee,Z){super(N,y,P,ee,Z,!0)}}class ye extends X.ul{constructor(N,y,P,ee=!1){super(N,y,ee),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=P,this.configureRules()}configureRules(){this.rules.push(new X.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new F("name","The attorney name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class f extends ie{constructor(N){super("CreateAttorneyAction"),this.input=N}preValidateAction(){this.validationContext.addRule(new ye("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateAttorney({input:this.input}).pipe((0,K.w)(N=>(0,I.of)(N.data.created)))}}class Ae extends ie{constructor(N){super("UpdateAttorneysAction"),this.attorneys=N}preValidateAction(){this.validationContext.addRule(new X.DJ("Input","Input should have values",this.attorneys,!0))}performAction(){this.response=this.businessProvider.data.userUpdateAttorneys({input:{attorneys:this.attorneys}}).pipe((0,K.w)(N=>(0,E.of)(N.data.updated)))}}class de extends ie{constructor(N,y){super("UpdateAttorneyAction"),this.attorney=N,this.attorneyId=y}preValidateAction(){this.validationContext.addRule(new X.DJ("Input","Input should have values",this.attorney,!0)).addRule(new X.xF("Id","Id should be a CUID and not null",this.attorneyId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateAttorney({attorneyId:this.attorneyId,input:this.attorney}).pipe((0,K.w)(N=>(0,E.of)(N.data.updated)))}}let Te=(()=>{class M extends V.nH{constructor(y,P,ee){super("NotificationService.AttorneyBusinessProviderService",y,ee),this.data=P}createAttorney(y){const P=new f(y);return P.Do(this),P.response}updateAttorney(y,P){const ee=new de(y,P);return ee.Do(this),ee.response}importAttorneys(y){const P=new Ae(y);return P.Do(this),P.response}validateAttorneyExcelData(y,P,ee,Z){const te=new U(y,P,ee,Z);return te.Do(this),te.response}}return M.\u0275fac=function(y){return new(y||M)(B.LFG(e.ed),B.LFG(S.q),B.LFG(V.oI))},M.\u0275prov=B.Yz7({token:M,factory:M.\u0275fac,providedIn:"root"}),M})(),Fe=(()=>{class M extends V.nH{constructor(y,P,ee){super("AttorneyService",ee,y),this.businessProvider=P}createAttorney(y){const P=Object.fromEntries(Object.entries(y).filter(([ee,Z])=>null!==Z));return this.businessProvider.createAttorney(P)}updateAttorney(y,P){return this.businessProvider.updateAttorney(y,P)}importAttorneys(y){return this.businessProvider.importAttorneys(y)}validateAttorneyExcelData(y,P,ee,Z){return this.businessProvider.validateAttorneyExcelData(y,P,ee,Z)}}return M.\u0275fac=function(y){return new(y||M)(B.LFG(Te,8),B.LFG(Te),B.LFG(e.ed))},M.\u0275prov=B.Yz7({token:M,factory:M.\u0275fac,providedIn:"root"}),M})(),ne=(()=>{class M extends x.m1{constructor(y,P,ee,Z,te,Ce){if(super({loading:!1,attorneys:[],done:!1,searchQuery:"",formName:void 0,firmId:void 0,attorneyStatusId:void 0,attorneyTypeId:void 0,paging:{limit:1e4,skip:0}}),this.data=y,this.router=P,this.route=ee,this.toast=Z,this.formService=te,this.attorneyService=Ce,this.errors$=this.select(O=>O.errors),this.loading$=this.select(O=>O.loading),this.done$=this.select(O=>O.done),this.item$=this.select(O=>O.item),this.attorneys$=this.select(O=>O.attorneys),this.firms$=this.select(O=>O.firms||[]),this.attorneyStatuses$=this.select(O=>O.attorneyStatuses||[]),this.attorneyTypes$=this.select(O=>O.attorneyTypes||[]),this.firmId$=this.select(O=>O.firmId),this.attorneyStatusId$=this.select(O=>O.attorneyStatusId),this.attorneyTypeId$=this.select(O=>O.attorneyTypeId),this.paging$=this.select(O=>O.paging),this.searchQuery$=this.select(O=>O.searchQuery),this.formName$=this.select(O=>O.formName),this.actionResult$=this.select(this.item$,this.done$,(O,D)=>({item:O,done:D}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.attorneys$,this.firms$,this.attorneyStatuses$,this.attorneyTypes$,(O,D,z,re,ue,$,G,q)=>({errors:O,loading:D,item:z,formName:re,attorneys:ue,firms:$,attorneyStatuses:G,attorneyTypes:q}),{debounce:!0}),this.input$=this.select(this.paging$,this.firmId$,this.attorneyStatusId$,this.attorneyTypeId$,this.searchQuery$,(O,D,z,re,ue)=>({limit:O.limit,skip:O.skip,name:ue,firmId:D,attorneyStatusId:z,attorneyTypeId:re,total:O.total})),this.setFormName=this.updater((O,D)=>Object.assign(Object.assign({},O),{formName:D})),this.setFirmId=this.updater((O,D)=>Object.assign(Object.assign({},O),{firmId:D})),this.setAttorneyStatusId=this.updater((O,D)=>Object.assign(Object.assign({},O),{attorneyStatusId:D})),this.setAttorneyTypeId=this.updater((O,D)=>Object.assign(Object.assign({},O),{attorneyTypeId:D})),this.filterFirms=O=>this.data.userSelectFirms({input:{name:O}}).pipe((0,x._b)(D=>{let z=D.data.items;return this.patchState({firms:z}),z},D=>this.patchState({errors:D.graphQLErrors?D.graphQLErrors:D})),(0,R.U)(D=>D.data.items)),this.filterAttorneyStatuses=O=>this.data.userSelectAttorneyStatuses({input:{name:O}}).pipe((0,x._b)(D=>{let z=D.data.items;return this.patchState({attorneyStatuses:z}),z},D=>this.patchState({errors:D.graphQLErrors?D.graphQLErrors:D})),(0,R.U)(D=>D.data.items)),this.filterAttorneyTypes=O=>this.data.userSelectAttorneyTypes({input:{name:O}}).pipe((0,x._b)(D=>{let z=D.data.items;return this.patchState({attorneyTypes:z}),z},D=>this.patchState({errors:D.graphQLErrors?D.graphQLErrors:D})),(0,R.U)(D=>D.data.items)),this.addFirm=this.updater((O,D)=>Object.assign(Object.assign({},O),{firms:O.firms.concat(D)})),this.addAttorneyStatus=this.updater((O,D)=>Object.assign(Object.assign({},O),{attorneyStatuses:O.attorneyStatuses.concat(D)})),this.addAttorneyType=this.updater((O,D)=>Object.assign(Object.assign({},O),{attorneyTypes:O.attorneyTypes.concat(D)})),this.setItem=this.updater((O,D)=>Object.assign(Object.assign({},O),{item:D})),this.addNewAttorney=this.updater((O,D)=>Object.assign(Object.assign({},O),{attorneys:[...O.attorneys,D]})),this.updateAttorney=this.updater((O,D)=>Object.assign(Object.assign({},O),{attorneys:O.attorneys.map(z=>z.id===D.id?D:z)})),this.addAttorneys=this.updater((O,D)=>Object.assign(Object.assign({},O),{attorneys:O.attorneys.concat(D)})),this.updateAttorneys=this.updater((O,D)=>Object.assign(Object.assign({},O),{attorneys:O.attorneys.map(z=>D.find(ue=>ue.id===z.id)||z)})),this.setSearchQuery=this.updater((O,D)=>Object.assign(Object.assign({},O),{searchQuery:D})),this.loadAttorneyEffect=this.effect(O=>O.pipe((0,j.b)(()=>this.patchState({loading:!0})),(0,K.w)(D=>this.data.userAttorney({attorneyId:D}).pipe((0,x._b)(z=>{this.patchState({item:z.data.item,errors:z.errors,loading:!1})},z=>this.patchState({loading:!1,errors:z.graphQLErrors?z.graphQLErrors:z})))))),this.loadAttorneysEffect=this.effect(O=>O.pipe((0,j.b)(()=>this.patchState({loading:!0})),(0,se.M)(this.input$),(0,K.w)(([D,z])=>this.data.userAttorneys({input:z}).pipe((0,x._b)(re=>this.patchState({paging:{limit:z.limit,skip:z.skip,total:re.data.count.total},attorneys:re.data.items,errors:re.errors,loading:!1}),re=>this.patchState({loading:!1,errors:re.graphQLErrors?re.graphQLErrors:re})))))),this.createAttorneyEffect=this.effect(O=>O.pipe((0,j.b)(()=>this.patchState({loading:!0})),(0,K.w)(D=>this.attorneyService.createAttorney(Object.assign({},D)).pipe((0,x._b)(z=>{this.addNewAttorney(z),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:z,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},z=>{z.graphQLErrors?(this.toast.error(z.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:z.graphQLErrors?z.graphQLErrors:z})):(this.toast.error(z.Message),this.formService.setErrors(z.Data))}))))),this.updateAttorneyEffect=this.effect(O=>O.pipe((0,j.b)(()=>this.patchState({loading:!0})),(0,se.M)(this.item$),(0,K.w)(([D,z])=>this.attorneyService.updateAttorney(D,D.id).pipe((0,x._b)(re=>{this.updateAttorney(re),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:re,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},re=>{re.graphQLErrors?(this.toast.error(re.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:re.graphQLErrors?re.graphQLErrors:re})):(this.toast.error(re.Message),this.formService.setErrors(re.Data))}))))),this.deleteAttorneyEffect=this.effect(O=>O.pipe((0,j.b)(()=>this.patchState({loading:!0})),(0,se.M)(this.item$),(0,K.w)(([D,z])=>this.data.userDeleteAttorney({attorneyId:z.id}).pipe((0,x._b)(re=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:re.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},re=>{re.graphQLErrors?(this.toast.error(re.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:re.graphQLErrors?re.graphQLErrors:re})):(this.toast.error(re.Message),this.formService.setErrors(re.Data))}))))),this.importExcelEffect=this.effect(O=>O.pipe((0,j.b)(()=>this.patchState({loading:!0})),(0,K.w)(D=>this.attorneyService.importAttorneys(D).pipe((0,g.K)(z=>{var re;return this.toast.error(null!==(re=z.Message)&&void 0!==re?re:"Failed to save",{duration:3e3}),W.E}),(0,j.b)(z=>{const re=JSON.parse(z.created),ue=JSON.parse(z.updated),$=JSON.parse(z.failed),G=re.length+ue.length+$.length;this.addAttorneys(re),this.updateAttorneys(ue),this.toast.success(`${re.length} created, ${ue.length} updated, ${$.length} failed of total ${G}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("attorneyId")?(this.route.snapshot.paramMap.get("attorneyId"),this.setFormName("attorney_edit")):this.setFormName("attorney_create"),this.route.snapshot.paramMap.has("firmId")){var C=this.route.snapshot.paramMap.get("firmId");this.setFirmId(C)}if(this.route.snapshot.paramMap.has("attorneyStatusId")){var v=this.route.snapshot.paramMap.get("attorneyStatusId");this.setAttorneyStatusId(v)}if(this.route.snapshot.paramMap.has("attorneyTypeId")){var T=this.route.snapshot.paramMap.get("attorneyTypeId");this.setAttorneyTypeId(T)}}validateImportData(y){return this.vm$.pipe((0,K.w)(P=>this.attorneyService.validateAttorneyExcelData(y,P.firms,P.attorneyStatuses,P.attorneyTypes)))}}return M.\u0275fac=function(y){return new(y||M)(B.LFG(S.q),B.LFG(h.F0),B.LFG(h.gz),B.LFG(L.F),B.LFG(ce.o),B.LFG(Fe))},M.\u0275prov=B.Yz7({token:M,factory:M.\u0275fac}),M})()},78649:(Ee,Ne,Q)=>{Q.d(Ne,{I:()=>Fe});var x=Q(24280),W=Q(60515),R=Q(18505),j=Q(63900),K=Q(11365),se=Q(70262),g=Q(94650),B=Q(73602),S=Q(30144),h=Q(71873),L=Q(4523),ce=Q(56869),e=Q(88821),V=Q(39646);class E extends e.T_{constructor(M){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=M}Do(M){return this.businessProvider=M,this.serviceContext=M.serviceContext,this.loggingService=M.loggingService,this.execute(),this.response}}var ie=Q(26177);class X extends E{constructor(M){super("ValidateCaseStatusExcelDataAction"),this.valid=!1,this.excelData=M}preValidateAction(){const M=[];this.excelData.map((N,y)=>{M.push(N.name)}),this.validationContext.addRule(new ie.cL("nameIsUnique","Name should be unique",M,!0))}performAction(){}finish(){super.finish();const M={};let N=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(y=>{y instanceof ie.mi?y.isValid||(M[y.columnName]?M[y.columnName].newNames.includes(y.newName)||M[y.columnName].newNames.push(y.newName):M[y.columnName]={options:y.possibleValueList.map(P=>P.name),newNames:[y.newName]}):y instanceof ie.cL&&(y.isValid||(N=y.conflicts))})):this.valid=!0,this.response=(0,V.of)({valid:this.valid,excelData:this.excelData,conflictNames:N,unknownNames:M})}}var U=Q(28234);class I extends ie.wS{constructor(M,N,y,P,ee){super(M,N,y,P,ee,!0)}}class F extends ie.ul{constructor(M,N,y,P=!1){super(M,N,P),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=y,this.configureRules()}configureRules(){this.rules.push(new ie.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new I("name","The casestatus name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class ye extends E{constructor(M){super("CreateCaseStatusAction"),this.input=M}preValidateAction(){this.validationContext.addRule(new F("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateCaseStatus({input:this.input}).pipe((0,j.w)(M=>(0,U.of)(M.data.created)))}}class f extends E{constructor(M){super("UpdateCaseStatusesAction"),this.caseStatuses=M}preValidateAction(){this.validationContext.addRule(new ie.DJ("Input","Input should have values",this.caseStatuses,!0))}performAction(){this.response=this.businessProvider.data.userUpdateCaseStatuses({input:{caseStatuses:this.caseStatuses}}).pipe((0,j.w)(M=>(0,V.of)(M.data.updated)))}}class Ae extends E{constructor(M,N){super("UpdateCaseStatusAction"),this.caseStatus=M,this.caseStatusId=N}preValidateAction(){this.validationContext.addRule(new ie.DJ("Input","Input should have values",this.caseStatus,!0)).addRule(new ie.xF("Id","Id should be a CUID and not null",this.caseStatusId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateCaseStatus({caseStatusId:this.caseStatusId,input:this.caseStatus}).pipe((0,j.w)(M=>(0,V.of)(M.data.updated)))}}let de=(()=>{class ne extends e.nH{constructor(N,y,P){super("NotificationService.CaseStatusBusinessProviderService",N,P),this.data=y}createCaseStatus(N){const y=new ye(N);return y.Do(this),y.response}updateCaseStatus(N,y){const P=new Ae(N,y);return P.Do(this),P.response}importCaseStatuses(N){const y=new f(N);return y.Do(this),y.response}validateCaseStatusExcelData(N){const y=new X(N);return y.Do(this),y.response}}return ne.\u0275fac=function(N){return new(N||ne)(g.LFG(ce.ed),g.LFG(B.q),g.LFG(e.oI))},ne.\u0275prov=g.Yz7({token:ne,factory:ne.\u0275fac,providedIn:"root"}),ne})(),Te=(()=>{class ne extends e.nH{constructor(N,y,P){super("CaseStatusService",P,N),this.businessProvider=y}createCaseStatus(N){const y=Object.fromEntries(Object.entries(N).filter(([P,ee])=>null!==ee));return this.businessProvider.createCaseStatus(y)}updateCaseStatus(N,y){return this.businessProvider.updateCaseStatus(N,y)}importCaseStatuses(N){return this.businessProvider.importCaseStatuses(N)}validateCaseStatusExcelData(N){return this.businessProvider.validateCaseStatusExcelData(N)}}return ne.\u0275fac=function(N){return new(N||ne)(g.LFG(de,8),g.LFG(de),g.LFG(ce.ed))},ne.\u0275prov=g.Yz7({token:ne,factory:ne.\u0275fac,providedIn:"root"}),ne})(),Fe=(()=>{class ne extends x.m1{constructor(N,y,P,ee,Z,te){super({loading:!1,caseStatuses:[],done:!1,searchQuery:"",formName:void 0,paging:{limit:1e4,skip:0}}),this.data=N,this.router=y,this.route=P,this.toast=ee,this.formService=Z,this.caseStatusService=te,this.errors$=this.select(b=>b.errors),this.loading$=this.select(b=>b.loading),this.done$=this.select(b=>b.done),this.item$=this.select(b=>b.item),this.caseStatuses$=this.select(b=>b.caseStatuses),this.paging$=this.select(b=>b.paging),this.searchQuery$=this.select(b=>b.searchQuery),this.formName$=this.select(b=>b.formName),this.actionResult$=this.select(this.item$,this.done$,(b,C)=>({item:b,done:C}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.caseStatuses$,(b,C,v,T,O)=>({errors:b,loading:C,item:v,formName:T,caseStatuses:O}),{debounce:!0}),this.input$=this.select(this.paging$,this.searchQuery$,(b,C)=>({limit:b.limit,skip:b.skip,name:C,total:b.total})),this.setFormName=this.updater((b,C)=>Object.assign(Object.assign({},b),{formName:C})),this.setItem=this.updater((b,C)=>Object.assign(Object.assign({},b),{item:C})),this.addNewCaseStatus=this.updater((b,C)=>Object.assign(Object.assign({},b),{caseStatuses:[...b.caseStatuses,C]})),this.updateCaseStatus=this.updater((b,C)=>Object.assign(Object.assign({},b),{caseStatuses:b.caseStatuses.map(v=>v.id===C.id?C:v)})),this.addCaseStatuses=this.updater((b,C)=>Object.assign(Object.assign({},b),{caseStatuses:b.caseStatuses.concat(C)})),this.updateCaseStatuses=this.updater((b,C)=>Object.assign(Object.assign({},b),{caseStatuses:b.caseStatuses.map(v=>C.find(O=>O.id===v.id)||v)})),this.setSearchQuery=this.updater((b,C)=>Object.assign(Object.assign({},b),{searchQuery:C})),this.loadCaseStatusEffect=this.effect(b=>b.pipe((0,R.b)(()=>this.patchState({loading:!0})),(0,j.w)(C=>this.data.userCaseStatus({caseStatusId:C}).pipe((0,x._b)(v=>{this.patchState({item:v.data.item,errors:v.errors,loading:!1})},v=>this.patchState({loading:!1,errors:v.graphQLErrors?v.graphQLErrors:v})))))),this.loadCaseStatusesEffect=this.effect(b=>b.pipe((0,R.b)(()=>this.patchState({loading:!0})),(0,K.M)(this.input$),(0,j.w)(([C,v])=>this.data.userCaseStatuses({input:v}).pipe((0,x._b)(T=>this.patchState({paging:{limit:v.limit,skip:v.skip,total:T.data.count.total},caseStatuses:T.data.items,errors:T.errors,loading:!1}),T=>this.patchState({loading:!1,errors:T.graphQLErrors?T.graphQLErrors:T})))))),this.createCaseStatusEffect=this.effect(b=>b.pipe((0,R.b)(()=>this.patchState({loading:!0})),(0,j.w)(C=>this.caseStatusService.createCaseStatus(Object.assign({},C)).pipe((0,x._b)(v=>{this.addNewCaseStatus(v),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:v,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},v=>{v.graphQLErrors?(this.toast.error(v.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:v.graphQLErrors?v.graphQLErrors:v})):(this.toast.error(v.Message),this.formService.setErrors(v.Data))}))))),this.updateCaseStatusEffect=this.effect(b=>b.pipe((0,R.b)(()=>this.patchState({loading:!0})),(0,K.M)(this.item$),(0,j.w)(([C,v])=>this.caseStatusService.updateCaseStatus(C,C.id).pipe((0,x._b)(T=>{this.updateCaseStatus(T),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:T,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},T=>{T.graphQLErrors?(this.toast.error(T.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:T.graphQLErrors?T.graphQLErrors:T})):(this.toast.error(T.Message),this.formService.setErrors(T.Data))}))))),this.deleteCaseStatusEffect=this.effect(b=>b.pipe((0,R.b)(()=>this.patchState({loading:!0})),(0,K.M)(this.item$),(0,j.w)(([C,v])=>this.data.userDeleteCaseStatus({caseStatusId:v.id}).pipe((0,x._b)(T=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:T.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},T=>{T.graphQLErrors?(this.toast.error(T.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:T.graphQLErrors?T.graphQLErrors:T})):(this.toast.error(T.Message),this.formService.setErrors(T.Data))}))))),this.importExcelEffect=this.effect(b=>b.pipe((0,R.b)(()=>this.patchState({loading:!0})),(0,j.w)(C=>this.caseStatusService.importCaseStatuses(C).pipe((0,se.K)(v=>{var T;return this.toast.error(null!==(T=v.Message)&&void 0!==T?T:"Failed to save",{duration:3e3}),W.E}),(0,R.b)(v=>{const T=JSON.parse(v.created),O=JSON.parse(v.updated),D=JSON.parse(v.failed),z=T.length+O.length+D.length;this.addCaseStatuses(T),this.updateCaseStatuses(O),this.toast.success(`${T.length} created, ${O.length} updated, ${D.length} failed of total ${z}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("caseStatusId")?(this.route.snapshot.paramMap.get("caseStatusId"),this.setFormName("caseStatus_edit")):this.setFormName("caseStatus_create")}validateImportData(N){return this.vm$.pipe((0,j.w)(y=>this.caseStatusService.validateCaseStatusExcelData(N)))}}return ne.\u0275fac=function(N){return new(N||ne)(g.LFG(B.q),g.LFG(S.F0),g.LFG(S.gz),g.LFG(h.F),g.LFG(L.o),g.LFG(Te))},ne.\u0275prov=g.Yz7({token:ne,factory:ne.\u0275fac}),ne})()},30760:(Ee,Ne,Q)=>{Q.d(Ne,{j:()=>y});var x=Q(24280),W=Q(60515),R=Q(54004),j=Q(18505),K=Q(63900),se=Q(11365),g=Q(70262),B=Q(22412),S=Q(15439),h=Q.n(S),L=Q(94650),ce=Q(73602),e=Q(30144),V=Q(71873),E=Q(4523),ie=Q(56869),X=Q(88821),U=Q(39646);class I extends X.T_{constructor(ee){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=ee}Do(ee){return this.businessProvider=ee,this.serviceContext=ee.serviceContext,this.loggingService=ee.loggingService,this.execute(),this.response}}var F=Q(26177);class ye extends I{constructor(ee,Z,te){super("ValidateClinicalProviderLocationExcelDataAction"),this.valid=!1,this.excelData=ee,this.clinicalProviders=Z,this.locations=te}preValidateAction(){const ee=[];this.excelData.map((Z,te)=>{ee.push(Z.name),this.validationContext.addRule(new F.mi(`clinicalProviderName_${te}_is_valid}`,"Clinical Provider Is Not Valid","clinicalProvider.name",Z.clinicalProvider,this.clinicalProviders,!0)),this.validationContext.addRule(new F.mi(`locationName_${te}_is_valid}`,"Location Is Not Valid","location.name",Z.location,this.locations,!0))}),this.validationContext.addRule(new F.cL("nameIsUnique","Name should be unique",ee,!0))}performAction(){}finish(){super.finish();const ee={};let Z=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(te=>{te instanceof F.mi?te.isValid||(ee[te.columnName]?ee[te.columnName].newNames.includes(te.newName)||ee[te.columnName].newNames.push(te.newName):ee[te.columnName]={options:te.possibleValueList.map(Ce=>Ce.name),newNames:[te.newName]}):te instanceof F.cL&&(te.isValid||(Z=te.conflicts))})):this.valid=!0,this.response=(0,U.of)({valid:this.valid,excelData:this.excelData,conflictNames:Z,unknownNames:ee})}}var f=Q(28234);class Ae extends F.wS{constructor(ee,Z,te,Ce,b){super(ee,Z,te,Ce,b,!0)}}class de extends F.ul{constructor(ee,Z,te,Ce=!1){super(ee,Z,Ce),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=te,this.configureRules()}configureRules(){this.rules.push(new F.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new Ae("name","The clinicalproviderlocation name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class Te extends I{constructor(ee){super("CreateClinicalProviderLocationAction"),this.input=ee}preValidateAction(){this.validationContext.addRule(new de("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateClinicalProviderLocation({input:this.input}).pipe((0,K.w)(ee=>(0,f.of)(ee.data.created)))}}class Fe extends I{constructor(ee){super("UpdateClinicalProviderLocationsAction"),this.clinicalProviderLocations=ee}preValidateAction(){this.validationContext.addRule(new F.DJ("Input","Input should have values",this.clinicalProviderLocations,!0))}performAction(){this.response=this.businessProvider.data.userUpdateClinicalProviderLocations({input:{clinicalProviderLocations:this.clinicalProviderLocations}}).pipe((0,K.w)(ee=>(0,U.of)(ee.data.updated)))}}class ne extends I{constructor(ee,Z){super("UpdateClinicalProviderLocationAction"),this.clinicalProviderLocation=ee,this.clinicalProviderLocationId=Z}preValidateAction(){this.validationContext.addRule(new F.DJ("Input","Input should have values",this.clinicalProviderLocation,!0)).addRule(new F.xF("Id","Id should be a CUID and not null",this.clinicalProviderLocationId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateClinicalProviderLocation({clinicalProviderLocationId:this.clinicalProviderLocationId,input:this.clinicalProviderLocation}).pipe((0,K.w)(ee=>(0,U.of)(ee.data.updated)))}}let M=(()=>{class P extends X.nH{constructor(Z,te,Ce){super("NotificationService.ClinicalProviderLocationBusinessProviderService",Z,Ce),this.data=te}createClinicalProviderLocation(Z){const te=new Te(Z);return te.Do(this),te.response}updateClinicalProviderLocation(Z,te){const Ce=new ne(Z,te);return Ce.Do(this),Ce.response}importClinicalProviderLocations(Z){const te=new Fe(Z);return te.Do(this),te.response}validateClinicalProviderLocationExcelData(Z,te,Ce){const b=new ye(Z,te,Ce);return b.Do(this),b.response}}return P.\u0275fac=function(Z){return new(Z||P)(L.LFG(ie.ed),L.LFG(ce.q),L.LFG(X.oI))},P.\u0275prov=L.Yz7({token:P,factory:P.\u0275fac,providedIn:"root"}),P})(),N=(()=>{class P extends X.nH{constructor(Z,te,Ce){super("ClinicalProviderLocationService",Ce,Z),this.businessProvider=te}createClinicalProviderLocation(Z){const te=Object.fromEntries(Object.entries(Z).filter(([Ce,b])=>null!==b));return this.businessProvider.createClinicalProviderLocation(te)}updateClinicalProviderLocation(Z,te){return this.businessProvider.updateClinicalProviderLocation(Z,te)}importClinicalProviderLocations(Z){return this.businessProvider.importClinicalProviderLocations(Z)}validateClinicalProviderLocationExcelData(Z,te,Ce){return this.businessProvider.validateClinicalProviderLocationExcelData(Z,te,Ce)}}return P.\u0275fac=function(Z){return new(Z||P)(L.LFG(M,8),L.LFG(M),L.LFG(ie.ed))},P.\u0275prov=L.Yz7({token:P,factory:P.\u0275fac,providedIn:"root"}),P})(),y=(()=>{class P extends x.m1{constructor(Z,te,Ce,b,C,v){if(super({loading:!1,clinicalProviderLocations:[],done:!1,searchQuery:"",formName:void 0,clinicalProviderId:void 0,locationId:void 0,paging:{limit:1e4,skip:0}}),this.data=Z,this.router=te,this.route=Ce,this.toast=b,this.formService=C,this.clinicalProviderLocationService=v,this.errors$=this.select(D=>D.errors),this.loading$=this.select(D=>D.loading),this.done$=this.select(D=>D.done),this.item$=this.select(D=>D.item),this.formattedItem$=this.select(this.item$,D=>{var z,re,ue,$,G,q,k;const be=[];null===(re=null===(z=D?.clinicalProvider)||void 0===z?void 0:z.clinicalProviderLocations)||void 0===re||re.map(({clinicalProviderLocationAvailabilities:xe})=>{be.push(...xe)});const me=(0,B.vM)(be,xe=>xe.day),we=[];let Ie=!1;const pe=h()().format("ll")+"",$e=h()().format("dddd")+"";let Le;for(const xe in me){let We=me[xe];We.sort((De,Me)=>Date.parse(De.startTime)-Date.parse(Me.startTime)),We=We.map(De=>(De.startTime=h()(De.startTime,"hh:mm A").isValid()?h()(De.startTime,"hh:mm A").format("HH:mm"):De.startTime,De.endTime=h()(De.endTime,"hh:mm A").isValid()?h()(De.endTime,"hh:mm A").format("HH:mm"):De.endTime,De)),xe===$e&&(Le=We),we.push({day:xe,hours:We}),"Sunday"===xe&&(Ie=!0)}const Re={day:pe,hours:Le},je=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];we.sort((xe,We)=>je.indexOf(xe.day)-je.indexOf(We.day));const Je={todayHours:Re,others:we,sundayFlag:Ie},Ue=Object.assign(Object.assign({},D),{clinicalProvider:Object.assign(Object.assign({},D?.clinicalProvider),{rating:0,locations:null===($=null===(ue=D?.clinicalProvider)||void 0===ue?void 0:ue.clinicalProviderLocations)||void 0===$?void 0:$.map(({location:xe,clinicalProviderLocationAvailabilities:We})=>{var De,Me,Qe;return{id:xe?.id,name:xe?.name,locationImages:xe.locationImages,endLatitudeProp:xe?.latitude,endLongitudeProp:xe?.longitude,vendor:null===(Me=null===(De=D?.clinicalProvider)||void 0===De?void 0:De.vendor)||void 0===Me?void 0:Me.name,rating:null!==(Qe=D?.clinicalProvider.rating)&&void 0!==Qe?Qe:0,businessHours:(0,B.f1)(We??[],ys=>ys.day)}}),specialties:null===(q=null===(G=D?.clinicalProvider)||void 0===G?void 0:G.clinicalProviderSpecialties)||void 0===q?void 0:q.map(({specialty:xe})=>({name:xe?.name})),businessHours:Je}),detailView:!0,formattedDistance:(null!==(k=D?.distance)&&void 0!==k?k:0).toFixed(2),clinicalProviderLocations:[]});return delete Ue.clinicalProviderLocations,delete Ue.clinicalProviderSpecialties,Ue}),this.clinicalProviderLocations$=this.select(D=>D.clinicalProviderLocations),this.formattedClinicalProviderLocations$=this.select(this.clinicalProviderLocations$,D=>D.map(z=>{var re,ue,$,G;return Object.assign(Object.assign({},z),{formattedDistance:(null!==(re=z?.distance)&&void 0!==re?re:0).toFixed(2),clinicalProvider:Object.assign(Object.assign({},z.clinicalProvider),{rating:0,specialtiesCount:(null===(ue=z.clinicalProvider.clinicalProviderSpecialties)||void 0===ue?void 0:ue.length)-3,clinicalProviderSpecialties:null===(G=null===($=z?.clinicalProvider)||void 0===$?void 0:$.clinicalProviderSpecialties)||void 0===G?void 0:G.slice(0,3)})})})),this.clinicalProviders$=this.select(D=>D.clinicalProviders||[]),this.locations$=this.select(D=>D.locations||[]),this.clinicalProviderId$=this.select(D=>D.clinicalProviderId),this.locationId$=this.select(D=>D.locationId),this.paging$=this.select(D=>D.paging),this.searchQuery$=this.select(D=>D.searchQuery),this.formName$=this.select(D=>D.formName),this.providerName$=this.select(D=>D.providerName),this.specialties$=this.select(D=>D.specialties),this.favorite$=this.select(D=>D.favorite),this.locationData$=this.select(D=>D.locationData),this.distance$=this.select(D=>D.distance),this.centerLocation$=this.select(D=>D.centerLocation),this.actionResult$=this.select(this.item$,this.done$,(D,z)=>({item:D,done:z}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.clinicalProviderLocations$,this.clinicalProviders$,this.locations$,(D,z,re,ue,$,G,q)=>({errors:D,loading:z,item:re,formName:ue,clinicalProviderLocations:$,clinicalProviders:G,locations:q}),{debounce:!0}),this.input$=this.select(this.paging$,this.clinicalProviderId$,this.locationId$,this.searchQuery$,this.providerName$,this.specialties$,this.favorite$,this.distance$,this.centerLocation$,this.locationData$,(D,z,re,ue,$,G,q,k,be,Pe)=>({limit:D.limit,skip:D.skip,name:ue,clinicalProviderId:z,locationId:re,total:D.total,providerName:$,specialties:G,favorite:q,distance:k,centerLocation:be,locationData:Pe})),this.setFormName=this.updater((D,z)=>Object.assign(Object.assign({},D),{formName:z})),this.setClinicalProviderId=this.updater((D,z)=>Object.assign(Object.assign({},D),{clinicalProviderId:z})),this.setLocationId=this.updater((D,z)=>Object.assign(Object.assign({},D),{locationId:z})),this.setProviderName=this.updater((D,z)=>Object.assign(Object.assign({},D),{providerName:z})),this.setSpecialties=this.updater((D,z)=>Object.assign(Object.assign({},D),{specialties:z})),this.setFavorite=this.updater((D,z)=>Object.assign(Object.assign({},D),{favorite:z})),this.setLocationData=this.updater((D,z)=>Object.assign(Object.assign({},D),{locationData:z})),this.setDistance=this.updater((D,z)=>Object.assign(Object.assign({},D),{distance:z})),this.setCenterLocation=this.updater((D,z)=>Object.assign(Object.assign({},D),{centerLocation:z})),this.setSkip=this.updater((D,z)=>Object.assign(Object.assign({},D),{paging:Object.assign(Object.assign({},D.paging),{skip:z})})),this.setLimit=this.updater((D,z)=>Object.assign(Object.assign({},D),{paging:Object.assign(Object.assign({},D.paging),{limit:z})})),this.filterClinicalProviders=D=>this.data.userSelectClinicalProviders({input:{name:D}}).pipe((0,x._b)(z=>{let re=z.data.items;return this.patchState({clinicalProviders:re}),re},z=>this.patchState({errors:z.graphQLErrors?z.graphQLErrors:z})),(0,R.U)(z=>z.data.items)),this.filterLocations=D=>this.data.userSelectLocations({input:{name:D}}).pipe((0,x._b)(z=>{let re=z.data.items;return this.patchState({locations:re}),re},z=>this.patchState({errors:z.graphQLErrors?z.graphQLErrors:z})),(0,R.U)(z=>z.data.items)),this.addClinicalProvider=this.updater((D,z)=>Object.assign(Object.assign({},D),{clinicalProviders:D.clinicalProviders.concat(z)})),this.addLocation=this.updater((D,z)=>Object.assign(Object.assign({},D),{locations:D.locations.concat(z)})),this.updateClinicalProvider=this.updater((D,z)=>{var re;return Object.assign(Object.assign({},D),{clinicalProviderLocations:null===(re=D.clinicalProviderLocations)||void 0===re?void 0:re.map(ue=>z.id===ue.clinicalProviderId?Object.assign(Object.assign({},ue),{clinicalProvider:z}):ue)})}),this.setItem=this.updater((D,z)=>Object.assign(Object.assign({},D),{item:z})),this.addNewClinicalProviderLocation=this.updater((D,z)=>Object.assign(Object.assign({},D),{clinicalProviderLocations:[...D.clinicalProviderLocations,z]})),this.updateClinicalProviderLocation=this.updater((D,z)=>Object.assign(Object.assign({},D),{clinicalProviderLocations:D.clinicalProviderLocations.map(re=>re.id===z.id?z:re)})),this.clear=this.updater(D=>Object.assign(Object.assign({},D),{clinicalProviderLocations:[]})),this.addClinicalProviderLocations=this.updater((D,z)=>Object.assign(Object.assign({},D),{clinicalProviderLocations:D.clinicalProviderLocations.concat(z)})),this.updateClinicalProviderLocations=this.updater((D,z)=>Object.assign(Object.assign({},D),{clinicalProviderLocations:D.clinicalProviderLocations.map(re=>z.find($=>$.id===re.id)||re)})),this.setSearchQuery=this.updater((D,z)=>Object.assign(Object.assign({},D),{searchQuery:z})),this.loadClinicalProviderLocationEffect=this.effect(D=>D.pipe((0,j.b)(()=>this.patchState({loading:!0})),(0,K.w)(z=>this.data.userClinicalProviderLocation({clinicalProviderLocationId:z}).pipe((0,x._b)(re=>(console.log("res.data.item",re.data.item),this.patchState({item:re.data.item,errors:re.errors,loading:!1})),re=>this.patchState({loading:!1,errors:re.graphQLErrors?re.graphQLErrors:re})))))),this.loadClinicalProviderLocationsEffect=this.effect(D=>D.pipe((0,j.b)(()=>this.patchState({loading:!0})),(0,se.M)(this.input$),(0,K.w)(([z,re])=>this.data.userClinicalProviderLocations({input:re}).pipe((0,x._b)(ue=>this.patchState({paging:{limit:re.limit,skip:re.skip,total:ue.data.count.total},clinicalProviderLocations:"all"!==re.clinicalProviderId?ue.data.items:[],errors:ue.errors,loading:!1}),ue=>this.patchState({loading:!1,errors:ue.graphQLErrors?ue.graphQLErrors:ue})))))),this.createClinicalProviderLocationEffect=this.effect(D=>D.pipe((0,j.b)(()=>this.patchState({loading:!0})),(0,K.w)(z=>this.clinicalProviderLocationService.createClinicalProviderLocation(Object.assign({},z)).pipe((0,x._b)(re=>{this.addNewClinicalProviderLocation(re),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:re,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},re=>{re.graphQLErrors?(this.toast.error(re.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:re.graphQLErrors?re.graphQLErrors:re})):(this.toast.error(re.Message),this.formService.setErrors(re.Data))}))))),this.updateClinicalProviderLocationEffect=this.effect(D=>D.pipe((0,j.b)(()=>this.patchState({loading:!0})),(0,se.M)(this.item$),(0,K.w)(([z,re])=>this.clinicalProviderLocationService.updateClinicalProviderLocation(z,z.id).pipe((0,x._b)(ue=>{this.updateClinicalProviderLocation(ue),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:ue,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},ue=>{ue.graphQLErrors?(this.toast.error(ue.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:ue.graphQLErrors?ue.graphQLErrors:ue})):(this.toast.error(ue.Message),this.formService.setErrors(ue.Data))}))))),this.deleteClinicalProviderLocationEffect=this.effect(D=>D.pipe((0,j.b)(()=>this.patchState({loading:!0})),(0,se.M)(this.item$),(0,K.w)(([z,re])=>this.data.userDeleteClinicalProviderLocation({clinicalProviderLocationId:re.id}).pipe((0,x._b)(ue=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:ue.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},ue=>{ue.graphQLErrors?(this.toast.error(ue.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:ue.graphQLErrors?ue.graphQLErrors:ue})):(this.toast.error(ue.Message),this.formService.setErrors(ue.Data))}))))),this.importExcelEffect=this.effect(D=>D.pipe((0,j.b)(()=>this.patchState({loading:!0})),(0,K.w)(z=>this.clinicalProviderLocationService.importClinicalProviderLocations(z).pipe((0,g.K)(re=>{var ue;return this.toast.error(null!==(ue=re.Message)&&void 0!==ue?ue:"Failed to save",{duration:3e3}),W.E}),(0,j.b)(re=>{const ue=JSON.parse(re.created),$=JSON.parse(re.updated),G=JSON.parse(re.failed),q=ue.length+$.length+G.length;this.addClinicalProviderLocations(ue),this.updateClinicalProviderLocations($),this.toast.success(`${ue.length} created, ${$.length} updated, ${G.length} failed of total ${q}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("clinicalProviderLocationId")?this.setFormName("clinicalProviderLocation_edit"):this.setFormName("clinicalProviderLocation_create"),this.route.snapshot.paramMap.has("clinicalProviderId")){var T=this.route.snapshot.paramMap.get("clinicalProviderId");this.setClinicalProviderId(T)}if(this.route.snapshot.paramMap.has("locationId")){var O=this.route.snapshot.paramMap.get("locationId");this.setLocationId(O)}}validateImportData(Z){return this.vm$.pipe((0,K.w)(te=>this.clinicalProviderLocationService.validateClinicalProviderLocationExcelData(Z,te.clinicalProviders,te.locations)))}}return P.\u0275fac=function(Z){return new(Z||P)(L.LFG(ce.q),L.LFG(e.F0),L.LFG(e.gz),L.LFG(V.F),L.LFG(E.o),L.LFG(N))},P.\u0275prov=L.Yz7({token:P,factory:P.\u0275fac}),P})()},94929:(Ee,Ne,Q)=>{Q.d(Ne,{D:()=>ne});var x=Q(24280),W=Q(60515),R=Q(54004),j=Q(18505),K=Q(63900),se=Q(11365),g=Q(70262),B=Q(94650),S=Q(73602),h=Q(30144),L=Q(71873),ce=Q(4523),e=Q(56869),V=Q(88821),E=Q(39646);class ie extends V.T_{constructor(N){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=N}Do(N){return this.businessProvider=N,this.serviceContext=N.serviceContext,this.loggingService=N.loggingService,this.execute(),this.response}}var X=Q(26177);class U extends ie{constructor(N,y){super("ValidateClinicalProviderExcelDataAction"),this.valid=!1,this.excelData=N,this.vendors=y}preValidateAction(){const N=[];this.excelData.map((y,P)=>{N.push(y.name),this.validationContext.addRule(new X.mi(`vendorName_${P}_is_valid}`,"Vendor Is Not Valid","vendor.name",y.vendor,this.vendors,!0))}),this.validationContext.addRule(new X.cL("nameIsUnique","Name should be unique",N,!0))}performAction(){}finish(){super.finish();const N={};let y=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(P=>{P instanceof X.mi?P.isValid||(N[P.columnName]?N[P.columnName].newNames.includes(P.newName)||N[P.columnName].newNames.push(P.newName):N[P.columnName]={options:P.possibleValueList.map(ee=>ee.name),newNames:[P.newName]}):P instanceof X.cL&&(P.isValid||(y=P.conflicts))})):this.valid=!0,this.response=(0,E.of)({valid:this.valid,excelData:this.excelData,conflictNames:y,unknownNames:N})}}var I=Q(28234);class F extends X.wS{constructor(N,y,P,ee,Z){super(N,y,P,ee,Z,!0)}}class ye extends X.ul{constructor(N,y,P,ee=!1){super(N,y,ee),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=P,this.configureRules()}configureRules(){this.rules.push(new X.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new F("name","The clinicalprovider name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class f extends ie{constructor(N){super("CreateClinicalProviderAction"),this.input=N}preValidateAction(){this.validationContext.addRule(new ye("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateClinicalProvider({input:this.input}).pipe((0,K.w)(N=>(0,I.of)(N.data.created)))}}class Ae extends ie{constructor(N){super("UpdateClinicalProvidersAction"),this.clinicalProviders=N}preValidateAction(){this.validationContext.addRule(new X.DJ("Input","Input should have values",this.clinicalProviders,!0))}performAction(){this.response=this.businessProvider.data.userUpdateClinicalProviders({input:{clinicalProviders:this.clinicalProviders}}).pipe((0,K.w)(N=>(0,E.of)(N.data.updated)))}}class de extends ie{constructor(N,y){super("UpdateClinicalProviderAction"),this.clinicalProvider=N,this.clinicalProviderId=y}preValidateAction(){this.validationContext.addRule(new X.DJ("Input","Input should have values",this.clinicalProvider,!0)).addRule(new X.xF("Id","Id should be a CUID and not null",this.clinicalProviderId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateClinicalProvider({clinicalProviderId:this.clinicalProviderId,input:this.clinicalProvider}).pipe((0,K.w)(N=>(0,E.of)(N.data.updated)))}}let Te=(()=>{class M extends V.nH{constructor(y,P,ee){super("NotificationService.ClinicalProviderBusinessProviderService",y,ee),this.data=P}createClinicalProvider(y){const P=new f(y);return P.Do(this),P.response}updateClinicalProvider(y,P){const ee=new de(y,P);return ee.Do(this),ee.response}importClinicalProviders(y){const P=new Ae(y);return P.Do(this),P.response}validateClinicalProviderExcelData(y,P){const ee=new U(y,P);return ee.Do(this),ee.response}}return M.\u0275fac=function(y){return new(y||M)(B.LFG(e.ed),B.LFG(S.q),B.LFG(V.oI))},M.\u0275prov=B.Yz7({token:M,factory:M.\u0275fac,providedIn:"root"}),M})(),Fe=(()=>{class M extends V.nH{constructor(y,P,ee){super("ClinicalProviderService",ee,y),this.businessProvider=P}createClinicalProvider(y){const P=Object.fromEntries(Object.entries(y).filter(([ee,Z])=>null!==Z));return this.businessProvider.createClinicalProvider(P)}updateClinicalProvider(y,P){return this.businessProvider.updateClinicalProvider(y,P)}importClinicalProviders(y){return this.businessProvider.importClinicalProviders(y)}validateClinicalProviderExcelData(y,P){return this.businessProvider.validateClinicalProviderExcelData(y,P)}}return M.\u0275fac=function(y){return new(y||M)(B.LFG(Te,8),B.LFG(Te),B.LFG(e.ed))},M.\u0275prov=B.Yz7({token:M,factory:M.\u0275fac,providedIn:"root"}),M})(),ne=(()=>{class M extends x.m1{constructor(y,P,ee,Z,te,Ce){if(super({loading:!1,clinicalProviders:[],done:!1,searchQuery:"",formName:void 0,vendorId:void 0,specialtyFilterParam:[],serviceFilterParam:[],clinicalProvidersSpecial:[],clinicalProviderLocations:[],clinicalProviderId:void 0,clinicalProviderLocationId:void 0,paging:{limit:1e4,skip:0},locationFilterParam:[],distance:void 0,isDoctorsPage:!1}),this.data=y,this.router=P,this.route=ee,this.toast=Z,this.formService=te,this.clinicalProviderService=Ce,this.errors$=this.select(b=>b.errors),this.favorites$=this.select(b=>b.favorites),this.loading$=this.select(b=>b.loading),this.done$=this.select(b=>b.done),this.item$=this.select(b=>b.item),this.clinicalProviders$=this.select(b=>b.clinicalProviders),this.specialtyFilterParam$=this.select(b=>b.specialtyFilterParam),this.serviceFilterParam$=this.select(b=>b.serviceFilterParam),this.vendors$=this.select(b=>b.vendors||[]),this.clinicalProviderId$=this.select(b=>b.clinicalProviderId),this.clinicalProviderLocationId$=this.select(b=>b.clinicalProviderLocationId),this.locationId$=this.select(b=>b.locationId),this.clinicalProvidersSpecial$=this.select(b=>b.clinicalProvidersSpecial),this.clinicalProviderLocations$=this.select(b=>b.clinicalProviderLocations),this.vendorId$=this.select(b=>b.vendorId),this.paging$=this.select(b=>b.paging),this.searchQuery$=this.select(b=>b.searchQuery),this.formName$=this.select(b=>b.formName),this.locationFilterParam$=this.select(b=>b.locationFilterParam),this.distance$=this.select(b=>b.distance),this.isDoctorsPage$=this.select(b=>b.isDoctorsPage),this.actionResult$=this.select(this.item$,this.done$,(b,C)=>({item:b,done:C}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.clinicalProviders$,this.vendors$,(b,C,v,T,O,D)=>({errors:b,loading:C,item:v,formName:T,clinicalProviders:O,vendors:D}),{debounce:!0}),this.input$=this.select(this.paging$,this.vendorId$,this.searchQuery$,this.specialtyFilterParam$,this.serviceFilterParam$,this.clinicalProviderId$,this.clinicalProviderLocationId$,this.locationFilterParam$,this.distance$,this.isDoctorsPage$,this.favorites$,(b,C,v,T,O,D,z,re,ue,$,G)=>({limit:b.limit,skip:b.skip,name:v,vendorId:C,specialites:T,services:O,total:b.total,clinicalProviderId:D,clinicalProviderLocationId:z,centerLocation:re,distance:ue,isDoctorsPage:$,favorites:G})),this.setFormName=this.updater((b,C)=>Object.assign(Object.assign({},b),{formName:C})),this.setClinicalProviderId=this.updater((b,C)=>Object.assign(Object.assign({},b),{clinicalProviderId:C})),this.setClinicalProviderLocationId=this.updater((b,C)=>Object.assign(Object.assign({},b),{clinicalProviderLocationId:C})),this.setLocationId=this.updater((b,C)=>Object.assign(Object.assign({},b),{locationId:C})),this.setFavorites=this.updater((b,C)=>Object.assign(Object.assign({},b),{favorites:C})),this.setSpecialtyFilterParam=this.updater((b,C)=>Object.assign(Object.assign({},b),{specialtyFilterParam:C})),this.setServiceFilterParam=this.updater((b,C)=>Object.assign(Object.assign({},b),{serviceFilterParam:C})),this.setLocationFilterParam=this.updater((b,C)=>Object.assign(Object.assign({},b),{locationFilterParam:C})),this.setDistance=this.updater((b,C)=>Object.assign(Object.assign({},b),{distance:C})),this.setVendorId=this.updater((b,C)=>Object.assign(Object.assign({},b),{vendorId:C})),this.setIsDoctorsPage=this.updater((b,C)=>Object.assign(Object.assign({},b),{isDoctorsPage:C})),this.setSkip=this.updater((b,C)=>Object.assign(Object.assign({},b),{paging:Object.assign(Object.assign({},b.paging),{skip:C})})),this.setLimit=this.updater((b,C)=>Object.assign(Object.assign({},b),{paging:Object.assign(Object.assign({},b.paging),{limit:C})})),this.filterVendors=b=>this.data.userSelectVendors({input:{name:b}}).pipe((0,x._b)(C=>{const v=C.data.items;return this.patchState({vendors:v}),v},C=>this.patchState({errors:C.graphQLErrors?C.graphQLErrors:C})),(0,R.U)(C=>C.data.items)),this.addVendor=this.updater((b,C)=>Object.assign(Object.assign({},b),{vendors:b.vendors.concat(C)})),this.setItem=this.updater((b,C)=>Object.assign(Object.assign({},b),{item:C})),this.addNewClinicalProvider=this.updater((b,C)=>Object.assign(Object.assign({},b),{clinicalProviders:[...b.clinicalProviders,C]})),this.removeClinicalProvider=this.updater((b,C)=>Object.assign(Object.assign({},b),{clinicalProviders:b.clinicalProviders.filter(v=>v.id!==C.id)})),this.updateClinicalProvider=this.updater((b,C)=>Object.assign(Object.assign({},b),{clinicalProviders:b.clinicalProviders.map(v=>v.id===C.id?C:v)})),this.addClinicalProviders=this.updater((b,C)=>Object.assign(Object.assign({},b),{clinicalProviders:b.clinicalProviders.concat(C)})),this.updateClinicalProviders=this.updater((b,C)=>Object.assign(Object.assign({},b),{clinicalProviders:b.clinicalProviders.map(v=>C.find(O=>O.id===v.id)||v)})),this.setSearchQuery=this.updater((b,C)=>Object.assign(Object.assign({},b),{searchQuery:C})),this.loadClinicalProviderEffect=this.effect(b=>b.pipe((0,j.b)(()=>this.patchState({loading:!0})),(0,K.w)(C=>this.data.userClinicalProvider({clinicalProviderId:C}).pipe((0,x._b)(v=>this.patchState({item:v.data.item,errors:v.errors,loading:!1}),v=>this.patchState({loading:!1,errors:v.graphQLErrors?v.graphQLErrors:v})))))),this.loadClinicalProvidersEffect=this.effect(b=>b.pipe((0,j.b)(()=>{this.patchState({loading:!0})}),(0,se.M)(this.input$),(0,K.w)(([C,v])=>(console.log("input",v),this.data.userClinicalProviders({input:v}).pipe((0,x._b)(T=>{var O;const D=[];return null===(O=T.data.items)||void 0===O||O.map(z=>{var re;null===(re=z.clinicalProviderLocations)||void 0===re||re.forEach(ue=>{var $,G,q;D.push({latitude:null===($=ue.location)||void 0===$?void 0:$.latitude,longitude:null===(G=ue.location)||void 0===G?void 0:G.longitude,id:ue.id,name:null===(q=ue.location)||void 0===q?void 0:q.name,clinicalProvider:z,location:ue.location})})}),this.patchState({paging:{limit:v.limit,skip:v.skip,total:T.data.count.total},clinicalProviders:T.data.items,clinicalProviderLocations:D,errors:T.errors,loading:!1})},T=>this.patchState({loading:!1,errors:T.graphQLErrors?T.graphQLErrors:T}))))))),this.loadClinicalProvidersSpecialEffect=this.effect(b=>b.pipe((0,j.b)(()=>{this.patchState({loading:!0})}),(0,se.M)(this.input$),(0,K.w)(([C,v])=>this.data.userClinicalProviders({input:v}).pipe((0,x._b)(T=>this.patchState({paging:{limit:v.limit,skip:v.skip,total:T.data.count.total},clinicalProvidersSpecial:T.data.items,errors:T.errors,loading:!1}),T=>this.patchState({loading:!1,errors:T.graphQLErrors?T.graphQLErrors:T})))))),this.createClinicalProviderEffect=this.effect(b=>b.pipe((0,j.b)(()=>this.patchState({loading:!0})),(0,K.w)(C=>this.clinicalProviderService.createClinicalProvider(Object.assign({},C)).pipe((0,x._b)(v=>{this.addNewClinicalProvider(v),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:v,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},v=>{v.graphQLErrors?(this.toast.error(v.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:v.graphQLErrors?v.graphQLErrors:v})):(this.toast.error(v.Message),this.formService.setErrors(v.Data))}))))),this.updateClinicalProviderEffect=this.effect(b=>b.pipe((0,j.b)(()=>this.patchState({loading:!0})),(0,se.M)(this.item$),(0,K.w)(([C,v])=>this.clinicalProviderService.updateClinicalProvider(C,C.id).pipe((0,x._b)(T=>{this.updateClinicalProvider(T),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:T,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1}),600)},T=>{T.graphQLErrors?(this.toast.error(T.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:T.graphQLErrors?T.graphQLErrors:T})):(this.toast.error(T.Message),this.formService.setErrors(T.Data))}))))),this.deleteClinicalProviderEffect=this.effect(b=>b.pipe((0,j.b)(()=>this.patchState({loading:!0})),(0,se.M)(this.item$),(0,K.w)(([C,v])=>this.data.userDeleteClinicalProvider({clinicalProviderId:v.id}).pipe((0,x._b)(T=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:T.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},T=>{T.graphQLErrors?(this.toast.error(T.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:T.graphQLErrors?T.graphQLErrors:T})):(this.toast.error(T.Message),this.formService.setErrors(T.Data))}))))),this.importExcelEffect=this.effect(b=>b.pipe((0,j.b)(()=>this.patchState({loading:!0})),(0,K.w)(C=>this.clinicalProviderService.importClinicalProviders(C).pipe((0,g.K)(v=>{var T;return this.toast.error(null!==(T=v.Message)&&void 0!==T?T:"Failed to save",{duration:3e3}),W.E}),(0,j.b)(v=>{const T=JSON.parse(v.created),O=JSON.parse(v.updated),D=JSON.parse(v.failed),z=T.length+O.length+D.length;this.addClinicalProviders(T),this.updateClinicalProviders(O),this.toast.success(`${T.length} created, ${O.length} updated, ${D.length} failed of total ${z}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("clinicalProviderId")?this.setFormName("clinicalProvider_edit"):this.setFormName("clinicalProvider_create"),this.route.snapshot.paramMap.has("vendorId")){const b=this.route.snapshot.paramMap.get("vendorId");this.setVendorId(b)}}validateImportData(y){return this.vm$.pipe((0,K.w)(P=>this.clinicalProviderService.validateClinicalProviderExcelData(y,P.vendors)))}}return M.\u0275fac=function(y){return new(y||M)(B.LFG(S.q),B.LFG(h.F0),B.LFG(h.gz),B.LFG(L.F),B.LFG(ce.o),B.LFG(Fe))},M.\u0275prov=B.Yz7({token:M,factory:M.\u0275fac}),M})()},59443:(Ee,Ne,Q)=>{Q.d(Ne,{r:()=>Fe});var x=Q(24280),W=Q(60515),R=Q(18505),j=Q(63900),K=Q(11365),se=Q(70262),g=Q(94650),B=Q(73602),S=Q(30144),h=Q(71873),L=Q(4523),ce=Q(56869),e=Q(88821),V=Q(39646);class E extends e.T_{constructor(M){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=M}Do(M){return this.businessProvider=M,this.serviceContext=M.serviceContext,this.loggingService=M.loggingService,this.execute(),this.response}}var ie=Q(26177);class X extends E{constructor(M){super("ValidateDiagnosisCodeExcelDataAction"),this.valid=!1,this.excelData=M}preValidateAction(){const M=[];this.excelData.map((N,y)=>{M.push(N.name)}),this.validationContext.addRule(new ie.cL("nameIsUnique","Name should be unique",M,!0))}performAction(){}finish(){super.finish();const M={};let N=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(y=>{y instanceof ie.mi?y.isValid||(M[y.columnName]?M[y.columnName].newNames.includes(y.newName)||M[y.columnName].newNames.push(y.newName):M[y.columnName]={options:y.possibleValueList.map(P=>P.name),newNames:[y.newName]}):y instanceof ie.cL&&(y.isValid||(N=y.conflicts))})):this.valid=!0,this.response=(0,V.of)({valid:this.valid,excelData:this.excelData,conflictNames:N,unknownNames:M})}}var U=Q(28234);class I extends ie.wS{constructor(M,N,y,P,ee){super(M,N,y,P,ee,!0)}}class F extends ie.ul{constructor(M,N,y,P=!1){super(M,N,P),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=y,this.configureRules()}configureRules(){this.rules.push(new ie.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new I("name","The diagnosiscode name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class ye extends E{constructor(M){super("CreateDiagnosisCodeAction"),this.input=M}preValidateAction(){this.validationContext.addRule(new F("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateDiagnosisCode({input:this.input}).pipe((0,j.w)(M=>(0,U.of)(M.data.created)))}}class f extends E{constructor(M){super("UpdateDiagnosisCodesAction"),this.diagnosisCodes=M}preValidateAction(){this.validationContext.addRule(new ie.DJ("Input","Input should have values",this.diagnosisCodes,!0))}performAction(){this.response=this.businessProvider.data.userUpdateDiagnosisCodes({input:{diagnosisCodes:this.diagnosisCodes}}).pipe((0,j.w)(M=>(0,V.of)(M.data.updated)))}}class Ae extends E{constructor(M,N){super("UpdateDiagnosisCodeAction"),this.diagnosisCode=M,this.diagnosisCodeId=N}preValidateAction(){this.validationContext.addRule(new ie.DJ("Input","Input should have values",this.diagnosisCode,!0)).addRule(new ie.xF("Id","Id should be a CUID and not null",this.diagnosisCodeId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateDiagnosisCode({diagnosisCodeId:this.diagnosisCodeId,input:this.diagnosisCode}).pipe((0,j.w)(M=>(0,V.of)(M.data.updated)))}}let de=(()=>{class ne extends e.nH{constructor(N,y,P){super("NotificationService.DiagnosisCodeBusinessProviderService",N,P),this.data=y}createDiagnosisCode(N){const y=new ye(N);return y.Do(this),y.response}updateDiagnosisCode(N,y){const P=new Ae(N,y);return P.Do(this),P.response}importDiagnosisCodes(N){const y=new f(N);return y.Do(this),y.response}validateDiagnosisCodeExcelData(N){const y=new X(N);return y.Do(this),y.response}}return ne.\u0275fac=function(N){return new(N||ne)(g.LFG(ce.ed),g.LFG(B.q),g.LFG(e.oI))},ne.\u0275prov=g.Yz7({token:ne,factory:ne.\u0275fac,providedIn:"root"}),ne})(),Te=(()=>{class ne extends e.nH{constructor(N,y,P){super("DiagnosisCodeService",P,N),this.businessProvider=y}createDiagnosisCode(N){return this.businessProvider.createDiagnosisCode(N)}updateDiagnosisCode(N,y){return this.businessProvider.updateDiagnosisCode(N,y)}importDiagnosisCodes(N){return this.businessProvider.importDiagnosisCodes(N)}validateDiagnosisCodeExcelData(N){return this.businessProvider.validateDiagnosisCodeExcelData(N)}}return ne.\u0275fac=function(N){return new(N||ne)(g.LFG(de,8),g.LFG(de),g.LFG(ce.ed))},ne.\u0275prov=g.Yz7({token:ne,factory:ne.\u0275fac,providedIn:"root"}),ne})(),Fe=(()=>{class ne extends x.m1{constructor(N,y,P,ee,Z,te){super({loading:!1,diagnosisCodes:[],done:!1,searchQuery:"",formName:void 0,paging:{limit:1e4,skip:0}}),this.data=N,this.router=y,this.route=P,this.toast=ee,this.formService=Z,this.diagnosisCodeService=te,this.errors$=this.select(b=>b.errors),this.loading$=this.select(b=>b.loading),this.done$=this.select(b=>b.done),this.item$=this.select(b=>b.item),this.diagnosisCodes$=this.select(b=>b.diagnosisCodes),this.paging$=this.select(b=>b.paging),this.searchQuery$=this.select(b=>b.searchQuery),this.formName$=this.select(b=>b.formName),this.actionResult$=this.select(this.item$,this.done$,(b,C)=>({item:b,done:C}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.diagnosisCodes$,(b,C,v,T,O)=>({errors:b,loading:C,item:v,formName:T,diagnosisCodes:O}),{debounce:!0}),this.input$=this.select(this.paging$,this.searchQuery$,(b,C)=>({limit:b.limit,skip:b.skip,name:C,total:b.total})),this.setFormName=this.updater((b,C)=>Object.assign(Object.assign({},b),{formName:C})),this.setItem=this.updater((b,C)=>Object.assign(Object.assign({},b),{item:C})),this.addNewDiagnosisCode=this.updater((b,C)=>Object.assign(Object.assign({},b),{diagnosisCodes:[...b.diagnosisCodes,C]})),this.updateDiagnosisCode=this.updater((b,C)=>Object.assign(Object.assign({},b),{diagnosisCodes:b.diagnosisCodes.map(v=>v.id===C.id?C:v)})),this.addDiagnosisCodes=this.updater((b,C)=>Object.assign(Object.assign({},b),{diagnosisCodes:b.diagnosisCodes.concat(C)})),this.updateDiagnosisCodes=this.updater((b,C)=>Object.assign(Object.assign({},b),{diagnosisCodes:b.diagnosisCodes.map(v=>C.find(O=>O.id===v.id)||v)})),this.setSearchQuery=this.updater((b,C)=>Object.assign(Object.assign({},b),{searchQuery:C})),this.loadDiagnosisCodeEffect=this.effect(b=>b.pipe((0,R.b)(()=>this.patchState({loading:!0})),(0,j.w)(C=>this.data.userDiagnosisCode({diagnosisCodeId:C}).pipe((0,x._b)(v=>{this.patchState({item:v.data.item,errors:v.errors,loading:!1})},v=>this.patchState({loading:!1,errors:v.graphQLErrors?v.graphQLErrors:v})))))),this.loadDiagnosisCodesEffect=this.effect(b=>b.pipe((0,R.b)(()=>this.patchState({loading:!0})),(0,K.M)(this.input$),(0,j.w)(([C,v])=>this.data.userDiagnosisCodes({input:v}).pipe((0,x._b)(T=>this.patchState({paging:{limit:v.limit,skip:v.skip,total:T.data.count.total},diagnosisCodes:T.data.items,errors:T.errors,loading:!1}),T=>this.patchState({loading:!1,errors:T.graphQLErrors?T.graphQLErrors:T})))))),this.createDiagnosisCodeEffect=this.effect(b=>b.pipe((0,R.b)(()=>this.patchState({loading:!0})),(0,j.w)(C=>this.diagnosisCodeService.createDiagnosisCode(Object.assign({},C)).pipe((0,x._b)(v=>{this.addNewDiagnosisCode(v),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:v,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},v=>{v.graphQLErrors?(this.toast.error(v.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:v.graphQLErrors?v.graphQLErrors:v})):(this.toast.error(v.Message),this.formService.setErrors(v.Data))}))))),this.updateDiagnosisCodeEffect=this.effect(b=>b.pipe((0,R.b)(()=>this.patchState({loading:!0})),(0,K.M)(this.item$),(0,j.w)(([C,v])=>this.diagnosisCodeService.updateDiagnosisCode(C,C.id).pipe((0,x._b)(T=>{this.updateDiagnosisCode(T),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:T,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},T=>{T.graphQLErrors?(this.toast.error(T.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:T.graphQLErrors?T.graphQLErrors:T})):(this.toast.error(T.Message),this.formService.setErrors(T.Data))}))))),this.deleteDiagnosisCodeEffect=this.effect(b=>b.pipe((0,R.b)(()=>this.patchState({loading:!0})),(0,K.M)(this.item$),(0,j.w)(([C,v])=>this.data.userDeleteDiagnosisCode({diagnosisCodeId:v.id}).pipe((0,x._b)(T=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:T.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},T=>{T.graphQLErrors?(this.toast.error(T.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:T.graphQLErrors?T.graphQLErrors:T})):(this.toast.error(T.Message),this.formService.setErrors(T.Data))}))))),this.importExcelEffect=this.effect(b=>b.pipe((0,R.b)(()=>this.patchState({loading:!0})),(0,j.w)(C=>this.diagnosisCodeService.importDiagnosisCodes(C).pipe((0,se.K)(v=>{var T;return this.toast.error(null!==(T=v.Message)&&void 0!==T?T:"Failed to save",{duration:3e3}),W.E}),(0,R.b)(v=>{const T=JSON.parse(v.created),O=JSON.parse(v.updated),D=JSON.parse(v.failed),z=T.length+O.length+D.length;this.addDiagnosisCodes(T),this.updateDiagnosisCodes(O),this.toast.success(`${T.length} created, ${O.length} updated, ${D.length} failed of total ${z}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("diagnosisCodeId")?(this.route.snapshot.paramMap.get("diagnosisCodeId"),this.setFormName("diagnosisCode_edit")):this.setFormName("diagnosisCode_create")}validateImportData(N){return this.vm$.pipe((0,j.w)(y=>this.diagnosisCodeService.validateDiagnosisCodeExcelData(N)))}}return ne.\u0275fac=function(N){return new(N||ne)(g.LFG(B.q),g.LFG(S.F0),g.LFG(S.gz),g.LFG(h.F),g.LFG(L.o),g.LFG(Te))},ne.\u0275prov=g.Yz7({token:ne,factory:ne.\u0275fac}),ne})()},56794:(Ee,Ne,Q)=>{Q.d(Ne,{F:()=>Fe});var x=Q(24280),W=Q(60515),R=Q(18505),j=Q(63900),K=Q(11365),se=Q(70262),g=Q(94650),B=Q(73602),S=Q(30144),h=Q(71873),L=Q(4523),ce=Q(56869),e=Q(88821),V=Q(39646);class E extends e.T_{constructor(M){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=M}Do(M){return this.businessProvider=M,this.serviceContext=M.serviceContext,this.loggingService=M.loggingService,this.execute(),this.response}}var ie=Q(26177);class X extends E{constructor(M){super("ValidateDocumentExcelDataAction"),this.valid=!1,this.excelData=M}preValidateAction(){const M=[];this.excelData.map((N,y)=>{M.push(N.name)}),this.validationContext.addRule(new ie.cL("nameIsUnique","Name should be unique",M,!0))}performAction(){}finish(){super.finish();const M={};let N=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(y=>{y instanceof ie.mi?y.isValid||(M[y.columnName]?M[y.columnName].newNames.includes(y.newName)||M[y.columnName].newNames.push(y.newName):M[y.columnName]={options:y.possibleValueList.map(P=>P.name),newNames:[y.newName]}):y instanceof ie.cL&&(y.isValid||(N=y.conflicts))})):this.valid=!0,this.response=(0,V.of)({valid:this.valid,excelData:this.excelData,conflictNames:N,unknownNames:M})}}var U=Q(28234);class I extends ie.wS{constructor(M,N,y,P,ee){super(M,N,y,P,ee,!0)}}class F extends ie.ul{constructor(M,N,y,P=!1){super(M,N,P),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=y,this.configureRules()}configureRules(){this.rules.push(new ie.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new I("name","The documenttype name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class ye extends E{constructor(M){super("CreateDocumentAction"),this.input=M}preValidateAction(){this.validationContext.addRule(new F("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateDocument({input:this.input}).pipe((0,j.w)(M=>(0,U.of)(M.data.created)))}}class f extends E{constructor(M){super("UpdateDocumentsAction"),this.documents=M}preValidateAction(){this.validationContext.addRule(new ie.DJ("Input","Input should have values",this.documents,!0))}performAction(){this.response=this.businessProvider.data.userUpdateDocuments({input:{documents:this.documents}}).pipe((0,j.w)(M=>(0,V.of)(M.data.updated)))}}class Ae extends E{constructor(M,N){super("UpdateDocumentAction"),this.document=M,this.documentId=N}preValidateAction(){this.validationContext.addRule(new ie.DJ("Input","Input should have values",this.document,!0)).addRule(new ie.xF("Id","Id should be a CUID and not null",this.documentId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateDocument({documentId:this.documentId,input:this.document}).pipe((0,j.w)(M=>(0,V.of)(M.data.updated)))}}let de=(()=>{class ne extends e.nH{constructor(N,y,P){super("NotificationService.DocumentBusinessProviderService",N,P),this.data=y}createDocument(N){const y=new ye(N);return y.Do(this),y.response}updateDocument(N,y){const P=new Ae(N,y);return P.Do(this),P.response}importDocuments(N){const y=new f(N);return y.Do(this),y.response}validateDocumentExcelData(N){const y=new X(N);return y.Do(this),y.response}}return ne.\u0275fac=function(N){return new(N||ne)(g.LFG(ce.ed),g.LFG(B.q),g.LFG(e.oI))},ne.\u0275prov=g.Yz7({token:ne,factory:ne.\u0275fac,providedIn:"root"}),ne})(),Te=(()=>{class ne extends e.nH{constructor(N,y,P){super("DocumentService",P,N),this.businessProvider=y}createDocument(N){const y=Object.fromEntries(Object.entries(N).filter(([P,ee])=>null!==ee));return this.businessProvider.createDocument(y)}updateDocument(N,y){return this.businessProvider.updateDocument(N,y)}importDocuments(N){return this.businessProvider.importDocuments(N)}validateDocumentExcelData(N){return this.businessProvider.validateDocumentExcelData(N)}}return ne.\u0275fac=function(N){return new(N||ne)(g.LFG(de,8),g.LFG(de),g.LFG(ce.ed))},ne.\u0275prov=g.Yz7({token:ne,factory:ne.\u0275fac,providedIn:"root"}),ne})(),Fe=(()=>{class ne extends x.m1{constructor(N,y,P,ee,Z,te){super({loading:!1,documents:[],done:!1,searchQuery:"",formName:void 0,paging:{limit:1e4,skip:0}}),this.data=N,this.router=y,this.route=P,this.toast=ee,this.formService=Z,this.documentService=te,this.errors$=this.select(b=>b.errors),this.loading$=this.select(b=>b.loading),this.done$=this.select(b=>b.done),this.item$=this.select(b=>b.item),this.documents$=this.select(b=>b.documents),this.paging$=this.select(b=>b.paging),this.searchQuery$=this.select(b=>b.searchQuery),this.formName$=this.select(b=>b.formName),this.actionResult$=this.select(this.item$,this.done$,(b,C)=>({item:b,done:C}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.documents$,(b,C,v,T,O)=>({errors:b,loading:C,item:v,formName:T,documents:O}),{debounce:!0}),this.input$=this.select(this.paging$,this.searchQuery$,(b,C)=>({limit:b.limit,skip:b.skip,name:C,total:b.total})),this.setFormName=this.updater((b,C)=>Object.assign(Object.assign({},b),{formName:C})),this.setItem=this.updater((b,C)=>Object.assign(Object.assign({},b),{item:C})),this.addNewDocument=this.updater((b,C)=>Object.assign(Object.assign({},b),{documents:[...b.documents,C]})),this.updateDocument=this.updater((b,C)=>Object.assign(Object.assign({},b),{documents:b.documents.map(v=>v.id===C.id?C:v)})),this.addDocuments=this.updater((b,C)=>Object.assign(Object.assign({},b),{documents:b.documents.concat(C)})),this.updateDocuments=this.updater((b,C)=>Object.assign(Object.assign({},b),{documents:b.documents.map(v=>C.find(O=>O.id===v.id)||v)})),this.setSearchQuery=this.updater((b,C)=>Object.assign(Object.assign({},b),{searchQuery:C})),this.loadDocumentEffect=this.effect(b=>b.pipe((0,R.b)(()=>this.patchState({loading:!0})),(0,j.w)(C=>this.data.getDocument(C).pipe((0,x._b)(v=>{this.patchState({item:v,loading:!1})},v=>{console.log(v),this.patchState({loading:!1,errors:v.graphQLErrors?v.graphQLErrors:v})}))))),this.loadDocumentsEffect=this.effect(b=>b.pipe((0,R.b)(()=>this.patchState({loading:!0})),(0,K.M)(this.input$),(0,j.w)(([C,v])=>this.data.userDocuments({input:v}).pipe((0,x._b)(T=>this.patchState({paging:{limit:v.limit,skip:v.skip,total:T.data.count.total},documents:T.data.items,errors:T.errors,loading:!1}),T=>this.patchState({loading:!1,errors:T.graphQLErrors?T.graphQLErrors:T})))))),this.createDocumentEffect=this.effect(b=>b.pipe((0,R.b)(()=>this.patchState({loading:!0})),(0,j.w)(C=>(console.log(C),this.documentService.createDocument(Object.assign({},C)).pipe((0,x._b)(v=>{this.addNewDocument(v),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:v,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},v=>{v.graphQLErrors?(this.toast.error(v.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:v.graphQLErrors?v.graphQLErrors:v})):(this.toast.error(v.Message),this.formService.setErrors(v.Data))})))))),this.updateDocumentEffect=this.effect(b=>b.pipe((0,R.b)(()=>this.patchState({loading:!0})),(0,K.M)(this.item$),(0,j.w)(([C,v])=>this.documentService.updateDocument(C,C.id).pipe((0,x._b)(T=>{this.updateDocument(T),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:T,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},T=>{T.graphQLErrors?(this.toast.error(T.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:T.graphQLErrors?T.graphQLErrors:T})):(this.toast.error(T.Message),this.formService.setErrors(T.Data))}))))),this.deleteDocumentEffect=this.effect(b=>b.pipe((0,R.b)(()=>this.patchState({loading:!0})),(0,K.M)(this.item$),(0,j.w)(([C,v])=>this.data.userDeleteDocument({documentId:v.id,featureName:" "}).pipe((0,x._b)(T=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:T.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},T=>{T.graphQLErrors?(this.toast.error(T.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:T.graphQLErrors?T.graphQLErrors:T})):(this.toast.error(T.Message),this.formService.setErrors(T.Data))}))))),this.importExcelEffect=this.effect(b=>b.pipe((0,R.b)(()=>this.patchState({loading:!0})),(0,j.w)(C=>this.documentService.importDocuments(C).pipe((0,se.K)(v=>{var T;return this.toast.error(null!==(T=v.Message)&&void 0!==T?T:"Failed to save",{duration:3e3}),W.E}),(0,R.b)(v=>{const T=JSON.parse(v.created),O=JSON.parse(v.updated),D=JSON.parse(v.failed),z=T.length+O.length+D.length;this.addDocuments(T),this.updateDocuments(O),this.toast.success(`${T.length} created, ${O.length} updated, ${D.length} failed of total ${z}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("documentId")?(this.route.snapshot.paramMap.get("documentId"),this.setFormName("document_edit")):this.setFormName("document_create")}validateImportData(N){return this.vm$.pipe((0,j.w)(y=>this.documentService.validateDocumentExcelData(N)))}}return ne.\u0275fac=function(N){return new(N||ne)(g.LFG(B.q),g.LFG(S.F0),g.LFG(S.gz),g.LFG(h.F),g.LFG(L.o),g.LFG(Te))},ne.\u0275prov=g.Yz7({token:ne,factory:ne.\u0275fac}),ne})()},32944:(Ee,Ne,Q)=>{Q.d(Ne,{m:()=>ne});var x=Q(24280),W=Q(60515),R=Q(54004),j=Q(18505),K=Q(63900),se=Q(11365),g=Q(70262),B=Q(94650),S=Q(73602),h=Q(30144),L=Q(71873),ce=Q(4523),e=Q(56869),V=Q(88821),E=Q(39646);class ie extends V.T_{constructor(N){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=N}Do(N){return this.businessProvider=N,this.serviceContext=N.serviceContext,this.loggingService=N.loggingService,this.execute(),this.response}}var X=Q(26177);class U extends ie{constructor(N,y){super("ValidateFavoriteProviderExcelDataAction"),this.valid=!1,this.excelData=N,this.clinicalProviders=y}preValidateAction(){const N=[];this.excelData.map((y,P)=>{N.push(y.name),this.validationContext.addRule(new X.mi(`clinicalProviderName_${P}_is_valid}`,"Clinical Provider Is Not Valid","clinicalProvider.name",y.clinicalProvider,this.clinicalProviders,!0))}),this.validationContext.addRule(new X.cL("nameIsUnique","Name should be unique",N,!0))}performAction(){}finish(){super.finish();const N={};let y=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(P=>{P instanceof X.mi?P.isValid||(N[P.columnName]?N[P.columnName].newNames.includes(P.newName)||N[P.columnName].newNames.push(P.newName):N[P.columnName]={options:P.possibleValueList.map(ee=>ee.name),newNames:[P.newName]}):P instanceof X.cL&&(P.isValid||(y=P.conflicts))})):this.valid=!0,this.response=(0,E.of)({valid:this.valid,excelData:this.excelData,conflictNames:y,unknownNames:N})}}var I=Q(28234);class F extends X.wS{constructor(N,y,P,ee,Z){super(N,y,P,ee,Z,!0)}}class ye extends X.ul{constructor(N,y,P,ee=!1){super(N,y,ee),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=P,this.configureRules()}configureRules(){this.rules.push(new X.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new F("name","The favoriteprovider name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class f extends ie{constructor(N){super("CreateFavoriteProviderAction"),this.input=N}preValidateAction(){this.validationContext.addRule(new ye("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateFavoriteProvider({input:this.input}).pipe((0,K.w)(N=>(0,I.of)(N.data.created)))}}class Ae extends ie{constructor(N){super("UpdateFavoriteProvidersAction"),this.favoriteProviders=N}preValidateAction(){this.validationContext.addRule(new X.DJ("Input","Input should have values",this.favoriteProviders,!0))}performAction(){this.response=this.businessProvider.data.userUpdateFavoriteProviders({input:{favoriteProviders:this.favoriteProviders}}).pipe((0,K.w)(N=>(0,E.of)(N.data.updated)))}}class de extends ie{constructor(N,y){super("UpdateFavoriteProviderAction"),this.favoriteProvider=N,this.favoriteProviderId=y}preValidateAction(){this.validationContext.addRule(new X.DJ("Input","Input should have values",this.favoriteProvider,!0)).addRule(new X.xF("Id","Id should be a CUID and not null",this.favoriteProviderId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateFavoriteProvider({favoriteProviderId:this.favoriteProviderId,input:this.favoriteProvider}).pipe((0,K.w)(N=>(0,E.of)(N.data.updated)))}}let Te=(()=>{class M extends V.nH{constructor(y,P,ee){super("NotificationService.FavoriteProviderBusinessProviderService",y,ee),this.data=P}createFavoriteProvider(y){const P=new f(y);return P.Do(this),P.response}updateFavoriteProvider(y,P){const ee=new de(y,P);return ee.Do(this),ee.response}importFavoriteProviders(y){const P=new Ae(y);return P.Do(this),P.response}validateFavoriteProviderExcelData(y,P){const ee=new U(y,P);return ee.Do(this),ee.response}}return M.\u0275fac=function(y){return new(y||M)(B.LFG(e.ed),B.LFG(S.q),B.LFG(V.oI))},M.\u0275prov=B.Yz7({token:M,factory:M.\u0275fac,providedIn:"root"}),M})(),Fe=(()=>{class M extends V.nH{constructor(y,P,ee){super("FavoriteProviderService",ee,y),this.businessProvider=P}createFavoriteProvider(y){const P=Object.fromEntries(Object.entries(y).filter(([ee,Z])=>null!==Z));return this.businessProvider.createFavoriteProvider(P)}updateFavoriteProvider(y,P){return this.businessProvider.updateFavoriteProvider(y,P)}importFavoriteProviders(y){return this.businessProvider.importFavoriteProviders(y)}validateFavoriteProviderExcelData(y,P){return this.businessProvider.validateFavoriteProviderExcelData(y,P)}}return M.\u0275fac=function(y){return new(y||M)(B.LFG(Te,8),B.LFG(Te),B.LFG(e.ed))},M.\u0275prov=B.Yz7({token:M,factory:M.\u0275fac,providedIn:"root"}),M})(),ne=(()=>{class M extends x.m1{constructor(y,P,ee,Z,te,Ce){if(super({loading:!1,favoriteProviders:[],done:!1,searchQuery:"",formName:void 0,clinicalProviderId:void 0,paging:{limit:1e4,skip:0}}),this.data=y,this.router=P,this.route=ee,this.toast=Z,this.formService=te,this.favoriteProviderService=Ce,this.errors$=this.select(v=>v.errors),this.loading$=this.select(v=>v.loading),this.done$=this.select(v=>v.done),this.item$=this.select(v=>v.item),this.favoriteProviders$=this.select(v=>v.favoriteProviders),this.clinicalProviders$=this.select(v=>v.clinicalProviders||[]),this.clinicalProviderId$=this.select(v=>v.clinicalProviderId),this.paging$=this.select(v=>v.paging),this.searchQuery$=this.select(v=>v.searchQuery),this.formName$=this.select(v=>v.formName),this.actionResult$=this.select(this.item$,this.done$,(v,T)=>({item:v,done:T}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.favoriteProviders$,this.clinicalProviders$,(v,T,O,D,z,re)=>({errors:v,loading:T,item:O,formName:D,favoriteProviders:z,clinicalProviders:re}),{debounce:!0}),this.input$=this.select(this.paging$,this.clinicalProviderId$,this.searchQuery$,(v,T,O)=>({limit:v.limit,skip:v.skip,name:O,clinicalProviderId:T,total:v.total})),this.setFormName=this.updater((v,T)=>Object.assign(Object.assign({},v),{formName:T})),this.setClinicalProviderId=this.updater((v,T)=>Object.assign(Object.assign({},v),{clinicalProviderId:T})),this.filterClinicalProviders=v=>this.data.userSelectClinicalProviders({input:{name:v}}).pipe((0,x._b)(T=>{let O=T.data.items;return this.patchState({clinicalProviders:O}),O},T=>this.patchState({errors:T.graphQLErrors?T.graphQLErrors:T})),(0,R.U)(T=>T.data.items)),this.addClinicalProvider=this.updater((v,T)=>Object.assign(Object.assign({},v),{clinicalProviders:v.clinicalProviders.concat(T)})),this.setItem=this.updater((v,T)=>Object.assign(Object.assign({},v),{item:T})),this.addNewFavoriteProvider=this.updater((v,T)=>Object.assign(Object.assign({},v),{favoriteProviders:[...v.favoriteProviders,T]})),this.updateFavoriteProvider=this.updater((v,T)=>Object.assign(Object.assign({},v),{favoriteProviders:v.favoriteProviders.map(O=>O.id===T.id?T:O)})),this.addFavoriteProviders=this.updater((v,T)=>Object.assign(Object.assign({},v),{favoriteProviders:v.favoriteProviders.concat(T)})),this.updateFavoriteProviders=this.updater((v,T)=>Object.assign(Object.assign({},v),{favoriteProviders:v.favoriteProviders.map(O=>T.find(z=>z.id===O.id)||O)})),this.setSearchQuery=this.updater((v,T)=>Object.assign(Object.assign({},v),{searchQuery:T})),this.loadFavoriteProviderEffect=this.effect(v=>v.pipe((0,j.b)(()=>this.patchState({loading:!0})),(0,K.w)(T=>this.data.userFavoriteProvider({favoriteProviderId:T}).pipe((0,x._b)(O=>{this.patchState({item:O.data.item,errors:O.errors,loading:!1})},O=>this.patchState({loading:!1,errors:O.graphQLErrors?O.graphQLErrors:O})))))),this.loadFavoriteProvidersEffect=this.effect(v=>v.pipe((0,j.b)(()=>this.patchState({loading:!0})),(0,se.M)(this.input$),(0,K.w)(([T,O])=>this.data.userFavoriteProviders({input:O}).pipe((0,x._b)(D=>this.patchState({paging:{limit:O.limit,skip:O.skip,total:D.data.count.total},favoriteProviders:D.data.items,errors:D.errors,loading:!1}),D=>this.patchState({loading:!1,errors:D.graphQLErrors?D.graphQLErrors:D})))))),this.createFavoriteProviderEffect=this.effect(v=>v.pipe((0,j.b)(()=>this.patchState({loading:!0})),(0,K.w)(T=>this.favoriteProviderService.createFavoriteProvider(Object.assign({},T)).pipe((0,x._b)(O=>{this.addNewFavoriteProvider(O),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:O,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},O=>{O.graphQLErrors?(this.toast.error(O.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:O.graphQLErrors?O.graphQLErrors:O})):(this.toast.error(O.Message),this.formService.setErrors(O.Data))}))))),this.updateFavoriteProviderEffect=this.effect(v=>v.pipe((0,j.b)(()=>this.patchState({loading:!0})),(0,se.M)(this.item$),(0,K.w)(([T,O])=>this.favoriteProviderService.updateFavoriteProvider(T,T.id).pipe((0,x._b)(D=>{this.updateFavoriteProvider(D),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:D,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},D=>{D.graphQLErrors?(this.toast.error(D.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:D.graphQLErrors?D.graphQLErrors:D})):(this.toast.error(D.Message),this.formService.setErrors(D.Data))}))))),this.deleteFavoriteProviderEffect=this.effect(v=>v.pipe((0,j.b)(()=>this.patchState({loading:!0})),(0,se.M)(this.item$),(0,K.w)(([T,O])=>this.data.userDeleteFavoriteProvider({favoriteProviderId:O.id}).pipe((0,x._b)(D=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:D.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},D=>{D.graphQLErrors?(this.toast.error(D.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:D.graphQLErrors?D.graphQLErrors:D})):(this.toast.error(D.Message),this.formService.setErrors(D.Data))}))))),this.deleteSpecificFavoriteProviderEffect=this.effect(v=>v.pipe((0,K.w)(T=>this.data.userDeleteFavoriteProvider({favoriteProviderId:T.id}).pipe((0,x._b)(O=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:O.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},O=>{O.graphQLErrors?(this.toast.error(O.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:O.graphQLErrors?O.graphQLErrors:O})):(this.toast.error(O.Message),this.formService.setErrors(O.Data))}))))),this.importExcelEffect=this.effect(v=>v.pipe((0,j.b)(()=>this.patchState({loading:!0})),(0,K.w)(T=>this.favoriteProviderService.importFavoriteProviders(T).pipe((0,g.K)(O=>{var D;return this.toast.error(null!==(D=O.Message)&&void 0!==D?D:"Failed to save",{duration:3e3}),W.E}),(0,j.b)(O=>{const D=JSON.parse(O.created),z=JSON.parse(O.updated),re=JSON.parse(O.failed),ue=D.length+z.length+re.length;this.addFavoriteProviders(D),this.updateFavoriteProviders(z),this.toast.success(`${D.length} created, ${z.length} updated, ${re.length} failed of total ${ue}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("favoriteProviderId")?(this.route.snapshot.paramMap.get("favoriteProviderId"),this.setFormName("favoriteProvider_edit")):this.setFormName("favoriteProvider_create"),this.route.snapshot.paramMap.has("clinicalProviderId")){var C=this.route.snapshot.paramMap.get("clinicalProviderId");this.setClinicalProviderId(C)}}validateImportData(y){return this.vm$.pipe((0,K.w)(P=>this.favoriteProviderService.validateFavoriteProviderExcelData(y,P.clinicalProviders)))}}return M.\u0275fac=function(y){return new(y||M)(B.LFG(S.q),B.LFG(h.F0),B.LFG(h.gz),B.LFG(L.F),B.LFG(ce.o),B.LFG(Fe))},M.\u0275prov=B.Yz7({token:M,factory:M.\u0275fac}),M})()},28816:(Ee,Ne,Q)=>{Q.d(Ne,{_:()=>Fe});var x=Q(24280),W=Q(60515),R=Q(18505),j=Q(63900),K=Q(11365),se=Q(70262),g=Q(94650),B=Q(73602),S=Q(30144),h=Q(71873),L=Q(4523),ce=Q(56869),e=Q(88821),V=Q(39646);class E extends e.T_{constructor(M){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=M}Do(M){return this.businessProvider=M,this.serviceContext=M.serviceContext,this.loggingService=M.loggingService,this.execute(),this.response}}var ie=Q(26177);class X extends E{constructor(M){super("ValidateGenderExcelDataAction"),this.valid=!1,this.excelData=M}preValidateAction(){const M=[];this.excelData.map((N,y)=>{M.push(N.name)}),this.validationContext.addRule(new ie.cL("nameIsUnique","Name should be unique",M,!0))}performAction(){}finish(){super.finish();const M={};let N=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(y=>{y instanceof ie.mi?y.isValid||(M[y.columnName]?M[y.columnName].newNames.includes(y.newName)||M[y.columnName].newNames.push(y.newName):M[y.columnName]={options:y.possibleValueList.map(P=>P.name),newNames:[y.newName]}):y instanceof ie.cL&&(y.isValid||(N=y.conflicts))})):this.valid=!0,this.response=(0,V.of)({valid:this.valid,excelData:this.excelData,conflictNames:N,unknownNames:M})}}var U=Q(28234);class I extends ie.wS{constructor(M,N,y,P,ee){super(M,N,y,P,ee,!0)}}class F extends ie.ul{constructor(M,N,y,P=!1){super(M,N,P),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=y,this.configureRules()}configureRules(){this.rules.push(new ie.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new I("name","The gender name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class ye extends E{constructor(M){super("CreateGenderAction"),this.input=M}preValidateAction(){this.validationContext.addRule(new F("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateGender({input:this.input}).pipe((0,j.w)(M=>(0,U.of)(M.data.created)))}}class f extends E{constructor(M){super("UpdateGendersAction"),this.genders=M}preValidateAction(){this.validationContext.addRule(new ie.DJ("Input","Input should have values",this.genders,!0))}performAction(){this.response=this.businessProvider.data.userUpdateGenders({input:{genders:this.genders}}).pipe((0,j.w)(M=>(0,V.of)(M.data.updated)))}}class Ae extends E{constructor(M,N){super("UpdateGenderAction"),this.gender=M,this.genderId=N}preValidateAction(){this.validationContext.addRule(new ie.DJ("Input","Input should have values",this.gender,!0)).addRule(new ie.xF("Id","Id should be a CUID and not null",this.genderId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateGender({genderId:this.genderId,input:this.gender}).pipe((0,j.w)(M=>(0,V.of)(M.data.updated)))}}let de=(()=>{class ne extends e.nH{constructor(N,y,P){super("NotificationService.GenderBusinessProviderService",N,P),this.data=y}createGender(N){const y=new ye(N);return y.Do(this),y.response}updateGender(N,y){const P=new Ae(N,y);return P.Do(this),P.response}importGenders(N){const y=new f(N);return y.Do(this),y.response}validateGenderExcelData(N){const y=new X(N);return y.Do(this),y.response}}return ne.\u0275fac=function(N){return new(N||ne)(g.LFG(ce.ed),g.LFG(B.q),g.LFG(e.oI))},ne.\u0275prov=g.Yz7({token:ne,factory:ne.\u0275fac,providedIn:"root"}),ne})(),Te=(()=>{class ne extends e.nH{constructor(N,y,P){super("GenderService",P,N),this.businessProvider=y}createGender(N){const y=Object.fromEntries(Object.entries(N).filter(([P,ee])=>null!==ee));return this.businessProvider.createGender(y)}updateGender(N,y){return this.businessProvider.updateGender(N,y)}importGenders(N){return this.businessProvider.importGenders(N)}validateGenderExcelData(N){return this.businessProvider.validateGenderExcelData(N)}}return ne.\u0275fac=function(N){return new(N||ne)(g.LFG(de,8),g.LFG(de),g.LFG(ce.ed))},ne.\u0275prov=g.Yz7({token:ne,factory:ne.\u0275fac,providedIn:"root"}),ne})(),Fe=(()=>{class ne extends x.m1{constructor(N,y,P,ee,Z,te){super({loading:!1,genders:[],done:!1,searchQuery:"",formName:void 0,paging:{limit:1e4,skip:0}}),this.data=N,this.router=y,this.route=P,this.toast=ee,this.formService=Z,this.genderService=te,this.errors$=this.select(b=>b.errors),this.loading$=this.select(b=>b.loading),this.done$=this.select(b=>b.done),this.item$=this.select(b=>b.item),this.genders$=this.select(b=>b.genders),this.paging$=this.select(b=>b.paging),this.searchQuery$=this.select(b=>b.searchQuery),this.formName$=this.select(b=>b.formName),this.actionResult$=this.select(this.item$,this.done$,(b,C)=>({item:b,done:C}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.genders$,(b,C,v,T,O)=>({errors:b,loading:C,item:v,formName:T,genders:O}),{debounce:!0}),this.input$=this.select(this.paging$,this.searchQuery$,(b,C)=>({limit:b.limit,skip:b.skip,name:C,total:b.total})),this.setFormName=this.updater((b,C)=>Object.assign(Object.assign({},b),{formName:C})),this.setItem=this.updater((b,C)=>Object.assign(Object.assign({},b),{item:C})),this.addNewGender=this.updater((b,C)=>Object.assign(Object.assign({},b),{genders:[...b.genders,C]})),this.updateGender=this.updater((b,C)=>Object.assign(Object.assign({},b),{genders:b.genders.map(v=>v.id===C.id?C:v)})),this.addGenders=this.updater((b,C)=>Object.assign(Object.assign({},b),{genders:b.genders.concat(C)})),this.updateGenders=this.updater((b,C)=>Object.assign(Object.assign({},b),{genders:b.genders.map(v=>C.find(O=>O.id===v.id)||v)})),this.setSearchQuery=this.updater((b,C)=>Object.assign(Object.assign({},b),{searchQuery:C})),this.loadGenderEffect=this.effect(b=>b.pipe((0,R.b)(()=>this.patchState({loading:!0})),(0,j.w)(C=>this.data.userGender({genderId:C}).pipe((0,x._b)(v=>{this.patchState({item:v.data.item,errors:v.errors,loading:!1})},v=>this.patchState({loading:!1,errors:v.graphQLErrors?v.graphQLErrors:v})))))),this.loadGendersEffect=this.effect(b=>b.pipe((0,R.b)(()=>this.patchState({loading:!0})),(0,K.M)(this.input$),(0,j.w)(([C,v])=>this.data.userGenders({input:v}).pipe((0,x._b)(T=>this.patchState({paging:{limit:v.limit,skip:v.skip,total:T.data.count.total},genders:T.data.items,errors:T.errors,loading:!1}),T=>this.patchState({loading:!1,errors:T.graphQLErrors?T.graphQLErrors:T})))))),this.createGenderEffect=this.effect(b=>b.pipe((0,R.b)(()=>this.patchState({loading:!0})),(0,j.w)(C=>this.genderService.createGender(Object.assign({},C)).pipe((0,x._b)(v=>{this.addNewGender(v),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:v,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},v=>{v.graphQLErrors?(this.toast.error(v.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:v.graphQLErrors?v.graphQLErrors:v})):(this.toast.error(v.Message),this.formService.setErrors(v.Data))}))))),this.updateGenderEffect=this.effect(b=>b.pipe((0,R.b)(()=>this.patchState({loading:!0})),(0,K.M)(this.item$),(0,j.w)(([C,v])=>this.genderService.updateGender(C,C.id).pipe((0,x._b)(T=>{this.updateGender(T),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:T,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},T=>{T.graphQLErrors?(this.toast.error(T.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:T.graphQLErrors?T.graphQLErrors:T})):(this.toast.error(T.Message),this.formService.setErrors(T.Data))}))))),this.deleteGenderEffect=this.effect(b=>b.pipe((0,R.b)(()=>this.patchState({loading:!0})),(0,K.M)(this.item$),(0,j.w)(([C,v])=>this.data.userDeleteGender({genderId:v.id}).pipe((0,x._b)(T=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:T.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},T=>{T.graphQLErrors?(this.toast.error(T.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:T.graphQLErrors?T.graphQLErrors:T})):(this.toast.error(T.Message),this.formService.setErrors(T.Data))}))))),this.importExcelEffect=this.effect(b=>b.pipe((0,R.b)(()=>this.patchState({loading:!0})),(0,j.w)(C=>this.genderService.importGenders(C).pipe((0,se.K)(v=>{var T;return this.toast.error(null!==(T=v.Message)&&void 0!==T?T:"Failed to save",{duration:3e3}),W.E}),(0,R.b)(v=>{const T=JSON.parse(v.created),O=JSON.parse(v.updated),D=JSON.parse(v.failed),z=T.length+O.length+D.length;this.addGenders(T),this.updateGenders(O),this.toast.success(`${T.length} created, ${O.length} updated, ${D.length} failed of total ${z}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("genderId")?(this.route.snapshot.paramMap.get("genderId"),this.setFormName("gender_edit")):this.setFormName("gender_create")}validateImportData(N){return this.vm$.pipe((0,j.w)(y=>this.genderService.validateGenderExcelData(N)))}}return ne.\u0275fac=function(N){return new(N||ne)(g.LFG(B.q),g.LFG(S.F0),g.LFG(S.gz),g.LFG(h.F),g.LFG(L.o),g.LFG(Te))},ne.\u0275prov=g.Yz7({token:ne,factory:ne.\u0275fac}),ne})()},11913:(Ee,Ne,Q)=>{Q.d(Ne,{I:()=>ne});var x=Q(24280),W=Q(60515),R=Q(54004),j=Q(18505),K=Q(63900),se=Q(11365),g=Q(70262),B=Q(94650),S=Q(73602),h=Q(30144),L=Q(71873),ce=Q(4523),e=Q(56869),V=Q(88821),E=Q(39646);class ie extends V.T_{constructor(N){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=N}Do(N){return this.businessProvider=N,this.serviceContext=N.serviceContext,this.loggingService=N.loggingService,this.execute(),this.response}}var X=Q(26177);class U extends ie{constructor(N,y,P,ee){super("ValidateInvoiceExcelDataAction"),this.valid=!1,this.excelData=N,this.billingOrganizations=y,this.legalCases=P,this.invoices=ee}preValidateAction(){const N=[];this.excelData.map((y,P)=>{N.push(y.name),this.validationContext.addRule(new X.mi(`billingOrganizationName_${P}_is_valid}`,"Billing Organization Is Not Valid","billingOrganization.name",y.billingOrganization,this.billingOrganizations,!0)),this.validationContext.addRule(new X.mi(`legalCaseName_${P}_is_valid}`,"Legal Case Is Not Valid","legalCase.name",y.legalCase,this.legalCases,!0)),this.validationContext.addRule(new X.mi(`invoiceName_${P}_is_valid}`,"Invoice Is Not Valid","invoice.name",y.invoice,this.invoices,!0))}),this.validationContext.addRule(new X.cL("nameIsUnique","Name should be unique",N,!0))}performAction(){}finish(){super.finish();const N={};let y=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(P=>{P instanceof X.mi?P.isValid||(N[P.columnName]?N[P.columnName].newNames.includes(P.newName)||N[P.columnName].newNames.push(P.newName):N[P.columnName]={options:P.possibleValueList.map(ee=>ee.name),newNames:[P.newName]}):P instanceof X.cL&&(P.isValid||(y=P.conflicts))})):this.valid=!0,this.response=(0,E.of)({valid:this.valid,excelData:this.excelData,conflictNames:y,unknownNames:N})}}var I=Q(28234);class F extends X.wS{constructor(N,y,P,ee,Z){super(N,y,P,ee,Z,!0)}}class ye extends X.ul{constructor(N,y,P,ee=!1){super(N,y,ee),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=P,this.configureRules()}configureRules(){this.rules.push(new X.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new F("name","The invoice name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class f extends ie{constructor(N){super("CreateInvoiceAction"),this.input=N}preValidateAction(){this.validationContext.addRule(new ye("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateInvoice({input:this.input}).pipe((0,K.w)(N=>(0,I.of)(N.data.created)))}}class Ae extends ie{constructor(N){super("UpdateInvoicesAction"),this.invoices=N}preValidateAction(){this.validationContext.addRule(new X.DJ("Input","Input should have values",this.invoices,!0))}performAction(){this.response=this.businessProvider.data.userUpdateInvoices({input:{invoices:this.invoices}}).pipe((0,K.w)(N=>(0,E.of)(N.data.updated)))}}class de extends ie{constructor(N,y){super("UpdateInvoiceAction"),this.invoice=N,this.invoiceId=y}preValidateAction(){this.validationContext.addRule(new X.DJ("Input","Input should have values",this.invoice,!0)).addRule(new X.xF("Id","Id should be a CUID and not null",this.invoiceId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateInvoice({invoiceId:this.invoiceId,input:this.invoice}).pipe((0,K.w)(N=>(0,E.of)(N.data.updated)))}}let Te=(()=>{class M extends V.nH{constructor(y,P,ee){super("NotificationService.InvoiceBusinessProviderService",y,ee),this.data=P}createInvoice(y){const P=new f(y);return P.Do(this),P.response}updateInvoice(y,P){const ee=new de(y,P);return ee.Do(this),ee.response}importInvoices(y){const P=new Ae(y);return P.Do(this),P.response}validateInvoiceExcelData(y,P,ee,Z){const te=new U(y,P,ee,Z);return te.Do(this),te.response}}return M.\u0275fac=function(y){return new(y||M)(B.LFG(e.ed),B.LFG(S.q),B.LFG(V.oI))},M.\u0275prov=B.Yz7({token:M,factory:M.\u0275fac,providedIn:"root"}),M})(),Fe=(()=>{class M extends V.nH{constructor(y,P,ee){super("InvoiceService",ee,y),this.businessProvider=P}createInvoice(y){const P=Object.fromEntries(Object.entries(y).filter(([ee,Z])=>null!==Z));return this.businessProvider.createInvoice(P)}updateInvoice(y,P){return this.businessProvider.updateInvoice(y,P)}importInvoices(y){return this.businessProvider.importInvoices(y)}validateInvoiceExcelData(y,P,ee,Z){return this.businessProvider.validateInvoiceExcelData(y,P,ee,Z)}}return M.\u0275fac=function(y){return new(y||M)(B.LFG(Te,8),B.LFG(Te),B.LFG(e.ed))},M.\u0275prov=B.Yz7({token:M,factory:M.\u0275fac,providedIn:"root"}),M})(),ne=(()=>{class M extends x.m1{constructor(y,P,ee,Z,te,Ce){if(super({loading:!1,invoices:[],done:!1,searchQuery:"",formName:void 0,organizationId:void 0,legalCaseId:void 0,invoiceId:void 0,clinicalProviderId:void 0,paging:{limit:1e4,skip:0}}),this.data=y,this.router=P,this.route=ee,this.toast=Z,this.formService=te,this.invoiceService=Ce,this.errors$=this.select(T=>T.errors),this.loading$=this.select(T=>T.loading),this.done$=this.select(T=>T.done),this.item$=this.select(T=>T.item),this.invoices$=this.select(T=>T.invoices),this.organizations$=this.select(T=>T.organizations||[]),this.legalCases$=this.select(T=>T.legalCases||[]),this.attorneyId$=this.select(T=>T.attorneyId),this.documents$=this.select(T=>T.documents||[]),this.organizationId$=this.select(T=>T.organizationId),this.legalCaseId$=this.select(T=>T.legalCaseId),this.invoiceId$=this.select(T=>T.invoiceId),this.clinicalProviderId$=this.select(T=>T.clinicalProviderId),this.paging$=this.select(T=>T.paging),this.searchQuery$=this.select(T=>T.searchQuery),this.formName$=this.select(T=>T.formName),this.actionResult$=this.select(this.item$,this.done$,(T,O)=>({item:T,done:O}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.invoices$,this.organizations$,this.legalCases$,this.documents$,(T,O,D,z,re,ue,$,G)=>({errors:T,loading:O,item:D,formName:z,invoices:re,organizations:ue,legalCases:$,documents:G}),{debounce:!0}),this.input$=this.select(this.paging$,this.organizationId$,this.legalCaseId$,this.invoiceId$,this.searchQuery$,this.attorneyId$,this.clinicalProviderId$,(T,O,D,z,re,ue,$)=>({limit:T.limit,skip:T.skip,name:re,attorneyId:ue,clinicalProviderId:$,organizationId:O,legalCaseId:D,invoiceId:z,total:T.total})),this.setFormName=this.updater((T,O)=>Object.assign(Object.assign({},T),{formName:O})),this.setOrganizationId=this.updater((T,O)=>Object.assign(Object.assign({},T),{organizationId:O})),this.setLegalCaseId=this.updater((T,O)=>Object.assign(Object.assign({},T),{legalCaseId:O})),this.setClinicalProviderId=this.updater((T,O)=>Object.assign(Object.assign({},T),{clinicalProviderId:O})),this.setAttorneyId=this.updater((T,O)=>Object.assign(Object.assign({},T),{attorneyId:O})),this.setInvoiceId=this.updater((T,O)=>Object.assign(Object.assign({},T),{invoiceId:O})),this.setSkip=this.updater((T,O)=>Object.assign(Object.assign({},T),{paging:Object.assign(Object.assign({},T.paging),{skip:O})})),this.setLimit=this.updater((T,O)=>Object.assign(Object.assign({},T),{paging:Object.assign(Object.assign({},T.paging),{limit:O})})),this.filterOrganizations=T=>this.data.userSelectOrganizations({input:{name:T}}).pipe((0,x._b)(O=>{let D=O.data.items;return this.patchState({organizations:D}),D},O=>this.patchState({errors:O.graphQLErrors?O.graphQLErrors:O})),(0,R.U)(O=>O.data.items)),this.filterLegalCases=T=>this.data.userSelectLegalCases({input:{name:T}}).pipe((0,x._b)(O=>{let D=O.data.items;return this.patchState({legalCases:D}),D},O=>this.patchState({errors:O.graphQLErrors?O.graphQLErrors:O})),(0,R.U)(O=>O.data.items)),this.filterDocuments=T=>this.data.userSelectDocuments({input:{name:T}}).pipe((0,x._b)(O=>{let D=O.data.items;return this.patchState({documents:D}),D},O=>this.patchState({errors:O.graphQLErrors?O.graphQLErrors:O})),(0,R.U)(O=>O.data.items)),this.addOrganization=this.updater((T,O)=>Object.assign(Object.assign({},T),{organizations:T.organizations.concat(O)})),this.addLegalCase=this.updater((T,O)=>Object.assign(Object.assign({},T),{legalCases:T.legalCases.concat(O)})),this.addDocument=this.updater((T,O)=>Object.assign(Object.assign({},T),{documents:T.documents.concat(O)})),this.setItem=this.updater((T,O)=>Object.assign(Object.assign({},T),{item:O})),this.addNewInvoice=this.updater((T,O)=>Object.assign(Object.assign({},T),{invoices:[...T.invoices,O]})),this.updateInvoice=this.updater((T,O)=>Object.assign(Object.assign({},T),{invoices:T.invoices.map(D=>D.id===O.id?O:D)})),this.addInvoices=this.updater((T,O)=>Object.assign(Object.assign({},T),{invoices:T.invoices.concat(O)})),this.updateInvoices=this.updater((T,O)=>Object.assign(Object.assign({},T),{invoices:T.invoices.map(D=>O.find(re=>re.id===D.id)||D)})),this.setSearchQuery=this.updater((T,O)=>Object.assign(Object.assign({},T),{searchQuery:O})),this.loadInvoiceEffect=this.effect(T=>T.pipe((0,j.b)(()=>this.patchState({loading:!0})),(0,K.w)(O=>this.data.userInvoice({invoiceId:O}).pipe((0,x._b)(D=>{this.patchState({item:D.data.item,errors:D.errors,loading:!1})},D=>this.patchState({loading:!1,errors:D.graphQLErrors?D.graphQLErrors:D})))))),this.loadInvoicesEffect=this.effect(T=>T.pipe((0,j.b)(()=>this.patchState({loading:!0})),(0,se.M)(this.input$),(0,K.w)(([O,D])=>this.data.userInvoices({input:D}).pipe((0,x._b)(z=>{console.log({limit:D.limit,skip:D.skip,total:z.data.count.total}),this.patchState({paging:{limit:D.limit,skip:D.skip,total:z.data.count.total},invoices:z.data.items,errors:z.errors,loading:!1})},z=>this.patchState({loading:!1,errors:z.graphQLErrors?z.graphQLErrors:z})))))),this.createInvoiceEffect=this.effect(T=>T.pipe((0,j.b)(()=>this.patchState({loading:!0})),(0,K.w)(O=>this.invoiceService.createInvoice(Object.assign({},O)).pipe((0,x._b)(D=>{this.addNewInvoice(D),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:D,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},D=>{D.graphQLErrors?(this.toast.error(D.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:D.graphQLErrors?D.graphQLErrors:D})):(this.toast.error(D.Message),this.formService.setErrors(D.Data))}))))),this.updateInvoiceEffect=this.effect(T=>T.pipe((0,j.b)(()=>this.patchState({loading:!0})),(0,se.M)(this.item$),(0,K.w)(([O,D])=>this.invoiceService.updateInvoice(O,O.id).pipe((0,x._b)(z=>{this.updateInvoice(z),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:z,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},z=>{z.graphQLErrors?(this.toast.error(z.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:z.graphQLErrors?z.graphQLErrors:z})):(this.toast.error(z.Message),this.formService.setErrors(z.Data))}))))),this.deleteInvoiceEffect=this.effect(T=>T.pipe((0,j.b)(()=>this.patchState({loading:!0})),(0,se.M)(this.item$),(0,K.w)(([O,D])=>this.data.userDeleteInvoice({invoiceId:D.id}).pipe((0,x._b)(z=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:z.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},z=>{z.graphQLErrors?(this.toast.error(z.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:z.graphQLErrors?z.graphQLErrors:z})):(this.toast.error(z.Message),this.formService.setErrors(z.Data))}))))),this.importExcelEffect=this.effect(T=>T.pipe((0,j.b)(()=>this.patchState({loading:!0})),(0,K.w)(O=>this.invoiceService.importInvoices(O).pipe((0,g.K)(D=>{var z;return this.toast.error(null!==(z=D.Message)&&void 0!==z?z:"Failed to save",{duration:3e3}),W.E}),(0,j.b)(D=>{const z=JSON.parse(D.created),re=JSON.parse(D.updated),ue=JSON.parse(D.failed),$=z.length+re.length+ue.length;this.addInvoices(z),this.updateInvoices(re),this.toast.success(`${z.length} created, ${re.length} updated, ${ue.length} failed of total ${$}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("invoiceId")){var b=this.route.snapshot.paramMap.get("invoiceId");this.setFormName("invoice_edit")}else this.setFormName("invoice_create");if(this.route.snapshot.paramMap.has("organizationId")){var C=this.route.snapshot.paramMap.get("organizationId");this.setOrganizationId(C)}if(this.route.snapshot.paramMap.has("legalCaseId")){var v=this.route.snapshot.paramMap.get("legalCaseId");this.setLegalCaseId(v)}this.route.snapshot.paramMap.has("invoiceId")&&(b=this.route.snapshot.paramMap.get("invoiceId"),this.setInvoiceId(b))}validateImportData(y){return this.vm$.pipe((0,K.w)(P=>this.invoiceService.validateInvoiceExcelData(y,P.organizations,P.legalCases,P.documents)))}}return M.\u0275fac=function(y){return new(y||M)(B.LFG(S.q),B.LFG(h.F0),B.LFG(h.gz),B.LFG(L.F),B.LFG(ce.o),B.LFG(Fe))},M.\u0275prov=B.Yz7({token:M,factory:M.\u0275fac}),M})()},6489:(Ee,Ne,Q)=>{Q.d(Ne,{O:()=>ne});var x=Q(24280),W=Q(60515),R=Q(39646),j=Q(54004),K=Q(18505),se=Q(63900),g=Q(11365),B=Q(70262),S=Q(94650),h=Q(73602),L=Q(30144),ce=Q(71873),e=Q(4523),V=Q(56869),E=Q(88821);class ie extends E.T_{constructor(N){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=N}Do(N){return this.businessProvider=N,this.serviceContext=N.serviceContext,this.loggingService=N.loggingService,this.execute(),this.response}}var X=Q(26177);class U extends ie{constructor(N,y,P,ee,Z){super("ValidateLeadExcelDataAction"),this.valid=!1,this.excelData=N,this.accidentTypes=y,this.statuses=P,this.sourceOfLeads=ee,this.submittedBies=Z}preValidateAction(){const N=[];this.excelData.map((y,P)=>{N.push(y.name),this.validationContext.addRule(new X.mi(`accidentTypeName_${P}_is_valid}`,"Accident Type Is Not Valid","accidentType.name",y.accidentType,this.accidentTypes,!0)),this.validationContext.addRule(new X.mi(`statusName_${P}_is_valid}`,"Status Is Not Valid","status.name",y.status,this.statuses,!0)),this.validationContext.addRule(new X.mi(`sourceOfLeadName_${P}_is_valid}`,"Source of Lead Is Not Valid","sourceOfLead.name",y.sourceOfLead,this.sourceOfLeads,!0))}),this.validationContext.addRule(new X.cL("nameIsUnique","Name should be unique",N,!0))}performAction(){}finish(){super.finish();const N={};let y=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(P=>{P instanceof X.mi?P.isValid||(N[P.columnName]?N[P.columnName].newNames.includes(P.newName)||N[P.columnName].newNames.push(P.newName):N[P.columnName]={options:P.possibleValueList.map(ee=>ee.name),newNames:[P.newName]}):P instanceof X.cL&&(P.isValid||(y=P.conflicts))})):this.valid=!0,this.response=(0,R.of)({valid:this.valid,excelData:this.excelData,conflictNames:y,unknownNames:N})}}var I=Q(28234);class F extends X.ul{constructor(N,y,P,ee=!1){super(N,y,ee),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=P,this.configureRules()}configureRules(){this.rules.push(new X.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser))}}class ye extends ie{constructor(N){super("CreateLeadAction"),this.input=N}preValidateAction(){this.validationContext.addRule(new F("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateLead({input:this.input}).pipe((0,se.w)(N=>(0,I.of)(N.data.created)))}}class f extends ie{constructor(N){super("SyncMrnToPharmacyAction"),this.input=N}preValidateAction(){this.validationContext.addRule(new X.DJ("Input","Input should have values",this.input,!0)).addRule(new X.xF("Id","Id should be a CUID and not null",this.input.id,!0))}performAction(){}}class Ae extends ie{constructor(N){super("UpdateLeadsAction"),this.leads=N}preValidateAction(){this.validationContext.addRule(new X.DJ("Input","Input should have values",this.leads,!0))}performAction(){this.response=this.businessProvider.data.userUpdateLeads({input:{leads:this.leads}}).pipe((0,se.w)(N=>(0,R.of)(N.data.updated)))}}class de extends ie{constructor(N,y){super("UpdateLeadAction"),this.lead=N,this.leadId=y}preValidateAction(){this.validationContext.addRule(new X.DJ("Input","Input should have values",this.lead,!0)).addRule(new X.xF("Id","Id should be a CUID and not null",this.leadId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateLead({leadId:this.leadId,input:this.lead}).pipe((0,se.w)(N=>(0,R.of)(N.data.updated)))}}let Te=(()=>{class M extends E.nH{constructor(y,P,ee){super("NotificationService.LeadBusinessProviderService",y,ee),this.data=P}createLead(y){const P=new ye(y);return P.Do(this),P.response}updateLead(y,P){const ee=new de(y,P);return ee.Do(this),ee.response}userSyncMrnToPharmacy(y){const P=new f(y);return P.Do(this),P.response}importLeads(y){const P=new Ae(y);return P.Do(this),P.response}validateLeadExcelData(y,P,ee,Z,te){const Ce=new U(y,P,ee,Z,te);return Ce.Do(this),Ce.response}}return M.\u0275fac=function(y){return new(y||M)(S.LFG(V.ed),S.LFG(h.q),S.LFG(E.oI))},M.\u0275prov=S.Yz7({token:M,factory:M.\u0275fac,providedIn:"root"}),M})(),Fe=(()=>{class M extends E.nH{constructor(y,P,ee){super("LeadService",ee,y),this.businessProvider=P}createLead(y){const P=Object.fromEntries(Object.entries(y).filter(([ee,Z])=>null!==Z));return this.businessProvider.createLead(P)}updateLead(y,P){return this.businessProvider.updateLead(y,P)}userSyncMrnToPharmacy(y){return this.businessProvider.userSyncMrnToPharmacy(y)}importLeads(y){return this.businessProvider.importLeads(y)}validateLeadExcelData(y,P,ee,Z,te){return this.businessProvider.validateLeadExcelData(y,P,ee,Z,te)}}return M.\u0275fac=function(y){return new(y||M)(S.LFG(Te,8),S.LFG(Te),S.LFG(V.ed))},M.\u0275prov=S.Yz7({token:M,factory:M.\u0275fac,providedIn:"root"}),M})(),ne=(()=>{class M extends x.m1{constructor(y,P,ee,Z,te,Ce){if(super({loading:!1,leads:[],done:!1,searchQuery:"",mrn:"",formName:void 0,accidentTypeId:void 0,driversLicenseId:void 0,policeReportAttachmentId:void 0,phoneRecordingId:void 0,leadStatusId:void 0,leadSourceId:void 0,submittedById:void 0,paging:{limit:1e4,skip:0}}),this.data=y,this.router=P,this.route=ee,this.toast=Z,this.formService=te,this.leadService=Ce,this.bodyPartInjured=[],this.errors$=this.select(b=>b.errors),this.loading$=this.select(b=>b.loading),this.done$=this.select(b=>b.done),this.item$=this.select(b=>b.item),this.leads$=this.select(b=>b.leads),this.accidentTypes$=this.select(b=>b.accidentTypes||[]),this.documents$=this.select(b=>b.documents||[]),this.leadStatuses$=this.select(b=>b.leadStatuses||[]),this.leadSources$=this.select(b=>b.leadSources||[]),this.users$=this.select(b=>b.users||[]),this.accidentTypeId$=this.select(b=>b.accidentTypeId),this.driversLicenseId$=this.select(b=>b.driversLicenseId),this.policeReportAttachmentId$=this.select(b=>b.policeReportAttachmentId),this.phoneRecordingId$=this.select(b=>b.phoneRecordingId),this.leadStatusId$=this.select(b=>b.leadStatusId),this.leadSourceId$=this.select(b=>b.leadSourceId),this.submittedById$=this.select(b=>b.submittedById),this.paging$=this.select(b=>b.paging),this.searchQuery$=this.select(b=>b.searchQuery),this.formName$=this.select(b=>b.formName),this.actionResult$=this.select(this.item$,this.done$,(b,C)=>({item:b,done:C}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.leads$,this.accidentTypes$,this.documents$,this.leadStatuses$,this.leadSources$,this.users$,(b,C,v,T,O,D,z,re,ue,$)=>({errors:b,loading:C,item:v,formName:T,leads:O,accidentTypes:D,documents:z,leadStatuses:re,leadSources:ue,users:$}),{debounce:!0}),this.input$=this.select(this.paging$,this.accidentTypeId$,this.driversLicenseId$,this.policeReportAttachmentId$,this.phoneRecordingId$,this.leadStatusId$,this.leadSourceId$,this.submittedById$,this.searchQuery$,(b,C,v,T,O,D,z,re,ue)=>({limit:b.limit,skip:b.skip,name:ue,accidentTypeId:C,driversLicenseId:v,policeReportAttachmentId:T,phoneRecordingId:O,leadStatusId:D,leadSourceId:z,submittedById:re,total:b.total})),this.setFormName=this.updater((b,C)=>Object.assign(Object.assign({},b),{formName:C})),this.setAccidentTypeId=this.updater((b,C)=>Object.assign(Object.assign({},b),{accidentTypeId:C})),this.setDriversLicenseId=this.updater((b,C)=>Object.assign(Object.assign({},b),{driversLicenseId:C})),this.setPoliceReportAttachmentId=this.updater((b,C)=>Object.assign(Object.assign({},b),{policeReportAttachmentId:C})),this.setPhoneRecordingId=this.updater((b,C)=>Object.assign(Object.assign({},b),{phoneRecordingId:C})),this.setLeadStatusId=this.updater((b,C)=>Object.assign(Object.assign({},b),{leadStatusId:C})),this.setLeadSourceId=this.updater((b,C)=>Object.assign(Object.assign({},b),{leadSourceId:C})),this.setSubmittedById=this.updater((b,C)=>Object.assign(Object.assign({},b),{submittedById:C})),this.filterAccidentTypes=b=>this.data.userSelectAccidentTypes({input:{name:b}}).pipe((0,x._b)(C=>{const v=C.data.items;return console.log("AccidentTypes",C.data.items),this.patchState({accidentTypes:v}),v},C=>this.patchState({errors:C.graphQLErrors?C.graphQLErrors:C})),(0,j.U)(C=>(console.log("filterAccidentTypes",C.data.items),C.data.items))),this.filterDocuments=b=>this.data.userSelectDocuments({input:{name:b}}).pipe((0,x._b)(C=>{const v=C.data.items;return this.patchState({documents:v}),v},C=>this.patchState({errors:C.graphQLErrors?C.graphQLErrors:C})),(0,j.U)(C=>C.data.items)),this.filterLeadStatuses=b=>this.data.userSelectLeadStatuses({input:{name:b}}).pipe((0,x._b)(C=>{const v=C.data.items;return this.patchState({leadStatuses:v}),v},C=>this.patchState({errors:C.graphQLErrors?C.graphQLErrors:C})),(0,j.U)(C=>C.data.items)),this.filterLeadSources=b=>this.data.userSelectLeadSources({input:{name:b}}).pipe((0,x._b)(C=>{const v=C.data.items;return this.patchState({leadSources:v}),v},C=>this.patchState({errors:C.graphQLErrors?C.graphQLErrors:C})),(0,j.U)(C=>C.data.items)),this.filterUsers=b=>this.data.userSelectUsers({input:{name:b}}).pipe((0,x._b)(C=>{const v=C.data.items;return this.patchState({users:v}),v},C=>this.patchState({errors:C.graphQLErrors?C.graphQLErrors:C})),(0,j.U)(C=>C.data.items)),this.filterBodyParts=b=>this.data.userSelectBodyParts({input:{name:b}}).pipe((0,x._b)(C=>{const v=C.data.items;return this.patchState({bodyParts:v}),v},C=>this.patchState({errors:C.graphQLErrors?C.graphQLErrors:C})),(0,j.U)(C=>C.data.items)),this.addAccidentType=this.updater((b,C)=>Object.assign(Object.assign({},b),{accidentTypes:b.accidentTypes.concat(C)})),this.addDocument=this.updater((b,C)=>Object.assign(Object.assign({},b),{documents:b.documents.concat(C)})),this.addLeadStatus=this.updater((b,C)=>Object.assign(Object.assign({},b),{leadStatuses:b.leadStatuses.concat(C)})),this.addLeadSource=this.updater((b,C)=>Object.assign(Object.assign({},b),{leadSources:b.leadSources.concat(C)})),this.addUser=this.updater((b,C)=>Object.assign(Object.assign({},b),{users:b.users.concat(C)})),this.setItem=this.updater((b,C)=>Object.assign(Object.assign({},b),{item:C})),this.addNewLead=this.updater((b,C)=>Object.assign(Object.assign({},b),{leads:[...b.leads,C]})),this.updateLead=this.updater((b,C)=>Object.assign(Object.assign({},b),{leads:b.leads.map(v=>v.id===C.id?C:v)})),this.addLeads=this.updater((b,C)=>Object.assign(Object.assign({},b),{leads:b.leads.concat(C)})),this.updateLeads=this.updater((b,C)=>Object.assign(Object.assign({},b),{leads:b.leads.map(v=>C.find(O=>O.id===v.id)||v)})),this.setSearchQuery=this.updater((b,C)=>Object.assign(Object.assign({},b),{searchQuery:C})),this.loadLeadEffect=this.effect(b=>b.pipe((0,K.b)(()=>this.patchState({loading:!0})),(0,se.w)(C=>this.data.userLead({leadId:C}).pipe((0,x._b)(v=>{this.patchState({item:v.data.item,errors:v.errors,loading:!1})},v=>this.patchState({loading:!1,errors:v.graphQLErrors?v.graphQLErrors:v})))))),this.loadLeadsEffect=this.effect(b=>b.pipe((0,K.b)(()=>this.patchState({loading:!0})),(0,g.M)(this.input$),(0,se.w)(([C,v])=>this.data.userLeads({input:v}).pipe((0,x._b)(T=>this.patchState({paging:{limit:v.limit,skip:v.skip,total:T.data.count.total},leads:T.data.items,errors:T.errors,loading:!1}),T=>this.patchState({loading:!1,errors:T.graphQLErrors?T.graphQLErrors:T})))))),this.createLeadEffect=this.effect(b=>b.pipe((0,K.b)(()=>this.patchState({loading:!0})),(0,se.w)(C=>(console.log("input",C),this.leadService.createLead(Object.assign({},C)).pipe((0,x._b)(v=>{this.addNewLead(v),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:v,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},v=>{v.graphQLErrors?(this.toast.error(v.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:v.graphQLErrors?v.graphQLErrors:v})):(this.toast.error(v.Message),this.formService.setErrors(v.Data))})))))),this.updateLeadEffect=this.effect(b=>b.pipe((0,K.b)(()=>this.patchState({loading:!0})),(0,g.M)(this.item$),(0,se.w)(([C,v])=>this.leadService.updateLead(v,v.id).pipe((0,x._b)(T=>{this.updateLead(T),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:T,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},T=>{T.graphQLErrors?(this.toast.error(T.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:T.graphQLErrors?T.graphQLErrors:T})):(this.toast.error(T.Message),this.formService.setErrors(T.Data))}))))),this.userSyncMrnToPharmacyEffect=this.effect(b=>b.pipe((0,K.b)(()=>{this.patchState({loading:!0})}),(0,se.w)(C=>this.data.userSyncMrnToPharmacy({input:C,mrn:C.legalCase.medicalRecordNumber}).pipe((0,x._b)(v=>{this.toast.success("Successfully synced mrn to pharmacy",{duration:3e3}),this.patchState({loading:!1})},v=>{this.toast.error("Failed to ",{duration:3e3}),this.patchState({loading:!1})}))))),this.deleteLeadEffect=this.effect(b=>b.pipe((0,K.b)(()=>this.patchState({loading:!0})),(0,g.M)(this.item$),(0,se.w)(([C,v])=>this.data.userDeleteLead({leadId:v.id}).pipe((0,x._b)(T=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:T.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},T=>{T.graphQLErrors?(this.toast.error(T.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:T.graphQLErrors?T.graphQLErrors:T})):(this.toast.error(T.Message),this.formService.setErrors(T.Data))}))))),this.importExcelEffect=this.effect(b=>b.pipe((0,K.b)(()=>this.patchState({loading:!0})),(0,se.w)(C=>this.leadService.importLeads(C).pipe((0,B.K)(v=>{var T;return this.toast.error(null!==(T=v.Message)&&void 0!==T?T:"Failed to save",{duration:3e3}),W.E}),(0,K.b)(v=>{const T=JSON.parse(v.created),O=JSON.parse(v.updated),D=JSON.parse(v.failed),z=T.length+O.length+D.length;this.addLeads(T),this.updateLeads(O),this.toast.success(`${T.length} created, ${O.length} updated, ${D.length} failed of total ${z}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("leadId")?(this.route.snapshot.paramMap.get("leadId"),this.setFormName("lead_edit")):this.setFormName("lead_create"),this.route.snapshot.paramMap.has("accidentTypeId")){const b=this.route.snapshot.paramMap.get("accidentTypeId");this.setAccidentTypeId(b)}if(this.route.snapshot.paramMap.has("driversLicenseId")){const b=this.route.snapshot.paramMap.get("driversLicenseId");this.setDriversLicenseId(b)}if(this.route.snapshot.paramMap.has("policeReportAttachmentId")){const b=this.route.snapshot.paramMap.get("policeReportAttachmentId");this.setPoliceReportAttachmentId(b)}if(this.route.snapshot.paramMap.has("phoneRecordingId")){const b=this.route.snapshot.paramMap.get("phoneRecordingId");this.setPhoneRecordingId(b)}if(this.route.snapshot.paramMap.has("leadStatusId")){const b=this.route.snapshot.paramMap.get("leadStatusId");this.setLeadStatusId(b)}if(this.route.snapshot.paramMap.has("leadSourceId")){const b=this.route.snapshot.paramMap.get("leadSourceId");this.setLeadSourceId(b)}if(this.route.snapshot.paramMap.has("submittedById")){const b=this.route.snapshot.paramMap.get("submittedById");this.setSubmittedById(b)}}validateImportData(y){return this.vm$.pipe((0,se.w)(P=>this.leadService.validateLeadExcelData(y,P.accidentTypes,P.leadStatuses,P.leadSources,P.users)))}syncMrnToPharmacy(){return this.vm$.pipe((0,se.w)(y=>(0,R.of)(this.data.userSyncMrnToPharmacy({input:y.item,mrn:"123456"})).pipe((0,B.K)(ee=>{var Z;return this.toast.error(null!==(Z=ee.Message)&&void 0!==Z?Z:"Failed to save",{duration:3e3}),W.E}),(0,K.b)(ee=>{ee&&this.toast.success("Successfully synced to pharmacy, {result}",{duration:3e3})}))))}getMrn(){return this.vm$.pipe((0,se.w)(y=>(0,R.of)(this.data.getPatientMrnNumber({dateOfBirth:y.item.dateOfBirth,dateOfLoss:y.item.dateOfLoss,accidentKind:y.item.accidentTypeId,legalCaseId:y.item.id})).pipe((0,B.K)(P=>{var ee;return this.toast.error(null!==(ee=P.Message)&&void 0!==ee?ee:"Failed to save",{duration:3e3}),W.E}),(0,K.b)(P=>{P&&(console.log(P),this.toast.success(`Success, new MRN: ${P}`,{duration:3e3}))}))))}BodyPartsInjuredChanged(y){console.log("bodyParts",y),this.bodyPartInjured=y.map(P=>({bodyPartId:P}))}}return M.\u0275fac=function(y){return new(y||M)(S.LFG(h.q),S.LFG(L.F0),S.LFG(L.gz),S.LFG(ce.F),S.LFG(e.o),S.LFG(Fe))},M.\u0275prov=S.Yz7({token:M,factory:M.\u0275fac}),M})()},19647:(Ee,Ne,Q)=>{Q.d(Ne,{d:()=>ne});var x=Q(24280),W=Q(60515),R=Q(54004),j=Q(18505),K=Q(63900),se=Q(11365),g=Q(70262),B=Q(94650),S=Q(73602),h=Q(30144),L=Q(71873),ce=Q(4523),e=Q(56869),V=Q(88821),E=Q(39646);class ie extends V.T_{constructor(N){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=N}Do(N){return this.businessProvider=N,this.serviceContext=N.serviceContext,this.loggingService=N.loggingService,this.execute(),this.response}}var X=Q(26177);class U extends ie{constructor(N,y,P,ee,Z,te,Ce,b,C,v,T){super("ValidateLegalCaseExcelDataAction"),this.valid=!1,this.excelData=N,this.accidentTypes=y,this.patients=P,this.medLevels=ee,this.firms=Z,this.attorneys=te,this.caseStatuses=Ce,this.caseTypes=b,this.patientTreatmentStatuses=C,this.caseProgressStatuses=v,this.adverseInsuranceStatuses=T}preValidateAction(){const N=[];this.excelData.map((y,P)=>{N.push(y.name),this.validationContext.addRule(new X.mi(`accidentTypeName_${P}_is_valid}`,"Accident Type Is Not Valid","accidentType.name",y.accidentType,this.accidentTypes,!0)),this.validationContext.addRule(new X.mi(`patientName_${P}_is_valid}`,"Patient Is Not Valid","patient.name",y.patient,this.patients,!0)),this.validationContext.addRule(new X.mi(`medLevelName_${P}_is_valid}`,"Med Level Is Not Valid","medLevel.name",y.medLevel,this.medLevels,!0)),this.validationContext.addRule(new X.mi(`firmName_${P}_is_valid}`,"Firm Is Not Valid","firm.name",y.firm,this.firms,!0)),this.validationContext.addRule(new X.mi(`attorneyName_${P}_is_valid}`,"Attorney Is Not Valid","attorney.name",y.attorney,this.attorneys,!0)),this.validationContext.addRule(new X.mi(`caseStatusName_${P}_is_valid}`,"Case Status Is Not Valid","caseStatus.name",y.caseStatus,this.caseStatuses,!0)),this.validationContext.addRule(new X.mi(`caseTypeName_${P}_is_valid}`,"Case Type Is Not Valid","caseType.name",y.caseType,this.caseTypes,!0)),this.validationContext.addRule(new X.mi(`patientTreatmentStatusName_${P}_is_valid}`,"Patient Treatment Status Is Not Valid","patientTreatmentStatus.name",y.patientTreatmentStatus,this.patientTreatmentStatuses,!0)),this.validationContext.addRule(new X.mi(`caseProgressStatusName_${P}_is_valid}`,"Case Progress Status Is Not Valid","caseProgressStatus.name",y.caseProgressStatus,this.caseProgressStatuses,!0)),this.validationContext.addRule(new X.mi(`adverseInsuranceStatusName_${P}_is_valid}`,"Adverse Insurance Status Is Not Valid","adverseInsuranceStatus.name",y.adverseInsuranceStatus,this.adverseInsuranceStatuses,!0))}),this.validationContext.addRule(new X.cL("nameIsUnique","Name should be unique",N,!0))}performAction(){}finish(){super.finish();const N={};let y=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(P=>{P instanceof X.mi?P.isValid||(N[P.columnName]?N[P.columnName].newNames.includes(P.newName)||N[P.columnName].newNames.push(P.newName):N[P.columnName]={options:P.possibleValueList.map(ee=>ee.name),newNames:[P.newName]}):P instanceof X.cL&&(P.isValid||(y=P.conflicts))})):this.valid=!0,this.response=(0,E.of)({valid:this.valid,excelData:this.excelData,conflictNames:y,unknownNames:N})}}var I=Q(28234);class F extends X.wS{constructor(N,y,P,ee,Z){super(N,y,P,ee,Z,!0)}}class ye extends X.ul{constructor(N,y,P,ee=!1){super(N,y,ee),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=P,this.configureRules()}configureRules(){this.rules.push(new X.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new F("name","The legalcase name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class f extends ie{constructor(N){super("CreateLegalCaseAction"),this.input=N}preValidateAction(){this.validationContext.addRule(new ye("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateLegalCase({input:this.input}).pipe((0,K.w)(N=>(0,I.of)(N.data.created)))}}class Ae extends ie{constructor(N){super("UpdateLegalCasesAction"),this.legalCases=N}preValidateAction(){this.validationContext.addRule(new X.DJ("Input","Input should have values",this.legalCases,!0))}performAction(){this.response=this.businessProvider.data.userUpdateLegalCases({input:{legalCases:this.legalCases}}).pipe((0,K.w)(N=>(0,E.of)(N.data.updated)))}}class de extends ie{constructor(N,y){super("UpdateLegalCaseAction"),this.legalCase=N,this.legalCaseId=y}preValidateAction(){this.validationContext.addRule(new X.DJ("Input","Input should have values",this.legalCase,!0)).addRule(new X.xF("Id","Id should be a CUID and not null",this.legalCaseId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateLegalCase({legalCaseId:this.legalCaseId,input:this.legalCase}).pipe((0,K.w)(N=>(0,E.of)(N.data.updated)))}}let Te=(()=>{class M extends V.nH{constructor(y,P,ee){super("NotificationService.LegalCaseBusinessProviderService",y,ee),this.data=P}createLegalCase(y){const P=new f(y);return P.Do(this),P.response}updateLegalCase(y,P){const ee=new de(y,P);return ee.Do(this),ee.response}importLegalCases(y){const P=new Ae(y);return P.Do(this),P.response}validateLegalCaseExcelData(y,P,ee,Z,te,Ce,b,C,v,T,O){const D=new U(y,P,ee,Z,te,Ce,b,C,v,T,O);return D.Do(this),D.response}}return M.\u0275fac=function(y){return new(y||M)(B.LFG(e.ed),B.LFG(S.q),B.LFG(V.oI))},M.\u0275prov=B.Yz7({token:M,factory:M.\u0275fac,providedIn:"root"}),M})(),Fe=(()=>{class M extends V.nH{constructor(y,P,ee){super("LegalCaseService",ee,y),this.businessProvider=P}createLegalCase(y){const P=Object.fromEntries(Object.entries(y).filter(([ee,Z])=>null!==Z));return this.businessProvider.createLegalCase(P)}updateLegalCase(y,P){return this.businessProvider.updateLegalCase(y,P)}importLegalCases(y){return this.businessProvider.importLegalCases(y)}validateLegalCaseExcelData(y,P,ee,Z,te,Ce,b,C,v,T,O){return this.businessProvider.validateLegalCaseExcelData(y,P,ee,Z,te,Ce,b,C,v,T,O)}}return M.\u0275fac=function(y){return new(y||M)(B.LFG(Te,8),B.LFG(Te),B.LFG(e.ed))},M.\u0275prov=B.Yz7({token:M,factory:M.\u0275fac,providedIn:"root"}),M})(),ne=(()=>{class M extends x.m1{constructor(y,P,ee,Z,te,Ce){if(super({loading:!1,legalCases:[],done:!1,searchQuery:"",formName:void 0,accidentTypeId:void 0,patientId:void 0,medLevelId:void 0,firmId:void 0,attorneyId:void 0,caseStatusId:void 0,caseTypeId:void 0,patientTreatmentStatusId:void 0,caseProgressStatusId:void 0,adverseInsuranceStatusId:void 0,legalCaseUpdates:[],mrnNumber:void 0,currentLegalCaseId:void 0,paging:{limit:1e4,skip:0},summary:[{month:"Jan",settlement:45,prorata:78},{month:"Feb",settlement:50,prorata:82},{month:"Mar",settlement:70,prorata:110},{month:"Apr",settlement:76,prorata:90}]}),this.data=y,this.router=P,this.route=ee,this.toast=Z,this.formService=te,this.legalCaseService=Ce,this.errors$=this.select(b=>b.errors),this.loading$=this.select(b=>b.loading),this.summary$=this.select(b=>b.summary),this.done$=this.select(b=>b.done),this.currentLegalCaseId$=this.select(b=>b.currentLegalCaseId),this.item$=this.select(b=>{var C,v,T,O,D,z,re,ue,$,G,q;if(b.item){let k=0,be=0;null===(v=null===(C=b.item)||void 0===C?void 0:C.insurances)||void 0===v||v.map(we=>{var Ie,pe;we.minimumCoverageAmount=null!==(Ie=we.minimumCoverageAmount)&&void 0!==Ie?Ie:0,we.maximumCoverageAmount=null!==(pe=we.maximumCoverageAmount)&&void 0!==pe?pe:0,k+=we.minimumCoverageAmount}),null===(O=null===(T=b.item)||void 0===T?void 0:T.priorMedsToDates)||void 0===O||O.map(we=>{var Ie;we.amount=null!==(Ie=we.amount)&&void 0!==Ie?Ie:0,be+=we.amount});const Pe=null===(re=null===(z=null===(D=b.item)||void 0===D?void 0:D.caseProcedures)||void 0===z?void 0:z.map(we=>we.estimate))||void 0===re?void 0:re.reduce((we,Ie)=>we+Ie,0),me=null===(G=null===($=null===(ue=b.item)||void 0===ue?void 0:ue.caseAccounts)||void 0===$?void 0:$.map(we=>we.contractedAmount))||void 0===G?void 0:G.reduce((we,Ie)=>we+Ie,0);return Object.assign(Object.assign({},b.item),{sumOfMinAmount:k.toFixed(2),totalPendingRequestEstimate:Pe.toFixed(2),sumOfPriorMedsToDateAmount:be.toFixed(2),totalCaseAccountsSiteCost:me.toFixed(2),totalMedsToDates:null===(q=Pe+be+me)||void 0===q?void 0:q.toFixed(2)})}}),this.legalCases$=this.select(b=>b.legalCases),this.legalCaseUpdates$=this.select(b=>b.legalCaseUpdates),this.accidentTypes$=this.select(b=>b.accidentTypes||[]),this.patients$=this.select(b=>b.patients||[]),this.medLevels$=this.select(b=>b.medLevels||[]),this.firms$=this.select(b=>b.firms||[]),this.attorneys$=this.select(b=>b.attorneys||[]),this.caseStatuses$=this.select(b=>b.caseStatuses||[]),this.caseTypes$=this.select(b=>b.caseTypes||[]),this.mrnNumber$=this.select(b=>b.mrnNumber||""),this.patientTreatmentStatuses$=this.select(b=>b.patientTreatmentStatuses||[]),this.caseProgressStatuses$=this.select(b=>b.caseProgressStatuses||[]),this.adverseInsuranceStatuses$=this.select(b=>b.adverseInsuranceStatuses||[]),this.accidentTypeId$=this.select(b=>b.accidentTypeId),this.patientId$=this.select(b=>b.patientId),this.medLevelId$=this.select(b=>b.medLevelId),this.firmId$=this.select(b=>b.firmId),this.attorneyId$=this.select(b=>b.attorneyId),this.caseStatusId$=this.select(b=>b.caseStatusId),this.caseTypeId$=this.select(b=>b.caseTypeId),this.patientTreatmentStatusId$=this.select(b=>b.patientTreatmentStatusId),this.caseProgressStatusId$=this.select(b=>b.caseProgressStatusId),this.adverseInsuranceStatusId$=this.select(b=>b.adverseInsuranceStatusId),this.paging$=this.select(b=>b.paging),this.searchQuery$=this.select(b=>b.searchQuery),this.formName$=this.select(b=>b.formName),this.actionResult$=this.select(this.item$,this.done$,(b,C)=>({item:b,done:C}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.legalCases$,this.accidentTypes$,this.patients$,this.medLevels$,this.firms$,this.attorneys$,this.caseStatuses$,this.caseTypes$,this.patientTreatmentStatuses$,this.caseProgressStatuses$,this.adverseInsuranceStatuses$,this.mrnNumber$,(b,C,v,T,O,D,z,re,ue,$,G,q,k,be,Pe,me)=>({errors:b,loading:C,item:v,formName:T,legalCases:O,accidentTypes:D,patients:z,medLevels:re,firms:ue,attorneys:$,caseStatuses:G,caseTypes:q,patientTreatmentStatuses:k,caseProgressStatuses:be,adverseInsuranceStatuses:Pe,mrnNumber:me}),{debounce:!0}),this.input$=this.select(this.paging$,this.accidentTypeId$,this.patientId$,this.medLevelId$,this.firmId$,this.attorneyId$,this.caseStatusId$,this.caseTypeId$,this.patientTreatmentStatusId$,this.caseProgressStatusId$,this.adverseInsuranceStatusId$,this.searchQuery$,(b,C,v,T,O,D,z,re,ue,$,G,q)=>({limit:b.limit,skip:b.skip,name:q,accidentTypeId:C,patientId:v,medLevelId:T,firmId:O,attorneyId:D,caseStatusId:z,caseTypeId:re,patientTreatmentStatusId:ue,caseProgressStatusId:$,adverseInsuranceStatusId:G,total:b.total})),this.setFormName=this.updater((b,C)=>Object.assign(Object.assign({},b),{formName:C})),this.setAccidentTypeId=this.updater((b,C)=>Object.assign(Object.assign({},b),{accidentTypeId:C})),this.setPatientId=this.updater((b,C)=>Object.assign(Object.assign({},b),{patientId:C})),this.setMedLevelId=this.updater((b,C)=>Object.assign(Object.assign({},b),{medLevelId:C})),this.setFirmId=this.updater((b,C)=>Object.assign(Object.assign({},b),{firmId:C})),this.setAttorneyId=this.updater((b,C)=>Object.assign(Object.assign({},b),{attorneyId:C})),this.setCaseStatusId=this.updater((b,C)=>Object.assign(Object.assign({},b),{caseStatusId:C})),this.setCurrentLegalCaseId=this.updater((b,C)=>Object.assign(Object.assign({},b),{currentLegalCaseId:C})),this.setCaseTypeId=this.updater((b,C)=>Object.assign(Object.assign({},b),{caseTypeId:C})),this.setPatientTreatmentStatusId=this.updater((b,C)=>Object.assign(Object.assign({},b),{patientTreatmentStatusId:C})),this.setCaseProgressStatusId=this.updater((b,C)=>Object.assign(Object.assign({},b),{caseProgressStatusId:C})),this.setAdverseInsuranceStatusId=this.updater((b,C)=>Object.assign(Object.assign({},b),{adverseInsuranceStatusId:C})),this.setLimit=this.updater((b,C)=>Object.assign(Object.assign({},b),{paging:Object.assign(Object.assign({},b.paging),{limit:C})})),this.setSkip=this.updater((b,C)=>Object.assign(Object.assign({},b),{paging:Object.assign(Object.assign({},b.paging),{skip:C})})),this.filterAccidentTypes=b=>this.data.userSelectAccidentTypes({input:{name:b}}).pipe((0,x._b)(C=>{const v=C.data.items;return this.patchState({accidentTypes:v}),v},C=>this.patchState({errors:C.graphQLErrors?C.graphQLErrors:C})),(0,R.U)(C=>C.data.items)),this.filterPatients=b=>this.data.userSelectPatients({input:{name:b}}).pipe((0,x._b)(C=>{const v=C.data.items;return this.patchState({patients:v}),v},C=>this.patchState({errors:C.graphQLErrors?C.graphQLErrors:C})),(0,R.U)(C=>C.data.items)),this.filterMedLevels=b=>this.data.userSelectMedLevels({input:{name:b}}).pipe((0,x._b)(C=>{const v=C.data.items;return this.patchState({medLevels:v}),v},C=>this.patchState({errors:C.graphQLErrors?C.graphQLErrors:C})),(0,R.U)(C=>C.data.items)),this.filterFirms=b=>this.data.userSelectFirms({input:{name:b}}).pipe((0,x._b)(C=>{const v=C.data.items;return this.patchState({firms:v}),v},C=>this.patchState({errors:C.graphQLErrors?C.graphQLErrors:C})),(0,R.U)(C=>C.data.items)),this.filterAttorneys=b=>this.data.userSelectAttorneys({input:{name:b}}).pipe((0,x._b)(C=>{const v=C.data.items;return this.patchState({attorneys:v}),v},C=>this.patchState({errors:C.graphQLErrors?C.graphQLErrors:C})),(0,R.U)(C=>C.data.items)),this.filterCaseStatuses=b=>this.data.userSelectCaseStatuses({input:{name:b}}).pipe((0,x._b)(C=>{const v=C.data.items;return this.patchState({caseStatuses:v}),v},C=>this.patchState({errors:C.graphQLErrors?C.graphQLErrors:C})),(0,R.U)(C=>C.data.items)),this.filterCaseTypes=b=>this.data.userSelectCaseTypes({input:{name:b}}).pipe((0,x._b)(C=>{const v=C.data.items;return this.patchState({caseTypes:v}),v},C=>this.patchState({errors:C.graphQLErrors?C.graphQLErrors:C})),(0,R.U)(C=>C.data.items)),this.filterPatientTreatmentStatuses=b=>this.data.userSelectPatientTreatmentStatuses({input:{name:b}}).pipe((0,x._b)(C=>{const v=C.data.items;return this.patchState({patientTreatmentStatuses:v}),v},C=>this.patchState({errors:C.graphQLErrors?C.graphQLErrors:C})),(0,R.U)(C=>C.data.items)),this.filterCaseProgressStatuses=b=>this.data.userSelectCaseProgressStatuses({input:{name:b}}).pipe((0,x._b)(C=>{const v=C.data.items;return this.patchState({caseProgressStatuses:v}),v},C=>this.patchState({errors:C.graphQLErrors?C.graphQLErrors:C})),(0,R.U)(C=>C.data.items)),this.filterAdverseInsuranceStatuses=b=>this.data.userSelectAdverseInsuranceStatuses({input:{name:b}}).pipe((0,x._b)(C=>{const v=C.data.items;return this.patchState({adverseInsuranceStatuses:v}),v},C=>this.patchState({errors:C.graphQLErrors?C.graphQLErrors:C})),(0,R.U)(C=>C.data.items)),this.addAccidentType=this.updater((b,C)=>Object.assign(Object.assign({},b),{accidentTypes:b.accidentTypes.concat(C)})),this.addPatient=this.updater((b,C)=>Object.assign(Object.assign({},b),{patients:b.patients.concat(C)})),this.addMedLevel=this.updater((b,C)=>Object.assign(Object.assign({},b),{medLevels:b.medLevels.concat(C)})),this.addFirm=this.updater((b,C)=>Object.assign(Object.assign({},b),{firms:b.firms.concat(C)})),this.addAttorney=this.updater((b,C)=>Object.assign(Object.assign({},b),{attorneys:b.attorneys.concat(C)})),this.addCaseStatus=this.updater((b,C)=>Object.assign(Object.assign({},b),{caseStatuses:b.caseStatuses.concat(C)})),this.addCaseType=this.updater((b,C)=>Object.assign(Object.assign({},b),{caseTypes:b.caseTypes.concat(C)})),this.addPatientTreatmentStatus=this.updater((b,C)=>Object.assign(Object.assign({},b),{patientTreatmentStatuses:b.patientTreatmentStatuses.concat(C)})),this.addCaseProgressStatus=this.updater((b,C)=>Object.assign(Object.assign({},b),{caseProgressStatuses:b.caseProgressStatuses.concat(C)})),this.addAdverseInsuranceStatus=this.updater((b,C)=>Object.assign(Object.assign({},b),{adverseInsuranceStatuses:b.adverseInsuranceStatuses.concat(C)})),this.setItem=this.updater((b,C)=>Object.assign(Object.assign({},b),{item:C})),this.addNewLegalCase=this.updater((b,C)=>Object.assign(Object.assign({},b),{legalCases:[...b.legalCases,C]})),this.updateLegalCase=this.updater((b,C)=>Object.assign(Object.assign({},b),{legalCases:b.legalCases.map(v=>v.id===C.id?C:v)})),this.addLegalCases=this.updater((b,C)=>Object.assign(Object.assign({},b),{legalCases:b.legalCases.concat(C)})),this.updateLegalCases=this.updater((b,C)=>Object.assign(Object.assign({},b),{legalCases:b.legalCases.map(v=>C.find(O=>O.id===v.id)||v)})),this.setSearchQuery=this.updater((b,C)=>Object.assign(Object.assign({},b),{searchQuery:C})),this.loadLegalCaseEffect=this.effect(b=>b.pipe((0,j.b)(()=>this.patchState({loading:!0})),(0,K.w)(C=>(this.setCurrentLegalCaseId(C),this.data.userLegalCase({legalCaseId:C}).pipe((0,x._b)(v=>{var T,O,D,z;return null===(O=null===(T=v.data.item)||void 0===T?void 0:T.caseProcedures)||void 0===O||O.map(ue=>{var $;return Object.assign(Object.assign({},ue),{estimate:null===($=ue.procedureVendors)||void 0===$?void 0:$.map(G=>G.estimate).reduce((G,q)=>G+q)})}),console.log("caseAccounts:",v.data.item.caseAccounts),this.patchState({item:Object.assign(Object.assign({},v.data.item),{caseProcedures:null===(z=null===(D=v.data.item)||void 0===D?void 0:D.caseProcedures)||void 0===z?void 0:z.map(ue=>{var $;return Object.assign(Object.assign({},ue),{estimate:null===($=ue.procedureVendors)||void 0===$?void 0:$.map(G=>G.estimate).reduce((G,q)=>G+q)})})}),errors:v.errors,loading:!1})},v=>this.patchState({loading:!1,errors:v.graphQLErrors?v.graphQLErrors:v}))))))),this.loadLegalCasesEffect=this.effect(b=>b.pipe((0,j.b)(()=>this.patchState({loading:!0})),(0,se.M)(this.input$),(0,K.w)(([C,v])=>this.data.userLegalCases({input:v}).pipe((0,x._b)(T=>this.patchState({paging:{limit:v.limit,skip:v.skip,total:T.data.count.total},legalCases:T.data.items,errors:T.errors,loading:!1}),T=>this.patchState({loading:!1,errors:T.graphQLErrors?T.graphQLErrors:T})))))),this.loadLegalCasesUpdatesEffect=this.effect(b=>b.pipe((0,j.b)(()=>this.patchState({loading:!0})),(0,K.w)(()=>this.data.userLegalCaseUpdates().pipe((0,x._b)(C=>this.patchState({legalCaseUpdates:C.data.legalCases,errors:C.errors,loading:!1}),C=>this.patchState({loading:!1,errors:C.graphQLErrors?C.graphQLErrors:C})))))),this.createLegalCaseEffect=this.effect(b=>b.pipe((0,j.b)(()=>this.patchState({loading:!0})),(0,K.w)(C=>this.legalCaseService.createLegalCase(Object.assign({},C)).pipe((0,x._b)(v=>{this.addNewLegalCase(v),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:v,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},v=>{v.graphQLErrors?(this.toast.error(v.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:v.graphQLErrors?v.graphQLErrors:v})):(this.toast.error(v.Message),this.formService.setErrors(v.Data))}))))),this.createPatientDocumentEffect=this.effect(b=>b.pipe((0,j.b)(()=>this.patchState({loading:!0})),(0,K.w)(C=>(C.patientId=this.get().item.patientId,console.log(C.patientId),this.data.userCreateDocument({input:C}).pipe((0,R.U)(v=>console.log(v.data.created))))))),this.getMrnNumberEffect=this.effect(b=>b.pipe((0,j.b)(()=>this.patchState({loading:!0})),(0,K.w)(C=>(console.log(C),this.data.getPatientMrnNumber({dateOfBirth:C.dateOfBirth,dateOfLoss:C.dateOfLoss,accidentKind:C.accidentKind,legalCaseId:C.legalCaseId}).pipe((0,R.U)(v=>console.log("Mrn Output",v.data.patientMrn))))))),this.updateLegalCaseEffect=this.effect(b=>b.pipe((0,j.b)(()=>this.patchState({loading:!0})),(0,se.M)(this.item$),(0,K.w)(([C,v])=>this.legalCaseService.updateLegalCase(C,C.id).pipe((0,x._b)(T=>{this.updateLegalCase(T),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:T,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},T=>{T.graphQLErrors?(this.toast.error(T.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:T.graphQLErrors?T.graphQLErrors:T})):(this.toast.error(T.Message),this.formService.setErrors(T.Data))}))))),this.deleteLegalCaseEffect=this.effect(b=>b.pipe((0,j.b)(()=>this.patchState({loading:!0})),(0,se.M)(this.item$),(0,K.w)(([C,v])=>this.data.userDeleteLegalCase({legalCaseId:v.id}).pipe((0,x._b)(T=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:T.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},T=>{T.graphQLErrors?(this.toast.error(T.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:T.graphQLErrors?T.graphQLErrors:T})):(this.toast.error(T.Message),this.formService.setErrors(T.Data))}))))),this.importExcelEffect=this.effect(b=>b.pipe((0,j.b)(()=>this.patchState({loading:!0})),(0,K.w)(C=>this.legalCaseService.importLegalCases(C).pipe((0,g.K)(v=>{var T;return this.toast.error(null!==(T=v.Message)&&void 0!==T?T:"Failed to save",{duration:3e3}),W.E}),(0,j.b)(v=>{const T=JSON.parse(v.created),O=JSON.parse(v.updated),D=JSON.parse(v.failed),z=T.length+O.length+D.length;this.addLegalCases(T),this.updateLegalCases(O),this.toast.success(`${T.length} created, ${O.length} updated, ${D.length} failed of total ${z}`,{duration:3e3})}))))),this.updateCaseStatusEffect=this.effect(b=>b.pipe((0,j.b)(C=>{this.patchState({loading:!0})}),(0,K.w)(C=>this.data.userUpdateLegalCase({legalCaseId:C.legalCaseId,input:{name:C.name,firmId:C.firmId,patientId:C.patientId,caseStatusId:C.caseStatusId}}).pipe((0,x._b)(v=>{var T,O,D;this.toast.success(`Successfully updated case status to ${null!==(D=null===(O=null===(T=v.data.updated)||void 0===T?void 0:T.caseStatus)||void 0===O?void 0:O.name)&&void 0!==D?D:""}`,{duration:3e3}),this.patchState({loading:!1})},v=>{this.toast.error("Failed to update status",{duration:3e3}),console.log(v),this.patchState({loading:!1})}))))),this.updateFundingApproved=this.effect(b=>b.pipe((0,j.b)(()=>this.patchState({loading:!0})),(0,K.w)(C=>(console.log("updateFundingApproved",C),this.data.userUpdateProcedureVendor({procedureVendorId:C.input.id,input:C.input}).pipe((0,x._b)(v=>{this.currentLegalCaseId$.subscribe(T=>{this.loadLegalCaseEffect(T)}).unsubscribe(),this.patchState({errors:v.errors,loading:!1}),C.resultEmitter.emit(v.data.updated)},v=>this.patchState({loading:!1,errors:v.graphQLErrors?v.graphQLErrors:v}))))))),this.route.snapshot.paramMap.has("legalCaseId")?(this.route.snapshot.paramMap.get("legalCaseId"),this.setFormName("legalCase_edit")):this.setFormName("legalCase_create"),this.route.snapshot.paramMap.has("accidentTypeId")){const b=this.route.snapshot.paramMap.get("accidentTypeId");this.setAccidentTypeId(b)}if(this.route.snapshot.paramMap.has("patientId")){const b=this.route.snapshot.paramMap.get("patientId");this.setPatientId(b)}if(this.route.snapshot.paramMap.has("medLevelId")){const b=this.route.snapshot.paramMap.get("medLevelId");this.setMedLevelId(b)}if(this.route.snapshot.paramMap.has("firmId")){const b=this.route.snapshot.paramMap.get("firmId");this.setFirmId(b)}if(this.route.snapshot.paramMap.has("attorneyId")){const b=this.route.snapshot.paramMap.get("attorneyId");this.setAttorneyId(b)}if(this.route.snapshot.paramMap.has("caseStatusId")){const b=this.route.snapshot.paramMap.get("caseStatusId");this.setCaseStatusId(b)}if(this.route.snapshot.paramMap.has("caseTypeId")){const b=this.route.snapshot.paramMap.get("caseTypeId");this.setCaseTypeId(b)}if(this.route.snapshot.paramMap.has("patientTreatmentStatusId")){const b=this.route.snapshot.paramMap.get("patientTreatmentStatusId");this.setPatientTreatmentStatusId(b)}if(this.route.snapshot.paramMap.has("caseProgressStatusId")){const b=this.route.snapshot.paramMap.get("caseProgressStatusId");this.setCaseProgressStatusId(b)}if(this.route.snapshot.paramMap.has("adverseInsuranceStatusId")){const b=this.route.snapshot.paramMap.get("adverseInsuranceStatusId");this.setAdverseInsuranceStatusId(b)}}validateImportData(y){return this.vm$.pipe((0,K.w)(P=>this.legalCaseService.validateLegalCaseExcelData(y,P.accidentTypes,P.patients,P.medLevels,P.firms,P.attorneys,P.caseStatuses,P.caseTypes,P.patientTreatmentStatuses,P.caseProgressStatuses,P.adverseInsuranceStatuses)))}}return M.\u0275fac=function(y){return new(y||M)(B.LFG(S.q),B.LFG(h.F0),B.LFG(h.gz),B.LFG(L.F),B.LFG(ce.o),B.LFG(Fe))},M.\u0275prov=B.Yz7({token:M,factory:M.\u0275fac}),M})()},3866:(Ee,Ne,Q)=>{Q.d(Ne,{v:()=>ne});var x=Q(24280),W=Q(60515),R=Q(54004),j=Q(18505),K=Q(63900),se=Q(11365),g=Q(70262),B=Q(94650),S=Q(73602),h=Q(30144),L=Q(71873),ce=Q(4523),e=Q(56869),V=Q(88821),E=Q(39646);class ie extends V.T_{constructor(N){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=N}Do(N){return this.businessProvider=N,this.serviceContext=N.serviceContext,this.loggingService=N.loggingService,this.execute(),this.response}}var X=Q(26177);class U extends ie{constructor(N,y){super("ValidateLocationExcelDataAction"),this.valid=!1,this.excelData=N,this.placeOfServices=y}preValidateAction(){const N=[];this.excelData.map((y,P)=>{N.push(y.name),this.validationContext.addRule(new X.mi(`placeOfServiceName_${P}_is_valid}`,"Place of Service Is Not Valid","placeOfService.name",y.placeOfService,this.placeOfServices,!0))}),this.validationContext.addRule(new X.cL("nameIsUnique","Name should be unique",N,!0))}performAction(){}finish(){super.finish();const N={};let y=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(P=>{P instanceof X.mi?P.isValid||(N[P.columnName]?N[P.columnName].newNames.includes(P.newName)||N[P.columnName].newNames.push(P.newName):N[P.columnName]={options:P.possibleValueList.map(ee=>ee.name),newNames:[P.newName]}):P instanceof X.cL&&(P.isValid||(y=P.conflicts))})):this.valid=!0,this.response=(0,E.of)({valid:this.valid,excelData:this.excelData,conflictNames:y,unknownNames:N})}}var I=Q(28234);class F extends X.wS{constructor(N,y,P,ee,Z){super(N,y,P,ee,Z,!0)}}class ye extends X.ul{constructor(N,y,P,ee=!1){super(N,y,ee),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=P,this.configureRules()}configureRules(){this.rules.push(new X.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new F("name","The location name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class f extends ie{constructor(N){super("CreateLocationAction"),this.input=N}preValidateAction(){this.validationContext.addRule(new ye("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateLocation({input:this.input}).pipe((0,K.w)(N=>(0,I.of)(N.data.created)))}}class Ae extends ie{constructor(N){super("UpdateLocationsAction"),this.locations=N}preValidateAction(){this.validationContext.addRule(new X.DJ("Input","Input should have values",this.locations,!0))}performAction(){this.response=this.businessProvider.data.userUpdateLocations({input:{locations:this.locations}}).pipe((0,K.w)(N=>(0,E.of)(N.data.updated)))}}class de extends ie{constructor(N,y){super("UpdateLocationAction"),this.location=N,this.locationId=y}preValidateAction(){this.validationContext.addRule(new X.DJ("Input","Input should have values",this.location,!0)).addRule(new X.xF("Id","Id should be a CUID and not null",this.locationId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateLocation({locationId:this.locationId,input:this.location}).pipe((0,K.w)(N=>(0,E.of)(N.data.updated)))}}let Te=(()=>{class M extends V.nH{constructor(y,P,ee){super("NotificationService.LocationBusinessProviderService",y,ee),this.data=P}createLocation(y){const P=new f(y);return P.Do(this),P.response}updateLocation(y,P){const ee=new de(y,P);return ee.Do(this),ee.response}importLocations(y){const P=new Ae(y);return P.Do(this),P.response}validateLocationExcelData(y,P){const ee=new U(y,P);return ee.Do(this),ee.response}}return M.\u0275fac=function(y){return new(y||M)(B.LFG(e.ed),B.LFG(S.q),B.LFG(V.oI))},M.\u0275prov=B.Yz7({token:M,factory:M.\u0275fac,providedIn:"root"}),M})(),Fe=(()=>{class M extends V.nH{constructor(y,P,ee){super("LocationService",ee,y),this.businessProvider=P}createLocation(y){const P=Object.fromEntries(Object.entries(y).filter(([ee,Z])=>null!==Z));return this.businessProvider.createLocation(P)}updateLocation(y,P){return this.businessProvider.updateLocation(y,P)}importLocations(y){return this.businessProvider.importLocations(y)}validateLocationExcelData(y,P){return this.businessProvider.validateLocationExcelData(y,P)}}return M.\u0275fac=function(y){return new(y||M)(B.LFG(Te,8),B.LFG(Te),B.LFG(e.ed))},M.\u0275prov=B.Yz7({token:M,factory:M.\u0275fac,providedIn:"root"}),M})(),ne=(()=>{class M extends x.m1{constructor(y,P,ee,Z,te,Ce){if(super({loading:!1,locations:[],done:!1,searchQuery:"",formName:void 0,placeOfServiceId:void 0,vendorLocationId:void 0,clinicalProviderId:void 0,vendorId:void 0,paging:{limit:1e4,skip:0}}),this.data=y,this.router=P,this.route=ee,this.toast=Z,this.formService=te,this.locationService=Ce,this.errors$=this.select(D=>D.errors),this.loading$=this.select(D=>D.loading),this.done$=this.select(D=>D.done),this.item$=this.select(D=>D.item),this.locations$=this.select(D=>D.locations),this.placeOfServices$=this.select(D=>D.placeOfServices||[]),this.vendorLocationId$=this.select(D=>D.vendorLocationId),this.vendorId$=this.select(D=>D.vendorId),this.clinicalProviderId$=this.select(D=>D.clinicalProviderId),this.placeOfServiceId$=this.select(D=>D.placeOfServiceId),this.paging$=this.select(D=>D.paging),this.searchQuery$=this.select(D=>D.searchQuery),this.formName$=this.select(D=>D.formName),this.actionResult$=this.select(this.item$,this.done$,(D,z)=>({item:D,done:z}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.locations$,this.placeOfServices$,(D,z,re,ue,$,G)=>({errors:D,loading:z,item:re,formName:ue,locations:$,placeOfServices:G}),{debounce:!0}),this.input$=this.select(this.paging$,this.placeOfServiceId$,this.searchQuery$,this.vendorLocationId$,this.vendorId$,this.clinicalProviderId$,(D,z,re,ue,$,G)=>({limit:D.limit,skip:D.skip,name:re,placeOfServiceId:z,vendorLocationId:ue,clinicalProviderId:G,vendorId:$,total:D.total})),this.setFormName=this.updater((D,z)=>Object.assign(Object.assign({},D),{formName:z})),this.setPlaceOfServiceId=this.updater((D,z)=>Object.assign(Object.assign({},D),{placeOfServiceId:z})),this.setVendorLocationId=this.updater((D,z)=>Object.assign(Object.assign({},D),{vendorLocationId:z})),this.setVendorId=this.updater((D,z)=>Object.assign(Object.assign({},D),{vendorId:z})),this.setClinicalProviderId=this.updater((D,z)=>Object.assign(Object.assign({},D),{clinicalProviderId:z})),this.filterPlaceOfServices=D=>this.data.userSelectPlaceOfServices({input:{name:D}}).pipe((0,x._b)(z=>{let re=z.data.items;return this.patchState({placeOfServices:re}),re},z=>this.patchState({errors:z.graphQLErrors?z.graphQLErrors:z})),(0,R.U)(z=>z.data.items)),this.addPlaceOfService=this.updater((D,z)=>Object.assign(Object.assign({},D),{placeOfServices:D.placeOfServices.concat(z)})),this.setItem=this.updater((D,z)=>Object.assign(Object.assign({},D),{item:z})),this.addNewLocation=this.updater((D,z)=>Object.assign(Object.assign({},D),{locations:[...D.locations,z]})),this.updateLocation=this.updater((D,z)=>Object.assign(Object.assign({},D),{locations:D.locations.map(re=>re.id===z.id?z:re)})),this.addLocations=this.updater((D,z)=>Object.assign(Object.assign({},D),{locations:D.locations.concat(z)})),this.updateLocations=this.updater((D,z)=>Object.assign(Object.assign({},D),{locations:D.locations.map(re=>z.find($=>$.id===re.id)||re)})),this.setSearchQuery=this.updater((D,z)=>Object.assign(Object.assign({},D),{searchQuery:z})),this.loadLocationEffect=this.effect(D=>D.pipe((0,j.b)(()=>this.patchState({loading:!0})),(0,K.w)(z=>this.data.userLocation({locationId:z}).pipe((0,x._b)(re=>{console.log("location",re.data.item),this.patchState({item:re.data.item,errors:re.errors,loading:!1})},re=>this.patchState({loading:!1,errors:re.graphQLErrors?re.graphQLErrors:re})))))),this.loadLocationsEffect=this.effect(D=>D.pipe((0,j.b)(()=>this.patchState({loading:!0})),(0,se.M)(this.input$),(0,K.w)(([z,re])=>this.data.userLocations({input:re}).pipe((0,x._b)(ue=>this.patchState({paging:{limit:re.limit,skip:re.skip,total:ue.data.count.total},locations:ue.data.items,errors:ue.errors,loading:!1}),ue=>this.patchState({loading:!1,errors:ue.graphQLErrors?ue.graphQLErrors:ue})))))),this.createLocationEffect=this.effect(D=>D.pipe((0,j.b)(()=>this.patchState({loading:!0})),(0,K.w)(z=>this.locationService.createLocation(Object.assign({},z)).pipe((0,x._b)(re=>{this.addNewLocation(re),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:re,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},re=>{re.graphQLErrors?(this.toast.error(re.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:re.graphQLErrors?re.graphQLErrors:re})):(this.toast.error(re.Message),this.formService.setErrors(re.Data))}))))),this.updateLocationEffect=this.effect(D=>D.pipe((0,j.b)(()=>this.patchState({loading:!0})),(0,se.M)(this.item$),(0,K.w)(([z,re])=>this.locationService.updateLocation(z,z.id).pipe((0,x._b)(ue=>{this.updateLocation(ue),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:ue,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},ue=>{ue.graphQLErrors?(this.toast.error(ue.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:ue.graphQLErrors?ue.graphQLErrors:ue})):(this.toast.error(ue.Message),this.formService.setErrors(ue.Data))}))))),this.deleteLocationEffect=this.effect(D=>D.pipe((0,j.b)(()=>this.patchState({loading:!0})),(0,se.M)(this.item$),(0,K.w)(([z,re])=>this.data.userDeleteLocation({locationId:re.id}).pipe((0,x._b)(ue=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:ue.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},ue=>{ue.graphQLErrors?(this.toast.error(ue.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:ue.graphQLErrors?ue.graphQLErrors:ue})):(this.toast.error(ue.Message),this.formService.setErrors(ue.Data))}))))),this.importExcelEffect=this.effect(D=>D.pipe((0,j.b)(()=>this.patchState({loading:!0})),(0,K.w)(z=>this.locationService.importLocations(z).pipe((0,g.K)(re=>{var ue;return this.toast.error(null!==(ue=re.Message)&&void 0!==ue?ue:"Failed to save",{duration:3e3}),W.E}),(0,j.b)(re=>{const ue=JSON.parse(re.created),$=JSON.parse(re.updated),G=JSON.parse(re.failed),q=ue.length+$.length+G.length;this.addLocations(ue),this.updateLocations($),this.toast.success(`${ue.length} created, ${$.length} updated, ${G.length} failed of total ${q}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("locationId")?(this.route.snapshot.paramMap.get("locationId"),this.setFormName("location_edit")):this.setFormName("location_create"),this.route.snapshot.paramMap.has("placeOfServiceId")){var C=this.route.snapshot.paramMap.get("placeOfServiceId");this.setPlaceOfServiceId(C)}if(this.route.snapshot.paramMap.has("vendorLocationId")){var v=this.route.snapshot.paramMap.get("vendorLocationId");this.setVendorLocationId(v)}if(this.route.snapshot.paramMap.has("vendorId")){var T=this.route.snapshot.paramMap.get("vendorId");this.setVendorId(T)}if(this.route.snapshot.paramMap.has("clinicalProviderId")){var O=this.route.snapshot.paramMap.get("clinicalProviderId");this.setClinicalProviderId(O)}}validateImportData(y){return this.vm$.pipe((0,K.w)(P=>this.locationService.validateLocationExcelData(y,P.placeOfServices)))}}return M.\u0275fac=function(y){return new(y||M)(B.LFG(S.q),B.LFG(h.F0),B.LFG(h.gz),B.LFG(L.F),B.LFG(ce.o),B.LFG(Fe))},M.\u0275prov=B.Yz7({token:M,factory:M.\u0275fac}),M})()},62336:(Ee,Ne,Q)=>{Q.d(Ne,{J:()=>ne});var x=Q(24280),W=Q(60515),R=Q(54004),j=Q(18505),K=Q(63900),se=Q(11365),g=Q(70262),B=Q(94650),S=Q(73602),h=Q(30144),L=Q(71873),ce=Q(4523),e=Q(56869),V=Q(88821),E=Q(39646);class ie extends V.T_{constructor(N){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=N}Do(N){return this.businessProvider=N,this.serviceContext=N.serviceContext,this.loggingService=N.loggingService,this.execute(),this.response}}var X=Q(26177);class U extends ie{constructor(N,y){super("ValidateReviewExcelDataAction"),this.valid=!1,this.excelData=N,this.clinicalProviders=y}preValidateAction(){const N=[];this.excelData.map((y,P)=>{N.push(y.name),this.validationContext.addRule(new X.mi(`clinicalProviderName_${P}_is_valid}`,"Clinical Provider Is Not Valid","clinicalProvider.name",y.clinicalProvider,this.clinicalProviders,!0))}),this.validationContext.addRule(new X.cL("nameIsUnique","Name should be unique",N,!0))}performAction(){}finish(){super.finish();const N={};let y=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(P=>{P instanceof X.mi?P.isValid||(N[P.columnName]?N[P.columnName].newNames.includes(P.newName)||N[P.columnName].newNames.push(P.newName):N[P.columnName]={options:P.possibleValueList.map(ee=>ee.name),newNames:[P.newName]}):P instanceof X.cL&&(P.isValid||(y=P.conflicts))})):this.valid=!0,this.response=(0,E.of)({valid:this.valid,excelData:this.excelData,conflictNames:y,unknownNames:N})}}var I=Q(28234);class F extends X.wS{constructor(N,y,P,ee,Z){super(N,y,P,ee,Z,!0)}}class ye extends X.ul{constructor(N,y,P,ee=!1){super(N,y,ee),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=P,this.configureRules()}configureRules(){this.rules.push(new X.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new F("name","The review name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class f extends ie{constructor(N){super("CreateReviewAction"),this.input=N}preValidateAction(){this.validationContext.addRule(new ye("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateReview({input:this.input}).pipe((0,K.w)(N=>(0,I.of)(N.data.created)))}}class Ae extends ie{constructor(N){super("UpdateReviewsAction"),this.reviews=N}preValidateAction(){this.validationContext.addRule(new X.DJ("Input","Input should have values",this.reviews,!0))}performAction(){this.response=this.businessProvider.data.userUpdateReviews({input:{reviews:this.reviews}}).pipe((0,K.w)(N=>(0,E.of)(N.data.updated)))}}class de extends ie{constructor(N,y){super("UpdateReviewAction"),this.review=N,this.reviewId=y}preValidateAction(){this.validationContext.addRule(new X.DJ("Input","Input should have values",this.review,!0)).addRule(new X.xF("Id","Id should be a CUID and not null",this.reviewId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateReview({reviewId:this.reviewId,input:this.review}).pipe((0,K.w)(N=>(0,E.of)(N.data.updated)))}}let Te=(()=>{class M extends V.nH{constructor(y,P,ee){super("NotificationService.ReviewBusinessProviderService",y,ee),this.data=P}createReview(y){const P=new f(y);return P.Do(this),P.response}updateReview(y,P){const ee=new de(y,P);return ee.Do(this),ee.response}importReviews(y){const P=new Ae(y);return P.Do(this),P.response}validateReviewExcelData(y,P){const ee=new U(y,P);return ee.Do(this),ee.response}}return M.\u0275fac=function(y){return new(y||M)(B.LFG(e.ed),B.LFG(S.q),B.LFG(V.oI))},M.\u0275prov=B.Yz7({token:M,factory:M.\u0275fac,providedIn:"root"}),M})(),Fe=(()=>{class M extends V.nH{constructor(y,P,ee){super("ReviewService",ee,y),this.businessProvider=P}createReview(y){const P=Object.fromEntries(Object.entries(y).filter(([ee,Z])=>null!==Z));return this.businessProvider.createReview(P)}updateReview(y,P){return this.businessProvider.updateReview(y,P)}importReviews(y){return this.businessProvider.importReviews(y)}validateReviewExcelData(y,P){return this.businessProvider.validateReviewExcelData(y,P)}}return M.\u0275fac=function(y){return new(y||M)(B.LFG(Te,8),B.LFG(Te),B.LFG(e.ed))},M.\u0275prov=B.Yz7({token:M,factory:M.\u0275fac,providedIn:"root"}),M})(),ne=(()=>{class M extends x.m1{constructor(y,P,ee,Z,te,Ce){if(super({loading:!1,reviews:[],done:!1,searchQuery:"",formName:void 0,clinicalProviderId:void 0,paging:{limit:1e4,skip:0}}),this.data=y,this.router=P,this.route=ee,this.toast=Z,this.formService=te,this.reviewService=Ce,this.errors$=this.select(v=>v.errors),this.loading$=this.select(v=>v.loading),this.done$=this.select(v=>v.done),this.item$=this.select(v=>v.item),this.reviews$=this.select(v=>v.reviews),this.clinicalProviders$=this.select(v=>v.clinicalProviders||[]),this.clinicalProviderId$=this.select(v=>v.clinicalProviderId),this.paging$=this.select(v=>v.paging),this.searchQuery$=this.select(v=>v.searchQuery),this.formName$=this.select(v=>v.formName),this.actionResult$=this.select(this.item$,this.done$,(v,T)=>({item:v,done:T}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.reviews$,this.clinicalProviders$,(v,T,O,D,z,re)=>({errors:v,loading:T,item:O,formName:D,reviews:z,clinicalProviders:re}),{debounce:!0}),this.input$=this.select(this.paging$,this.clinicalProviderId$,this.searchQuery$,(v,T,O)=>({limit:v.limit,skip:v.skip,name:O,clinicalProviderId:T,total:v.total})),this.setFormName=this.updater((v,T)=>Object.assign(Object.assign({},v),{formName:T})),this.setClinicalProviderId=this.updater((v,T)=>Object.assign(Object.assign({},v),{clinicalProviderId:T})),this.filterClinicalProviders=v=>this.data.userSelectClinicalProviders({input:{name:v}}).pipe((0,x._b)(T=>{let O=T.data.items;return this.patchState({clinicalProviders:O}),O},T=>this.patchState({errors:T.graphQLErrors?T.graphQLErrors:T})),(0,R.U)(T=>T.data.items)),this.addClinicalProvider=this.updater((v,T)=>Object.assign(Object.assign({},v),{clinicalProviders:v.clinicalProviders.concat(T)})),this.setItem=this.updater((v,T)=>Object.assign(Object.assign({},v),{item:T})),this.addNewReview=this.updater((v,T)=>{if(T.parentId){let O={};return v.reviews.forEach(D=>{D.id==T.parentId&&(D.childrenReviews.push(D),O=D)}),Object.assign(Object.assign({},v),{reviews:[...v.reviews,O]})}return Object.assign(Object.assign({},v),{reviews:[...v.reviews,T]})}),this.updateReview=this.updater((v,T)=>Object.assign(Object.assign({},v),{reviews:v.reviews.map(O=>O.id===T.id?T:O)})),this.addReviews=this.updater((v,T)=>Object.assign(Object.assign({},v),{reviews:v.reviews.concat(T)})),this.updateReviews=this.updater((v,T)=>Object.assign(Object.assign({},v),{reviews:v.reviews.map(O=>T.find(z=>z.id===O.id)||O)})),this.setSearchQuery=this.updater((v,T)=>Object.assign(Object.assign({},v),{searchQuery:T})),this.loadReviewEffect=this.effect(v=>v.pipe((0,j.b)(()=>this.patchState({loading:!0})),(0,K.w)(T=>this.data.userReview({reviewId:T}).pipe((0,x._b)(O=>{this.patchState({item:O.data.item,errors:O.errors,loading:!1})},O=>this.patchState({loading:!1,errors:O.graphQLErrors?O.graphQLErrors:O})))))),this.loadReviewsEffect=this.effect(v=>v.pipe((0,j.b)(()=>this.patchState({loading:!0})),(0,se.M)(this.input$),(0,K.w)(([T,O])=>this.data.userReviews({input:O}).pipe((0,x._b)(D=>(console.log("userReviews",D.data.items),this.patchState({paging:{limit:O.limit,skip:O.skip,total:D.data.count.total},reviews:D.data.items,errors:D.errors,loading:!1})),D=>this.patchState({loading:!1,errors:D.graphQLErrors?D.graphQLErrors:D})))))),this.createReviewEffect=this.effect(v=>v.pipe((0,j.b)(()=>this.patchState({loading:!0})),(0,K.w)(T=>this.reviewService.createReview(Object.assign({},T)).pipe((0,x._b)(O=>{this.addNewReview(O),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:O,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},O=>{O.graphQLErrors?(this.toast.error(O.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:O.graphQLErrors?O.graphQLErrors:O})):(this.toast.error(O.Message),this.formService.setErrors(O.Data))}))))),this.updateReviewEffect=this.effect(v=>v.pipe((0,j.b)(()=>this.patchState({loading:!0})),(0,se.M)(this.item$),(0,K.w)(([T,O])=>this.reviewService.updateReview(T,T.id).pipe((0,x._b)(D=>{this.updateReview(D),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:D,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},D=>{D.graphQLErrors?(this.toast.error(D.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:D.graphQLErrors?D.graphQLErrors:D})):(this.toast.error(D.Message),this.formService.setErrors(D.Data))}))))),this.deleteReviewEffect=this.effect(v=>v.pipe((0,j.b)(()=>this.patchState({loading:!0})),(0,se.M)(this.item$),(0,K.w)(([T,O])=>this.data.userDeleteReview({reviewId:O.id}).pipe((0,x._b)(D=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:D.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},D=>{D.graphQLErrors?(this.toast.error(D.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:D.graphQLErrors?D.graphQLErrors:D})):(this.toast.error(D.Message),this.formService.setErrors(D.Data))}))))),this.importExcelEffect=this.effect(v=>v.pipe((0,j.b)(()=>this.patchState({loading:!0})),(0,K.w)(T=>this.reviewService.importReviews(T).pipe((0,g.K)(O=>{var D;return this.toast.error(null!==(D=O.Message)&&void 0!==D?D:"Failed to save",{duration:3e3}),W.E}),(0,j.b)(O=>{const D=JSON.parse(O.created),z=JSON.parse(O.updated),re=JSON.parse(O.failed),ue=D.length+z.length+re.length;this.addReviews(D),this.updateReviews(z),this.toast.success(`${D.length} created, ${z.length} updated, ${re.length} failed of total ${ue}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("reviewId")?(this.route.snapshot.paramMap.get("reviewId"),this.setFormName("review_edit")):this.setFormName("review_create"),this.route.snapshot.paramMap.has("clinicalProviderId")){var C=this.route.snapshot.paramMap.get("clinicalProviderId");this.setClinicalProviderId(C)}}validateImportData(y){return this.vm$.pipe((0,K.w)(P=>this.reviewService.validateReviewExcelData(y,P.clinicalProviders)))}}return M.\u0275fac=function(y){return new(y||M)(B.LFG(S.q),B.LFG(h.F0),B.LFG(h.gz),B.LFG(L.F),B.LFG(ce.o),B.LFG(Fe))},M.\u0275prov=B.Yz7({token:M,factory:M.\u0275fac}),M})()},94214:(Ee,Ne,Q)=>{Q.d(Ne,{m:()=>Fe});var x=Q(24280),W=Q(60515),R=Q(18505),j=Q(63900),K=Q(11365),se=Q(70262),g=Q(94650),B=Q(73602),S=Q(30144),h=Q(71873),L=Q(4523),ce=Q(56869),e=Q(88821),V=Q(39646);class E extends e.T_{constructor(M){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=M}Do(M){return this.businessProvider=M,this.serviceContext=M.serviceContext,this.loggingService=M.loggingService,this.execute(),this.response}}var ie=Q(26177);class X extends E{constructor(M){super("ValidateServiceExcelDataAction"),this.valid=!1,this.excelData=M}preValidateAction(){const M=[];this.excelData.map((N,y)=>{M.push(N.name)}),this.validationContext.addRule(new ie.cL("nameIsUnique","Name should be unique",M,!0))}performAction(){}finish(){super.finish();const M={};let N=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(y=>{y instanceof ie.mi?y.isValid||(M[y.columnName]?M[y.columnName].newNames.includes(y.newName)||M[y.columnName].newNames.push(y.newName):M[y.columnName]={options:y.possibleValueList.map(P=>P.name),newNames:[y.newName]}):y instanceof ie.cL&&(y.isValid||(N=y.conflicts))})):this.valid=!0,this.response=(0,V.of)({valid:this.valid,excelData:this.excelData,conflictNames:N,unknownNames:M})}}var U=Q(28234);class I extends ie.wS{constructor(M,N,y,P,ee){super(M,N,y,P,ee,!0)}}class F extends ie.ul{constructor(M,N,y,P=!1){super(M,N,P),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=y,this.configureRules()}configureRules(){this.rules.push(new ie.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new I("name","The service name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class ye extends E{constructor(M){super("CreateServiceAction"),this.input=M}preValidateAction(){this.validationContext.addRule(new F("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateService({input:this.input}).pipe((0,j.w)(M=>(0,U.of)(M.data.created)))}}class f extends E{constructor(M){super("UpdateServicesAction"),this.services=M}preValidateAction(){this.validationContext.addRule(new ie.DJ("Input","Input should have values",this.services,!0))}performAction(){this.response=this.businessProvider.data.userUpdateServices({input:{services:this.services}}).pipe((0,j.w)(M=>(0,V.of)(M.data.updated)))}}class Ae extends E{constructor(M,N){super("UpdateServiceAction"),this.service=M,this.serviceId=N}preValidateAction(){this.validationContext.addRule(new ie.DJ("Input","Input should have values",this.service,!0)).addRule(new ie.xF("Id","Id should be a CUID and not null",this.serviceId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateService({serviceId:this.serviceId,input:this.service}).pipe((0,j.w)(M=>(0,V.of)(M.data.updated)))}}let de=(()=>{class ne extends e.nH{constructor(N,y,P){super("NotificationService.ServiceBusinessProviderService",N,P),this.data=y}createService(N){const y=new ye(N);return y.Do(this),y.response}updateService(N,y){const P=new Ae(N,y);return P.Do(this),P.response}importServices(N){const y=new f(N);return y.Do(this),y.response}validateServiceExcelData(N){const y=new X(N);return y.Do(this),y.response}}return ne.\u0275fac=function(N){return new(N||ne)(g.LFG(ce.ed),g.LFG(B.q),g.LFG(e.oI))},ne.\u0275prov=g.Yz7({token:ne,factory:ne.\u0275fac,providedIn:"root"}),ne})(),Te=(()=>{class ne extends e.nH{constructor(N,y,P){super("ServiceService",P,N),this.businessProvider=y}createService(N){const y=Object.fromEntries(Object.entries(N).filter(([P,ee])=>null!==ee));return this.businessProvider.createService(y)}updateService(N,y){return this.businessProvider.updateService(N,y)}importServices(N){return this.businessProvider.importServices(N)}validateServiceExcelData(N){return this.businessProvider.validateServiceExcelData(N)}}return ne.\u0275fac=function(N){return new(N||ne)(g.LFG(de,8),g.LFG(de),g.LFG(ce.ed))},ne.\u0275prov=g.Yz7({token:ne,factory:ne.\u0275fac,providedIn:"root"}),ne})(),Fe=(()=>{class ne extends x.m1{constructor(N,y,P,ee,Z,te){super({loading:!1,services:[],done:!1,searchQuery:"",formName:void 0,paging:{limit:1e4,skip:0}}),this.data=N,this.router=y,this.route=P,this.toast=ee,this.formService=Z,this.serviceService=te,this.errors$=this.select(b=>b.errors),this.loading$=this.select(b=>b.loading),this.done$=this.select(b=>b.done),this.item$=this.select(b=>b.item),this.services$=this.select(b=>b.services),this.paging$=this.select(b=>b.paging),this.searchQuery$=this.select(b=>b.searchQuery),this.formName$=this.select(b=>b.formName),this.actionResult$=this.select(this.item$,this.done$,(b,C)=>({item:b,done:C}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.services$,(b,C,v,T,O)=>({errors:b,loading:C,item:v,formName:T,services:O}),{debounce:!0}),this.input$=this.select(this.paging$,this.searchQuery$,(b,C)=>({limit:b.limit,skip:b.skip,name:C,total:b.total})),this.setFormName=this.updater((b,C)=>Object.assign(Object.assign({},b),{formName:C})),this.setItem=this.updater((b,C)=>Object.assign(Object.assign({},b),{item:C})),this.addNewService=this.updater((b,C)=>Object.assign(Object.assign({},b),{services:[...b.services,C]})),this.updateService=this.updater((b,C)=>Object.assign(Object.assign({},b),{services:b.services.map(v=>v.id===C.id?C:v)})),this.addServices=this.updater((b,C)=>Object.assign(Object.assign({},b),{services:b.services.concat(C)})),this.updateServices=this.updater((b,C)=>Object.assign(Object.assign({},b),{services:b.services.map(v=>C.find(O=>O.id===v.id)||v)})),this.setSearchQuery=this.updater((b,C)=>Object.assign(Object.assign({},b),{searchQuery:C})),this.loadServiceEffect=this.effect(b=>b.pipe((0,R.b)(()=>this.patchState({loading:!0})),(0,j.w)(C=>this.data.userService({serviceId:C}).pipe((0,x._b)(v=>{this.patchState({item:v.data.item,errors:v.errors,loading:!1})},v=>this.patchState({loading:!1,errors:v.graphQLErrors?v.graphQLErrors:v})))))),this.loadServicesEffect=this.effect(b=>b.pipe((0,R.b)(()=>this.patchState({loading:!0})),(0,K.M)(this.input$),(0,j.w)(([C,v])=>this.data.userServices({input:v}).pipe((0,x._b)(T=>this.patchState({paging:{limit:v.limit,skip:v.skip,total:T.data.count.total},services:T.data.items,errors:T.errors,loading:!1}),T=>this.patchState({loading:!1,errors:T.graphQLErrors?T.graphQLErrors:T})))))),this.createServiceEffect=this.effect(b=>b.pipe((0,R.b)(()=>this.patchState({loading:!0})),(0,j.w)(C=>this.serviceService.createService(Object.assign({},C)).pipe((0,x._b)(v=>{this.addNewService(v),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:v,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},v=>{v.graphQLErrors?(this.toast.error(v.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:v.graphQLErrors?v.graphQLErrors:v})):(this.toast.error(v.Message),this.formService.setErrors(v.Data))}))))),this.updateServiceEffect=this.effect(b=>b.pipe((0,R.b)(()=>this.patchState({loading:!0})),(0,K.M)(this.item$),(0,j.w)(([C,v])=>this.serviceService.updateService(C,C.id).pipe((0,x._b)(T=>{this.updateService(T),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:T,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},T=>{T.graphQLErrors?(this.toast.error(T.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:T.graphQLErrors?T.graphQLErrors:T})):(this.toast.error(T.Message),this.formService.setErrors(T.Data))}))))),this.deleteServiceEffect=this.effect(b=>b.pipe((0,R.b)(()=>this.patchState({loading:!0})),(0,K.M)(this.item$),(0,j.w)(([C,v])=>this.data.userDeleteService({serviceId:v.id}).pipe((0,x._b)(T=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:T.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},T=>{T.graphQLErrors?(this.toast.error(T.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:T.graphQLErrors?T.graphQLErrors:T})):(this.toast.error(T.Message),this.formService.setErrors(T.Data))}))))),this.importExcelEffect=this.effect(b=>b.pipe((0,R.b)(()=>this.patchState({loading:!0})),(0,j.w)(C=>this.serviceService.importServices(C).pipe((0,se.K)(v=>{var T;return this.toast.error(null!==(T=v.Message)&&void 0!==T?T:"Failed to save",{duration:3e3}),W.E}),(0,R.b)(v=>{const T=JSON.parse(v.created),O=JSON.parse(v.updated),D=JSON.parse(v.failed),z=T.length+O.length+D.length;this.addServices(T),this.updateServices(O),this.toast.success(`${T.length} created, ${O.length} updated, ${D.length} failed of total ${z}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("serviceId")?(this.route.snapshot.paramMap.get("serviceId"),this.setFormName("service_edit")):this.setFormName("service_create")}validateImportData(N){return this.vm$.pipe((0,j.w)(y=>this.serviceService.validateServiceExcelData(N)))}}return ne.\u0275fac=function(N){return new(N||ne)(g.LFG(B.q),g.LFG(S.F0),g.LFG(S.gz),g.LFG(h.F),g.LFG(L.o),g.LFG(Te))},ne.\u0275prov=g.Yz7({token:ne,factory:ne.\u0275fac}),ne})()},53783:(Ee,Ne,Q)=>{Q.d(Ne,{T:()=>Fe});var x=Q(24280),W=Q(60515),R=Q(18505),j=Q(63900),K=Q(11365),se=Q(70262),g=Q(94650),B=Q(73602),S=Q(30144),h=Q(71873),L=Q(4523),ce=Q(56869),e=Q(88821),V=Q(39646);class E extends e.T_{constructor(M){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=M}Do(M){return this.businessProvider=M,this.serviceContext=M.serviceContext,this.loggingService=M.loggingService,this.execute(),this.response}}var ie=Q(26177);class X extends E{constructor(M){super("ValidateSpecialtyExcelDataAction"),this.valid=!1,this.excelData=M}preValidateAction(){const M=[];this.excelData.map((N,y)=>{M.push(N.name)}),this.validationContext.addRule(new ie.cL("nameIsUnique","Name should be unique",M,!0))}performAction(){}finish(){super.finish();const M={};let N=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(y=>{y instanceof ie.mi?y.isValid||(M[y.columnName]?M[y.columnName].newNames.includes(y.newName)||M[y.columnName].newNames.push(y.newName):M[y.columnName]={options:y.possibleValueList.map(P=>P.name),newNames:[y.newName]}):y instanceof ie.cL&&(y.isValid||(N=y.conflicts))})):this.valid=!0,this.response=(0,V.of)({valid:this.valid,excelData:this.excelData,conflictNames:N,unknownNames:M})}}var U=Q(28234);class I extends ie.wS{constructor(M,N,y,P,ee){super(M,N,y,P,ee,!0)}}class F extends ie.ul{constructor(M,N,y,P=!1){super(M,N,P),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=y,this.configureRules()}configureRules(){this.rules.push(new ie.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new I("name","The specialty name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class ye extends E{constructor(M){super("CreateSpecialtyAction"),this.input=M}preValidateAction(){this.validationContext.addRule(new F("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateSpecialty({input:this.input}).pipe((0,j.w)(M=>(0,U.of)(M.data.created)))}}class f extends E{constructor(M){super("UpdateSpecialtiesAction"),this.specialties=M}preValidateAction(){this.validationContext.addRule(new ie.DJ("Input","Input should have values",this.specialties,!0))}performAction(){this.response=this.businessProvider.data.userUpdateSpecialties({input:{specialties:this.specialties}}).pipe((0,j.w)(M=>(0,V.of)(M.data.updated)))}}class Ae extends E{constructor(M,N){super("UpdateSpecialtyAction"),this.specialty=M,this.specialtyId=N}preValidateAction(){this.validationContext.addRule(new ie.DJ("Input","Input should have values",this.specialty,!0)).addRule(new ie.xF("Id","Id should be a CUID and not null",this.specialtyId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateSpecialty({specialtyId:this.specialtyId,input:this.specialty}).pipe((0,j.w)(M=>(0,V.of)(M.data.updated)))}}let de=(()=>{class ne extends e.nH{constructor(N,y,P){super("NotificationService.SpecialtyBusinessProviderService",N,P),this.data=y}createSpecialty(N){const y=new ye(N);return y.Do(this),y.response}updateSpecialty(N,y){const P=new Ae(N,y);return P.Do(this),P.response}importSpecialties(N){const y=new f(N);return y.Do(this),y.response}validateSpecialtyExcelData(N){const y=new X(N);return y.Do(this),y.response}}return ne.\u0275fac=function(N){return new(N||ne)(g.LFG(ce.ed),g.LFG(B.q),g.LFG(e.oI))},ne.\u0275prov=g.Yz7({token:ne,factory:ne.\u0275fac,providedIn:"root"}),ne})(),Te=(()=>{class ne extends e.nH{constructor(N,y,P){super("SpecialtyService",P,N),this.businessProvider=y}createSpecialty(N){const y=Object.fromEntries(Object.entries(N).filter(([P,ee])=>null!==ee));return this.businessProvider.createSpecialty(y)}updateSpecialty(N,y){return this.businessProvider.updateSpecialty(N,y)}importSpecialties(N){return this.businessProvider.importSpecialties(N)}validateSpecialtyExcelData(N){return this.businessProvider.validateSpecialtyExcelData(N)}}return ne.\u0275fac=function(N){return new(N||ne)(g.LFG(de,8),g.LFG(de),g.LFG(ce.ed))},ne.\u0275prov=g.Yz7({token:ne,factory:ne.\u0275fac,providedIn:"root"}),ne})(),Fe=(()=>{class ne extends x.m1{constructor(N,y,P,ee,Z,te){super({loading:!1,specialties:[],done:!1,searchQuery:"",formName:void 0,paging:{limit:1e4,skip:0}}),this.data=N,this.router=y,this.route=P,this.toast=ee,this.formService=Z,this.specialtyService=te,this.errors$=this.select(b=>b.errors),this.loading$=this.select(b=>b.loading),this.done$=this.select(b=>b.done),this.item$=this.select(b=>b.item),this.specialties$=this.select(b=>b.specialties),this.paging$=this.select(b=>b.paging),this.searchQuery$=this.select(b=>b.searchQuery),this.formName$=this.select(b=>b.formName),this.actionResult$=this.select(this.item$,this.done$,(b,C)=>({item:b,done:C}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.specialties$,(b,C,v,T,O)=>({errors:b,loading:C,item:v,formName:T,specialties:O}),{debounce:!0}),this.input$=this.select(this.paging$,this.searchQuery$,(b,C)=>({limit:b.limit,skip:b.skip,name:C,total:b.total})),this.setFormName=this.updater((b,C)=>Object.assign(Object.assign({},b),{formName:C})),this.setItem=this.updater((b,C)=>Object.assign(Object.assign({},b),{item:C})),this.addNewSpecialty=this.updater((b,C)=>Object.assign(Object.assign({},b),{specialties:[...b.specialties,C]})),this.updateSpecialty=this.updater((b,C)=>Object.assign(Object.assign({},b),{specialties:b.specialties.map(v=>v.id===C.id?C:v)})),this.addSpecialties=this.updater((b,C)=>Object.assign(Object.assign({},b),{specialties:b.specialties.concat(C)})),this.updateSpecialties=this.updater((b,C)=>Object.assign(Object.assign({},b),{specialties:b.specialties.map(v=>C.find(O=>O.id===v.id)||v)})),this.setSearchQuery=this.updater((b,C)=>Object.assign(Object.assign({},b),{searchQuery:C})),this.loadSpecialtyEffect=this.effect(b=>b.pipe((0,R.b)(()=>this.patchState({loading:!0})),(0,j.w)(C=>this.data.userSpecialty({specialtyId:C}).pipe((0,x._b)(v=>{this.patchState({item:v.data.item,errors:v.errors,loading:!1})},v=>this.patchState({loading:!1,errors:v.graphQLErrors?v.graphQLErrors:v})))))),this.loadSpecialtiesEffect=this.effect(b=>b.pipe((0,R.b)(()=>this.patchState({loading:!0})),(0,K.M)(this.input$),(0,j.w)(([C,v])=>this.data.userSpecialties({input:v}).pipe((0,x._b)(T=>this.patchState({paging:{limit:v.limit,skip:v.skip,total:T.data.count.total},specialties:T.data.items,errors:T.errors,loading:!1}),T=>this.patchState({loading:!1,errors:T.graphQLErrors?T.graphQLErrors:T})))))),this.createSpecialtyEffect=this.effect(b=>b.pipe((0,R.b)(()=>this.patchState({loading:!0})),(0,j.w)(C=>this.specialtyService.createSpecialty(Object.assign({},C)).pipe((0,x._b)(v=>{this.addNewSpecialty(v),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:v,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},v=>{v.graphQLErrors?(this.toast.error(v.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:v.graphQLErrors?v.graphQLErrors:v})):(this.toast.error(v.Message),this.formService.setErrors(v.Data))}))))),this.updateSpecialtyEffect=this.effect(b=>b.pipe((0,R.b)(()=>this.patchState({loading:!0})),(0,K.M)(this.item$),(0,j.w)(([C,v])=>this.specialtyService.updateSpecialty(C,C.id).pipe((0,x._b)(T=>{this.updateSpecialty(T),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:T,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},T=>{T.graphQLErrors?(this.toast.error(T.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:T.graphQLErrors?T.graphQLErrors:T})):(this.toast.error(T.Message),this.formService.setErrors(T.Data))}))))),this.deleteSpecialtyEffect=this.effect(b=>b.pipe((0,R.b)(()=>this.patchState({loading:!0})),(0,K.M)(this.item$),(0,j.w)(([C,v])=>this.data.userDeleteSpecialty({specialtyId:v.id}).pipe((0,x._b)(T=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:T.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},T=>{T.graphQLErrors?(this.toast.error(T.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:T.graphQLErrors?T.graphQLErrors:T})):(this.toast.error(T.Message),this.formService.setErrors(T.Data))}))))),this.importExcelEffect=this.effect(b=>b.pipe((0,R.b)(()=>this.patchState({loading:!0})),(0,j.w)(C=>this.specialtyService.importSpecialties(C).pipe((0,se.K)(v=>{var T;return this.toast.error(null!==(T=v.Message)&&void 0!==T?T:"Failed to save",{duration:3e3}),W.E}),(0,R.b)(v=>{const T=JSON.parse(v.created),O=JSON.parse(v.updated),D=JSON.parse(v.failed),z=T.length+O.length+D.length;this.addSpecialties(T),this.updateSpecialties(O),this.toast.success(`${T.length} created, ${O.length} updated, ${D.length} failed of total ${z}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("specialtyId")?(this.route.snapshot.paramMap.get("specialtyId"),this.setFormName("specialty_edit")):this.setFormName("specialty_create")}validateImportData(N){return this.vm$.pipe((0,j.w)(y=>this.specialtyService.validateSpecialtyExcelData(N)))}}return ne.\u0275fac=function(N){return new(N||ne)(g.LFG(B.q),g.LFG(S.F0),g.LFG(S.gz),g.LFG(h.F),g.LFG(L.o),g.LFG(Te))},ne.\u0275prov=g.Yz7({token:ne,factory:ne.\u0275fac}),ne})()},91728:(Ee,Ne,Q)=>{Q.d(Ne,{o:()=>FX});var x=Q(36895),W=Q(24006),R=Q(49821),j=Q(5084),K=Q(41746),se=Q(55274),g=Q(24280),B=Q(60515),S=Q(18505),h=Q(63900),L=Q(11365),ce=Q(70262),e=Q(94650),V=Q(73602),E=Q(30144),ie=Q(71873),X=Q(4523),U=Q(56869),I=Q(88821),F=Q(39646);class ye extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}var f=Q(26177);class Ae extends ye{constructor(o){super("ValidateAccidentTypeExcelDataAction"),this.valid=!1,this.excelData=o}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name)}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}var de=Q(28234);class Te extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class Fe extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new Te("name","The accidenttype name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class ne extends ye{constructor(o){super("CreateAccidentTypeAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new Fe("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateAccidentType({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class M extends ye{constructor(o){super("UpdateAccidentTypesAction"),this.accidentTypes=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.accidentTypes,!0))}performAction(){this.response=this.businessProvider.data.userUpdateAccidentTypes({input:{accidentTypes:this.accidentTypes}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class N extends ye{constructor(o,t){super("UpdateAccidentTypeAction"),this.accidentType=o,this.accidentTypeId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.accidentType,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.accidentTypeId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateAccidentType({accidentTypeId:this.accidentTypeId,input:this.accidentType}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let y=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.AccidentTypeBusinessProviderService",t,a),this.data=i}createAccidentType(t){const i=new ne(t);return i.Do(this),i.response}updateAccidentType(t,i){const a=new N(t,i);return a.Do(this),a.response}importAccidentTypes(t){const i=new M(t);return i.Do(this),i.response}validateAccidentTypeExcelData(t){const i=new Ae(t);return i.Do(this),i.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),P=(()=>{class s extends I.nH{constructor(t,i,a){super("AccidentTypeService",a,t),this.businessProvider=i}createAccidentType(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createAccidentType(i)}updateAccidentType(t,i){return this.businessProvider.updateAccidentType(t,i)}importAccidentTypes(t){return this.businessProvider.importAccidentTypes(t)}validateAccidentTypeExcelData(t){return this.businessProvider.validateAccidentTypeExcelData(t)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(y,8),e.LFG(y),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),ee=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){super({loading:!1,accidentTypes:[],done:!1,searchQuery:"",formName:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.accidentTypeService=H,this.errors$=this.select(c=>c.errors),this.loading$=this.select(c=>c.loading),this.done$=this.select(c=>c.done),this.item$=this.select(c=>c.item),this.accidentTypes$=this.select(c=>c.accidentTypes),this.paging$=this.select(c=>c.paging),this.searchQuery$=this.select(c=>c.searchQuery),this.formName$=this.select(c=>c.formName),this.actionResult$=this.select(this.item$,this.done$,(c,d)=>({item:c,done:d}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.accidentTypes$,(c,d,n,r,m)=>({errors:c,loading:d,item:n,formName:r,accidentTypes:m}),{debounce:!0}),this.input$=this.select(this.paging$,this.searchQuery$,(c,d)=>({limit:c.limit,skip:c.skip,name:d,total:c.total})),this.setFormName=this.updater((c,d)=>Object.assign(Object.assign({},c),{formName:d})),this.setItem=this.updater((c,d)=>Object.assign(Object.assign({},c),{item:d})),this.addNewAccidentType=this.updater((c,d)=>Object.assign(Object.assign({},c),{accidentTypes:[...c.accidentTypes,d]})),this.updateAccidentType=this.updater((c,d)=>Object.assign(Object.assign({},c),{accidentTypes:c.accidentTypes.map(n=>n.id===d.id?d:n)})),this.addAccidentTypes=this.updater((c,d)=>Object.assign(Object.assign({},c),{accidentTypes:c.accidentTypes.concat(d)})),this.updateAccidentTypes=this.updater((c,d)=>Object.assign(Object.assign({},c),{accidentTypes:c.accidentTypes.map(n=>d.find(m=>m.id===n.id)||n)})),this.setSearchQuery=this.updater((c,d)=>Object.assign(Object.assign({},c),{searchQuery:d})),this.loadAccidentTypeEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.data.userAccidentType({accidentTypeId:d}).pipe((0,g._b)(n=>{this.patchState({item:n.data.item,errors:n.errors,loading:!1})},n=>this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})))))),this.loadAccidentTypesEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([d,n])=>this.data.userAccidentTypes({input:n}).pipe((0,g._b)(r=>this.patchState({paging:{limit:n.limit,skip:n.skip,total:r.data.count.total},accidentTypes:r.data.items,errors:r.errors,loading:!1}),r=>this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})))))),this.createAccidentTypeEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.accidentTypeService.createAccidentType(Object.assign({},d)).pipe((0,g._b)(n=>{this.addNewAccidentType(n),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:n,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},n=>{n.graphQLErrors?(this.toast.error(n.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})):(this.toast.error(n.Message),this.formService.setErrors(n.Data))}))))),this.updateAccidentTypeEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.accidentTypeService.updateAccidentType(d,d.id).pipe((0,g._b)(r=>{this.updateAccidentType(r),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:r,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.deleteAccidentTypeEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.data.userDeleteAccidentType({accidentTypeId:n.id}).pipe((0,g._b)(r=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:r.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.importExcelEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.accidentTypeService.importAccidentTypes(d).pipe((0,ce.K)(n=>{var r;return this.toast.error(null!==(r=n.Message)&&void 0!==r?r:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(n=>{const r=JSON.parse(n.created),m=JSON.parse(n.updated),p=JSON.parse(n.failed),_=r.length+m.length+p.length;this.addAccidentTypes(r),this.updateAccidentTypes(m),this.toast.success(`${r.length} created, ${m.length} updated, ${p.length} failed of total ${_}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("accidentTypeId")?(this.route.snapshot.paramMap.get("accidentTypeId"),this.setFormName("accidentType_edit")):this.setFormName("accidentType_create")}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.accidentTypeService.validateAccidentTypeExcelData(t)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(P))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();var Z=Q(15909),te=Q(92518);function Ce(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.accidentType)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let b=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"accidentType_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.accidentType=i.item})):t.formName&&t.formName.currentValue&&"accidentType_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadAccidentTypeEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.accidentType=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(ee),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-accident-type-form"]],inputs:{accidentType:"accidentType",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,Ce,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})();var C=Q(51645),v=Q(26244);let T=(()=>{class s{constructor(){this.autoHeight=!1,this.accidentTypes=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[,{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-accident-type-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",accidentTypes:"accidentTypes"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.accidentTypes)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function O(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-accident-type-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","accidentType_edit")("formControl",t.formControl)("accidentType",t.accidentType)}}const D=function(){return{}};function z(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-accident-type-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","accidentType_create")("formControl",t.formControl)("accidentType",e.DdM(3,D))}}function re(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-accident-type-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("accidentTypes",o.data.items)}let ue=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadAccidentTypesEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.accidentTypes$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(ee))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","accidentType","send","close"],[1,"w-full","h-full","bg-white",3,"accidentTypes","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,O,2,3,"ng-template",null,1,e.W1O),e.YNc(3,z,1,4,"ng-template",null,2,e.W1O),e.YNc(5,re,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,b,T],encapsulation:2}),s})();var $=Q(10948),G=Q(19859),q=Q(31276),k=Q(27503),be=Q(927),Pe=Q(4859);let me=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[x.ez,Pe.ot,W.UX,$.P,be.W]}),s})();var we=Q(82722),Ie=Q(77579);let pe=(()=>{class s extends R.fS{constructor(){super(),this._unsubscribeAll=new Ie.x,this.data=[],this.onSave=this.onSave.bind(this)}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}ngOnInit(){this.formControl.value&&(this.data=this.formControl.value),this.formControl.valueChanges.pipe((0,we.R)(this._unsubscribeAll)).subscribe(t=>{this.data=t})}onSave(t){const i=this.data.findIndex(a=>a.id===t.id);-1!==i?(this.data[i]=t,this.data=this.data.map((a,l)=>l===i?t:a)):this.data=[...this.data]}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-formly-field-base-grid"]],features:[e.qOj],decls:0,vars:0,template:function(t,i){},encapsulation:2}),s})();var $e=Q(17489),Le=Q(12282),Re=Q(57148);const je=["editTpl"],Je=["createTpl"];function Ue(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"button",9),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.onCreate())}),e._uU(1,"+ Add"),e.qZA()}}function xe(s,o){1&s&&e.GkF(0)}function We(s,o){1&s&&e.GkF(0)}const De=function(s,o,t){return{value:s,ref:o,onSave:t}},Me=function(s){return{data:s}};function Qe(s,o){if(1&s&&(e.TgZ(0,"div",10),e.YNc(1,We,1,0,"ng-container",6),e.qZA()),2&s){const t=o.$implicit,i=e.oxw();e.xp6(1),e.Q6J("ngTemplateOutlet",i.editTemplate)("ngTemplateOutletContext",e.VKq(6,Me,e.kEZ(2,De,t.data,t,i.onSave)))}}function ys(s,o){1&s&&e.GkF(0)}const ep=function(){return{}};function tp(s,o){if(1&s&&(e.TgZ(0,"div",10),e.YNc(1,ys,1,0,"ng-container",6),e.qZA()),2&s){const t=o.$implicit,i=e.oxw();e.xp6(1),e.Q6J("ngTemplateOutlet",i.createTemplate)("ngTemplateOutletContext",e.VKq(7,Me,e.kEZ(3,De,e.DdM(2,ep),t,i.onSave)))}}const ip=function(s,o){return{items:s,itemDidSelect:o}},sp=function(s){return{data:s}};let fe=(()=>{class s{constructor(t,i){this.configService=t,this.dialogService=i,this.data=[],this.title="Title",this.readOnly=!1,this.saveButtonDidClick=new e.vpe,this.itemDidSelect=this.itemDidSelect.bind(this)}itemDidSelect(t){this.readOnly||this.dialogService.open(this.editTpl,{data:Object.assign({},t),width:"auto",minHeight:"200px"})}onCreate(){console.log("onCreate"),this.dialogService.open(this.createTpl,{data:null,width:"auto",minHeight:"200px"})}getCloneValue(t){return(0,$e.cloneDeep)(t)}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Le.m),e.Y36(Re.xA))},s.\u0275cmp=e.Xpm({type:s,selectors:[["web-ui-grid"]],viewQuery:function(t,i){if(1&t&&(e.Gf(je,5),e.Gf(Je,5)),2&t){let a;e.iGM(a=e.CRH())&&(i.editTpl=a.first),e.iGM(a=e.CRH())&&(i.createTpl=a.first)}},inputs:{data:"data",title:"title",onSave:"onSave",listTemplate:"listTemplate",editTemplate:"editTemplate",createTemplate:"createTemplate",readOnly:"readOnly"},outputs:{saveButtonDidClick:"saveButtonDidClick"},decls:12,vars:9,consts:[[1,"p-2","flex","flex-col"],[1,"flex","flex-row","items-center","justify-between","gap-2","p-2","w-full"],[1,"text-lg","font-bold","text-gray-800","dark:text-gray-50"],["mat-flat-button","","type","button","class","bg-primary text-white",3,"click",4,"ngIf"],[1,"flex","flex-col","gap-2","h-full","bg-grey-light"],[1,"w-full","h-auto"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],["editTpl",""],["createTpl",""],["mat-flat-button","","type","button",1,"bg-primary","text-white",3,"click"],[1,"p-5","bg-gray-50","overflow-auto","dark:bg-gray-800"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"h3",2),e._uU(3),e.qZA(),e.YNc(4,Ue,2,0,"button",3),e.qZA(),e.TgZ(5,"div",4)(6,"div",5),e.YNc(7,xe,1,0,"ng-container",6),e.qZA()()(),e.YNc(8,Qe,2,8,"ng-template",null,7,e.W1O),e.YNc(10,tp,2,9,"ng-template",null,8,e.W1O)),2&t&&(e.xp6(3),e.Oqu(i.title),e.xp6(1),e.Q6J("ngIf",!i.readOnly),e.xp6(3),e.Q6J("ngTemplateOutlet",i.listTemplate)("ngTemplateOutletContext",e.VKq(7,sp,e.WLB(4,ip,i.data,i.itemDidSelect))))},dependencies:[x.O5,x.tP,Pe.lW]}),s})();function op(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-accident-type-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","accidentType_edit")("accidentType",t.value)}}const ap=function(){return{}};function rp(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-accident-type-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","accidentType_create")("accidentType",e.DdM(2,ap))}function np(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-accident-type-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("accidentTypes",t.items)}}let lp=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","accidentType","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","accidentTypes","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,op,1,2,"ng-template",null,1,e.W1O),e.YNc(3,rp,1,3,"ng-template",null,2,e.W1O),e.YNc(5,np,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,b,T],encapsulation:2}),s})(),cp=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[ee],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"accident-type-select",component:ue,wrappers:["form-field"]},{name:"accident-type-grid",component:lp}]})]}),s})(),dp=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[cp]}),s})();class Xe extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class up extends Xe{constructor(o){super("ValidateAccountStatusExcelDataAction"),this.valid=!1,this.excelData=o}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name)}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class mp extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class pp extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new mp("name","The accountstatus name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class hp extends Xe{constructor(o){super("CreateAccountStatusAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new pp("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateAccountStatus({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class fp extends Xe{constructor(o){super("UpdateAccountStatusesAction"),this.accountStatuses=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.accountStatuses,!0))}performAction(){this.response=this.businessProvider.data.userUpdateAccountStatuses({input:{accountStatuses:this.accountStatuses}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class _p extends Xe{constructor(o,t){super("UpdateAccountStatusAction"),this.accountStatus=o,this.accountStatusId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.accountStatus,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.accountStatusId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateAccountStatus({accountStatusId:this.accountStatusId,input:this.accountStatus}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let Va=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.AccountStatusBusinessProviderService",t,a),this.data=i}createAccountStatus(t){const i=new hp(t);return i.Do(this),i.response}updateAccountStatus(t,i){const a=new _p(t,i);return a.Do(this),a.response}importAccountStatuses(t){const i=new fp(t);return i.Do(this),i.response}validateAccountStatusExcelData(t){const i=new up(t);return i.Do(this),i.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),gp=(()=>{class s extends I.nH{constructor(t,i,a){super("AccountStatusService",a,t),this.businessProvider=i}createAccountStatus(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createAccountStatus(i)}updateAccountStatus(t,i){return this.businessProvider.updateAccountStatus(t,i)}importAccountStatuses(t){return this.businessProvider.importAccountStatuses(t)}validateAccountStatusExcelData(t){return this.businessProvider.validateAccountStatusExcelData(t)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(Va,8),e.LFG(Va),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),ws=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){super({loading:!1,accountStatuses:[],done:!1,searchQuery:"",formName:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.accountStatusService=H,this.errors$=this.select(c=>c.errors),this.loading$=this.select(c=>c.loading),this.done$=this.select(c=>c.done),this.item$=this.select(c=>c.item),this.accountStatuses$=this.select(c=>c.accountStatuses),this.paging$=this.select(c=>c.paging),this.searchQuery$=this.select(c=>c.searchQuery),this.formName$=this.select(c=>c.formName),this.actionResult$=this.select(this.item$,this.done$,(c,d)=>({item:c,done:d}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.accountStatuses$,(c,d,n,r,m)=>({errors:c,loading:d,item:n,formName:r,accountStatuses:m}),{debounce:!0}),this.input$=this.select(this.paging$,this.searchQuery$,(c,d)=>({limit:c.limit,skip:c.skip,name:d,total:c.total})),this.setFormName=this.updater((c,d)=>Object.assign(Object.assign({},c),{formName:d})),this.setItem=this.updater((c,d)=>Object.assign(Object.assign({},c),{item:d})),this.addNewAccountStatus=this.updater((c,d)=>Object.assign(Object.assign({},c),{accountStatuses:[...c.accountStatuses,d]})),this.updateAccountStatus=this.updater((c,d)=>Object.assign(Object.assign({},c),{accountStatuses:c.accountStatuses.map(n=>n.id===d.id?d:n)})),this.addAccountStatuses=this.updater((c,d)=>Object.assign(Object.assign({},c),{accountStatuses:c.accountStatuses.concat(d)})),this.updateAccountStatuses=this.updater((c,d)=>Object.assign(Object.assign({},c),{accountStatuses:c.accountStatuses.map(n=>d.find(m=>m.id===n.id)||n)})),this.setSearchQuery=this.updater((c,d)=>Object.assign(Object.assign({},c),{searchQuery:d})),this.loadAccountStatusEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.data.userAccountStatus({accountStatusId:d}).pipe((0,g._b)(n=>{this.patchState({item:n.data.item,errors:n.errors,loading:!1})},n=>this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})))))),this.loadAccountStatusesEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([d,n])=>this.data.userAccountStatuses({input:n}).pipe((0,g._b)(r=>this.patchState({paging:{limit:n.limit,skip:n.skip,total:r.data.count.total},accountStatuses:r.data.items,errors:r.errors,loading:!1}),r=>this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})))))),this.createAccountStatusEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.accountStatusService.createAccountStatus(Object.assign({},d)).pipe((0,g._b)(n=>{this.addNewAccountStatus(n),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:n,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},n=>{n.graphQLErrors?(this.toast.error(n.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})):(this.toast.error(n.Message),this.formService.setErrors(n.Data))}))))),this.updateAccountStatusEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.accountStatusService.updateAccountStatus(d,d.id).pipe((0,g._b)(r=>{this.updateAccountStatus(r),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:r,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.deleteAccountStatusEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.data.userDeleteAccountStatus({accountStatusId:n.id}).pipe((0,g._b)(r=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:r.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.importExcelEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.accountStatusService.importAccountStatuses(d).pipe((0,ce.K)(n=>{var r;return this.toast.error(null!==(r=n.Message)&&void 0!==r?r:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(n=>{const r=JSON.parse(n.created),m=JSON.parse(n.updated),p=JSON.parse(n.failed),_=r.length+m.length+p.length;this.addAccountStatuses(r),this.updateAccountStatuses(m),this.toast.success(`${r.length} created, ${m.length} updated, ${p.length} failed of total ${_}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("accountStatusId")?(this.route.snapshot.paramMap.get("accountStatusId"),this.setFormName("accountStatus_edit")):this.setFormName("accountStatus_create")}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.accountStatusService.validateAccountStatusExcelData(t)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(gp))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function Cp(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.accountStatus)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let ja=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"accountStatus_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.accountStatus=i.item})):t.formName&&t.formName.currentValue&&"accountStatus_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadAccountStatusEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.accountStatus=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(ws),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-account-status-form"]],inputs:{accountStatus:"accountStatus",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,Cp,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),Ua=(()=>{class s{constructor(){this.autoHeight=!1,this.accountStatuses=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[,{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-account-status-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",accountStatuses:"accountStatuses"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.accountStatuses)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function vp(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-account-status-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","accountStatus_edit")("formControl",t.formControl)("accountStatus",t.accountStatus)}}const Sp=function(){return{}};function bp(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-account-status-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","accountStatus_create")("formControl",t.formControl)("accountStatus",e.DdM(3,Sp))}}function Tp(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-account-status-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("accountStatuses",o.data.items)}let yp=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadAccountStatusesEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.accountStatuses$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(ws))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","accountStatus","send","close"],[1,"w-full","h-full","bg-white",3,"accountStatuses","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,vp,2,3,"ng-template",null,1,e.W1O),e.YNc(3,bp,1,4,"ng-template",null,2,e.W1O),e.YNc(5,Tp,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,ja,Ua],encapsulation:2}),s})();function wp(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-account-status-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","accountStatus_edit")("accountStatus",t.value)}}const xp=function(){return{}};function Np(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-account-status-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","accountStatus_create")("accountStatus",e.DdM(2,xp))}function Ap(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-account-status-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("accountStatuses",t.items)}}let Fp=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","accountStatus","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","accountStatuses","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,wp,1,2,"ng-template",null,1,e.W1O),e.YNc(3,Np,1,3,"ng-template",null,2,e.W1O),e.YNc(5,Ap,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,ja,Ua],encapsulation:2}),s})(),Pp=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[ws],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"account-status-select",component:yp,wrappers:["form-field"]},{name:"account-status-grid",component:Fp}]})]}),s})(),Ip=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[Pp]}),s})();class et extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class Dp extends et{constructor(o){super("ValidateAdverseInsuranceStatusExcelDataAction"),this.valid=!1,this.excelData=o}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name)}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class Mp extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class Wp extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new Mp("name","The adverseinsurancestatus name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class Ep extends et{constructor(o){super("CreateAdverseInsuranceStatusAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new Wp("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateAdverseInsuranceStatus({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class Op extends et{constructor(o){super("UpdateAdverseInsuranceStatusesAction"),this.adverseInsuranceStatuses=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.adverseInsuranceStatuses,!0))}performAction(){this.response=this.businessProvider.data.userUpdateAdverseInsuranceStatuses({input:{adverseInsuranceStatuses:this.adverseInsuranceStatuses}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class Lp extends et{constructor(o,t){super("UpdateAdverseInsuranceStatusAction"),this.adverseInsuranceStatus=o,this.adverseInsuranceStatusId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.adverseInsuranceStatus,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.adverseInsuranceStatusId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateAdverseInsuranceStatus({adverseInsuranceStatusId:this.adverseInsuranceStatusId,input:this.adverseInsuranceStatus}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let Ja=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.AdverseInsuranceStatusBusinessProviderService",t,a),this.data=i}createAdverseInsuranceStatus(t){const i=new Ep(t);return i.Do(this),i.response}updateAdverseInsuranceStatus(t,i){const a=new Lp(t,i);return a.Do(this),a.response}importAdverseInsuranceStatuses(t){const i=new Op(t);return i.Do(this),i.response}validateAdverseInsuranceStatusExcelData(t){const i=new Dp(t);return i.Do(this),i.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),$p=(()=>{class s extends I.nH{constructor(t,i,a){super("AdverseInsuranceStatusService",a,t),this.businessProvider=i}createAdverseInsuranceStatus(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createAdverseInsuranceStatus(i)}updateAdverseInsuranceStatus(t,i){return this.businessProvider.updateAdverseInsuranceStatus(t,i)}importAdverseInsuranceStatuses(t){return this.businessProvider.importAdverseInsuranceStatuses(t)}validateAdverseInsuranceStatusExcelData(t){return this.businessProvider.validateAdverseInsuranceStatusExcelData(t)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(Ja,8),e.LFG(Ja),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),xs=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){super({loading:!1,adverseInsuranceStatuses:[],done:!1,searchQuery:"",formName:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.adverseInsuranceStatusService=H,this.errors$=this.select(c=>c.errors),this.loading$=this.select(c=>c.loading),this.done$=this.select(c=>c.done),this.item$=this.select(c=>c.item),this.adverseInsuranceStatuses$=this.select(c=>c.adverseInsuranceStatuses),this.paging$=this.select(c=>c.paging),this.searchQuery$=this.select(c=>c.searchQuery),this.formName$=this.select(c=>c.formName),this.actionResult$=this.select(this.item$,this.done$,(c,d)=>({item:c,done:d}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.adverseInsuranceStatuses$,(c,d,n,r,m)=>({errors:c,loading:d,item:n,formName:r,adverseInsuranceStatuses:m}),{debounce:!0}),this.input$=this.select(this.paging$,this.searchQuery$,(c,d)=>({limit:c.limit,skip:c.skip,name:d,total:c.total})),this.setFormName=this.updater((c,d)=>Object.assign(Object.assign({},c),{formName:d})),this.setItem=this.updater((c,d)=>Object.assign(Object.assign({},c),{item:d})),this.addNewAdverseInsuranceStatus=this.updater((c,d)=>Object.assign(Object.assign({},c),{adverseInsuranceStatuses:[...c.adverseInsuranceStatuses,d]})),this.updateAdverseInsuranceStatus=this.updater((c,d)=>Object.assign(Object.assign({},c),{adverseInsuranceStatuses:c.adverseInsuranceStatuses.map(n=>n.id===d.id?d:n)})),this.addAdverseInsuranceStatuses=this.updater((c,d)=>Object.assign(Object.assign({},c),{adverseInsuranceStatuses:c.adverseInsuranceStatuses.concat(d)})),this.updateAdverseInsuranceStatuses=this.updater((c,d)=>Object.assign(Object.assign({},c),{adverseInsuranceStatuses:c.adverseInsuranceStatuses.map(n=>d.find(m=>m.id===n.id)||n)})),this.setSearchQuery=this.updater((c,d)=>Object.assign(Object.assign({},c),{searchQuery:d})),this.loadAdverseInsuranceStatusEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.data.userAdverseInsuranceStatus({adverseInsuranceStatusId:d}).pipe((0,g._b)(n=>{this.patchState({item:n.data.item,errors:n.errors,loading:!1})},n=>this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})))))),this.loadAdverseInsuranceStatusesEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([d,n])=>this.data.userAdverseInsuranceStatuses({input:n}).pipe((0,g._b)(r=>this.patchState({paging:{limit:n.limit,skip:n.skip,total:r.data.count.total},adverseInsuranceStatuses:r.data.items,errors:r.errors,loading:!1}),r=>this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})))))),this.createAdverseInsuranceStatusEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.adverseInsuranceStatusService.createAdverseInsuranceStatus(Object.assign({},d)).pipe((0,g._b)(n=>{this.addNewAdverseInsuranceStatus(n),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:n,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},n=>{n.graphQLErrors?(this.toast.error(n.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})):(this.toast.error(n.Message),this.formService.setErrors(n.Data))}))))),this.updateAdverseInsuranceStatusEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.adverseInsuranceStatusService.updateAdverseInsuranceStatus(d,d.id).pipe((0,g._b)(r=>{this.updateAdverseInsuranceStatus(r),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:r,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.deleteAdverseInsuranceStatusEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.data.userDeleteAdverseInsuranceStatus({adverseInsuranceStatusId:n.id}).pipe((0,g._b)(r=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:r.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.importExcelEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.adverseInsuranceStatusService.importAdverseInsuranceStatuses(d).pipe((0,ce.K)(n=>{var r;return this.toast.error(null!==(r=n.Message)&&void 0!==r?r:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(n=>{const r=JSON.parse(n.created),m=JSON.parse(n.updated),p=JSON.parse(n.failed),_=r.length+m.length+p.length;this.addAdverseInsuranceStatuses(r),this.updateAdverseInsuranceStatuses(m),this.toast.success(`${r.length} created, ${m.length} updated, ${p.length} failed of total ${_}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("adverseInsuranceStatusId")?(this.route.snapshot.paramMap.get("adverseInsuranceStatusId"),this.setFormName("adverseInsuranceStatus_edit")):this.setFormName("adverseInsuranceStatus_create")}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.adverseInsuranceStatusService.validateAdverseInsuranceStatusExcelData(t)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG($p))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function Gp(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.adverseInsuranceStatus)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let za=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"adverseInsuranceStatus_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.adverseInsuranceStatus=i.item})):t.formName&&t.formName.currentValue&&"adverseInsuranceStatus_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadAdverseInsuranceStatusEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.adverseInsuranceStatus=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(xs),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-adverse-insurance-status-form"]],inputs:{adverseInsuranceStatus:"adverseInsuranceStatus",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,Gp,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),Ha=(()=>{class s{constructor(){this.autoHeight=!1,this.adverseInsuranceStatuses=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[,{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-adverse-insurance-status-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",adverseInsuranceStatuses:"adverseInsuranceStatuses"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.adverseInsuranceStatuses)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function Rp(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-adverse-insurance-status-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","adverseInsuranceStatus_edit")("formControl",t.formControl)("adverseInsuranceStatus",t.adverseInsuranceStatus)}}const Qp=function(){return{}};function Vp(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-adverse-insurance-status-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","adverseInsuranceStatus_create")("formControl",t.formControl)("adverseInsuranceStatus",e.DdM(3,Qp))}}function jp(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-adverse-insurance-status-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("adverseInsuranceStatuses",o.data.items)}let Up=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadAdverseInsuranceStatusesEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.adverseInsuranceStatuses$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(xs))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","adverseInsuranceStatus","send","close"],[1,"w-full","h-full","bg-white",3,"adverseInsuranceStatuses","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,Rp,2,3,"ng-template",null,1,e.W1O),e.YNc(3,Vp,1,4,"ng-template",null,2,e.W1O),e.YNc(5,jp,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,za,Ha],encapsulation:2}),s})();function Jp(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-adverse-insurance-status-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","adverseInsuranceStatus_edit")("adverseInsuranceStatus",t.value)}}const zp=function(){return{}};function Hp(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-adverse-insurance-status-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","adverseInsuranceStatus_create")("adverseInsuranceStatus",e.DdM(2,zp))}function qp(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-adverse-insurance-status-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("adverseInsuranceStatuses",t.items)}}let Kp=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","adverseInsuranceStatus","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","adverseInsuranceStatuses","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,Jp,1,2,"ng-template",null,1,e.W1O),e.YNc(3,Hp,1,3,"ng-template",null,2,e.W1O),e.YNc(5,qp,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,za,Ha],encapsulation:2}),s})(),Zp=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[xs],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"adverse-insurance-status-select",component:Up,wrappers:["form-field"]},{name:"adverse-insurance-status-grid",component:Kp}]})]}),s})(),kp=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[Zp]}),s})();class tt extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class Bp extends tt{constructor(o){super("ValidateAgreementTypeExcelDataAction"),this.valid=!1,this.excelData=o}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name)}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class Yp extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class Xp extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new Yp("name","The agreementtype name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class eh extends tt{constructor(o){super("CreateAgreementTypeAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new Xp("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateAgreementType({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class th extends tt{constructor(o){super("UpdateAgreementTypesAction"),this.agreementTypes=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.agreementTypes,!0))}performAction(){this.response=this.businessProvider.data.userUpdateAgreementTypes({input:{agreementTypes:this.agreementTypes}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class ih extends tt{constructor(o,t){super("UpdateAgreementTypeAction"),this.agreementType=o,this.agreementTypeId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.agreementType,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.agreementTypeId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateAgreementType({agreementTypeId:this.agreementTypeId,input:this.agreementType}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let qa=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.AgreementTypeBusinessProviderService",t,a),this.data=i}createAgreementType(t){const i=new eh(t);return i.Do(this),i.response}updateAgreementType(t,i){const a=new ih(t,i);return a.Do(this),a.response}importAgreementTypes(t){const i=new th(t);return i.Do(this),i.response}validateAgreementTypeExcelData(t){const i=new Bp(t);return i.Do(this),i.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),sh=(()=>{class s extends I.nH{constructor(t,i,a){super("AgreementTypeService",a,t),this.businessProvider=i}createAgreementType(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createAgreementType(i)}updateAgreementType(t,i){return this.businessProvider.updateAgreementType(t,i)}importAgreementTypes(t){return this.businessProvider.importAgreementTypes(t)}validateAgreementTypeExcelData(t){return this.businessProvider.validateAgreementTypeExcelData(t)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(qa,8),e.LFG(qa),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),Ns=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){super({loading:!1,agreementTypes:[],done:!1,searchQuery:"",formName:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.agreementTypeService=H,this.errors$=this.select(c=>c.errors),this.loading$=this.select(c=>c.loading),this.done$=this.select(c=>c.done),this.item$=this.select(c=>c.item),this.agreementTypes$=this.select(c=>c.agreementTypes),this.paging$=this.select(c=>c.paging),this.searchQuery$=this.select(c=>c.searchQuery),this.formName$=this.select(c=>c.formName),this.actionResult$=this.select(this.item$,this.done$,(c,d)=>({item:c,done:d}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.agreementTypes$,(c,d,n,r,m)=>({errors:c,loading:d,item:n,formName:r,agreementTypes:m}),{debounce:!0}),this.input$=this.select(this.paging$,this.searchQuery$,(c,d)=>({limit:c.limit,skip:c.skip,name:d,total:c.total})),this.setFormName=this.updater((c,d)=>Object.assign(Object.assign({},c),{formName:d})),this.setItem=this.updater((c,d)=>Object.assign(Object.assign({},c),{item:d})),this.addNewAgreementType=this.updater((c,d)=>Object.assign(Object.assign({},c),{agreementTypes:[...c.agreementTypes,d]})),this.updateAgreementType=this.updater((c,d)=>Object.assign(Object.assign({},c),{agreementTypes:c.agreementTypes.map(n=>n.id===d.id?d:n)})),this.addAgreementTypes=this.updater((c,d)=>Object.assign(Object.assign({},c),{agreementTypes:c.agreementTypes.concat(d)})),this.updateAgreementTypes=this.updater((c,d)=>Object.assign(Object.assign({},c),{agreementTypes:c.agreementTypes.map(n=>d.find(m=>m.id===n.id)||n)})),this.setSearchQuery=this.updater((c,d)=>Object.assign(Object.assign({},c),{searchQuery:d})),this.loadAgreementTypeEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.data.userAgreementType({agreementTypeId:d}).pipe((0,g._b)(n=>{this.patchState({item:n.data.item,errors:n.errors,loading:!1})},n=>this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})))))),this.loadAgreementTypesEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([d,n])=>this.data.userAgreementTypes({input:n}).pipe((0,g._b)(r=>this.patchState({paging:{limit:n.limit,skip:n.skip,total:r.data.count.total},agreementTypes:r.data.items,errors:r.errors,loading:!1}),r=>this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})))))),this.createAgreementTypeEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.agreementTypeService.createAgreementType(Object.assign({},d)).pipe((0,g._b)(n=>{this.addNewAgreementType(n),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:n,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},n=>{n.graphQLErrors?(this.toast.error(n.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})):(this.toast.error(n.Message),this.formService.setErrors(n.Data))}))))),this.updateAgreementTypeEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.agreementTypeService.updateAgreementType(d,d.id).pipe((0,g._b)(r=>{this.updateAgreementType(r),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:r,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.deleteAgreementTypeEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.data.userDeleteAgreementType({agreementTypeId:n.id}).pipe((0,g._b)(r=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:r.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.importExcelEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.agreementTypeService.importAgreementTypes(d).pipe((0,ce.K)(n=>{var r;return this.toast.error(null!==(r=n.Message)&&void 0!==r?r:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(n=>{const r=JSON.parse(n.created),m=JSON.parse(n.updated),p=JSON.parse(n.failed),_=r.length+m.length+p.length;this.addAgreementTypes(r),this.updateAgreementTypes(m),this.toast.success(`${r.length} created, ${m.length} updated, ${p.length} failed of total ${_}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("agreementTypeId")?(this.route.snapshot.paramMap.get("agreementTypeId"),this.setFormName("agreementType_edit")):this.setFormName("agreementType_create")}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.agreementTypeService.validateAgreementTypeExcelData(t)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(sh))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function oh(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.agreementType)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let Ka=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"agreementType_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.agreementType=i.item})):t.formName&&t.formName.currentValue&&"agreementType_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadAgreementTypeEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.agreementType=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Ns),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-agreement-type-form"]],inputs:{agreementType:"agreementType",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,oh,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),Za=(()=>{class s{constructor(){this.autoHeight=!1,this.agreementTypes=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[,{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-agreement-type-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",agreementTypes:"agreementTypes"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.agreementTypes)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function ah(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-agreement-type-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","agreementType_edit")("formControl",t.formControl)("agreementType",t.agreementType)}}const rh=function(){return{}};function nh(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-agreement-type-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","agreementType_create")("formControl",t.formControl)("agreementType",e.DdM(3,rh))}}function lh(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-agreement-type-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("agreementTypes",o.data.items)}let ch=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadAgreementTypesEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.agreementTypes$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Ns))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","agreementType","send","close"],[1,"w-full","h-full","bg-white",3,"agreementTypes","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,ah,2,3,"ng-template",null,1,e.W1O),e.YNc(3,nh,1,4,"ng-template",null,2,e.W1O),e.YNc(5,lh,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,Ka,Za],encapsulation:2}),s})();function dh(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-agreement-type-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","agreementType_edit")("agreementType",t.value)}}const uh=function(){return{}};function mh(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-agreement-type-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","agreementType_create")("agreementType",e.DdM(2,uh))}function ph(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-agreement-type-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("agreementTypes",t.items)}}let hh=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","agreementType","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","agreementTypes","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,dh,1,2,"ng-template",null,1,e.W1O),e.YNc(3,mh,1,3,"ng-template",null,2,e.W1O),e.YNc(5,ph,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,Ka,Za],encapsulation:2}),s})(),fh=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[Ns],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"agreement-type-select",component:ch,wrappers:["form-field"]},{name:"agreement-type-grid",component:hh}]})]}),s})(),_h=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[fh]}),s})();var As=Q(95614);function gh(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.appointment)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let ka=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"appointment_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({id:null,name:""}),this.store.vm$.subscribe(i=>{this.appointment=i.item})):t.formName&&t.formName.currentValue&&"appointment_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadAppointmentEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.appointment=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(As.L6),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-appointment-form"]],inputs:{appointment:"appointment",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,gh,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),Ba=(()=>{class s{constructor(){this.autoHeight=!1,this.appointments=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[{field:"location.name",headerName:"Location",filter:"agTextColumnFilter"},{field:"patient.name",headerName:"Patient",filter:"agTextColumnFilter"},{field:"clinicalProvider.name",headerName:"Clinical Provider",filter:"agTextColumnFilter"},{field:"legalCase.name",headerName:"Legal Case",filter:"agTextColumnFilter"},{field:"appointmentStatus.name",headerName:"Appointment Status",filter:"agTextColumnFilter"},{field:"medicalRecordStatus.name",headerName:"Medical Record Status",filter:"agTextColumnFilter"},{field:"visitKind.name",headerName:"Visit Kind",filter:"agTextColumnFilter"},{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{field:"appointmentDateAndTime",filter:"agDateColumnFilter"},{field:"locationId",filter:"agTextColumnFilter",hide:!0},{headerName:"Checked in",field:"checkedIn",filter:"agSetColumnFilter",cellRenderer:"checkboxRenderer"},{field:"checkedInDateTime",filter:"agDateColumnFilter"},{headerName:"MedicalReport",field:"medicalReport.name",filter:"agTextColumnFilter"},{headerName:"Bill",field:"bill.name",filter:"agTextColumnFilter"},{headerName:"Imaging",field:"imaging.name",filter:"agTextColumnFilter"},{headerName:"Duration",field:"duration",filter:"agNumberColumnFilter",aggFunc:"sum"},{field:"patientId",filter:"agTextColumnFilter",hide:!0},{field:"clinicalProviderId",filter:"agTextColumnFilter",hide:!0},{field:"legalCaseId",filter:"agTextColumnFilter",hide:!0},{field:"appointmentStatusId",filter:"agTextColumnFilter",hide:!0},{field:"visitKindId",filter:"agTextColumnFilter",hide:!0},{field:"notes",filter:"agTextColumnFilter"},{field:"recurringEventId",filter:"agTextColumnFilter",hide:!0},{headerName:"Is First Instance",field:"isFirstInstance",filter:"agSetColumnFilter",cellRenderer:"checkboxRenderer"},{field:"description",filter:"agTextColumnFilter"},{field:"start",filter:"agTextColumnFilter"},{field:"end",filter:"agTextColumnFilter"},{headerName:"All Day",field:"allDay",filter:"agSetColumnFilter",cellRenderer:"checkboxRenderer"},{field:"recurrence",filter:"agTextColumnFilter"},{headerName:"Final Visit Approved",field:"finalVisitApproved",filter:"agSetColumnFilter",cellRenderer:"checkboxRenderer"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-appointment-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",appointments:"appointments"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.appointments)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function Ch(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-appointment-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","appointment_edit")("formControl",t.formControl)("appointment",t.appointment)}}const vh=function(){return{}};function Sh(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-appointment-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","appointment_create")("formControl",t.formControl)("appointment",e.DdM(3,vh))}}function bh(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-appointment-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("appointments",o.data.items)}let Th=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadAppointmentsEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.appointments$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(As.L6))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","appointment","send","close"],[1,"w-full","h-full","bg-white",3,"appointments","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,Ch,2,3,"ng-template",null,1,e.W1O),e.YNc(3,Sh,1,4,"ng-template",null,2,e.W1O),e.YNc(5,bh,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,ka,Ba],encapsulation:2}),s})();function yh(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-appointment-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","appointment_edit")("appointment",t.value)}}const wh=function(){return{}};function xh(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-appointment-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","appointment_create")("appointment",e.DdM(2,wh))}function Nh(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-appointment-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("appointments",t.items)}}let Ah=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","appointment","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","appointments","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,yh,1,2,"ng-template",null,1,e.W1O),e.YNc(3,xh,1,3,"ng-template",null,2,e.W1O),e.YNc(5,Nh,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,ka,Ba],encapsulation:2}),s})(),Fh=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[As.L6],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"appointment-select",component:Th,wrappers:["form-field"]},{name:"appointment-grid",component:Ah}]})]}),s})(),Ph=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[Fh]}),s})();class it extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class Ih extends it{constructor(o){super("ValidateAppointmentStatusExcelDataAction"),this.valid=!1,this.excelData=o}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name)}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class Dh extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class Mh extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new Dh("name","The appointmentstatus name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class Wh extends it{constructor(o){super("CreateAppointmentStatusAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new Mh("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateAppointmentStatus({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class Eh extends it{constructor(o){super("UpdateAppointmentStatusesAction"),this.appointmentStatuses=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.appointmentStatuses,!0))}performAction(){this.response=this.businessProvider.data.userUpdateAppointmentStatuses({input:{appointmentStatuses:this.appointmentStatuses}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class Oh extends it{constructor(o,t){super("UpdateAppointmentStatusAction"),this.appointmentStatus=o,this.appointmentStatusId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.appointmentStatus,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.appointmentStatusId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateAppointmentStatus({appointmentStatusId:this.appointmentStatusId,input:this.appointmentStatus}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let Ya=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.AppointmentStatusBusinessProviderService",t,a),this.data=i}createAppointmentStatus(t){const i=new Wh(t);return i.Do(this),i.response}updateAppointmentStatus(t,i){const a=new Oh(t,i);return a.Do(this),a.response}importAppointmentStatuses(t){const i=new Eh(t);return i.Do(this),i.response}validateAppointmentStatusExcelData(t){const i=new Ih(t);return i.Do(this),i.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),Lh=(()=>{class s extends I.nH{constructor(t,i,a){super("AppointmentStatusService",a,t),this.businessProvider=i}createAppointmentStatus(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createAppointmentStatus(i)}updateAppointmentStatus(t,i){return this.businessProvider.updateAppointmentStatus(t,i)}importAppointmentStatuses(t){return this.businessProvider.importAppointmentStatuses(t)}validateAppointmentStatusExcelData(t){return this.businessProvider.validateAppointmentStatusExcelData(t)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(Ya,8),e.LFG(Ya),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),Fs=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){super({loading:!1,appointmentStatuses:[],done:!1,searchQuery:"",formName:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.appointmentStatusService=H,this.errors$=this.select(c=>c.errors),this.loading$=this.select(c=>c.loading),this.done$=this.select(c=>c.done),this.item$=this.select(c=>c.item),this.appointmentStatuses$=this.select(c=>c.appointmentStatuses),this.paging$=this.select(c=>c.paging),this.searchQuery$=this.select(c=>c.searchQuery),this.formName$=this.select(c=>c.formName),this.actionResult$=this.select(this.item$,this.done$,(c,d)=>({item:c,done:d}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.appointmentStatuses$,(c,d,n,r,m)=>({errors:c,loading:d,item:n,formName:r,appointmentStatuses:m}),{debounce:!0}),this.input$=this.select(this.paging$,this.searchQuery$,(c,d)=>({limit:c.limit,skip:c.skip,name:d,total:c.total})),this.setFormName=this.updater((c,d)=>Object.assign(Object.assign({},c),{formName:d})),this.setItem=this.updater((c,d)=>Object.assign(Object.assign({},c),{item:d})),this.addNewAppointmentStatus=this.updater((c,d)=>Object.assign(Object.assign({},c),{appointmentStatuses:[...c.appointmentStatuses,d]})),this.updateAppointmentStatus=this.updater((c,d)=>Object.assign(Object.assign({},c),{appointmentStatuses:c.appointmentStatuses.map(n=>n.id===d.id?d:n)})),this.addAppointmentStatuses=this.updater((c,d)=>Object.assign(Object.assign({},c),{appointmentStatuses:c.appointmentStatuses.concat(d)})),this.updateAppointmentStatuses=this.updater((c,d)=>Object.assign(Object.assign({},c),{appointmentStatuses:c.appointmentStatuses.map(n=>d.find(m=>m.id===n.id)||n)})),this.setSearchQuery=this.updater((c,d)=>Object.assign(Object.assign({},c),{searchQuery:d})),this.loadAppointmentStatusEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.data.userAppointmentStatus({appointmentStatusId:d}).pipe((0,g._b)(n=>{this.patchState({item:n.data.item,errors:n.errors,loading:!1})},n=>this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})))))),this.loadAppointmentStatusesEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([d,n])=>this.data.userAppointmentStatuses({input:n}).pipe((0,g._b)(r=>this.patchState({paging:{limit:n.limit,skip:n.skip,total:r.data.count.total},appointmentStatuses:r.data.items,errors:r.errors,loading:!1}),r=>this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})))))),this.createAppointmentStatusEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.appointmentStatusService.createAppointmentStatus(Object.assign({},d)).pipe((0,g._b)(n=>{this.addNewAppointmentStatus(n),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:n,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},n=>{n.graphQLErrors?(this.toast.error(n.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})):(this.toast.error(n.Message),this.formService.setErrors(n.Data))}))))),this.updateAppointmentStatusEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.appointmentStatusService.updateAppointmentStatus(d,d.id).pipe((0,g._b)(r=>{this.updateAppointmentStatus(r),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:r,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.deleteAppointmentStatusEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.data.userDeleteAppointmentStatus({appointmentStatusId:n.id}).pipe((0,g._b)(r=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:r.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.importExcelEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.appointmentStatusService.importAppointmentStatuses(d).pipe((0,ce.K)(n=>{var r;return this.toast.error(null!==(r=n.Message)&&void 0!==r?r:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(n=>{const r=JSON.parse(n.created),m=JSON.parse(n.updated),p=JSON.parse(n.failed),_=r.length+m.length+p.length;this.addAppointmentStatuses(r),this.updateAppointmentStatuses(m),this.toast.success(`${r.length} created, ${m.length} updated, ${p.length} failed of total ${_}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("appointmentStatusId")?(this.route.snapshot.paramMap.get("appointmentStatusId"),this.setFormName("appointmentStatus_edit")):this.setFormName("appointmentStatus_create")}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.appointmentStatusService.validateAppointmentStatusExcelData(t)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(Lh))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function $h(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.appointmentStatus)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let Xa=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"appointmentStatus_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.appointmentStatus=i.item})):t.formName&&t.formName.currentValue&&"appointmentStatus_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadAppointmentStatusEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.appointmentStatus=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Fs),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-appointment-status-form"]],inputs:{appointmentStatus:"appointmentStatus",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,$h,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),er=(()=>{class s{constructor(){this.autoHeight=!1,this.appointmentStatuses=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[,{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-appointment-status-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",appointmentStatuses:"appointmentStatuses"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.appointmentStatuses)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function Gh(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-appointment-status-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","appointmentStatus_edit")("formControl",t.formControl)("appointmentStatus",t.appointmentStatus)}}const Rh=function(){return{}};function Qh(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-appointment-status-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","appointmentStatus_create")("formControl",t.formControl)("appointmentStatus",e.DdM(3,Rh))}}function Vh(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-appointment-status-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("appointmentStatuses",o.data.items)}let jh=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadAppointmentStatusesEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.appointmentStatuses$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Fs))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","appointmentStatus","send","close"],[1,"w-full","h-full","bg-white",3,"appointmentStatuses","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,Gh,2,3,"ng-template",null,1,e.W1O),e.YNc(3,Qh,1,4,"ng-template",null,2,e.W1O),e.YNc(5,Vh,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,Xa,er],encapsulation:2}),s})();function Uh(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-appointment-status-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","appointmentStatus_edit")("appointmentStatus",t.value)}}const Jh=function(){return{}};function zh(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-appointment-status-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","appointmentStatus_create")("appointmentStatus",e.DdM(2,Jh))}function Hh(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-appointment-status-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("appointmentStatuses",t.items)}}let qh=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","appointmentStatus","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","appointmentStatuses","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,Uh,1,2,"ng-template",null,1,e.W1O),e.YNc(3,zh,1,3,"ng-template",null,2,e.W1O),e.YNc(5,Hh,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,Xa,er],encapsulation:2}),s})(),Kh=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[Fs],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"appointment-status-select",component:jh,wrappers:["form-field"]},{name:"appointment-status-grid",component:qh}]})]}),s})(),Zh=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[Kh]}),s})(),kh=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[x.ez,E.Bz,$.P]}),s})(),Bh=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[x.ez,E.Bz,G.t,$.P,kh]}),s})();var Ps=Q(30269);function Yh(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.attorney)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let tr=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"attorney_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.attorney=i.item})):t.formName&&t.formName.currentValue&&"attorney_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadAttorneyEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.attorney=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Ps.I),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-attorney-form"]],inputs:{attorney:"attorney",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,Yh,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),ir=(()=>{class s{constructor(){this.autoHeight=!1,this.attorneys=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[{field:"firm.name",headerName:"Firm",filter:"agTextColumnFilter"},{field:"attorneyStatus.name",headerName:"Attorney Status",filter:"agTextColumnFilter"},{field:"attorneyType.name",headerName:"Attorney Type",filter:"agTextColumnFilter"},{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{field:"firmId",filter:"agTextColumnFilter",hide:!0},{field:"attorneyStatusId",filter:"agTextColumnFilter",hide:!0},{field:"attorneyTypeId",filter:"agTextColumnFilter",hide:!0},{field:"title",filter:"agTextColumnFilter"},{field:"firstName",filter:"agTextColumnFilter"},{field:"lastName",filter:"agTextColumnFilter"},{field:"address",filter:"agTextColumnFilter"},{field:"city",filter:"agTextColumnFilter"},{field:"state",filter:"agTextColumnFilter"},{field:"zip",filter:"agTextColumnFilter"},{field:"email",filter:"agTextColumnFilter"},{field:"direct",filter:"agTextColumnFilter"},{field:"fax",filter:"agTextColumnFilter"},{field:"cellPhone",filter:"agTextColumnFilter"},{field:"barNumber",filter:"agTextColumnFilter"},{field:"barState",filter:"agTextColumnFilter"},{headerName:"Do Not Disturb",field:"doNotDisturb",filter:"agSetColumnFilter",cellRenderer:"checkboxRenderer"},{field:"temp",filter:"agTextColumnFilter"},{field:"createdById",filter:"agTextColumnFilter",hide:!0},{field:"dateCreated",filter:"agDateColumnFilter"},{headerName:"Removed",field:"removed",filter:"agSetColumnFilter",cellRenderer:"checkboxRenderer"},{field:"migSource",filter:"agTextColumnFilter"},{field:"entity",filter:"agTextColumnFilter"},{headerName:"Firm Nolonger Needed",field:"firmNolongerNeeded",filter:"agSetColumnFilter",cellRenderer:"checkboxRenderer"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-attorney-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",attorneys:"attorneys"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.attorneys)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function Xh(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-attorney-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","attorney_edit")("formControl",t.formControl)("attorney",t.attorney)}}const ef=function(){return{}};function tf(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-attorney-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","attorney_create")("formControl",t.formControl)("attorney",e.DdM(3,ef))}}function sf(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-attorney-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("attorneys",o.data.items)}let of=(()=>{class s extends R.fS{constructor(t,i){super(),this.store=t,this.formService=i,this.routerKeys=["firmId","attorneyStatusId","attorneyTypeId"],this.store.loadAttorneysEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.attorneys$.pipe((0,h.w)(i=>(0,F.of)(i)))}formRouterKeyDidChange(t){this.store.setFirmId(t.firmId),this.store.setAttorneyStatusId(t.attorneyStatusId),this.store.setAttorneyTypeId(t.attorneyTypeId),this.store.loadAttorneysEffect()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Ps.I),e.Y36(X.o))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e._Bn([Ps.I]),e.qOj],decls:7,vars:7,consts:[[3,"to","control","listTemplate","editTemplate","createTemplate","key","routerKeys","selectionChanged","formRouterKeyDidChange"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","attorney","send","close"],[1,"w-full","h-full","bg-white",3,"attorneys","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value})("formRouterKeyDidChange",function(l){return i.formRouterKeyDidChange(l)}),e.qZA(),e.YNc(1,Xh,2,3,"ng-template",null,1,e.W1O),e.YNc(3,tf,1,4,"ng-template",null,2,e.W1O),e.YNc(5,sf,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)("routerKeys",i.routerKeys)}},dependencies:[W.JJ,W.oH,Z.$,tr,ir],encapsulation:2}),s})();function af(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-attorney-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","attorney_edit")("attorney",t.value)}}const rf=function(){return{}};function nf(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-attorney-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","attorney_create")("attorney",e.DdM(2,rf))}function lf(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-attorney-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("attorneys",t.items)}}let cf=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","attorney","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","attorneys","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,af,1,2,"ng-template",null,1,e.W1O),e.YNc(3,nf,1,3,"ng-template",null,2,e.W1O),e.YNc(5,lf,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,tr,ir],encapsulation:2}),s})(),df=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"attorney-select",component:of,wrappers:["form-field"]},{name:"attorney-grid",component:cf}]})]}),s})(),uf=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[df]}),s})();class st extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class mf extends st{constructor(o){super("ValidateAttorneyStatusExcelDataAction"),this.valid=!1,this.excelData=o}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name)}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class pf extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class hf extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new pf("name","The attorneystatus name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class ff extends st{constructor(o){super("CreateAttorneyStatusAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new hf("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateAttorneyStatus({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class _f extends st{constructor(o){super("UpdateAttorneyStatusesAction"),this.attorneyStatuses=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.attorneyStatuses,!0))}performAction(){this.response=this.businessProvider.data.userUpdateAttorneyStatuses({input:{attorneyStatuses:this.attorneyStatuses}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class gf extends st{constructor(o,t){super("UpdateAttorneyStatusAction"),this.attorneyStatus=o,this.attorneyStatusId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.attorneyStatus,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.attorneyStatusId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateAttorneyStatus({attorneyStatusId:this.attorneyStatusId,input:this.attorneyStatus}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let sr=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.AttorneyStatusBusinessProviderService",t,a),this.data=i}createAttorneyStatus(t){const i=new ff(t);return i.Do(this),i.response}updateAttorneyStatus(t,i){const a=new gf(t,i);return a.Do(this),a.response}importAttorneyStatuses(t){const i=new _f(t);return i.Do(this),i.response}validateAttorneyStatusExcelData(t){const i=new mf(t);return i.Do(this),i.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),Cf=(()=>{class s extends I.nH{constructor(t,i,a){super("AttorneyStatusService",a,t),this.businessProvider=i}createAttorneyStatus(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createAttorneyStatus(i)}updateAttorneyStatus(t,i){return this.businessProvider.updateAttorneyStatus(t,i)}importAttorneyStatuses(t){return this.businessProvider.importAttorneyStatuses(t)}validateAttorneyStatusExcelData(t){return this.businessProvider.validateAttorneyStatusExcelData(t)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(sr,8),e.LFG(sr),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),Is=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){super({loading:!1,attorneyStatuses:[],done:!1,searchQuery:"",formName:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.attorneyStatusService=H,this.errors$=this.select(c=>c.errors),this.loading$=this.select(c=>c.loading),this.done$=this.select(c=>c.done),this.item$=this.select(c=>c.item),this.attorneyStatuses$=this.select(c=>c.attorneyStatuses),this.paging$=this.select(c=>c.paging),this.searchQuery$=this.select(c=>c.searchQuery),this.formName$=this.select(c=>c.formName),this.actionResult$=this.select(this.item$,this.done$,(c,d)=>({item:c,done:d}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.attorneyStatuses$,(c,d,n,r,m)=>({errors:c,loading:d,item:n,formName:r,attorneyStatuses:m}),{debounce:!0}),this.input$=this.select(this.paging$,this.searchQuery$,(c,d)=>({limit:c.limit,skip:c.skip,name:d,total:c.total})),this.setFormName=this.updater((c,d)=>Object.assign(Object.assign({},c),{formName:d})),this.setItem=this.updater((c,d)=>Object.assign(Object.assign({},c),{item:d})),this.addNewAttorneyStatus=this.updater((c,d)=>Object.assign(Object.assign({},c),{attorneyStatuses:[...c.attorneyStatuses,d]})),this.updateAttorneyStatus=this.updater((c,d)=>Object.assign(Object.assign({},c),{attorneyStatuses:c.attorneyStatuses.map(n=>n.id===d.id?d:n)})),this.addAttorneyStatuses=this.updater((c,d)=>Object.assign(Object.assign({},c),{attorneyStatuses:c.attorneyStatuses.concat(d)})),this.updateAttorneyStatuses=this.updater((c,d)=>Object.assign(Object.assign({},c),{attorneyStatuses:c.attorneyStatuses.map(n=>d.find(m=>m.id===n.id)||n)})),this.setSearchQuery=this.updater((c,d)=>Object.assign(Object.assign({},c),{searchQuery:d})),this.loadAttorneyStatusEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.data.userAttorneyStatus({attorneyStatusId:d}).pipe((0,g._b)(n=>{this.patchState({item:n.data.item,errors:n.errors,loading:!1})},n=>this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})))))),this.loadAttorneyStatusesEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([d,n])=>this.data.userAttorneyStatuses({input:n}).pipe((0,g._b)(r=>this.patchState({paging:{limit:n.limit,skip:n.skip,total:r.data.count.total},attorneyStatuses:r.data.items,errors:r.errors,loading:!1}),r=>this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})))))),this.createAttorneyStatusEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.attorneyStatusService.createAttorneyStatus(Object.assign({},d)).pipe((0,g._b)(n=>{this.addNewAttorneyStatus(n),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:n,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},n=>{n.graphQLErrors?(this.toast.error(n.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})):(this.toast.error(n.Message),this.formService.setErrors(n.Data))}))))),this.updateAttorneyStatusEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.attorneyStatusService.updateAttorneyStatus(d,d.id).pipe((0,g._b)(r=>{this.updateAttorneyStatus(r),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:r,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.deleteAttorneyStatusEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.data.userDeleteAttorneyStatus({attorneyStatusId:n.id}).pipe((0,g._b)(r=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:r.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.importExcelEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.attorneyStatusService.importAttorneyStatuses(d).pipe((0,ce.K)(n=>{var r;return this.toast.error(null!==(r=n.Message)&&void 0!==r?r:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(n=>{const r=JSON.parse(n.created),m=JSON.parse(n.updated),p=JSON.parse(n.failed),_=r.length+m.length+p.length;this.addAttorneyStatuses(r),this.updateAttorneyStatuses(m),this.toast.success(`${r.length} created, ${m.length} updated, ${p.length} failed of total ${_}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("attorneyStatusId")?(this.route.snapshot.paramMap.get("attorneyStatusId"),this.setFormName("attorneyStatus_edit")):this.setFormName("attorneyStatus_create")}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.attorneyStatusService.validateAttorneyStatusExcelData(t)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(Cf))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function vf(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.attorneyStatus)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let or=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"attorneyStatus_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.attorneyStatus=i.item})):t.formName&&t.formName.currentValue&&"attorneyStatus_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadAttorneyStatusEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.attorneyStatus=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Is),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-attorney-status-form"]],inputs:{attorneyStatus:"attorneyStatus",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,vf,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),ar=(()=>{class s{constructor(){this.autoHeight=!1,this.attorneyStatuses=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[,{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-attorney-status-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",attorneyStatuses:"attorneyStatuses"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.attorneyStatuses)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function Sf(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-attorney-status-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","attorneyStatus_edit")("formControl",t.formControl)("attorneyStatus",t.attorneyStatus)}}const bf=function(){return{}};function Tf(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-attorney-status-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","attorneyStatus_create")("formControl",t.formControl)("attorneyStatus",e.DdM(3,bf))}}function yf(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-attorney-status-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("attorneyStatuses",o.data.items)}let wf=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadAttorneyStatusesEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.attorneyStatuses$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Is))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","attorneyStatus","send","close"],[1,"w-full","h-full","bg-white",3,"attorneyStatuses","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,Sf,2,3,"ng-template",null,1,e.W1O),e.YNc(3,Tf,1,4,"ng-template",null,2,e.W1O),e.YNc(5,yf,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,or,ar],encapsulation:2}),s})();function xf(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-attorney-status-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","attorneyStatus_edit")("attorneyStatus",t.value)}}const Nf=function(){return{}};function Af(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-attorney-status-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","attorneyStatus_create")("attorneyStatus",e.DdM(2,Nf))}function Ff(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-attorney-status-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("attorneyStatuses",t.items)}}let Pf=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","attorneyStatus","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","attorneyStatuses","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,xf,1,2,"ng-template",null,1,e.W1O),e.YNc(3,Af,1,3,"ng-template",null,2,e.W1O),e.YNc(5,Ff,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,or,ar],encapsulation:2}),s})(),If=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[Is],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"attorney-status-select",component:wf,wrappers:["form-field"]},{name:"attorney-status-grid",component:Pf}]})]}),s})(),Df=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[If]}),s})();class ot extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class Mf extends ot{constructor(o){super("ValidateAttorneyTypeExcelDataAction"),this.valid=!1,this.excelData=o}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name)}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class Wf extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class Ef extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new Wf("name","The attorneytype name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class Of extends ot{constructor(o){super("CreateAttorneyTypeAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new Ef("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateAttorneyType({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class Lf extends ot{constructor(o){super("UpdateAttorneyTypesAction"),this.attorneyTypes=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.attorneyTypes,!0))}performAction(){this.response=this.businessProvider.data.userUpdateAttorneyTypes({input:{attorneyTypes:this.attorneyTypes}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class $f extends ot{constructor(o,t){super("UpdateAttorneyTypeAction"),this.attorneyType=o,this.attorneyTypeId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.attorneyType,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.attorneyTypeId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateAttorneyType({attorneyTypeId:this.attorneyTypeId,input:this.attorneyType}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let rr=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.AttorneyTypeBusinessProviderService",t,a),this.data=i}createAttorneyType(t){const i=new Of(t);return i.Do(this),i.response}updateAttorneyType(t,i){const a=new $f(t,i);return a.Do(this),a.response}importAttorneyTypes(t){const i=new Lf(t);return i.Do(this),i.response}validateAttorneyTypeExcelData(t){const i=new Mf(t);return i.Do(this),i.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),Gf=(()=>{class s extends I.nH{constructor(t,i,a){super("AttorneyTypeService",a,t),this.businessProvider=i}createAttorneyType(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createAttorneyType(i)}updateAttorneyType(t,i){return this.businessProvider.updateAttorneyType(t,i)}importAttorneyTypes(t){return this.businessProvider.importAttorneyTypes(t)}validateAttorneyTypeExcelData(t){return this.businessProvider.validateAttorneyTypeExcelData(t)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(rr,8),e.LFG(rr),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),Ds=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){super({loading:!1,attorneyTypes:[],done:!1,searchQuery:"",formName:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.attorneyTypeService=H,this.errors$=this.select(c=>c.errors),this.loading$=this.select(c=>c.loading),this.done$=this.select(c=>c.done),this.item$=this.select(c=>c.item),this.attorneyTypes$=this.select(c=>c.attorneyTypes),this.paging$=this.select(c=>c.paging),this.searchQuery$=this.select(c=>c.searchQuery),this.formName$=this.select(c=>c.formName),this.actionResult$=this.select(this.item$,this.done$,(c,d)=>({item:c,done:d}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.attorneyTypes$,(c,d,n,r,m)=>({errors:c,loading:d,item:n,formName:r,attorneyTypes:m}),{debounce:!0}),this.input$=this.select(this.paging$,this.searchQuery$,(c,d)=>({limit:c.limit,skip:c.skip,name:d,total:c.total})),this.setFormName=this.updater((c,d)=>Object.assign(Object.assign({},c),{formName:d})),this.setItem=this.updater((c,d)=>Object.assign(Object.assign({},c),{item:d})),this.addNewAttorneyType=this.updater((c,d)=>Object.assign(Object.assign({},c),{attorneyTypes:[...c.attorneyTypes,d]})),this.updateAttorneyType=this.updater((c,d)=>Object.assign(Object.assign({},c),{attorneyTypes:c.attorneyTypes.map(n=>n.id===d.id?d:n)})),this.addAttorneyTypes=this.updater((c,d)=>Object.assign(Object.assign({},c),{attorneyTypes:c.attorneyTypes.concat(d)})),this.updateAttorneyTypes=this.updater((c,d)=>Object.assign(Object.assign({},c),{attorneyTypes:c.attorneyTypes.map(n=>d.find(m=>m.id===n.id)||n)})),this.setSearchQuery=this.updater((c,d)=>Object.assign(Object.assign({},c),{searchQuery:d})),this.loadAttorneyTypeEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.data.userAttorneyType({attorneyTypeId:d}).pipe((0,g._b)(n=>{this.patchState({item:n.data.item,errors:n.errors,loading:!1})},n=>this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})))))),this.loadAttorneyTypesEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([d,n])=>this.data.userAttorneyTypes({input:n}).pipe((0,g._b)(r=>this.patchState({paging:{limit:n.limit,skip:n.skip,total:r.data.count.total},attorneyTypes:r.data.items,errors:r.errors,loading:!1}),r=>this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})))))),this.createAttorneyTypeEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.attorneyTypeService.createAttorneyType(Object.assign({},d)).pipe((0,g._b)(n=>{this.addNewAttorneyType(n),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:n,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},n=>{n.graphQLErrors?(this.toast.error(n.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})):(this.toast.error(n.Message),this.formService.setErrors(n.Data))}))))),this.updateAttorneyTypeEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.attorneyTypeService.updateAttorneyType(d,d.id).pipe((0,g._b)(r=>{this.updateAttorneyType(r),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:r,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.deleteAttorneyTypeEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.data.userDeleteAttorneyType({attorneyTypeId:n.id}).pipe((0,g._b)(r=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:r.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.importExcelEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.attorneyTypeService.importAttorneyTypes(d).pipe((0,ce.K)(n=>{var r;return this.toast.error(null!==(r=n.Message)&&void 0!==r?r:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(n=>{const r=JSON.parse(n.created),m=JSON.parse(n.updated),p=JSON.parse(n.failed),_=r.length+m.length+p.length;this.addAttorneyTypes(r),this.updateAttorneyTypes(m),this.toast.success(`${r.length} created, ${m.length} updated, ${p.length} failed of total ${_}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("attorneyTypeId")?(this.route.snapshot.paramMap.get("attorneyTypeId"),this.setFormName("attorneyType_edit")):this.setFormName("attorneyType_create")}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.attorneyTypeService.validateAttorneyTypeExcelData(t)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(Gf))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function Rf(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.attorneyType)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let nr=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"attorneyType_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.attorneyType=i.item})):t.formName&&t.formName.currentValue&&"attorneyType_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadAttorneyTypeEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.attorneyType=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Ds),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-attorney-type-form"]],inputs:{attorneyType:"attorneyType",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,Rf,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),lr=(()=>{class s{constructor(){this.autoHeight=!1,this.attorneyTypes=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[,{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-attorney-type-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",attorneyTypes:"attorneyTypes"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.attorneyTypes)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function Qf(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-attorney-type-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","attorneyType_edit")("formControl",t.formControl)("attorneyType",t.attorneyType)}}const Vf=function(){return{}};function jf(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-attorney-type-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","attorneyType_create")("formControl",t.formControl)("attorneyType",e.DdM(3,Vf))}}function Uf(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-attorney-type-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("attorneyTypes",o.data.items)}let Jf=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadAttorneyTypesEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.attorneyTypes$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Ds))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","attorneyType","send","close"],[1,"w-full","h-full","bg-white",3,"attorneyTypes","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,Qf,2,3,"ng-template",null,1,e.W1O),e.YNc(3,jf,1,4,"ng-template",null,2,e.W1O),e.YNc(5,Uf,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,nr,lr],encapsulation:2}),s})();function zf(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-attorney-type-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","attorneyType_edit")("attorneyType",t.value)}}const Hf=function(){return{}};function qf(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-attorney-type-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","attorneyType_create")("attorneyType",e.DdM(2,Hf))}function Kf(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-attorney-type-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("attorneyTypes",t.items)}}let Zf=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","attorneyType","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","attorneyTypes","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,zf,1,2,"ng-template",null,1,e.W1O),e.YNc(3,qf,1,3,"ng-template",null,2,e.W1O),e.YNc(5,Kf,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,nr,lr],encapsulation:2}),s})(),kf=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[Ds],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"attorney-type-select",component:Jf,wrappers:["form-field"]},{name:"attorney-type-grid",component:Zf}]})]}),s})(),Bf=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[kf]}),s})();var he=Q(54004);class at extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class Yf extends at{constructor(o,t,i,a,l){super("ValidateAuthorizationExcelDataAction"),this.valid=!1,this.excelData=o,this.vendors=t,this.authorizationCategories=i,this.authorizationTypes=a,this.procedures=l}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name),this.validationContext.addRule(new f.mi(`vendorName_${i}_is_valid}`,"Vendor Is Not Valid","vendor.name",t.vendor,this.vendors,!0)),this.validationContext.addRule(new f.mi(`authorizationCategoryName_${i}_is_valid}`,"Authorization Category Is Not Valid","authorizationCategory.name",t.authorizationCategory,this.authorizationCategories,!0)),this.validationContext.addRule(new f.mi(`authorizationTypeName_${i}_is_valid}`,"Authorization Type Is Not Valid","authorizationType.name",t.authorizationType,this.authorizationTypes,!0)),this.validationContext.addRule(new f.mi(`procedureName_${i}_is_valid}`,"Procedure Is Not Valid","procedure.name",t.procedure,this.procedures,!0))}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class Xf extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class e_ extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new Xf("name","The authorization name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class t_ extends at{constructor(o){super("CreateAuthorizationAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new e_("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateAuthorization({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class i_ extends at{constructor(o){super("UpdateAuthorizationsAction"),this.authorizations=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.authorizations,!0))}performAction(){this.response=this.businessProvider.data.userUpdateAuthorizations({input:{authorizations:this.authorizations}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class s_ extends at{constructor(o,t){super("UpdateAuthorizationAction"),this.authorization=o,this.authorizationId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.authorization,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.authorizationId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateAuthorization({authorizationId:this.authorizationId,input:this.authorization}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let cr=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.AuthorizationBusinessProviderService",t,a),this.data=i}createAuthorization(t){const i=new t_(t);return i.Do(this),i.response}updateAuthorization(t,i){const a=new s_(t,i);return a.Do(this),a.response}importAuthorizations(t){const i=new i_(t);return i.Do(this),i.response}validateAuthorizationExcelData(t,i,a,l,u){const H=new Yf(t,i,a,l,u);return H.Do(this),H.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),o_=(()=>{class s extends I.nH{constructor(t,i,a){super("AuthorizationService",a,t),this.businessProvider=i}createAuthorization(t){return this.businessProvider.createAuthorization(t)}updateAuthorization(t,i){return this.businessProvider.updateAuthorization(t,i)}importAuthorizations(t){return this.businessProvider.importAuthorizations(t)}validateAuthorizationExcelData(t,i,a,l,u){return this.businessProvider.validateAuthorizationExcelData(t,i,a,l,u)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(cr,8),e.LFG(cr),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),rt=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){if(super({loading:!1,authorizations:[],done:!1,searchQuery:"",formName:void 0,vendorId:void 0,authorizationCategoryId:void 0,authorizationTypeId:void 0,procedureId:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.authorizationService=H,this.errors$=this.select(m=>m.errors),this.loading$=this.select(m=>m.loading),this.done$=this.select(m=>m.done),this.item$=this.select(m=>m.item),this.authorizations$=this.select(m=>m.authorizations),this.vendors$=this.select(m=>m.vendors||[]),this.authorizationCategories$=this.select(m=>m.authorizationCategories||[]),this.authorizationTypes$=this.select(m=>m.authorizationTypes||[]),this.procedures$=this.select(m=>m.procedures||[]),this.vendorId$=this.select(m=>m.vendorId),this.authorizationCategoryId$=this.select(m=>m.authorizationCategoryId),this.authorizationTypeId$=this.select(m=>m.authorizationTypeId),this.procedureId$=this.select(m=>m.procedureId),this.paging$=this.select(m=>m.paging),this.searchQuery$=this.select(m=>m.searchQuery),this.formName$=this.select(m=>m.formName),this.actionResult$=this.select(this.item$,this.done$,(m,p)=>({item:m,done:p}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.authorizations$,this.vendors$,this.authorizationCategories$,this.authorizationTypes$,this.procedures$,(m,p,_,w,J,_e,ve,ae,le)=>({errors:m,loading:p,item:_,formName:w,authorizations:J,vendors:_e,authorizationCategories:ve,authorizationTypes:ae,procedures:le}),{debounce:!0}),this.input$=this.select(this.paging$,this.vendorId$,this.authorizationCategoryId$,this.authorizationTypeId$,this.procedureId$,this.searchQuery$,(m,p,_,w,J,_e)=>({limit:m.limit,skip:m.skip,name:_e,vendorId:p,authorizationCategoryId:_,authorizationTypeId:w,procedureId:J,total:m.total})),this.setFormName=this.updater((m,p)=>Object.assign(Object.assign({},m),{formName:p})),this.setVendorId=this.updater((m,p)=>Object.assign(Object.assign({},m),{vendorId:p})),this.setAuthorizationCategoryId=this.updater((m,p)=>Object.assign(Object.assign({},m),{authorizationCategoryId:p})),this.setAuthorizationTypeId=this.updater((m,p)=>Object.assign(Object.assign({},m),{authorizationTypeId:p})),this.setProcedureId=this.updater((m,p)=>Object.assign(Object.assign({},m),{procedureId:p})),this.filterVendors=m=>this.data.userSelectVendors({input:{name:m}}).pipe((0,g._b)(p=>{let _=p.data.items;return this.patchState({vendors:_}),_},p=>this.patchState({errors:p.graphQLErrors?p.graphQLErrors:p})),(0,he.U)(p=>p.data.items)),this.filterAuthorizationCategories=m=>this.data.userSelectAuthorizationCategories({input:{name:m}}).pipe((0,g._b)(p=>{let _=p.data.items;return this.patchState({authorizationCategories:_}),_},p=>this.patchState({errors:p.graphQLErrors?p.graphQLErrors:p})),(0,he.U)(p=>p.data.items)),this.filterAuthorizationTypes=m=>this.data.userSelectAuthorizationTypes({input:{name:m}}).pipe((0,g._b)(p=>{let _=p.data.items;return this.patchState({authorizationTypes:_}),_},p=>this.patchState({errors:p.graphQLErrors?p.graphQLErrors:p})),(0,he.U)(p=>p.data.items)),this.filterProcedures=m=>this.data.userSelectProcedures({input:{name:m}}).pipe((0,g._b)(p=>{let _=p.data.items;return this.patchState({procedures:_}),_},p=>this.patchState({errors:p.graphQLErrors?p.graphQLErrors:p})),(0,he.U)(p=>p.data.items)),this.addVendor=this.updater((m,p)=>Object.assign(Object.assign({},m),{vendors:m.vendors.concat(p)})),this.addAuthorizationCategory=this.updater((m,p)=>Object.assign(Object.assign({},m),{authorizationCategories:m.authorizationCategories.concat(p)})),this.addAuthorizationType=this.updater((m,p)=>Object.assign(Object.assign({},m),{authorizationTypes:m.authorizationTypes.concat(p)})),this.addProcedure=this.updater((m,p)=>Object.assign(Object.assign({},m),{procedures:m.procedures.concat(p)})),this.setItem=this.updater((m,p)=>Object.assign(Object.assign({},m),{item:p})),this.addNewAuthorization=this.updater((m,p)=>Object.assign(Object.assign({},m),{authorizations:[...m.authorizations,p]})),this.updateAuthorization=this.updater((m,p)=>Object.assign(Object.assign({},m),{authorizations:m.authorizations.map(_=>_.id===p.id?p:_)})),this.addAuthorizations=this.updater((m,p)=>Object.assign(Object.assign({},m),{authorizations:m.authorizations.concat(p)})),this.updateAuthorizations=this.updater((m,p)=>Object.assign(Object.assign({},m),{authorizations:m.authorizations.map(_=>p.find(J=>J.id===_.id)||_)})),this.setSearchQuery=this.updater((m,p)=>Object.assign(Object.assign({},m),{searchQuery:p})),this.loadAuthorizationEffect=this.effect(m=>m.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(p=>this.data.userAuthorization({authorizationId:p}).pipe((0,g._b)(_=>{this.patchState({item:_.data.item,errors:_.errors,loading:!1})},_=>this.patchState({loading:!1,errors:_.graphQLErrors?_.graphQLErrors:_})))))),this.loadAuthorizationsEffect=this.effect(m=>m.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([p,_])=>this.data.userAuthorizations({input:_}).pipe((0,g._b)(w=>this.patchState({paging:{limit:_.limit,skip:_.skip,total:w.data.count.total},authorizations:w.data.items,errors:w.errors,loading:!1}),w=>this.patchState({loading:!1,errors:w.graphQLErrors?w.graphQLErrors:w})))))),this.createAuthorizationEffect=this.effect(m=>m.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(p=>this.authorizationService.createAuthorization(Object.assign({},p)).pipe((0,g._b)(_=>{this.addNewAuthorization(_),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:_,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},_=>{_.graphQLErrors?(this.toast.error(_.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:_.graphQLErrors?_.graphQLErrors:_})):(this.toast.error(_.Message),this.formService.setErrors(_.Data))}))))),this.updateAuthorizationEffect=this.effect(m=>m.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([p,_])=>this.authorizationService.updateAuthorization(p,p.id).pipe((0,g._b)(w=>{this.updateAuthorization(w),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:w,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},w=>{w.graphQLErrors?(this.toast.error(w.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:w.graphQLErrors?w.graphQLErrors:w})):(this.toast.error(w.Message),this.formService.setErrors(w.Data))}))))),this.deleteAuthorizationEffect=this.effect(m=>m.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([p,_])=>this.data.userDeleteAuthorization({authorizationId:_.id}).pipe((0,g._b)(w=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:w.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},w=>{w.graphQLErrors?(this.toast.error(w.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:w.graphQLErrors?w.graphQLErrors:w})):(this.toast.error(w.Message),this.formService.setErrors(w.Data))}))))),this.importExcelEffect=this.effect(m=>m.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(p=>this.authorizationService.importAuthorizations(p).pipe((0,ce.K)(_=>{var w;return this.toast.error(null!==(w=_.Message)&&void 0!==w?w:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(_=>{const w=JSON.parse(_.created),J=JSON.parse(_.updated),_e=JSON.parse(_.failed),ve=w.length+J.length+_e.length;this.addAuthorizations(w),this.updateAuthorizations(J),this.toast.success(`${w.length} created, ${J.length} updated, ${_e.length} failed of total ${ve}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("authorizationId")?(this.route.snapshot.paramMap.get("authorizationId"),this.setFormName("authorization_edit")):this.setFormName("authorization_create"),this.route.snapshot.paramMap.has("vendorId")){var c=this.route.snapshot.paramMap.get("vendorId");this.setVendorId(c)}if(this.route.snapshot.paramMap.has("authorizationCategoryId")){var d=this.route.snapshot.paramMap.get("authorizationCategoryId");this.setAuthorizationCategoryId(d)}if(this.route.snapshot.paramMap.has("authorizationTypeId")){var n=this.route.snapshot.paramMap.get("authorizationTypeId");this.setAuthorizationTypeId(n)}if(this.route.snapshot.paramMap.has("procedureId")){var r=this.route.snapshot.paramMap.get("procedureId");this.setProcedureId(r)}}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.authorizationService.validateAuthorizationExcelData(t,i.vendors,i.authorizationCategories,i.authorizationTypes,i.procedures)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(o_))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function a_(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.authorization)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let dr=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"authorization_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({id:null,name:""}),this.store.vm$.subscribe(i=>{this.authorization=i.item})):t.formName&&t.formName.currentValue&&"authorization_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadAuthorizationEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.authorization=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(rt),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-authorization-form"]],inputs:{authorization:"authorization",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,a_,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),ur=(()=>{class s{constructor(){this.autoHeight=!1,this.authorizations=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[{field:"vendor.name",headerName:"Vendor",filter:"agTextColumnFilter"},{field:"authorizationCategory.name",headerName:"Authorization Category",filter:"agTextColumnFilter"},{field:"authorizationType.name",headerName:"Authorization Type",filter:"agTextColumnFilter"},{field:"procedure.name",headerName:"Procedure",filter:"agTextColumnFilter"},{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{field:"vendorId",filter:"agTextColumnFilter",hide:!0},{field:"authorizationCategoryId",filter:"agTextColumnFilter",hide:!0},{field:"authorizationTypeId",filter:"agTextColumnFilter",hide:!0},{field:"requestDescription",filter:"agTextColumnFilter"},{headerName:"Duration or Quantity",field:"durationOrQuantity",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.durationOrQuantity,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{field:"unit",filter:"agTextColumnFilter"},{field:"cptCode",filter:"agTextColumnFilter"},{field:"procedureId",filter:"agTextColumnFilter",hide:!0}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-authorization-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",authorizations:"authorizations"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","data","showSidebar","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("data",i.authorizations)("showSidebar",!1)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function r_(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-authorization-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","authorization_edit")("formControl",t.formControl)("authorization",t.authorization)}}const n_=function(){return{}};function l_(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-authorization-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","authorization_create")("formControl",t.formControl)("authorization",e.DdM(3,n_))}}function c_(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-authorization-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("authorizations",o.data.items)}let d_=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadAuthorizationsEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.authorizations$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(rt))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e._Bn([rt]),e.qOj],decls:7,vars:5,consts:[[3,"to","control","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","authorization","send","close"],[1,"w-full","h-full","bg-white",3,"authorizations","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"ui-select-form",0),e.YNc(1,r_,2,3,"ng-template",null,1,e.W1O),e.YNc(3,l_,1,4,"ng-template",null,2,e.W1O),e.YNc(5,c_,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[W.JJ,W.oH,Z.$,dr,ur],encapsulation:2}),s})();function u_(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-authorization-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","authorization_edit")("authorization",t.value)}}const m_=function(){return{}};function p_(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-authorization-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","authorization_create")("authorization",e.DdM(2,m_))}function h_(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-authorization-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("authorizations",t.items)}}let f_=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:6,consts:[[3,"data","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","authorization","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","authorizations","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,u_,1,2,"ng-template",null,1,e.W1O),e.YNc(3,p_,1,3,"ng-template",null,2,e.W1O),e.YNc(5,h_,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,dr,ur],encapsulation:2}),s})(),__=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[rt],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"authorization-select",component:d_,wrappers:["form-field"]},{name:"authorization-grid",component:f_}]})]}),s})(),g_=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[__]}),s})();class nt extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class C_ extends nt{constructor(o){super("ValidateAuthorizationCategoryExcelDataAction"),this.valid=!1,this.excelData=o}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name)}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class v_ extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class S_ extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new v_("name","The authorizationcategory name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class b_ extends nt{constructor(o){super("CreateAuthorizationCategoryAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new S_("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateAuthorizationCategory({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class T_ extends nt{constructor(o){super("UpdateAuthorizationCategoriesAction"),this.authorizationCategories=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.authorizationCategories,!0))}performAction(){this.response=this.businessProvider.data.userUpdateAuthorizationCategories({input:{authorizationCategories:this.authorizationCategories}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class y_ extends nt{constructor(o,t){super("UpdateAuthorizationCategoryAction"),this.authorizationCategory=o,this.authorizationCategoryId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.authorizationCategory,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.authorizationCategoryId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateAuthorizationCategory({authorizationCategoryId:this.authorizationCategoryId,input:this.authorizationCategory}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let mr=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.AuthorizationCategoryBusinessProviderService",t,a),this.data=i}createAuthorizationCategory(t){const i=new b_(t);return i.Do(this),i.response}updateAuthorizationCategory(t,i){const a=new y_(t,i);return a.Do(this),a.response}importAuthorizationCategories(t){const i=new T_(t);return i.Do(this),i.response}validateAuthorizationCategoryExcelData(t){const i=new C_(t);return i.Do(this),i.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),w_=(()=>{class s extends I.nH{constructor(t,i,a){super("AuthorizationCategoryService",a,t),this.businessProvider=i}createAuthorizationCategory(t){return this.businessProvider.createAuthorizationCategory(t)}updateAuthorizationCategory(t,i){return this.businessProvider.updateAuthorizationCategory(t,i)}importAuthorizationCategories(t){return this.businessProvider.importAuthorizationCategories(t)}validateAuthorizationCategoryExcelData(t){return this.businessProvider.validateAuthorizationCategoryExcelData(t)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(mr,8),e.LFG(mr),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),lt=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){super({loading:!1,authorizationCategories:[],done:!1,searchQuery:"",formName:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.authorizationCategoryService=H,this.errors$=this.select(c=>c.errors),this.loading$=this.select(c=>c.loading),this.done$=this.select(c=>c.done),this.item$=this.select(c=>c.item),this.authorizationCategories$=this.select(c=>c.authorizationCategories),this.paging$=this.select(c=>c.paging),this.searchQuery$=this.select(c=>c.searchQuery),this.formName$=this.select(c=>c.formName),this.actionResult$=this.select(this.item$,this.done$,(c,d)=>({item:c,done:d}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.authorizationCategories$,(c,d,n,r,m)=>({errors:c,loading:d,item:n,formName:r,authorizationCategories:m}),{debounce:!0}),this.input$=this.select(this.paging$,this.searchQuery$,(c,d)=>({limit:c.limit,skip:c.skip,name:d,total:c.total})),this.setFormName=this.updater((c,d)=>Object.assign(Object.assign({},c),{formName:d})),this.setItem=this.updater((c,d)=>Object.assign(Object.assign({},c),{item:d})),this.addNewAuthorizationCategory=this.updater((c,d)=>Object.assign(Object.assign({},c),{authorizationCategories:[...c.authorizationCategories,d]})),this.updateAuthorizationCategory=this.updater((c,d)=>Object.assign(Object.assign({},c),{authorizationCategories:c.authorizationCategories.map(n=>n.id===d.id?d:n)})),this.addAuthorizationCategories=this.updater((c,d)=>Object.assign(Object.assign({},c),{authorizationCategories:c.authorizationCategories.concat(d)})),this.updateAuthorizationCategories=this.updater((c,d)=>Object.assign(Object.assign({},c),{authorizationCategories:c.authorizationCategories.map(n=>d.find(m=>m.id===n.id)||n)})),this.setSearchQuery=this.updater((c,d)=>Object.assign(Object.assign({},c),{searchQuery:d})),this.loadAuthorizationCategoryEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.data.userAuthorizationCategory({authorizationCategoryId:d}).pipe((0,g._b)(n=>{this.patchState({item:n.data.item,errors:n.errors,loading:!1})},n=>this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})))))),this.loadAuthorizationCategoriesEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([d,n])=>this.data.userAuthorizationCategories({input:n}).pipe((0,g._b)(r=>this.patchState({paging:{limit:n.limit,skip:n.skip,total:r.data.count.total},authorizationCategories:r.data.items,errors:r.errors,loading:!1}),r=>this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})))))),this.createAuthorizationCategoryEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.authorizationCategoryService.createAuthorizationCategory(Object.assign({},d)).pipe((0,g._b)(n=>{this.addNewAuthorizationCategory(n),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:n,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},n=>{n.graphQLErrors?(this.toast.error(n.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})):(this.toast.error(n.Message),this.formService.setErrors(n.Data))}))))),this.updateAuthorizationCategoryEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.authorizationCategoryService.updateAuthorizationCategory(d,d.id).pipe((0,g._b)(r=>{this.updateAuthorizationCategory(r),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:r,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.deleteAuthorizationCategoryEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.data.userDeleteAuthorizationCategory({authorizationCategoryId:n.id}).pipe((0,g._b)(r=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:r.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.importExcelEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.authorizationCategoryService.importAuthorizationCategories(d).pipe((0,ce.K)(n=>{var r;return this.toast.error(null!==(r=n.Message)&&void 0!==r?r:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(n=>{const r=JSON.parse(n.created),m=JSON.parse(n.updated),p=JSON.parse(n.failed),_=r.length+m.length+p.length;this.addAuthorizationCategories(r),this.updateAuthorizationCategories(m),this.toast.success(`${r.length} created, ${m.length} updated, ${p.length} failed of total ${_}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("authorizationCategoryId")?(this.route.snapshot.paramMap.get("authorizationCategoryId"),this.setFormName("authorizationCategory_edit")):this.setFormName("authorizationCategory_create")}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.authorizationCategoryService.validateAuthorizationCategoryExcelData(t)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(w_))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function x_(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.authorizationCategory)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let pr=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"authorizationCategory_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({id:null,name:""}),this.store.vm$.subscribe(i=>{this.authorizationCategory=i.item})):t.formName&&t.formName.currentValue&&"authorizationCategory_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadAuthorizationCategoryEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.authorizationCategory=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(lt),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-authorization-category-form"]],inputs:{authorizationCategory:"authorizationCategory",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,x_,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),hr=(()=>{class s{constructor(){this.autoHeight=!1,this.authorizationCategories=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[,{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-authorization-category-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",authorizationCategories:"authorizationCategories"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:6,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.authorizationCategories)("showSidebar",!1)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function N_(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-authorization-category-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","authorizationCategory_edit")("formControl",t.formControl)("authorizationCategory",t.authorizationCategory)}}const A_=function(){return{}};function F_(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-authorization-category-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","authorizationCategory_create")("formControl",t.formControl)("authorizationCategory",e.DdM(3,A_))}}function P_(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-authorization-category-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("authorizationCategories",o.data.items)}let I_=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadAuthorizationCategoriesEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.authorizationCategories$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(lt))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e._Bn([lt]),e.qOj],decls:7,vars:5,consts:[[3,"to","control","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","authorizationCategory","send","close"],[1,"w-full","h-full","bg-white",3,"authorizationCategories","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"ui-select-form",0),e.YNc(1,N_,2,3,"ng-template",null,1,e.W1O),e.YNc(3,F_,1,4,"ng-template",null,2,e.W1O),e.YNc(5,P_,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[W.JJ,W.oH,Z.$,pr,hr],encapsulation:2}),s})();function D_(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-authorization-category-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","authorizationCategory_edit")("authorizationCategory",t.value)}}const M_=function(){return{}};function W_(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-authorization-category-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","authorizationCategory_create")("authorizationCategory",e.DdM(2,M_))}function E_(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-authorization-category-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("authorizationCategories",t.items)}}let O_=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:6,consts:[[3,"data","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","authorizationCategory","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","authorizationCategories","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,D_,1,2,"ng-template",null,1,e.W1O),e.YNc(3,W_,1,3,"ng-template",null,2,e.W1O),e.YNc(5,E_,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,pr,hr],encapsulation:2}),s})(),L_=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[lt],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"authorization-category-select",component:I_,wrappers:["form-field"]},{name:"authorization-category-grid",component:O_}]})]}),s})(),$_=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[L_]}),s})();class ct extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class G_ extends ct{constructor(o,t,i){super("ValidateAuthorizationDiagnosisCodeExcelDataAction"),this.valid=!1,this.excelData=o,this.diagnoses=t,this.authorizations=i}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name),this.validationContext.addRule(new f.mi(`diagnosisName_${i}_is_valid}`,"Diagnosis Is Not Valid","diagnosis.name",t.diagnosis,this.diagnoses,!0)),this.validationContext.addRule(new f.mi(`authorizationName_${i}_is_valid}`,"Authorization Is Not Valid","authorization.name",t.authorization,this.authorizations,!0))}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class R_ extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class Q_ extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new R_("name","The authorizationdiagnosiscode name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class V_ extends ct{constructor(o){super("CreateAuthorizationDiagnosisCodeAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new Q_("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateAuthorizationDiagnosisCode({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class j_ extends ct{constructor(o){super("UpdateAuthorizationDiagnosisCodesAction"),this.authorizationDiagnosisCodes=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.authorizationDiagnosisCodes,!0))}performAction(){this.response=this.businessProvider.data.userUpdateAuthorizationDiagnosisCodes({input:{authorizationDiagnosisCodes:this.authorizationDiagnosisCodes}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class U_ extends ct{constructor(o,t){super("UpdateAuthorizationDiagnosisCodeAction"),this.authorizationDiagnosisCode=o,this.authorizationDiagnosisCodeId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.authorizationDiagnosisCode,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.authorizationDiagnosisCodeId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateAuthorizationDiagnosisCode({authorizationDiagnosisCodeId:this.authorizationDiagnosisCodeId,input:this.authorizationDiagnosisCode}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let fr=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.AuthorizationDiagnosisCodeBusinessProviderService",t,a),this.data=i}createAuthorizationDiagnosisCode(t){const i=new V_(t);return i.Do(this),i.response}updateAuthorizationDiagnosisCode(t,i){const a=new U_(t,i);return a.Do(this),a.response}importAuthorizationDiagnosisCodes(t){const i=new j_(t);return i.Do(this),i.response}validateAuthorizationDiagnosisCodeExcelData(t,i,a){const l=new G_(t,i,a);return l.Do(this),l.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),J_=(()=>{class s extends I.nH{constructor(t,i,a){super("AuthorizationDiagnosisCodeService",a,t),this.businessProvider=i}createAuthorizationDiagnosisCode(t){return this.businessProvider.createAuthorizationDiagnosisCode(t)}updateAuthorizationDiagnosisCode(t,i){return this.businessProvider.updateAuthorizationDiagnosisCode(t,i)}importAuthorizationDiagnosisCodes(t){return this.businessProvider.importAuthorizationDiagnosisCodes(t)}validateAuthorizationDiagnosisCodeExcelData(t,i,a){return this.businessProvider.validateAuthorizationDiagnosisCodeExcelData(t,i,a)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(fr,8),e.LFG(fr),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),dt=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){if(super({loading:!1,authorizationDiagnosisCodes:[],done:!1,searchQuery:"",formName:void 0,diagnosisCodeId:void 0,authorizationId:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.authorizationDiagnosisCodeService=H,this.errors$=this.select(n=>n.errors),this.loading$=this.select(n=>n.loading),this.done$=this.select(n=>n.done),this.item$=this.select(n=>n.item),this.authorizationDiagnosisCodes$=this.select(n=>n.authorizationDiagnosisCodes),this.diagnosisCodes$=this.select(n=>n.diagnosisCodes||[]),this.authorizations$=this.select(n=>n.authorizations||[]),this.diagnosisCodeId$=this.select(n=>n.diagnosisCodeId),this.authorizationId$=this.select(n=>n.authorizationId),this.paging$=this.select(n=>n.paging),this.searchQuery$=this.select(n=>n.searchQuery),this.formName$=this.select(n=>n.formName),this.actionResult$=this.select(this.item$,this.done$,(n,r)=>({item:n,done:r}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.authorizationDiagnosisCodes$,this.diagnosisCodes$,this.authorizations$,(n,r,m,p,_,w,J)=>({errors:n,loading:r,item:m,formName:p,authorizationDiagnosisCodes:_,diagnosisCodes:w,authorizations:J}),{debounce:!0}),this.input$=this.select(this.paging$,this.diagnosisCodeId$,this.authorizationId$,this.searchQuery$,(n,r,m,p)=>({limit:n.limit,skip:n.skip,name:p,diagnosisCodeId:r,authorizationId:m,total:n.total})),this.setFormName=this.updater((n,r)=>Object.assign(Object.assign({},n),{formName:r})),this.setDiagnosisCodeId=this.updater((n,r)=>Object.assign(Object.assign({},n),{diagnosisCodeId:r})),this.setAuthorizationId=this.updater((n,r)=>Object.assign(Object.assign({},n),{authorizationId:r})),this.filterDiagnosisCodes=n=>this.data.userSelectDiagnosisCodes({input:{name:n}}).pipe((0,g._b)(r=>{let m=r.data.items;return this.patchState({diagnosisCodes:m}),m},r=>this.patchState({errors:r.graphQLErrors?r.graphQLErrors:r})),(0,he.U)(r=>r.data.items)),this.filterAuthorizations=n=>this.data.userSelectAuthorizations({input:{name:n}}).pipe((0,g._b)(r=>{let m=r.data.items;return this.patchState({authorizations:m}),m},r=>this.patchState({errors:r.graphQLErrors?r.graphQLErrors:r})),(0,he.U)(r=>r.data.items)),this.addDiagnosisCode=this.updater((n,r)=>Object.assign(Object.assign({},n),{diagnosisCodes:n.diagnosisCodes.concat(r)})),this.addAuthorization=this.updater((n,r)=>Object.assign(Object.assign({},n),{authorizations:n.authorizations.concat(r)})),this.setItem=this.updater((n,r)=>Object.assign(Object.assign({},n),{item:r})),this.addNewAuthorizationDiagnosisCode=this.updater((n,r)=>Object.assign(Object.assign({},n),{authorizationDiagnosisCodes:[...n.authorizationDiagnosisCodes,r]})),this.updateAuthorizationDiagnosisCode=this.updater((n,r)=>Object.assign(Object.assign({},n),{authorizationDiagnosisCodes:n.authorizationDiagnosisCodes.map(m=>m.id===r.id?r:m)})),this.addAuthorizationDiagnosisCodes=this.updater((n,r)=>Object.assign(Object.assign({},n),{authorizationDiagnosisCodes:n.authorizationDiagnosisCodes.concat(r)})),this.updateAuthorizationDiagnosisCodes=this.updater((n,r)=>Object.assign(Object.assign({},n),{authorizationDiagnosisCodes:n.authorizationDiagnosisCodes.map(m=>r.find(_=>_.id===m.id)||m)})),this.setSearchQuery=this.updater((n,r)=>Object.assign(Object.assign({},n),{searchQuery:r})),this.loadAuthorizationDiagnosisCodeEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(r=>this.data.userAuthorizationDiagnosisCode({authorizationDiagnosisCodeId:r}).pipe((0,g._b)(m=>{this.patchState({item:m.data.item,errors:m.errors,loading:!1})},m=>this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})))))),this.loadAuthorizationDiagnosisCodesEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([r,m])=>this.data.userAuthorizationDiagnosisCodes({input:m}).pipe((0,g._b)(p=>this.patchState({paging:{limit:m.limit,skip:m.skip,total:p.data.count.total},authorizationDiagnosisCodes:p.data.items,errors:p.errors,loading:!1}),p=>this.patchState({loading:!1,errors:p.graphQLErrors?p.graphQLErrors:p})))))),this.createAuthorizationDiagnosisCodeEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(r=>this.authorizationDiagnosisCodeService.createAuthorizationDiagnosisCode(Object.assign({},r)).pipe((0,g._b)(m=>{this.addNewAuthorizationDiagnosisCode(m),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:m,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},m=>{m.graphQLErrors?(this.toast.error(m.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})):(this.toast.error(m.Message),this.formService.setErrors(m.Data))}))))),this.updateAuthorizationDiagnosisCodeEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([r,m])=>this.authorizationDiagnosisCodeService.updateAuthorizationDiagnosisCode(r,r.id).pipe((0,g._b)(p=>{this.updateAuthorizationDiagnosisCode(p),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:p,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},p=>{p.graphQLErrors?(this.toast.error(p.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:p.graphQLErrors?p.graphQLErrors:p})):(this.toast.error(p.Message),this.formService.setErrors(p.Data))}))))),this.deleteAuthorizationDiagnosisCodeEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([r,m])=>this.data.userDeleteAuthorizationDiagnosisCode({authorizationDiagnosisCodeId:m.id}).pipe((0,g._b)(p=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:p.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},p=>{p.graphQLErrors?(this.toast.error(p.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:p.graphQLErrors?p.graphQLErrors:p})):(this.toast.error(p.Message),this.formService.setErrors(p.Data))}))))),this.importExcelEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(r=>this.authorizationDiagnosisCodeService.importAuthorizationDiagnosisCodes(r).pipe((0,ce.K)(m=>{var p;return this.toast.error(null!==(p=m.Message)&&void 0!==p?p:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(m=>{const p=JSON.parse(m.created),_=JSON.parse(m.updated),w=JSON.parse(m.failed),J=p.length+_.length+w.length;this.addAuthorizationDiagnosisCodes(p),this.updateAuthorizationDiagnosisCodes(_),this.toast.success(`${p.length} created, ${_.length} updated, ${w.length} failed of total ${J}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("authorizationDiagnosisCodeId")?(this.route.snapshot.paramMap.get("authorizationDiagnosisCodeId"),this.setFormName("authorizationDiagnosisCode_edit")):this.setFormName("authorizationDiagnosisCode_create"),this.route.snapshot.paramMap.has("diagnosisCodeId")){var c=this.route.snapshot.paramMap.get("diagnosisCodeId");this.setDiagnosisCodeId(c)}if(this.route.snapshot.paramMap.has("authorizationId")){var d=this.route.snapshot.paramMap.get("authorizationId");this.setAuthorizationId(d)}}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.authorizationDiagnosisCodeService.validateAuthorizationDiagnosisCodeExcelData(t,i.diagnosisCodes,i.authorizations)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(J_))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function z_(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.authorizationDiagnosisCode)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let _r=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"authorizationDiagnosisCode_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({id:null,name:""}),this.store.vm$.subscribe(i=>{this.authorizationDiagnosisCode=i.item})):t.formName&&t.formName.currentValue&&"authorizationDiagnosisCode_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadAuthorizationDiagnosisCodeEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.authorizationDiagnosisCode=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(dt),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-authorization-diagnosis-code-form"]],inputs:{authorizationDiagnosisCode:"authorizationDiagnosisCode",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,z_,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),gr=(()=>{class s{constructor(){this.autoHeight=!1,this.authorizationDiagnosisCodes=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[{field:"diagnosis.name",headerName:"Diagnosis",filter:"agTextColumnFilter"},{field:"authorization.name",headerName:"Authorization",filter:"agTextColumnFilter"},{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{field:"diagnosisCodeId",filter:"agTextColumnFilter",hide:!0},{field:"authorizationId",filter:"agTextColumnFilter",hide:!0}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-authorization-diagnosis-code-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",authorizationDiagnosisCodes:"authorizationDiagnosisCodes"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:6,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.authorizationDiagnosisCodes)("showSidebar",!1)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function H_(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-authorization-diagnosis-code-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","authorizationDiagnosisCode_edit")("formControl",t.formControl)("authorizationDiagnosisCode",t.authorizationDiagnosisCode)}}const q_=function(){return{}};function K_(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-authorization-diagnosis-code-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","authorizationDiagnosisCode_create")("formControl",t.formControl)("authorizationDiagnosisCode",e.DdM(3,q_))}}function Z_(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-authorization-diagnosis-code-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("authorizationDiagnosisCodes",o.data.items)}let k_=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadAuthorizationDiagnosisCodesEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.authorizationDiagnosisCodes$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(dt))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e._Bn([dt]),e.qOj],decls:7,vars:5,consts:[[3,"to","control","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","authorizationDiagnosisCode","send","close"],[1,"w-full","h-full","bg-white",3,"authorizationDiagnosisCodes","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"ui-select-form",0),e.YNc(1,H_,2,3,"ng-template",null,1,e.W1O),e.YNc(3,K_,1,4,"ng-template",null,2,e.W1O),e.YNc(5,Z_,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[W.JJ,W.oH,Z.$,_r,gr],encapsulation:2}),s})();function B_(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-authorization-diagnosis-code-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","authorizationDiagnosisCode_edit")("authorizationDiagnosisCode",t.value)}}const Y_=function(){return{}};function X_(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-authorization-diagnosis-code-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","authorizationDiagnosisCode_create")("authorizationDiagnosisCode",e.DdM(2,Y_))}function eg(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-authorization-diagnosis-code-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("authorizationDiagnosisCodes",t.items)}}let tg=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:6,consts:[[3,"data","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","authorizationDiagnosisCode","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","authorizationDiagnosisCodes","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,B_,1,2,"ng-template",null,1,e.W1O),e.YNc(3,X_,1,3,"ng-template",null,2,e.W1O),e.YNc(5,eg,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,_r,gr],encapsulation:2}),s})(),ig=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[dt],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"authorization-diagnosis-code-select",component:k_,wrappers:["form-field"]},{name:"authorization-diagnosis-code-grid",component:tg}]})]}),s})(),sg=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[ig]}),s})();class ut extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class og extends ut{constructor(o,t){super("ValidateAuthorizationKindExcelDataAction"),this.valid=!1,this.excelData=o,this.categories=t}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name),this.validationContext.addRule(new f.mi(`categoryName_${i}_is_valid}`,"Category Is Not Valid","category.name",t.category,this.categories,!0))}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class ag extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class rg extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new ag("name","The authorizationkind name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class ng extends ut{constructor(o){super("CreateAuthorizationKindAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new rg("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateAuthorizationKind({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class lg extends ut{constructor(o){super("UpdateAuthorizationKindsAction"),this.authorizationKinds=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.authorizationKinds,!0))}performAction(){this.response=this.businessProvider.data.userUpdateAuthorizationKinds({input:{authorizationKinds:this.authorizationKinds}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class cg extends ut{constructor(o,t){super("UpdateAuthorizationKindAction"),this.authorizationKind=o,this.authorizationKindId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.authorizationKind,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.authorizationKindId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateAuthorizationKind({authorizationKindId:this.authorizationKindId,input:this.authorizationKind}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let Cr=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.AuthorizationKindBusinessProviderService",t,a),this.data=i}createAuthorizationKind(t){const i=new ng(t);return i.Do(this),i.response}updateAuthorizationKind(t,i){const a=new cg(t,i);return a.Do(this),a.response}importAuthorizationKinds(t){const i=new lg(t);return i.Do(this),i.response}validateAuthorizationKindExcelData(t,i){const a=new og(t,i);return a.Do(this),a.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),dg=(()=>{class s extends I.nH{constructor(t,i,a){super("AuthorizationKindService",a,t),this.businessProvider=i}createAuthorizationKind(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createAuthorizationKind(i)}updateAuthorizationKind(t,i){return this.businessProvider.updateAuthorizationKind(t,i)}importAuthorizationKinds(t){return this.businessProvider.importAuthorizationKinds(t)}validateAuthorizationKindExcelData(t,i){return this.businessProvider.validateAuthorizationKindExcelData(t,i)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(Cr,8),e.LFG(Cr),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),Ms=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){if(super({loading:!1,authorizationKinds:[],done:!1,searchQuery:"",formName:void 0,categoryId:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.authorizationKindService=H,this.errors$=this.select(d=>d.errors),this.loading$=this.select(d=>d.loading),this.done$=this.select(d=>d.done),this.item$=this.select(d=>d.item),this.authorizationKinds$=this.select(d=>d.authorizationKinds),this.categories$=this.select(d=>d.categories||[]),this.categoryId$=this.select(d=>d.categoryId),this.paging$=this.select(d=>d.paging),this.searchQuery$=this.select(d=>d.searchQuery),this.formName$=this.select(d=>d.formName),this.actionResult$=this.select(this.item$,this.done$,(d,n)=>({item:d,done:n}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.authorizationKinds$,this.categories$,(d,n,r,m,p,_)=>({errors:d,loading:n,item:r,formName:m,authorizationKinds:p,categories:_}),{debounce:!0}),this.input$=this.select(this.paging$,this.categoryId$,this.searchQuery$,(d,n,r)=>({limit:d.limit,skip:d.skip,name:r,categoryId:n,total:d.total})),this.setFormName=this.updater((d,n)=>Object.assign(Object.assign({},d),{formName:n})),this.setCategoryId=this.updater((d,n)=>Object.assign(Object.assign({},d),{categoryId:n})),this.filterCategories=d=>this.data.userSelectCategories({input:{name:d}}).pipe((0,g._b)(n=>{let r=n.data.items;return this.patchState({categories:r}),r},n=>this.patchState({errors:n.graphQLErrors?n.graphQLErrors:n})),(0,he.U)(n=>n.data.items)),this.addCategory=this.updater((d,n)=>Object.assign(Object.assign({},d),{categories:d.categories.concat(n)})),this.setItem=this.updater((d,n)=>Object.assign(Object.assign({},d),{item:n})),this.addNewAuthorizationKind=this.updater((d,n)=>Object.assign(Object.assign({},d),{authorizationKinds:[...d.authorizationKinds,n]})),this.updateAuthorizationKind=this.updater((d,n)=>Object.assign(Object.assign({},d),{authorizationKinds:d.authorizationKinds.map(r=>r.id===n.id?n:r)})),this.addAuthorizationKinds=this.updater((d,n)=>Object.assign(Object.assign({},d),{authorizationKinds:d.authorizationKinds.concat(n)})),this.updateAuthorizationKinds=this.updater((d,n)=>Object.assign(Object.assign({},d),{authorizationKinds:d.authorizationKinds.map(r=>n.find(p=>p.id===r.id)||r)})),this.setSearchQuery=this.updater((d,n)=>Object.assign(Object.assign({},d),{searchQuery:n})),this.loadAuthorizationKindEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(n=>this.data.userAuthorizationKind({authorizationKindId:n}).pipe((0,g._b)(r=>{this.patchState({item:r.data.item,errors:r.errors,loading:!1})},r=>this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})))))),this.loadAuthorizationKindsEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([n,r])=>this.data.userAuthorizationKinds({input:r}).pipe((0,g._b)(m=>this.patchState({paging:{limit:r.limit,skip:r.skip,total:m.data.count.total},authorizationKinds:m.data.items,errors:m.errors,loading:!1}),m=>this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})))))),this.createAuthorizationKindEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(n=>this.authorizationKindService.createAuthorizationKind(Object.assign({},n)).pipe((0,g._b)(r=>{this.addNewAuthorizationKind(r),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:r,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.updateAuthorizationKindEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([n,r])=>this.authorizationKindService.updateAuthorizationKind(n,n.id).pipe((0,g._b)(m=>{this.updateAuthorizationKind(m),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:m,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},m=>{m.graphQLErrors?(this.toast.error(m.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})):(this.toast.error(m.Message),this.formService.setErrors(m.Data))}))))),this.deleteAuthorizationKindEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([n,r])=>this.data.userDeleteAuthorizationKind({authorizationKindId:r.id}).pipe((0,g._b)(m=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:m.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},m=>{m.graphQLErrors?(this.toast.error(m.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})):(this.toast.error(m.Message),this.formService.setErrors(m.Data))}))))),this.importExcelEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(n=>this.authorizationKindService.importAuthorizationKinds(n).pipe((0,ce.K)(r=>{var m;return this.toast.error(null!==(m=r.Message)&&void 0!==m?m:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(r=>{const m=JSON.parse(r.created),p=JSON.parse(r.updated),_=JSON.parse(r.failed),w=m.length+p.length+_.length;this.addAuthorizationKinds(m),this.updateAuthorizationKinds(p),this.toast.success(`${m.length} created, ${p.length} updated, ${_.length} failed of total ${w}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("authorizationKindId")?(this.route.snapshot.paramMap.get("authorizationKindId"),this.setFormName("authorizationKind_edit")):this.setFormName("authorizationKind_create"),this.route.snapshot.paramMap.has("categoryId")){var c=this.route.snapshot.paramMap.get("categoryId");this.setCategoryId(c)}}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.authorizationKindService.validateAuthorizationKindExcelData(t,i.categories)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(dg))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function ug(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.authorizationKind)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let vr=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"authorizationKind_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.authorizationKind=i.item})):t.formName&&t.formName.currentValue&&"authorizationKind_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadAuthorizationKindEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.authorizationKind=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Ms),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-authorization-kind-form"]],inputs:{authorizationKind:"authorizationKind",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,ug,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),Sr=(()=>{class s{constructor(){this.autoHeight=!1,this.authorizationKinds=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[{field:"category.name",headerName:"Category",filter:"agTextColumnFilter"},{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{field:"categoryId",filter:"agTextColumnFilter",hide:!0}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-authorization-kind-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",authorizationKinds:"authorizationKinds"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.authorizationKinds)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function mg(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-authorization-kind-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","authorizationKind_edit")("formControl",t.formControl)("authorizationKind",t.authorizationKind)}}const pg=function(){return{}};function hg(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-authorization-kind-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","authorizationKind_create")("formControl",t.formControl)("authorizationKind",e.DdM(3,pg))}}function fg(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-authorization-kind-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("authorizationKinds",o.data.items)}let _g=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadAuthorizationKindsEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.authorizationKinds$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Ms))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","authorizationKind","send","close"],[1,"w-full","h-full","bg-white",3,"authorizationKinds","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,mg,2,3,"ng-template",null,1,e.W1O),e.YNc(3,hg,1,4,"ng-template",null,2,e.W1O),e.YNc(5,fg,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,vr,Sr],encapsulation:2}),s})();function gg(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-authorization-kind-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","authorizationKind_edit")("authorizationKind",t.value)}}const Cg=function(){return{}};function vg(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-authorization-kind-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","authorizationKind_create")("authorizationKind",e.DdM(2,Cg))}function Sg(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-authorization-kind-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("authorizationKinds",t.items)}}let bg=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","authorizationKind","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","authorizationKinds","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,gg,1,2,"ng-template",null,1,e.W1O),e.YNc(3,vg,1,3,"ng-template",null,2,e.W1O),e.YNc(5,Sg,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,vr,Sr],encapsulation:2}),s})(),Tg=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[Ms],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"authorization-kind-select",component:_g,wrappers:["form-field"]},{name:"authorization-kind-grid",component:bg}]})]}),s})(),yg=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[Tg]}),s})();class mt extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class wg extends mt{constructor(o){super("ValidateAuthorizationStatusExcelDataAction"),this.valid=!1,this.excelData=o}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name)}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class xg extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class Ng extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new xg("name","The authorizationstatus name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class Ag extends mt{constructor(o){super("CreateAuthorizationStatusAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new Ng("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateAuthorizationStatus({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class Fg extends mt{constructor(o){super("UpdateAuthorizationStatusesAction"),this.authorizationStatuses=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.authorizationStatuses,!0))}performAction(){this.response=this.businessProvider.data.userUpdateAuthorizationStatuses({input:{authorizationStatuses:this.authorizationStatuses}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class Pg extends mt{constructor(o,t){super("UpdateAuthorizationStatusAction"),this.authorizationStatus=o,this.authorizationStatusId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.authorizationStatus,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.authorizationStatusId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateAuthorizationStatus({authorizationStatusId:this.authorizationStatusId,input:this.authorizationStatus}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let br=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.AuthorizationStatusBusinessProviderService",t,a),this.data=i}createAuthorizationStatus(t){const i=new Ag(t);return i.Do(this),i.response}updateAuthorizationStatus(t,i){const a=new Pg(t,i);return a.Do(this),a.response}importAuthorizationStatuses(t){const i=new Fg(t);return i.Do(this),i.response}validateAuthorizationStatusExcelData(t){const i=new wg(t);return i.Do(this),i.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),Ig=(()=>{class s extends I.nH{constructor(t,i,a){super("AuthorizationStatusService",a,t),this.businessProvider=i}createAuthorizationStatus(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createAuthorizationStatus(i)}updateAuthorizationStatus(t,i){return this.businessProvider.updateAuthorizationStatus(t,i)}importAuthorizationStatuses(t){return this.businessProvider.importAuthorizationStatuses(t)}validateAuthorizationStatusExcelData(t){return this.businessProvider.validateAuthorizationStatusExcelData(t)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(br,8),e.LFG(br),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),Ws=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){super({loading:!1,authorizationStatuses:[],done:!1,searchQuery:"",formName:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.authorizationStatusService=H,this.errors$=this.select(c=>c.errors),this.loading$=this.select(c=>c.loading),this.done$=this.select(c=>c.done),this.item$=this.select(c=>c.item),this.authorizationStatuses$=this.select(c=>c.authorizationStatuses),this.paging$=this.select(c=>c.paging),this.searchQuery$=this.select(c=>c.searchQuery),this.formName$=this.select(c=>c.formName),this.actionResult$=this.select(this.item$,this.done$,(c,d)=>({item:c,done:d}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.authorizationStatuses$,(c,d,n,r,m)=>({errors:c,loading:d,item:n,formName:r,authorizationStatuses:m}),{debounce:!0}),this.input$=this.select(this.paging$,this.searchQuery$,(c,d)=>({limit:c.limit,skip:c.skip,name:d,total:c.total})),this.setFormName=this.updater((c,d)=>Object.assign(Object.assign({},c),{formName:d})),this.setItem=this.updater((c,d)=>Object.assign(Object.assign({},c),{item:d})),this.addNewAuthorizationStatus=this.updater((c,d)=>Object.assign(Object.assign({},c),{authorizationStatuses:[...c.authorizationStatuses,d]})),this.updateAuthorizationStatus=this.updater((c,d)=>Object.assign(Object.assign({},c),{authorizationStatuses:c.authorizationStatuses.map(n=>n.id===d.id?d:n)})),this.addAuthorizationStatuses=this.updater((c,d)=>Object.assign(Object.assign({},c),{authorizationStatuses:c.authorizationStatuses.concat(d)})),this.updateAuthorizationStatuses=this.updater((c,d)=>Object.assign(Object.assign({},c),{authorizationStatuses:c.authorizationStatuses.map(n=>d.find(m=>m.id===n.id)||n)})),this.setSearchQuery=this.updater((c,d)=>Object.assign(Object.assign({},c),{searchQuery:d})),this.loadAuthorizationStatusEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.data.userAuthorizationStatus({authorizationStatusId:d}).pipe((0,g._b)(n=>{this.patchState({item:n.data.item,errors:n.errors,loading:!1})},n=>this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})))))),this.loadAuthorizationStatusesEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([d,n])=>this.data.userAuthorizationStatuses({input:n}).pipe((0,g._b)(r=>this.patchState({paging:{limit:n.limit,skip:n.skip,total:r.data.count.total},authorizationStatuses:r.data.items,errors:r.errors,loading:!1}),r=>this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})))))),this.createAuthorizationStatusEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.authorizationStatusService.createAuthorizationStatus(Object.assign({},d)).pipe((0,g._b)(n=>{this.addNewAuthorizationStatus(n),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:n,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},n=>{n.graphQLErrors?(this.toast.error(n.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})):(this.toast.error(n.Message),this.formService.setErrors(n.Data))}))))),this.updateAuthorizationStatusEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.authorizationStatusService.updateAuthorizationStatus(d,d.id).pipe((0,g._b)(r=>{this.updateAuthorizationStatus(r),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:r,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.deleteAuthorizationStatusEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.data.userDeleteAuthorizationStatus({authorizationStatusId:n.id}).pipe((0,g._b)(r=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:r.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.importExcelEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.authorizationStatusService.importAuthorizationStatuses(d).pipe((0,ce.K)(n=>{var r;return this.toast.error(null!==(r=n.Message)&&void 0!==r?r:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(n=>{const r=JSON.parse(n.created),m=JSON.parse(n.updated),p=JSON.parse(n.failed),_=r.length+m.length+p.length;this.addAuthorizationStatuses(r),this.updateAuthorizationStatuses(m),this.toast.success(`${r.length} created, ${m.length} updated, ${p.length} failed of total ${_}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("authorizationStatusId")?(this.route.snapshot.paramMap.get("authorizationStatusId"),this.setFormName("authorizationStatus_edit")):this.setFormName("authorizationStatus_create")}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.authorizationStatusService.validateAuthorizationStatusExcelData(t)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(Ig))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function Dg(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.authorizationStatus)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let Tr=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"authorizationStatus_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.authorizationStatus=i.item})):t.formName&&t.formName.currentValue&&"authorizationStatus_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadAuthorizationStatusEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.authorizationStatus=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Ws),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-authorization-status-form"]],inputs:{authorizationStatus:"authorizationStatus",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,Dg,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),yr=(()=>{class s{constructor(){this.autoHeight=!1,this.authorizationStatuses=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[,{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-authorization-status-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",authorizationStatuses:"authorizationStatuses"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.authorizationStatuses)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function Mg(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-authorization-status-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","authorizationStatus_edit")("formControl",t.formControl)("authorizationStatus",t.authorizationStatus)}}const Wg=function(){return{}};function Eg(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-authorization-status-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","authorizationStatus_create")("formControl",t.formControl)("authorizationStatus",e.DdM(3,Wg))}}function Og(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-authorization-status-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("authorizationStatuses",o.data.items)}let Lg=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadAuthorizationStatusesEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.authorizationStatuses$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Ws))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","authorizationStatus","send","close"],[1,"w-full","h-full","bg-white",3,"authorizationStatuses","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,Mg,2,3,"ng-template",null,1,e.W1O),e.YNc(3,Eg,1,4,"ng-template",null,2,e.W1O),e.YNc(5,Og,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,Tr,yr],encapsulation:2}),s})();function $g(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-authorization-status-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","authorizationStatus_edit")("authorizationStatus",t.value)}}const Gg=function(){return{}};function Rg(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-authorization-status-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","authorizationStatus_create")("authorizationStatus",e.DdM(2,Gg))}function Qg(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-authorization-status-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("authorizationStatuses",t.items)}}let Vg=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","authorizationStatus","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","authorizationStatuses","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,$g,1,2,"ng-template",null,1,e.W1O),e.YNc(3,Rg,1,3,"ng-template",null,2,e.W1O),e.YNc(5,Qg,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,Tr,yr],encapsulation:2}),s})(),jg=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[Ws],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"authorization-status-select",component:Lg,wrappers:["form-field"]},{name:"authorization-status-grid",component:Vg}]})]}),s})(),Ug=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[jg]}),s})();class pt extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class Jg extends pt{constructor(o){super("ValidateAuthorizationTypeExcelDataAction"),this.valid=!1,this.excelData=o}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name)}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class zg extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class Hg extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new zg("name","The authorizationtype name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class qg extends pt{constructor(o){super("CreateAuthorizationTypeAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new Hg("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateAuthorizationType({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class Kg extends pt{constructor(o){super("UpdateAuthorizationTypesAction"),this.authorizationTypes=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.authorizationTypes,!0))}performAction(){this.response=this.businessProvider.data.userUpdateAuthorizationTypes({input:{authorizationTypes:this.authorizationTypes}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class Zg extends pt{constructor(o,t){super("UpdateAuthorizationTypeAction"),this.authorizationType=o,this.authorizationTypeId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.authorizationType,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.authorizationTypeId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateAuthorizationType({authorizationTypeId:this.authorizationTypeId,input:this.authorizationType}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let wr=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.AuthorizationTypeBusinessProviderService",t,a),this.data=i}createAuthorizationType(t){const i=new qg(t);return i.Do(this),i.response}updateAuthorizationType(t,i){const a=new Zg(t,i);return a.Do(this),a.response}importAuthorizationTypes(t){const i=new Kg(t);return i.Do(this),i.response}validateAuthorizationTypeExcelData(t){const i=new Jg(t);return i.Do(this),i.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),kg=(()=>{class s extends I.nH{constructor(t,i,a){super("AuthorizationTypeService",a,t),this.businessProvider=i}createAuthorizationType(t){return this.businessProvider.createAuthorizationType(t)}updateAuthorizationType(t,i){return this.businessProvider.updateAuthorizationType(t,i)}importAuthorizationTypes(t){return this.businessProvider.importAuthorizationTypes(t)}validateAuthorizationTypeExcelData(t){return this.businessProvider.validateAuthorizationTypeExcelData(t)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(wr,8),e.LFG(wr),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),ht=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){super({loading:!1,authorizationTypes:[],done:!1,searchQuery:"",formName:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.authorizationTypeService=H,this.errors$=this.select(c=>c.errors),this.loading$=this.select(c=>c.loading),this.done$=this.select(c=>c.done),this.item$=this.select(c=>c.item),this.authorizationTypes$=this.select(c=>c.authorizationTypes),this.paging$=this.select(c=>c.paging),this.searchQuery$=this.select(c=>c.searchQuery),this.formName$=this.select(c=>c.formName),this.actionResult$=this.select(this.item$,this.done$,(c,d)=>({item:c,done:d}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.authorizationTypes$,(c,d,n,r,m)=>({errors:c,loading:d,item:n,formName:r,authorizationTypes:m}),{debounce:!0}),this.input$=this.select(this.paging$,this.searchQuery$,(c,d)=>({limit:c.limit,skip:c.skip,name:d,total:c.total})),this.setFormName=this.updater((c,d)=>Object.assign(Object.assign({},c),{formName:d})),this.setItem=this.updater((c,d)=>Object.assign(Object.assign({},c),{item:d})),this.addNewAuthorizationType=this.updater((c,d)=>Object.assign(Object.assign({},c),{authorizationTypes:[...c.authorizationTypes,d]})),this.updateAuthorizationType=this.updater((c,d)=>Object.assign(Object.assign({},c),{authorizationTypes:c.authorizationTypes.map(n=>n.id===d.id?d:n)})),this.addAuthorizationTypes=this.updater((c,d)=>Object.assign(Object.assign({},c),{authorizationTypes:c.authorizationTypes.concat(d)})),this.updateAuthorizationTypes=this.updater((c,d)=>Object.assign(Object.assign({},c),{authorizationTypes:c.authorizationTypes.map(n=>d.find(m=>m.id===n.id)||n)})),this.setSearchQuery=this.updater((c,d)=>Object.assign(Object.assign({},c),{searchQuery:d})),this.loadAuthorizationTypeEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.data.userAuthorizationType({authorizationTypeId:d}).pipe((0,g._b)(n=>{this.patchState({item:n.data.item,errors:n.errors,loading:!1})},n=>this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})))))),this.loadAuthorizationTypesEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([d,n])=>this.data.userAuthorizationTypes({input:n}).pipe((0,g._b)(r=>{this.patchState({paging:{limit:n.limit,skip:n.skip,total:r.data.count.total},authorizationTypes:r.data.items,errors:r.errors,loading:!1})},r=>this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})))))),this.createAuthorizationTypeEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.authorizationTypeService.createAuthorizationType(Object.assign({},d)).pipe((0,g._b)(n=>{this.addNewAuthorizationType(n),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:n,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},n=>{n.graphQLErrors?(this.toast.error(n.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})):(this.toast.error(n.Message),this.formService.setErrors(n.Data))}))))),this.updateAuthorizationTypeEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.authorizationTypeService.updateAuthorizationType(d,d.id).pipe((0,g._b)(r=>{this.updateAuthorizationType(r),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:r,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.deleteAuthorizationTypeEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.data.userDeleteAuthorizationType({authorizationTypeId:n.id}).pipe((0,g._b)(r=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:r.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.importExcelEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.authorizationTypeService.importAuthorizationTypes(d).pipe((0,ce.K)(n=>{var r;return this.toast.error(null!==(r=n.Message)&&void 0!==r?r:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(n=>{const r=JSON.parse(n.created),m=JSON.parse(n.updated),p=JSON.parse(n.failed),_=r.length+m.length+p.length;this.addAuthorizationTypes(r),this.updateAuthorizationTypes(m),this.toast.success(`${r.length} created, ${m.length} updated, ${p.length} failed of total ${_}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("authorizationTypeId")?(this.route.snapshot.paramMap.get("authorizationTypeId"),this.setFormName("authorizationType_edit")):this.setFormName("authorizationType_create")}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.authorizationTypeService.validateAuthorizationTypeExcelData(t)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(kg))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function Bg(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.authorizationType)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let xr=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"authorizationType_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({id:null,name:""}),this.store.vm$.subscribe(i=>{this.authorizationType=i.item})):t.formName&&t.formName.currentValue&&"authorizationType_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadAuthorizationTypeEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.authorizationType=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(ht),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-authorization-type-form"]],inputs:{authorizationType:"authorizationType",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,Bg,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),Nr=(()=>{class s{constructor(){this.autoHeight=!1,this.authorizationTypes=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[,{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-authorization-type-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",authorizationTypes:"authorizationTypes"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:6,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.authorizationTypes)("showSidebar",!1)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function Yg(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-authorization-type-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","authorizationType_edit")("formControl",t.formControl)("authorizationType",t.authorizationType)}}const Xg=function(){return{}};function eC(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-authorization-type-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","authorizationType_create")("formControl",t.formControl)("authorizationType",e.DdM(3,Xg))}}function tC(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-authorization-type-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("authorizationTypes",o.data.items)}let iC=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadAuthorizationTypesEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.authorizationTypes$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(ht))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e._Bn([ht]),e.qOj],decls:7,vars:5,consts:[[3,"to","control","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","authorizationType","send","close"],[1,"w-full","h-full","bg-white",3,"authorizationTypes","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"ui-select-form",0),e.YNc(1,Yg,2,3,"ng-template",null,1,e.W1O),e.YNc(3,eC,1,4,"ng-template",null,2,e.W1O),e.YNc(5,tC,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[W.JJ,W.oH,Z.$,xr,Nr],encapsulation:2}),s})();function sC(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-authorization-type-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","authorizationType_edit")("authorizationType",t.value)}}const oC=function(){return{}};function aC(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-authorization-type-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","authorizationType_create")("authorizationType",e.DdM(2,oC))}function rC(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-authorization-type-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("authorizationTypes",t.items)}}let nC=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:6,consts:[[3,"data","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","authorizationType","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","authorizationTypes","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,sC,1,2,"ng-template",null,1,e.W1O),e.YNc(3,aC,1,3,"ng-template",null,2,e.W1O),e.YNc(5,rC,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,xr,Nr],encapsulation:2}),s})(),lC=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[ht],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"authorization-type-select",component:iC,wrappers:["form-field"]},{name:"authorization-type-grid",component:nC}]})]}),s})(),cC=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[lC]}),s})();class ft extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class dC extends ft{constructor(o,t,i){super("ValidateBalanceRequestExcelDataAction"),this.valid=!1,this.excelData=o,this.statements=t,this.legalCases=i}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name),this.validationContext.addRule(new f.mi(`statementName_${i}_is_valid}`,"Statement Is Not Valid","statement.name",t.statement,this.statements,!0)),this.validationContext.addRule(new f.mi(`legalCaseName_${i}_is_valid}`,"Legal Case Is Not Valid","legalCase.name",t.legalCase,this.legalCases,!0))}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class uC extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class mC extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new uC("name","The balancerequest name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class pC extends ft{constructor(o){super("CreateBalanceRequestAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new mC("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateBalanceRequest({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class hC extends ft{constructor(o){super("UpdateBalanceRequestsAction"),this.balanceRequests=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.balanceRequests,!0))}performAction(){this.response=this.businessProvider.data.userUpdateBalanceRequests({input:{balanceRequests:this.balanceRequests}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class fC extends ft{constructor(o,t){super("UpdateBalanceRequestAction"),this.balanceRequest=o,this.balanceRequestId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.balanceRequest,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.balanceRequestId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateBalanceRequest({balanceRequestId:this.balanceRequestId,input:this.balanceRequest}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let Ar=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.BalanceRequestBusinessProviderService",t,a),this.data=i}createBalanceRequest(t){console.log("input",t);const i=new pC(t);return i.Do(this),i.response}updateBalanceRequest(t,i){const a=new fC(t,i);return a.Do(this),a.response}importBalanceRequests(t){const i=new hC(t);return i.Do(this),i.response}validateBalanceRequestExcelData(t,i,a){const l=new dC(t,i,a);return l.Do(this),l.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),_C=(()=>{class s extends I.nH{constructor(t,i,a){super("BalanceRequestService",a,t),this.businessProvider=i}createBalanceRequest(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createBalanceRequest(i)}updateBalanceRequest(t,i){return this.businessProvider.updateBalanceRequest(t,i)}importBalanceRequests(t){return this.businessProvider.importBalanceRequests(t)}validateBalanceRequestExcelData(t,i,a){return this.businessProvider.validateBalanceRequestExcelData(t,i,a)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(Ar,8),e.LFG(Ar),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),Es=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){if(super({loading:!1,balanceRequests:[],done:!1,searchQuery:"",formName:void 0,statementId:void 0,legalCaseId:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.balanceRequestService=H,this.errors$=this.select(r=>r.errors),this.loading$=this.select(r=>r.loading),this.done$=this.select(r=>r.done),this.item$=this.select(r=>r.item),this.balanceRequests$=this.select(r=>r.balanceRequests),this.documents$=this.select(r=>r.documents||[]),this.legalCases$=this.select(r=>r.legalCases||[]),this.statementId$=this.select(r=>r.statementId),this.legalCaseId$=this.select(r=>r.legalCaseId),this.paging$=this.select(r=>r.paging),this.searchQuery$=this.select(r=>r.searchQuery),this.formName$=this.select(r=>r.formName),this.actionResult$=this.select(this.item$,this.done$,(r,m)=>({item:r,done:m}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.balanceRequests$,this.documents$,this.legalCases$,(r,m,p,_,w,J,_e)=>({errors:r,loading:m,item:p,formName:_,balanceRequests:w,documents:J,legalCases:_e}),{debounce:!0}),this.input$=this.select(this.paging$,this.statementId$,this.legalCaseId$,this.searchQuery$,(r,m,p,_)=>({limit:r.limit,skip:r.skip,name:_,statementId:m,legalCaseId:p,total:r.total})),this.setFormName=this.updater((r,m)=>Object.assign(Object.assign({},r),{formName:m})),this.setStatementId=this.updater((r,m)=>Object.assign(Object.assign({},r),{statementId:m})),this.setAttorneyId=this.updater((r,m)=>Object.assign(Object.assign({},r),{attorneyId:m})),this.setLegalCaseId=this.updater((r,m)=>Object.assign(Object.assign({},r),{legalCaseId:m})),this.filterDocuments=r=>this.data.userSelectDocuments({input:{name:r}}).pipe((0,g._b)(m=>{let p=m.data.items;return this.patchState({documents:p}),p},m=>this.patchState({errors:m.graphQLErrors?m.graphQLErrors:m})),(0,he.U)(m=>m.data.items)),this.filterLegalCases=r=>this.data.userSelectLegalCases({input:{name:r}}).pipe((0,g._b)(m=>{let p=m.data.items;return this.patchState({legalCases:p}),p},m=>this.patchState({errors:m.graphQLErrors?m.graphQLErrors:m})),(0,he.U)(m=>m.data.items)),this.addDocument=this.updater((r,m)=>Object.assign(Object.assign({},r),{documents:r.documents.concat(m)})),this.addLegalCase=this.updater((r,m)=>Object.assign(Object.assign({},r),{legalCases:r.legalCases.concat(m)})),this.setItem=this.updater((r,m)=>Object.assign(Object.assign({},r),{item:m})),this.addNewBalanceRequest=this.updater((r,m)=>Object.assign(Object.assign({},r),{balanceRequests:[...r.balanceRequests,m]})),this.updateBalanceRequest=this.updater((r,m)=>Object.assign(Object.assign({},r),{balanceRequests:r.balanceRequests.map(p=>p.id===m.id?m:p)})),this.addBalanceRequests=this.updater((r,m)=>Object.assign(Object.assign({},r),{balanceRequests:r.balanceRequests.concat(m)})),this.updateBalanceRequests=this.updater((r,m)=>Object.assign(Object.assign({},r),{balanceRequests:r.balanceRequests.map(p=>m.find(w=>w.id===p.id)||p)})),this.setSearchQuery=this.updater((r,m)=>Object.assign(Object.assign({},r),{searchQuery:m})),this.loadBalanceRequestEffect=this.effect(r=>r.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(m=>this.data.userBalanceRequest({balanceRequestId:m}).pipe((0,g._b)(p=>{this.patchState({item:p.data.item,errors:p.errors,loading:!1})},p=>this.patchState({loading:!1,errors:p.graphQLErrors?p.graphQLErrors:p})))))),this.loadBalanceRequestsEffect=this.effect(r=>r.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([m,p])=>this.data.userBalanceRequests({input:p}).pipe((0,g._b)(_=>this.patchState({paging:{limit:p.limit,skip:p.skip,total:_.data.count.total},balanceRequests:_.data.items,errors:_.errors,loading:!1}),_=>this.patchState({loading:!1,errors:_.graphQLErrors?_.graphQLErrors:_})))))),this.createBalanceRequestEffect=this.effect(r=>r.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(m=>this.balanceRequestService.createBalanceRequest(Object.assign({},m)).pipe((0,g._b)(p=>{this.addNewBalanceRequest(p),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:p,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},p=>{p.graphQLErrors?(this.toast.error(p.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:p.graphQLErrors?p.graphQLErrors:p})):(this.toast.error(p.Message),this.formService.setErrors(p.Data))}))))),this.updateBalanceRequestEffect=this.effect(r=>r.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([m,p])=>this.balanceRequestService.updateBalanceRequest(m,m.id).pipe((0,g._b)(_=>{this.updateBalanceRequest(_),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:_,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},_=>{_.graphQLErrors?(this.toast.error(_.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:_.graphQLErrors?_.graphQLErrors:_})):(this.toast.error(_.Message),this.formService.setErrors(_.Data))}))))),this.deleteBalanceRequestEffect=this.effect(r=>r.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([m,p])=>this.data.userDeleteBalanceRequest({balanceRequestId:p.id}).pipe((0,g._b)(_=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:_.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},_=>{_.graphQLErrors?(this.toast.error(_.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:_.graphQLErrors?_.graphQLErrors:_})):(this.toast.error(_.Message),this.formService.setErrors(_.Data))}))))),this.importExcelEffect=this.effect(r=>r.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(m=>this.balanceRequestService.importBalanceRequests(m).pipe((0,ce.K)(p=>{var _;return this.toast.error(null!==(_=p.Message)&&void 0!==_?_:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(p=>{const _=JSON.parse(p.created),w=JSON.parse(p.updated),J=JSON.parse(p.failed),_e=_.length+w.length+J.length;this.addBalanceRequests(_),this.updateBalanceRequests(w),this.toast.success(`${_.length} created, ${w.length} updated, ${J.length} failed of total ${_e}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("balanceRequestId")?(this.route.snapshot.paramMap.get("balanceRequestId"),this.setFormName("balanceRequest_edit")):this.setFormName("balanceRequest_create"),this.route.snapshot.paramMap.has("statementId")){var c=this.route.snapshot.paramMap.get("statementId");this.setStatementId(c)}if(this.route.snapshot.paramMap.has("legalCaseId")){var d=this.route.snapshot.paramMap.get("legalCaseId");this.setLegalCaseId(d)}if(this.route.snapshot.paramMap.has("attorneyId")){var n=this.route.snapshot.paramMap.get("attorneyId");this.setAttorneyId(n)}}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.balanceRequestService.validateBalanceRequestExcelData(t,i.documents,i.legalCases)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(_C))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function gC(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.balanceRequest)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let Fr=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"balanceRequest_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({id:null,name:""}),this.store.vm$.subscribe(i=>{this.balanceRequest=i.item})):t.formName&&t.formName.currentValue&&"balanceRequest_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadBalanceRequestEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.balanceRequest=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Es),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-balance-request-form"]],inputs:{balanceRequest:"balanceRequest",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,gC,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),Pr=(()=>{class s{constructor(){this.autoHeight=!1,this.balanceRequests=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[{field:"statement.name",headerName:"Statement",filter:"agTextColumnFilter"},{field:"legalCase.name",headerName:"Legal Case",filter:"agTextColumnFilter"},{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{field:"requestedOn",filter:"agDateColumnFilter"},{field:"repliedOn",filter:"agDateColumnFilter"},{field:"status",filter:"agTextColumnFilter"},{field:"statementId",filter:"agTextColumnFilter",hide:!0},{field:"type",filter:"agTextColumnFilter"},{headerName:"Balance Amount",field:"balanceAmount",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.balanceAmount,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{field:"legalCaseId",filter:"agTextColumnFilter",hide:!0}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-balance-request-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",balanceRequests:"balanceRequests"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.balanceRequests)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function CC(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-balance-request-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","balanceRequest_edit")("formControl",t.formControl)("balanceRequest",t.balanceRequest)}}const vC=function(){return{}};function SC(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-balance-request-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","balanceRequest_create")("formControl",t.formControl)("balanceRequest",e.DdM(3,vC))}}function bC(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-balance-request-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("balanceRequests",o.data.items)}let TC=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadBalanceRequestsEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.balanceRequests$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Es))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","balanceRequest","send","close"],[1,"w-full","h-full","bg-white",3,"balanceRequests","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,CC,2,3,"ng-template",null,1,e.W1O),e.YNc(3,SC,1,4,"ng-template",null,2,e.W1O),e.YNc(5,bC,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,Fr,Pr],encapsulation:2}),s})();function yC(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-balance-request-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","balanceRequest_edit")("balanceRequest",t.value)}}const wC=function(){return{}};function xC(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-balance-request-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","balanceRequest_create")("balanceRequest",e.DdM(2,wC))}function NC(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-balance-request-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("balanceRequests",t.items)}}let AC=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:6,consts:[[3,"data","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","balanceRequest","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","balanceRequests","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,yC,1,2,"ng-template",null,1,e.W1O),e.YNc(3,xC,1,3,"ng-template",null,2,e.W1O),e.YNc(5,NC,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,Fr,Pr],encapsulation:2}),s})(),FC=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[Es],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"balance-request-select",component:TC,wrappers:["form-field"]},{name:"balance-request-grid",component:AC}]})]}),s})(),PC=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[FC]}),s})();class _t extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class IC extends _t{constructor(o){super("ValidateBankExcelDataAction"),this.valid=!1,this.excelData=o}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name)}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class DC extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class MC extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new DC("name","The bank name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class WC extends _t{constructor(o){super("CreateBankAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new MC("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateBank({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class EC extends _t{constructor(o){super("UpdateBanksAction"),this.banks=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.banks,!0))}performAction(){this.response=this.businessProvider.data.userUpdateBanks({input:{banks:this.banks}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class OC extends _t{constructor(o,t){super("UpdateBankAction"),this.bank=o,this.bankId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.bank,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.bankId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateBank({bankId:this.bankId,input:this.bank}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let Ir=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.BankBusinessProviderService",t,a),this.data=i}createBank(t){const i=new WC(t);return i.Do(this),i.response}updateBank(t,i){const a=new OC(t,i);return a.Do(this),a.response}importBanks(t){const i=new EC(t);return i.Do(this),i.response}validateBankExcelData(t){const i=new IC(t);return i.Do(this),i.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),LC=(()=>{class s extends I.nH{constructor(t,i,a){super("BankService",a,t),this.businessProvider=i}createBank(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createBank(i)}updateBank(t,i){return this.businessProvider.updateBank(t,i)}importBanks(t){return this.businessProvider.importBanks(t)}validateBankExcelData(t){return this.businessProvider.validateBankExcelData(t)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(Ir,8),e.LFG(Ir),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),Os=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){super({loading:!1,banks:[],done:!1,searchQuery:"",formName:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.bankService=H,this.errors$=this.select(c=>c.errors),this.loading$=this.select(c=>c.loading),this.done$=this.select(c=>c.done),this.item$=this.select(c=>c.item),this.banks$=this.select(c=>c.banks),this.paging$=this.select(c=>c.paging),this.searchQuery$=this.select(c=>c.searchQuery),this.formName$=this.select(c=>c.formName),this.actionResult$=this.select(this.item$,this.done$,(c,d)=>({item:c,done:d}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.banks$,(c,d,n,r,m)=>({errors:c,loading:d,item:n,formName:r,banks:m}),{debounce:!0}),this.input$=this.select(this.paging$,this.searchQuery$,(c,d)=>({limit:c.limit,skip:c.skip,name:d,total:c.total})),this.setFormName=this.updater((c,d)=>Object.assign(Object.assign({},c),{formName:d})),this.setItem=this.updater((c,d)=>Object.assign(Object.assign({},c),{item:d})),this.addNewBank=this.updater((c,d)=>Object.assign(Object.assign({},c),{banks:[...c.banks,d]})),this.updateBank=this.updater((c,d)=>Object.assign(Object.assign({},c),{banks:c.banks.map(n=>n.id===d.id?d:n)})),this.addBanks=this.updater((c,d)=>Object.assign(Object.assign({},c),{banks:c.banks.concat(d)})),this.updateBanks=this.updater((c,d)=>Object.assign(Object.assign({},c),{banks:c.banks.map(n=>d.find(m=>m.id===n.id)||n)})),this.setSearchQuery=this.updater((c,d)=>Object.assign(Object.assign({},c),{searchQuery:d})),this.loadBankEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.data.userBank({bankId:d}).pipe((0,g._b)(n=>{this.patchState({item:n.data.item,errors:n.errors,loading:!1})},n=>this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})))))),this.loadBanksEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([d,n])=>this.data.userBanks({input:n}).pipe((0,g._b)(r=>this.patchState({paging:{limit:n.limit,skip:n.skip,total:r.data.count.total},banks:r.data.items,errors:r.errors,loading:!1}),r=>this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})))))),this.createBankEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.bankService.createBank(Object.assign({},d)).pipe((0,g._b)(n=>{this.addNewBank(n),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:n,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},n=>{n.graphQLErrors?(this.toast.error(n.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})):(this.toast.error(n.Message),this.formService.setErrors(n.Data))}))))),this.updateBankEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.bankService.updateBank(d,d.id).pipe((0,g._b)(r=>{this.updateBank(r),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:r,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.deleteBankEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.data.userDeleteBank({bankId:n.id}).pipe((0,g._b)(r=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:r.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.importExcelEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.bankService.importBanks(d).pipe((0,ce.K)(n=>{var r;return this.toast.error(null!==(r=n.Message)&&void 0!==r?r:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(n=>{const r=JSON.parse(n.created),m=JSON.parse(n.updated),p=JSON.parse(n.failed),_=r.length+m.length+p.length;this.addBanks(r),this.updateBanks(m),this.toast.success(`${r.length} created, ${m.length} updated, ${p.length} failed of total ${_}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("bankId")?(this.route.snapshot.paramMap.get("bankId"),this.setFormName("bank_edit")):this.setFormName("bank_create")}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.bankService.validateBankExcelData(t)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(LC))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function $C(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.bank)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let Dr=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"bank_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.bank=i.item})):t.formName&&t.formName.currentValue&&"bank_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadBankEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.bank=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Os),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-bank-form"]],inputs:{bank:"bank",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,$C,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),Mr=(()=>{class s{constructor(){this.autoHeight=!1,this.banks=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[,{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-bank-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",banks:"banks"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.banks)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function GC(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-bank-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","bank_edit")("formControl",t.formControl)("bank",t.bank)}}const RC=function(){return{}};function QC(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-bank-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","bank_create")("formControl",t.formControl)("bank",e.DdM(3,RC))}}function VC(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-bank-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("banks",o.data.items)}let jC=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadBanksEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.banks$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Os))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","bank","send","close"],[1,"w-full","h-full","bg-white",3,"banks","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,GC,2,3,"ng-template",null,1,e.W1O),e.YNc(3,QC,1,4,"ng-template",null,2,e.W1O),e.YNc(5,VC,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,Dr,Mr],encapsulation:2}),s})();function UC(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-bank-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","bank_edit")("bank",t.value)}}const JC=function(){return{}};function zC(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-bank-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","bank_create")("bank",e.DdM(2,JC))}function HC(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-bank-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("banks",t.items)}}let qC=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","bank","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","banks","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,UC,1,2,"ng-template",null,1,e.W1O),e.YNc(3,zC,1,3,"ng-template",null,2,e.W1O),e.YNc(5,HC,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,Dr,Mr],encapsulation:2}),s})(),KC=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[Os],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"bank-select",component:jC,wrappers:["form-field"]},{name:"bank-grid",component:qC}]})]}),s})(),ZC=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[KC]}),s})();class gt extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class kC extends gt{constructor(o){super("ValidateBatchControlExcelDataAction"),this.valid=!1,this.excelData=o}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name)}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class BC extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class YC extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new BC("name","The batchcontrol name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class XC extends gt{constructor(o){super("CreateBatchControlAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new YC("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateBatchControl({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class ev extends gt{constructor(o){super("UpdateBatchControlsAction"),this.batchControls=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.batchControls,!0))}performAction(){this.response=this.businessProvider.data.userUpdateBatchControls({input:{batchControls:this.batchControls}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class tv extends gt{constructor(o,t){super("UpdateBatchControlAction"),this.batchControl=o,this.batchControlId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.batchControl,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.batchControlId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateBatchControl({batchControlId:this.batchControlId,input:this.batchControl}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let Wr=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.BatchControlBusinessProviderService",t,a),this.data=i}createBatchControl(t){const i=new XC(t);return i.Do(this),i.response}updateBatchControl(t,i){const a=new tv(t,i);return a.Do(this),a.response}importBatchControls(t){const i=new ev(t);return i.Do(this),i.response}validateBatchControlExcelData(t){const i=new kC(t);return i.Do(this),i.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),iv=(()=>{class s extends I.nH{constructor(t,i,a){super("BatchControlService",a,t),this.businessProvider=i}createBatchControl(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createBatchControl(i)}updateBatchControl(t,i){return this.businessProvider.updateBatchControl(t,i)}importBatchControls(t){return this.businessProvider.importBatchControls(t)}validateBatchControlExcelData(t){return this.businessProvider.validateBatchControlExcelData(t)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(Wr,8),e.LFG(Wr),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),Ls=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){super({loading:!1,batchControls:[],done:!1,searchQuery:"",formName:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.batchControlService=H,this.errors$=this.select(c=>c.errors),this.loading$=this.select(c=>c.loading),this.done$=this.select(c=>c.done),this.item$=this.select(c=>c.item),this.batchControls$=this.select(c=>c.batchControls),this.paging$=this.select(c=>c.paging),this.searchQuery$=this.select(c=>c.searchQuery),this.formName$=this.select(c=>c.formName),this.actionResult$=this.select(this.item$,this.done$,(c,d)=>({item:c,done:d}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.batchControls$,(c,d,n,r,m)=>({errors:c,loading:d,item:n,formName:r,batchControls:m}),{debounce:!0}),this.input$=this.select(this.paging$,this.searchQuery$,(c,d)=>({limit:c.limit,skip:c.skip,name:d,total:c.total})),this.setFormName=this.updater((c,d)=>Object.assign(Object.assign({},c),{formName:d})),this.setItem=this.updater((c,d)=>Object.assign(Object.assign({},c),{item:d})),this.addNewBatchControl=this.updater((c,d)=>Object.assign(Object.assign({},c),{batchControls:[...c.batchControls,d]})),this.updateBatchControl=this.updater((c,d)=>Object.assign(Object.assign({},c),{batchControls:c.batchControls.map(n=>n.id===d.id?d:n)})),this.addBatchControls=this.updater((c,d)=>Object.assign(Object.assign({},c),{batchControls:c.batchControls.concat(d)})),this.updateBatchControls=this.updater((c,d)=>Object.assign(Object.assign({},c),{batchControls:c.batchControls.map(n=>d.find(m=>m.id===n.id)||n)})),this.setSearchQuery=this.updater((c,d)=>Object.assign(Object.assign({},c),{searchQuery:d})),this.loadBatchControlEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.data.userBatchControl({batchControlId:d}).pipe((0,g._b)(n=>{this.patchState({item:n.data.item,errors:n.errors,loading:!1})},n=>this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})))))),this.loadBatchControlsEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([d,n])=>this.data.userBatchControls({input:n}).pipe((0,g._b)(r=>this.patchState({paging:{limit:n.limit,skip:n.skip,total:r.data.count.total},batchControls:r.data.items,errors:r.errors,loading:!1}),r=>this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})))))),this.createBatchControlEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.batchControlService.createBatchControl(Object.assign({},d)).pipe((0,g._b)(n=>{this.addNewBatchControl(n),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:n,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},n=>{n.graphQLErrors?(this.toast.error(n.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})):(this.toast.error(n.Message),this.formService.setErrors(n.Data))}))))),this.updateBatchControlEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.batchControlService.updateBatchControl(d,d.id).pipe((0,g._b)(r=>{this.updateBatchControl(r),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:r,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.deleteBatchControlEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.data.userDeleteBatchControl({batchControlId:n.id}).pipe((0,g._b)(r=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:r.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.importExcelEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.batchControlService.importBatchControls(d).pipe((0,ce.K)(n=>{var r;return this.toast.error(null!==(r=n.Message)&&void 0!==r?r:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(n=>{const r=JSON.parse(n.created),m=JSON.parse(n.updated),p=JSON.parse(n.failed),_=r.length+m.length+p.length;this.addBatchControls(r),this.updateBatchControls(m),this.toast.success(`${r.length} created, ${m.length} updated, ${p.length} failed of total ${_}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("batchControlId")?(this.route.snapshot.paramMap.get("batchControlId"),this.setFormName("batchControl_edit")):this.setFormName("batchControl_create")}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.batchControlService.validateBatchControlExcelData(t)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(iv))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function sv(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.batchControl)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let Er=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"batchControl_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.batchControl=i.item})):t.formName&&t.formName.currentValue&&"batchControl_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadBatchControlEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.batchControl=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Ls),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-batch-control-form"]],inputs:{batchControl:"batchControl",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,sv,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),Or=(()=>{class s{constructor(){this.autoHeight=!1,this.batchControls=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[,{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{field:"trackingNumber",filter:"agTextColumnFilter"},{headerName:"Batch Total",field:"batchTotal",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.batchTotal,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{field:"defaultGLCode",filter:"agTextColumnFilter"},{headerName:"Posted",field:"posted",filter:"agSetColumnFilter",cellRenderer:"checkboxRenderer"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-batch-control-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",batchControls:"batchControls"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.batchControls)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function ov(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-batch-control-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","batchControl_edit")("formControl",t.formControl)("batchControl",t.batchControl)}}const av=function(){return{}};function rv(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-batch-control-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","batchControl_create")("formControl",t.formControl)("batchControl",e.DdM(3,av))}}function nv(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-batch-control-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("batchControls",o.data.items)}let lv=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadBatchControlsEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.batchControls$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Ls))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","batchControl","send","close"],[1,"w-full","h-full","bg-white",3,"batchControls","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,ov,2,3,"ng-template",null,1,e.W1O),e.YNc(3,rv,1,4,"ng-template",null,2,e.W1O),e.YNc(5,nv,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,Er,Or],encapsulation:2}),s})();function cv(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-batch-control-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","batchControl_edit")("batchControl",t.value)}}const dv=function(){return{}};function uv(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-batch-control-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","batchControl_create")("batchControl",e.DdM(2,dv))}function mv(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-batch-control-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("batchControls",t.items)}}let pv=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","batchControl","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","batchControls","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,cv,1,2,"ng-template",null,1,e.W1O),e.YNc(3,uv,1,3,"ng-template",null,2,e.W1O),e.YNc(5,mv,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,Er,Or],encapsulation:2}),s})(),hv=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[Ls],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"batch-control-select",component:lv,wrappers:["form-field"]},{name:"batch-control-grid",component:pv}]})]}),s})(),fv=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[hv]}),s})();class Ct extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class _v extends Ct{constructor(o,t,i){super("ValidateBodyPartLeadExcelDataAction"),this.valid=!1,this.excelData=o,this.leads=t,this.bodyParts=i}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name),this.validationContext.addRule(new f.mi(`leadName_${i}_is_valid}`,"Lead Is Not Valid","lead.name",t.lead,this.leads,!0)),this.validationContext.addRule(new f.mi(`bodyPartName_${i}_is_valid}`,"Body Part Is Not Valid","bodyPart.name",t.bodyPart,this.bodyParts,!0))}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class gv extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class Cv extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new gv("name","The bodypartlead name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class vv extends Ct{constructor(o){super("CreateBodyPartLeadAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new Cv("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateBodyPartLead({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class Sv extends Ct{constructor(o){super("UpdateBodyPartLeadsAction"),this.bodyPartLeads=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.bodyPartLeads,!0))}performAction(){this.response=this.businessProvider.data.userUpdateBodyPartLeads({input:{bodyPartLeads:this.bodyPartLeads}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class bv extends Ct{constructor(o,t){super("UpdateBodyPartLeadAction"),this.bodyPartLead=o,this.bodyPartLeadId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.bodyPartLead,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.bodyPartLeadId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateBodyPartLead({bodyPartLeadId:this.bodyPartLeadId,input:this.bodyPartLead}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let Lr=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.BodyPartLeadBusinessProviderService",t,a),this.data=i}createBodyPartLead(t){const i=new vv(t);return i.Do(this),i.response}updateBodyPartLead(t,i){const a=new bv(t,i);return a.Do(this),a.response}importBodyPartLeads(t){const i=new Sv(t);return i.Do(this),i.response}validateBodyPartLeadExcelData(t,i,a){const l=new _v(t,i,a);return l.Do(this),l.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),Tv=(()=>{class s extends I.nH{constructor(t,i,a){super("BodyPartLeadService",a,t),this.businessProvider=i}createBodyPartLead(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createBodyPartLead(i)}updateBodyPartLead(t,i){return this.businessProvider.updateBodyPartLead(t,i)}importBodyPartLeads(t){return this.businessProvider.importBodyPartLeads(t)}validateBodyPartLeadExcelData(t,i,a){return this.businessProvider.validateBodyPartLeadExcelData(t,i,a)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(Lr,8),e.LFG(Lr),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),$s=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){if(super({loading:!1,bodyPartLeads:[],done:!1,searchQuery:"",formName:void 0,leadId:void 0,bodyPartId:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.bodyPartLeadService=H,this.errors$=this.select(n=>n.errors),this.loading$=this.select(n=>n.loading),this.done$=this.select(n=>n.done),this.item$=this.select(n=>n.item),this.bodyPartLeads$=this.select(n=>n.bodyPartLeads),this.leads$=this.select(n=>n.leads||[]),this.bodyParts$=this.select(n=>n.bodyParts||[]),this.leadId$=this.select(n=>n.leadId),this.bodyPartId$=this.select(n=>n.bodyPartId),this.paging$=this.select(n=>n.paging),this.searchQuery$=this.select(n=>n.searchQuery),this.formName$=this.select(n=>n.formName),this.actionResult$=this.select(this.item$,this.done$,(n,r)=>({item:n,done:r}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.bodyPartLeads$,this.leads$,this.bodyParts$,(n,r,m,p,_,w,J)=>({errors:n,loading:r,item:m,formName:p,bodyPartLeads:_,leads:w,bodyParts:J}),{debounce:!0}),this.input$=this.select(this.paging$,this.leadId$,this.bodyPartId$,this.searchQuery$,(n,r,m,p)=>({limit:n.limit,skip:n.skip,name:p,leadId:r,bodyPartId:m,total:n.total})),this.setFormName=this.updater((n,r)=>Object.assign(Object.assign({},n),{formName:r})),this.setLeadId=this.updater((n,r)=>Object.assign(Object.assign({},n),{leadId:r})),this.setBodyPartId=this.updater((n,r)=>Object.assign(Object.assign({},n),{bodyPartId:r})),this.filterLeads=n=>this.data.userSelectLeads({input:{name:n}}).pipe((0,g._b)(r=>{let m=r.data.items;return this.patchState({leads:m}),m},r=>this.patchState({errors:r.graphQLErrors?r.graphQLErrors:r})),(0,he.U)(r=>r.data.items)),this.filterBodyParts=n=>this.data.userSelectBodyParts({input:{name:n}}).pipe((0,g._b)(r=>{let m=r.data.items;return this.patchState({bodyParts:m}),m},r=>this.patchState({errors:r.graphQLErrors?r.graphQLErrors:r})),(0,he.U)(r=>r.data.items)),this.addLead=this.updater((n,r)=>Object.assign(Object.assign({},n),{leads:n.leads.concat(r)})),this.addBodyPart=this.updater((n,r)=>Object.assign(Object.assign({},n),{bodyParts:n.bodyParts.concat(r)})),this.setItem=this.updater((n,r)=>Object.assign(Object.assign({},n),{item:r})),this.addNewBodyPartLead=this.updater((n,r)=>Object.assign(Object.assign({},n),{bodyPartLeads:[...n.bodyPartLeads,r]})),this.updateBodyPartLead=this.updater((n,r)=>Object.assign(Object.assign({},n),{bodyPartLeads:n.bodyPartLeads.map(m=>m.id===r.id?r:m)})),this.addBodyPartLeads=this.updater((n,r)=>Object.assign(Object.assign({},n),{bodyPartLeads:n.bodyPartLeads.concat(r)})),this.updateBodyPartLeads=this.updater((n,r)=>Object.assign(Object.assign({},n),{bodyPartLeads:n.bodyPartLeads.map(m=>r.find(_=>_.id===m.id)||m)})),this.setSearchQuery=this.updater((n,r)=>Object.assign(Object.assign({},n),{searchQuery:r})),this.loadBodyPartLeadEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(r=>this.data.userBodyPartLead({bodyPartLeadId:r}).pipe((0,g._b)(m=>{this.patchState({item:m.data.item,errors:m.errors,loading:!1})},m=>this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})))))),this.loadBodyPartLeadsEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([r,m])=>this.data.userBodyPartLeads({input:m}).pipe((0,g._b)(p=>this.patchState({paging:{limit:m.limit,skip:m.skip,total:p.data.count.total},bodyPartLeads:p.data.items,errors:p.errors,loading:!1}),p=>this.patchState({loading:!1,errors:p.graphQLErrors?p.graphQLErrors:p})))))),this.createBodyPartLeadEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(r=>this.bodyPartLeadService.createBodyPartLead(Object.assign({},r)).pipe((0,g._b)(m=>{this.addNewBodyPartLead(m),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:m,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},m=>{m.graphQLErrors?(this.toast.error(m.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})):(this.toast.error(m.Message),this.formService.setErrors(m.Data))}))))),this.updateBodyPartLeadEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([r,m])=>this.bodyPartLeadService.updateBodyPartLead(r,r.id).pipe((0,g._b)(p=>{this.updateBodyPartLead(p),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:p,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},p=>{p.graphQLErrors?(this.toast.error(p.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:p.graphQLErrors?p.graphQLErrors:p})):(this.toast.error(p.Message),this.formService.setErrors(p.Data))}))))),this.deleteBodyPartLeadEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([r,m])=>this.data.userDeleteBodyPartLead({bodyPartLeadId:m.id}).pipe((0,g._b)(p=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:p.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},p=>{p.graphQLErrors?(this.toast.error(p.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:p.graphQLErrors?p.graphQLErrors:p})):(this.toast.error(p.Message),this.formService.setErrors(p.Data))}))))),this.importExcelEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(r=>this.bodyPartLeadService.importBodyPartLeads(r).pipe((0,ce.K)(m=>{var p;return this.toast.error(null!==(p=m.Message)&&void 0!==p?p:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(m=>{const p=JSON.parse(m.created),_=JSON.parse(m.updated),w=JSON.parse(m.failed),J=p.length+_.length+w.length;this.addBodyPartLeads(p),this.updateBodyPartLeads(_),this.toast.success(`${p.length} created, ${_.length} updated, ${w.length} failed of total ${J}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("bodyPartLeadId")?(this.route.snapshot.paramMap.get("bodyPartLeadId"),this.setFormName("bodyPartLead_edit")):this.setFormName("bodyPartLead_create"),this.route.snapshot.paramMap.has("leadId")){var c=this.route.snapshot.paramMap.get("leadId");this.setLeadId(c)}if(this.route.snapshot.paramMap.has("bodyPartId")){var d=this.route.snapshot.paramMap.get("bodyPartId");this.setBodyPartId(d)}}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.bodyPartLeadService.validateBodyPartLeadExcelData(t,i.leads,i.bodyParts)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(Tv))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function yv(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.bodyPartLead)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let $r=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"bodyPartLead_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({id:null,name:""}),this.store.vm$.subscribe(i=>{this.bodyPartLead=i.item})):t.formName&&t.formName.currentValue&&"bodyPartLead_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadBodyPartLeadEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.bodyPartLead=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36($s),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-body-part-lead-form"]],inputs:{bodyPartLead:"bodyPartLead",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,yv,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),Gr=(()=>{class s{constructor(){this.autoHeight=!1,this.bodyPartLeads=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[{field:"lead.name",headerName:"Lead",filter:"agTextColumnFilter"},{field:"bodyPart.name",headerName:"Body Part",filter:"agTextColumnFilter"},{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{field:"leadId",filter:"agTextColumnFilter",hide:!0},{field:"bodyPartId",filter:"agTextColumnFilter",hide:!0}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-body-part-lead-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",bodyPartLeads:"bodyPartLeads"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.bodyPartLeads)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function wv(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-body-part-lead-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","bodyPartLead_edit")("formControl",t.formControl)("bodyPartLead",t.bodyPartLead)}}const xv=function(){return{}};function Nv(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-body-part-lead-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","bodyPartLead_create")("formControl",t.formControl)("bodyPartLead",e.DdM(3,xv))}}function Av(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-body-part-lead-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("bodyPartLeads",o.data.items)}let Fv=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadBodyPartLeadsEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.bodyPartLeads$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36($s))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","bodyPartLead","send","close"],[1,"w-full","h-full","bg-white",3,"bodyPartLeads","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,wv,2,3,"ng-template",null,1,e.W1O),e.YNc(3,Nv,1,4,"ng-template",null,2,e.W1O),e.YNc(5,Av,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,$r,Gr],encapsulation:2}),s})();function Pv(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-body-part-lead-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","bodyPartLead_edit")("bodyPartLead",t.value)}}const Iv=function(){return{}};function Dv(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-body-part-lead-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","bodyPartLead_create")("bodyPartLead",e.DdM(2,Iv))}function Mv(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-body-part-lead-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("bodyPartLeads",t.items)}}let Wv=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:6,consts:[[3,"data","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","bodyPartLead","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","bodyPartLeads","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,Pv,1,2,"ng-template",null,1,e.W1O),e.YNc(3,Dv,1,3,"ng-template",null,2,e.W1O),e.YNc(5,Mv,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,$r,Gr],encapsulation:2}),s})(),Ev=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[$s],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"body-part-lead-select",component:Fv,wrappers:["form-field"]},{name:"body-part-lead-grid",component:Wv}]})]}),s})(),Ov=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[Ev]}),s})();class vt extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class Lv extends vt{constructor(o){super("ValidateBodyPartExcelDataAction"),this.valid=!1,this.excelData=o}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name)}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class $v extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class Gv extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new $v("name","The bodypart name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class Rv extends vt{constructor(o){super("CreateBodyPartAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new Gv("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateBodyPart({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class Qv extends vt{constructor(o){super("UpdateBodyPartsAction"),this.bodyParts=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.bodyParts,!0))}performAction(){this.response=this.businessProvider.data.userUpdateBodyParts({input:{bodyParts:this.bodyParts}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class Vv extends vt{constructor(o,t){super("UpdateBodyPartAction"),this.bodyPart=o,this.bodyPartId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.bodyPart,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.bodyPartId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateBodyPart({bodyPartId:this.bodyPartId,input:this.bodyPart}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let Rr=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.BodyPartBusinessProviderService",t,a),this.data=i}createBodyPart(t){const i=new Rv(t);return i.Do(this),i.response}updateBodyPart(t,i){const a=new Vv(t,i);return a.Do(this),a.response}importBodyParts(t){const i=new Qv(t);return i.Do(this),i.response}validateBodyPartExcelData(t){const i=new Lv(t);return i.Do(this),i.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),jv=(()=>{class s extends I.nH{constructor(t,i,a){super("BodyPartService",a,t),this.businessProvider=i}createBodyPart(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createBodyPart(i)}updateBodyPart(t,i){return this.businessProvider.updateBodyPart(t,i)}importBodyParts(t){return this.businessProvider.importBodyParts(t)}validateBodyPartExcelData(t){return this.businessProvider.validateBodyPartExcelData(t)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(Rr,8),e.LFG(Rr),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),Gs=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){super({loading:!1,bodyParts:[],done:!1,searchQuery:"",formName:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.bodyPartService=H,this.errors$=this.select(c=>c.errors),this.loading$=this.select(c=>c.loading),this.done$=this.select(c=>c.done),this.item$=this.select(c=>c.item),this.bodyParts$=this.select(c=>c.bodyParts),this.paging$=this.select(c=>c.paging),this.searchQuery$=this.select(c=>c.searchQuery),this.formName$=this.select(c=>c.formName),this.actionResult$=this.select(this.item$,this.done$,(c,d)=>({item:c,done:d}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.bodyParts$,(c,d,n,r,m)=>({errors:c,loading:d,item:n,formName:r,bodyParts:m}),{debounce:!0}),this.input$=this.select(this.paging$,this.searchQuery$,(c,d)=>({limit:c.limit,skip:c.skip,name:d,total:c.total})),this.setFormName=this.updater((c,d)=>Object.assign(Object.assign({},c),{formName:d})),this.setItem=this.updater((c,d)=>Object.assign(Object.assign({},c),{item:d})),this.addNewBodyPart=this.updater((c,d)=>Object.assign(Object.assign({},c),{bodyParts:[...c.bodyParts,d]})),this.updateBodyPart=this.updater((c,d)=>Object.assign(Object.assign({},c),{bodyParts:c.bodyParts.map(n=>n.id===d.id?d:n)})),this.addBodyParts=this.updater((c,d)=>Object.assign(Object.assign({},c),{bodyParts:c.bodyParts.concat(d)})),this.updateBodyParts=this.updater((c,d)=>Object.assign(Object.assign({},c),{bodyParts:c.bodyParts.map(n=>d.find(m=>m.id===n.id)||n)})),this.setSearchQuery=this.updater((c,d)=>Object.assign(Object.assign({},c),{searchQuery:d})),this.loadBodyPartEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.data.userBodyPart({bodyPartId:d}).pipe((0,g._b)(n=>{this.patchState({item:n.data.item,errors:n.errors,loading:!1})},n=>this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})))))),this.loadBodyPartsEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([d,n])=>this.data.userBodyParts({input:n}).pipe((0,g._b)(r=>this.patchState({paging:{limit:n.limit,skip:n.skip,total:r.data.count.total},bodyParts:r.data.items,errors:r.errors,loading:!1}),r=>this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})))))),this.createBodyPartEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.bodyPartService.createBodyPart(Object.assign({},d)).pipe((0,g._b)(n=>{this.addNewBodyPart(n),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:n,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},n=>{n.graphQLErrors?(this.toast.error(n.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})):(this.toast.error(n.Message),this.formService.setErrors(n.Data))}))))),this.updateBodyPartEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.bodyPartService.updateBodyPart(d,d.id).pipe((0,g._b)(r=>{this.updateBodyPart(r),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:r,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.deleteBodyPartEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.data.userDeleteBodyPart({bodyPartId:n.id}).pipe((0,g._b)(r=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:r.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.importExcelEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.bodyPartService.importBodyParts(d).pipe((0,ce.K)(n=>{var r;return this.toast.error(null!==(r=n.Message)&&void 0!==r?r:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(n=>{const r=JSON.parse(n.created),m=JSON.parse(n.updated),p=JSON.parse(n.failed),_=r.length+m.length+p.length;this.addBodyParts(r),this.updateBodyParts(m),this.toast.success(`${r.length} created, ${m.length} updated, ${p.length} failed of total ${_}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("bodyPartId")?(this.route.snapshot.paramMap.get("bodyPartId"),this.setFormName("bodyPart_edit")):this.setFormName("bodyPart_create")}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.bodyPartService.validateBodyPartExcelData(t)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(jv))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function Uv(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.bodyPart)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let Qr=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"bodyPart_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({id:null,name:""}),this.store.vm$.subscribe(i=>{this.bodyPart=i.item})):t.formName&&t.formName.currentValue&&"bodyPart_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadBodyPartEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.bodyPart=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Gs),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-body-part-form"]],inputs:{bodyPart:"bodyPart",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,Uv,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),Vr=(()=>{class s{constructor(){this.autoHeight=!1,this.bodyParts=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[,{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-body-part-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",bodyParts:"bodyParts"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.bodyParts)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function Jv(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-body-part-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","bodyPart_edit")("formControl",t.formControl)("bodyPart",t.bodyPart)}}const zv=function(){return{}};function Hv(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-body-part-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","bodyPart_create")("formControl",t.formControl)("bodyPart",e.DdM(3,zv))}}function qv(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-body-part-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("bodyParts",o.data.items)}let Kv=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadBodyPartsEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.bodyParts$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Gs))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","bodyPart","send","close"],[1,"w-full","h-full","bg-white",3,"bodyParts","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,Jv,2,3,"ng-template",null,1,e.W1O),e.YNc(3,Hv,1,4,"ng-template",null,2,e.W1O),e.YNc(5,qv,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,Qr,Vr],encapsulation:2}),s})();function Zv(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-body-part-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","bodyPart_edit")("bodyPart",t.value)}}const kv=function(){return{}};function Bv(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-body-part-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","bodyPart_create")("bodyPart",e.DdM(2,kv))}function Yv(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-body-part-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("bodyParts",t.items)}}let Xv=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:6,consts:[[3,"data","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","bodyPart","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","bodyParts","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,Zv,1,2,"ng-template",null,1,e.W1O),e.YNc(3,Bv,1,3,"ng-template",null,2,e.W1O),e.YNc(5,Yv,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,Qr,Vr],encapsulation:2}),s})(),eS=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[Gs],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"body-part-select",component:Kv,wrappers:["form-field"]},{name:"body-part-grid",component:Xv}]})]}),s})(),tS=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[eS]}),s})();class St extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class iS extends St{constructor(o){super("ValidateCalculationBasisTypeExcelDataAction"),this.valid=!1,this.excelData=o}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name)}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class sS extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class oS extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new sS("name","The calculationbasistype name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class aS extends St{constructor(o){super("CreateCalculationBasisTypeAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new oS("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateCalculationBasisType({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class rS extends St{constructor(o){super("UpdateCalculationBasisTypesAction"),this.calculationBasisTypes=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.calculationBasisTypes,!0))}performAction(){this.response=this.businessProvider.data.userUpdateCalculationBasisTypes({input:{calculationBasisTypes:this.calculationBasisTypes}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class nS extends St{constructor(o,t){super("UpdateCalculationBasisTypeAction"),this.calculationBasisType=o,this.calculationBasisTypeId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.calculationBasisType,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.calculationBasisTypeId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateCalculationBasisType({calculationBasisTypeId:this.calculationBasisTypeId,input:this.calculationBasisType}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let jr=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.CalculationBasisTypeBusinessProviderService",t,a),this.data=i}createCalculationBasisType(t){const i=new aS(t);return i.Do(this),i.response}updateCalculationBasisType(t,i){const a=new nS(t,i);return a.Do(this),a.response}importCalculationBasisTypes(t){const i=new rS(t);return i.Do(this),i.response}validateCalculationBasisTypeExcelData(t){const i=new iS(t);return i.Do(this),i.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),lS=(()=>{class s extends I.nH{constructor(t,i,a){super("CalculationBasisTypeService",a,t),this.businessProvider=i}createCalculationBasisType(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createCalculationBasisType(i)}updateCalculationBasisType(t,i){return this.businessProvider.updateCalculationBasisType(t,i)}importCalculationBasisTypes(t){return this.businessProvider.importCalculationBasisTypes(t)}validateCalculationBasisTypeExcelData(t){return this.businessProvider.validateCalculationBasisTypeExcelData(t)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(jr,8),e.LFG(jr),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),Rs=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){super({loading:!1,calculationBasisTypes:[],done:!1,searchQuery:"",formName:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.calculationBasisTypeService=H,this.errors$=this.select(c=>c.errors),this.loading$=this.select(c=>c.loading),this.done$=this.select(c=>c.done),this.item$=this.select(c=>c.item),this.calculationBasisTypes$=this.select(c=>c.calculationBasisTypes),this.paging$=this.select(c=>c.paging),this.searchQuery$=this.select(c=>c.searchQuery),this.formName$=this.select(c=>c.formName),this.actionResult$=this.select(this.item$,this.done$,(c,d)=>({item:c,done:d}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.calculationBasisTypes$,(c,d,n,r,m)=>({errors:c,loading:d,item:n,formName:r,calculationBasisTypes:m}),{debounce:!0}),this.input$=this.select(this.paging$,this.searchQuery$,(c,d)=>({limit:c.limit,skip:c.skip,name:d,total:c.total})),this.setFormName=this.updater((c,d)=>Object.assign(Object.assign({},c),{formName:d})),this.setItem=this.updater((c,d)=>Object.assign(Object.assign({},c),{item:d})),this.addNewCalculationBasisType=this.updater((c,d)=>Object.assign(Object.assign({},c),{calculationBasisTypes:[...c.calculationBasisTypes,d]})),this.updateCalculationBasisType=this.updater((c,d)=>Object.assign(Object.assign({},c),{calculationBasisTypes:c.calculationBasisTypes.map(n=>n.id===d.id?d:n)})),this.addCalculationBasisTypes=this.updater((c,d)=>Object.assign(Object.assign({},c),{calculationBasisTypes:c.calculationBasisTypes.concat(d)})),this.updateCalculationBasisTypes=this.updater((c,d)=>Object.assign(Object.assign({},c),{calculationBasisTypes:c.calculationBasisTypes.map(n=>d.find(m=>m.id===n.id)||n)})),this.setSearchQuery=this.updater((c,d)=>Object.assign(Object.assign({},c),{searchQuery:d})),this.loadCalculationBasisTypeEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.data.userCalculationBasisType({calculationBasisTypeId:d}).pipe((0,g._b)(n=>{this.patchState({item:n.data.item,errors:n.errors,loading:!1})},n=>this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})))))),this.loadCalculationBasisTypesEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([d,n])=>this.data.userCalculationBasisTypes({input:n}).pipe((0,g._b)(r=>this.patchState({paging:{limit:n.limit,skip:n.skip,total:r.data.count.total},calculationBasisTypes:r.data.items,errors:r.errors,loading:!1}),r=>this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})))))),this.createCalculationBasisTypeEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.calculationBasisTypeService.createCalculationBasisType(Object.assign({},d)).pipe((0,g._b)(n=>{this.addNewCalculationBasisType(n),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:n,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},n=>{n.graphQLErrors?(this.toast.error(n.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})):(this.toast.error(n.Message),this.formService.setErrors(n.Data))}))))),this.updateCalculationBasisTypeEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.calculationBasisTypeService.updateCalculationBasisType(d,d.id).pipe((0,g._b)(r=>{this.updateCalculationBasisType(r),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:r,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.deleteCalculationBasisTypeEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.data.userDeleteCalculationBasisType({calculationBasisTypeId:n.id}).pipe((0,g._b)(r=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:r.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.importExcelEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.calculationBasisTypeService.importCalculationBasisTypes(d).pipe((0,ce.K)(n=>{var r;return this.toast.error(null!==(r=n.Message)&&void 0!==r?r:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(n=>{const r=JSON.parse(n.created),m=JSON.parse(n.updated),p=JSON.parse(n.failed),_=r.length+m.length+p.length;this.addCalculationBasisTypes(r),this.updateCalculationBasisTypes(m),this.toast.success(`${r.length} created, ${m.length} updated, ${p.length} failed of total ${_}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("calculationBasisTypeId")?(this.route.snapshot.paramMap.get("calculationBasisTypeId"),this.setFormName("calculationBasisType_edit")):this.setFormName("calculationBasisType_create")}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.calculationBasisTypeService.validateCalculationBasisTypeExcelData(t)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(lS))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function cS(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.calculationBasisType)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let Ur=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"calculationBasisType_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.calculationBasisType=i.item})):t.formName&&t.formName.currentValue&&"calculationBasisType_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadCalculationBasisTypeEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.calculationBasisType=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Rs),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-calculation-basis-type-form"]],inputs:{calculationBasisType:"calculationBasisType",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,cS,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),Jr=(()=>{class s{constructor(){this.autoHeight=!1,this.calculationBasisTypes=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[,{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-calculation-basis-type-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",calculationBasisTypes:"calculationBasisTypes"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.calculationBasisTypes)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function dS(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-calculation-basis-type-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","calculationBasisType_edit")("formControl",t.formControl)("calculationBasisType",t.calculationBasisType)}}const uS=function(){return{}};function mS(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-calculation-basis-type-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","calculationBasisType_create")("formControl",t.formControl)("calculationBasisType",e.DdM(3,uS))}}function pS(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-calculation-basis-type-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("calculationBasisTypes",o.data.items)}let hS=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadCalculationBasisTypesEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.calculationBasisTypes$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Rs))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","calculationBasisType","send","close"],[1,"w-full","h-full","bg-white",3,"calculationBasisTypes","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,dS,2,3,"ng-template",null,1,e.W1O),e.YNc(3,mS,1,4,"ng-template",null,2,e.W1O),e.YNc(5,pS,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,Ur,Jr],encapsulation:2}),s})();function fS(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-calculation-basis-type-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","calculationBasisType_edit")("calculationBasisType",t.value)}}const _S=function(){return{}};function gS(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-calculation-basis-type-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","calculationBasisType_create")("calculationBasisType",e.DdM(2,_S))}function CS(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-calculation-basis-type-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("calculationBasisTypes",t.items)}}let vS=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","calculationBasisType","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","calculationBasisTypes","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,fS,1,2,"ng-template",null,1,e.W1O),e.YNc(3,gS,1,3,"ng-template",null,2,e.W1O),e.YNc(5,CS,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,Ur,Jr],encapsulation:2}),s})(),SS=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[Rs],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"calculation-basis-type-select",component:hS,wrappers:["form-field"]},{name:"calculation-basis-type-grid",component:vS}]})]}),s})(),bS=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[SS]}),s})();class bt extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class TS extends bt{constructor(o,t,i,a,l,u,H,A,c,d,n,r){super("ValidateCaseAccountExcelDataAction"),this.valid=!1,this.excelData=o,this.legalCases=t,this.locations=i,this.vendors=a,this.accountStatuses=l,this.procedureTypes=u,this.agreementTypes=H,this.claimProcedures=A,this.invoiceDetails=c,this.contracts=d,this.portfolios=n,this.procedureVendors=r}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name),this.validationContext.addRule(new f.mi(`legalCaseName_${i}_is_valid}`,"Legal Case Is Not Valid","legalCase.name",t.legalCase,this.legalCases,!0)),this.validationContext.addRule(new f.mi(`locationName_${i}_is_valid}`,"Location Is Not Valid","location.name",t.location,this.locations,!0)),this.validationContext.addRule(new f.mi(`vendorName_${i}_is_valid}`,"Vendor Is Not Valid","vendor.name",t.vendor,this.vendors,!0)),this.validationContext.addRule(new f.mi(`accountStatusName_${i}_is_valid}`,"Account Status Is Not Valid","accountStatus.name",t.accountStatus,this.accountStatuses,!0)),this.validationContext.addRule(new f.mi(`procedureTypeName_${i}_is_valid}`,"Procedure Type Is Not Valid","procedureType.name",t.procedureType,this.procedureTypes,!0)),this.validationContext.addRule(new f.mi(`agreementTypeName_${i}_is_valid}`,"Agreement Type Is Not Valid","agreementType.name",t.agreementType,this.agreementTypes,!0)),this.validationContext.addRule(new f.mi(`claimProcedureName_${i}_is_valid}`,"Claim Procedure Is Not Valid","claimProcedure.name",t.claimProcedure,this.claimProcedures,!0)),this.validationContext.addRule(new f.mi(`invoiceDetailName_${i}_is_valid}`,"Invoice Detail Is Not Valid","invoiceDetail.name",t.invoiceDetail,this.invoiceDetails,!0)),this.validationContext.addRule(new f.mi(`contractName_${i}_is_valid}`,"Contract Is Not Valid","contract.name",t.contract,this.contracts,!0)),this.validationContext.addRule(new f.mi(`portfolioName_${i}_is_valid}`,"Portfolio Is Not Valid","portfolio.name",t.portfolio,this.portfolios,!0)),this.validationContext.addRule(new f.mi(`procedureVendorName_${i}_is_valid}`,"Procedure Vendor Is Not Valid","procedureVendor.name",t.procedureVendor,this.procedureVendors,!0))}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class yS extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class wS extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new yS("name","The caseaccount name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class xS extends bt{constructor(o){super("CreateCaseAccountAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new wS("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateCaseAccount({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class NS extends bt{constructor(o){super("UpdateCaseAccountsAction"),this.caseAccounts=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.caseAccounts,!0))}performAction(){this.response=this.businessProvider.data.userUpdateCaseAccounts({input:{caseAccounts:this.caseAccounts}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class AS extends bt{constructor(o,t){super("UpdateCaseAccountAction"),this.caseAccount=o,this.caseAccountId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.caseAccount,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.caseAccountId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateCaseAccount({caseAccountId:this.caseAccountId,input:this.caseAccount}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let zr=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.CaseAccountBusinessProviderService",t,a),this.data=i}createCaseAccount(t){const i=new xS(t);return i.Do(this),i.response}updateCaseAccount(t,i){const a=new AS(t,i);return a.Do(this),a.response}importCaseAccounts(t){const i=new NS(t);return i.Do(this),i.response}validateCaseAccountExcelData(t,i,a,l,u,H,A,c,d,n,r,m){const p=new TS(t,i,a,l,u,H,A,c,d,n,r,m);return p.Do(this),p.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),FS=(()=>{class s extends I.nH{constructor(t,i,a){super("CaseAccountService",a,t),this.businessProvider=i}createCaseAccount(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createCaseAccount(i)}updateCaseAccount(t,i){return this.businessProvider.updateCaseAccount(t,i)}importCaseAccounts(t){return this.businessProvider.importCaseAccounts(t)}validateCaseAccountExcelData(t,i,a,l,u,H,A,c,d,n,r,m){return this.businessProvider.validateCaseAccountExcelData(t,i,a,l,u,H,A,c,d,n,r,m)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(zr,8),e.LFG(zr),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),Qs=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){if(super({loading:!1,caseAccounts:[],done:!1,searchQuery:"",formName:void 0,legalCaseId:void 0,locationId:void 0,vendorId:void 0,accountStatusId:void 0,procedureTypeId:void 0,agreementTypeId:void 0,claimProcedureId:void 0,invoiceDetailId:void 0,contractId:void 0,portfolioId:void 0,procedureVendorId:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.caseAccountService=H,this.errors$=this.select(ae=>ae.errors),this.loading$=this.select(ae=>ae.loading),this.done$=this.select(ae=>ae.done),this.item$=this.select(ae=>ae.item),this.caseAccounts$=this.select(ae=>ae.caseAccounts),this.legalCases$=this.select(ae=>ae.legalCases||[]),this.locations$=this.select(ae=>ae.locations||[]),this.vendors$=this.select(ae=>ae.vendors||[]),this.accountStatuses$=this.select(ae=>ae.accountStatuses||[]),this.procedureTypes$=this.select(ae=>ae.procedureTypes||[]),this.agreementTypes$=this.select(ae=>ae.agreementTypes||[]),this.claimProcedures$=this.select(ae=>ae.claimProcedures||[]),this.invoiceDetails$=this.select(ae=>ae.invoiceDetails||[]),this.contracts$=this.select(ae=>ae.contracts||[]),this.portfolios$=this.select(ae=>ae.portfolios||[]),this.procedureVendors$=this.select(ae=>ae.procedureVendors||[]),this.legalCaseId$=this.select(ae=>ae.legalCaseId),this.locationId$=this.select(ae=>ae.locationId),this.vendorId$=this.select(ae=>ae.vendorId),this.accountStatusId$=this.select(ae=>ae.accountStatusId),this.procedureTypeId$=this.select(ae=>ae.procedureTypeId),this.agreementTypeId$=this.select(ae=>ae.agreementTypeId),this.claimProcedureId$=this.select(ae=>ae.claimProcedureId),this.invoiceDetailId$=this.select(ae=>ae.invoiceDetailId),this.contractId$=this.select(ae=>ae.contractId),this.portfolioId$=this.select(ae=>ae.portfolioId),this.procedureVendorId$=this.select(ae=>ae.procedureVendorId),this.paging$=this.select(ae=>ae.paging),this.searchQuery$=this.select(ae=>ae.searchQuery),this.formName$=this.select(ae=>ae.formName),this.actionResult$=this.select(this.item$,this.done$,(ae,le)=>({item:ae,done:le}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.caseAccounts$,this.legalCases$,this.locations$,this.vendors$,this.accountStatuses$,this.procedureTypes$,this.agreementTypes$,this.claimProcedures$,this.invoiceDetails$,this.contracts$,this.portfolios$,this.procedureVendors$,(ae,le,Y,oe,ge,Se,Oe,Ge,Ve,ze,He,qe,Ke,ke,Be,Ye)=>({errors:ae,loading:le,item:Y,formName:oe,caseAccounts:ge,legalCases:Se,locations:Oe,vendors:Ge,accountStatuses:Ve,procedureTypes:ze,agreementTypes:He,claimProcedures:qe,invoiceDetails:Ke,contracts:ke,portfolios:Be,procedureVendors:Ye}),{debounce:!0}),this.input$=this.select(this.paging$,this.legalCaseId$,this.locationId$,this.vendorId$,this.accountStatusId$,this.procedureTypeId$,this.agreementTypeId$,this.claimProcedureId$,this.invoiceDetailId$,this.contractId$,this.portfolioId$,this.procedureVendorId$,this.searchQuery$,(ae,le,Y,oe,ge,Se,Oe,Ge,Ve,ze,He,qe,Ke)=>({limit:ae.limit,skip:ae.skip,name:Ke,legalCaseId:le,locationId:Y,vendorId:oe,accountStatusId:ge,procedureTypeId:Se,agreementTypeId:Oe,claimProcedureId:Ge,invoiceDetailId:Ve,contractId:ze,portfolioId:He,procedureVendorId:qe,total:ae.total})),this.setFormName=this.updater((ae,le)=>Object.assign(Object.assign({},ae),{formName:le})),this.setLegalCaseId=this.updater((ae,le)=>Object.assign(Object.assign({},ae),{legalCaseId:le})),this.setLocationId=this.updater((ae,le)=>Object.assign(Object.assign({},ae),{locationId:le})),this.setVendorId=this.updater((ae,le)=>Object.assign(Object.assign({},ae),{vendorId:le})),this.setAccountStatusId=this.updater((ae,le)=>Object.assign(Object.assign({},ae),{accountStatusId:le})),this.setProcedureTypeId=this.updater((ae,le)=>Object.assign(Object.assign({},ae),{procedureTypeId:le})),this.setAgreementTypeId=this.updater((ae,le)=>Object.assign(Object.assign({},ae),{agreementTypeId:le})),this.setClaimProcedureId=this.updater((ae,le)=>Object.assign(Object.assign({},ae),{claimProcedureId:le})),this.setInvoiceDetailId=this.updater((ae,le)=>Object.assign(Object.assign({},ae),{invoiceDetailId:le})),this.setContractId=this.updater((ae,le)=>Object.assign(Object.assign({},ae),{contractId:le})),this.setPortfolioId=this.updater((ae,le)=>Object.assign(Object.assign({},ae),{portfolioId:le})),this.setProcedureVendorId=this.updater((ae,le)=>Object.assign(Object.assign({},ae),{procedureVendorId:le})),this.filterLegalCases=ae=>this.data.userSelectLegalCases({input:{name:ae}}).pipe((0,g._b)(le=>{let Y=le.data.items;return this.patchState({legalCases:Y}),Y},le=>this.patchState({errors:le.graphQLErrors?le.graphQLErrors:le})),(0,he.U)(le=>le.data.items)),this.filterLocations=ae=>this.data.userSelectLocations({input:{name:ae}}).pipe((0,g._b)(le=>{let Y=le.data.items;return this.patchState({locations:Y}),Y},le=>this.patchState({errors:le.graphQLErrors?le.graphQLErrors:le})),(0,he.U)(le=>le.data.items)),this.filterVendors=ae=>this.data.userSelectVendors({input:{name:ae}}).pipe((0,g._b)(le=>{let Y=le.data.items;return this.patchState({vendors:Y}),Y},le=>this.patchState({errors:le.graphQLErrors?le.graphQLErrors:le})),(0,he.U)(le=>le.data.items)),this.filterAccountStatuses=ae=>this.data.userSelectAccountStatuses({input:{name:ae}}).pipe((0,g._b)(le=>{let Y=le.data.items;return this.patchState({accountStatuses:Y}),Y},le=>this.patchState({errors:le.graphQLErrors?le.graphQLErrors:le})),(0,he.U)(le=>le.data.items)),this.filterProcedureTypes=ae=>this.data.userSelectProcedureTypes({input:{name:ae}}).pipe((0,g._b)(le=>{let Y=le.data.items;return this.patchState({procedureTypes:Y}),Y},le=>this.patchState({errors:le.graphQLErrors?le.graphQLErrors:le})),(0,he.U)(le=>le.data.items)),this.filterAgreementTypes=ae=>this.data.userSelectAgreementTypes({input:{name:ae}}).pipe((0,g._b)(le=>{let Y=le.data.items;return this.patchState({agreementTypes:Y}),Y},le=>this.patchState({errors:le.graphQLErrors?le.graphQLErrors:le})),(0,he.U)(le=>le.data.items)),this.filterClaimProcedures=ae=>this.data.userSelectClaimProcedures({input:{name:ae}}).pipe((0,g._b)(le=>{let Y=le.data.items;return this.patchState({claimProcedures:Y}),Y},le=>this.patchState({errors:le.graphQLErrors?le.graphQLErrors:le})),(0,he.U)(le=>le.data.items)),this.filterInvoiceDetails=ae=>this.data.userSelectInvoiceDetails({input:{name:ae}}).pipe((0,g._b)(le=>{let Y=le.data.items;return this.patchState({invoiceDetails:Y}),Y},le=>this.patchState({errors:le.graphQLErrors?le.graphQLErrors:le})),(0,he.U)(le=>le.data.items)),this.filterContracts=ae=>this.data.userSelectContracts({input:{name:ae}}).pipe((0,g._b)(le=>{let Y=le.data.items;return this.patchState({contracts:Y}),Y},le=>this.patchState({errors:le.graphQLErrors?le.graphQLErrors:le})),(0,he.U)(le=>le.data.items)),this.filterPortfolios=ae=>this.data.userSelectPortfolios({input:{name:ae}}).pipe((0,g._b)(le=>{let Y=le.data.items;return this.patchState({portfolios:Y}),Y},le=>this.patchState({errors:le.graphQLErrors?le.graphQLErrors:le})),(0,he.U)(le=>le.data.items)),this.filterProcedureVendors=ae=>this.data.userSelectProcedureVendors({input:{name:ae}}).pipe((0,g._b)(le=>{let Y=le.data.items;return this.patchState({procedureVendors:Y}),Y},le=>this.patchState({errors:le.graphQLErrors?le.graphQLErrors:le})),(0,he.U)(le=>le.data.items)),this.addLegalCase=this.updater((ae,le)=>Object.assign(Object.assign({},ae),{legalCases:ae.legalCases.concat(le)})),this.addLocation=this.updater((ae,le)=>Object.assign(Object.assign({},ae),{locations:ae.locations.concat(le)})),this.addVendor=this.updater((ae,le)=>Object.assign(Object.assign({},ae),{vendors:ae.vendors.concat(le)})),this.addAccountStatus=this.updater((ae,le)=>Object.assign(Object.assign({},ae),{accountStatuses:ae.accountStatuses.concat(le)})),this.addProcedureType=this.updater((ae,le)=>Object.assign(Object.assign({},ae),{procedureTypes:ae.procedureTypes.concat(le)})),this.addAgreementType=this.updater((ae,le)=>Object.assign(Object.assign({},ae),{agreementTypes:ae.agreementTypes.concat(le)})),this.addClaimProcedure=this.updater((ae,le)=>Object.assign(Object.assign({},ae),{claimProcedures:ae.claimProcedures.concat(le)})),this.addInvoiceDetail=this.updater((ae,le)=>Object.assign(Object.assign({},ae),{invoiceDetails:ae.invoiceDetails.concat(le)})),this.addContract=this.updater((ae,le)=>Object.assign(Object.assign({},ae),{contracts:ae.contracts.concat(le)})),this.addPortfolio=this.updater((ae,le)=>Object.assign(Object.assign({},ae),{portfolios:ae.portfolios.concat(le)})),this.addProcedureVendor=this.updater((ae,le)=>Object.assign(Object.assign({},ae),{procedureVendors:ae.procedureVendors.concat(le)})),this.setItem=this.updater((ae,le)=>Object.assign(Object.assign({},ae),{item:le})),this.addNewCaseAccount=this.updater((ae,le)=>Object.assign(Object.assign({},ae),{caseAccounts:[...ae.caseAccounts,le]})),this.updateCaseAccount=this.updater((ae,le)=>Object.assign(Object.assign({},ae),{caseAccounts:ae.caseAccounts.map(Y=>Y.id===le.id?le:Y)})),this.addCaseAccounts=this.updater((ae,le)=>Object.assign(Object.assign({},ae),{caseAccounts:ae.caseAccounts.concat(le)})),this.updateCaseAccounts=this.updater((ae,le)=>Object.assign(Object.assign({},ae),{caseAccounts:ae.caseAccounts.map(Y=>le.find(ge=>ge.id===Y.id)||Y)})),this.setSearchQuery=this.updater((ae,le)=>Object.assign(Object.assign({},ae),{searchQuery:le})),this.loadCaseAccountEffect=this.effect(ae=>ae.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(le=>this.data.userCaseAccount({caseAccountId:le}).pipe((0,g._b)(Y=>{this.patchState({item:Y.data.item,errors:Y.errors,loading:!1})},Y=>this.patchState({loading:!1,errors:Y.graphQLErrors?Y.graphQLErrors:Y})))))),this.loadCaseAccountsEffect=this.effect(ae=>ae.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([le,Y])=>this.data.userCaseAccounts({input:Y}).pipe((0,g._b)(oe=>this.patchState({paging:{limit:Y.limit,skip:Y.skip,total:oe.data.count.total},caseAccounts:oe.data.items,errors:oe.errors,loading:!1}),oe=>this.patchState({loading:!1,errors:oe.graphQLErrors?oe.graphQLErrors:oe})))))),this.createCaseAccountEffect=this.effect(ae=>ae.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(le=>this.caseAccountService.createCaseAccount(Object.assign({},le)).pipe((0,g._b)(Y=>{this.addNewCaseAccount(Y),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:Y,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},Y=>{Y.graphQLErrors?(this.toast.error(Y.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:Y.graphQLErrors?Y.graphQLErrors:Y})):(this.toast.error(Y.Message),this.formService.setErrors(Y.Data))}))))),this.updateCaseAccountEffect=this.effect(ae=>ae.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([le,Y])=>this.caseAccountService.updateCaseAccount(le,le.id).pipe((0,g._b)(oe=>{this.updateCaseAccount(oe),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:oe,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},oe=>{oe.graphQLErrors?(this.toast.error(oe.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:oe.graphQLErrors?oe.graphQLErrors:oe})):(this.toast.error(oe.Message),this.formService.setErrors(oe.Data))}))))),this.deleteCaseAccountEffect=this.effect(ae=>ae.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([le,Y])=>this.data.userDeleteCaseAccount({caseAccountId:Y.id}).pipe((0,g._b)(oe=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:oe.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},oe=>{oe.graphQLErrors?(this.toast.error(oe.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:oe.graphQLErrors?oe.graphQLErrors:oe})):(this.toast.error(oe.Message),this.formService.setErrors(oe.Data))}))))),this.importExcelEffect=this.effect(ae=>ae.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(le=>this.caseAccountService.importCaseAccounts(le).pipe((0,ce.K)(Y=>{var oe;return this.toast.error(null!==(oe=Y.Message)&&void 0!==oe?oe:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(Y=>{const oe=JSON.parse(Y.created),ge=JSON.parse(Y.updated),Se=JSON.parse(Y.failed),Oe=oe.length+ge.length+Se.length;this.addCaseAccounts(oe),this.updateCaseAccounts(ge),this.toast.success(`${oe.length} created, ${ge.length} updated, ${Se.length} failed of total ${Oe}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("caseAccountId")?(this.route.snapshot.paramMap.get("caseAccountId"),this.setFormName("caseAccount_edit")):this.setFormName("caseAccount_create"),this.route.snapshot.paramMap.has("legalCaseId")){var c=this.route.snapshot.paramMap.get("legalCaseId");this.setLegalCaseId(c)}if(this.route.snapshot.paramMap.has("locationId")){var d=this.route.snapshot.paramMap.get("locationId");this.setLocationId(d)}if(this.route.snapshot.paramMap.has("vendorId")){var n=this.route.snapshot.paramMap.get("vendorId");this.setVendorId(n)}if(this.route.snapshot.paramMap.has("accountStatusId")){var r=this.route.snapshot.paramMap.get("accountStatusId");this.setAccountStatusId(r)}if(this.route.snapshot.paramMap.has("procedureTypeId")){var m=this.route.snapshot.paramMap.get("procedureTypeId");this.setProcedureTypeId(m)}if(this.route.snapshot.paramMap.has("agreementTypeId")){var p=this.route.snapshot.paramMap.get("agreementTypeId");this.setAgreementTypeId(p)}if(this.route.snapshot.paramMap.has("claimProcedureId")){var _=this.route.snapshot.paramMap.get("claimProcedureId");this.setClaimProcedureId(_)}if(this.route.snapshot.paramMap.has("invoiceDetailId")){var w=this.route.snapshot.paramMap.get("invoiceDetailId");this.setInvoiceDetailId(w)}if(this.route.snapshot.paramMap.has("contractId")){var J=this.route.snapshot.paramMap.get("contractId");this.setContractId(J)}if(this.route.snapshot.paramMap.has("portfolioId")){var _e=this.route.snapshot.paramMap.get("portfolioId");this.setPortfolioId(_e)}if(this.route.snapshot.paramMap.has("procedureVendorId")){var ve=this.route.snapshot.paramMap.get("procedureVendorId");this.setProcedureVendorId(ve)}}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.caseAccountService.validateCaseAccountExcelData(t,i.legalCases,i.locations,i.vendors,i.accountStatuses,i.procedureTypes,i.agreementTypes,i.claimProcedures,i.invoiceDetails,i.contracts,i.portfolios,i.procedureVendors)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(FS))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function PS(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.caseAccount)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let Hr=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"caseAccount_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.caseAccount=i.item})):t.formName&&t.formName.currentValue&&"caseAccount_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadCaseAccountEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.caseAccount=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Qs),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-case-account-form"]],inputs:{caseAccount:"caseAccount",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,PS,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),qr=(()=>{class s{constructor(){this.autoHeight=!1,this.caseAccounts=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[{field:"legalCase.name",headerName:"Legal Case",filter:"agTextColumnFilter"},{field:"location.name",headerName:"Location",filter:"agTextColumnFilter"},{field:"vendor.name",headerName:"Vendor",filter:"agTextColumnFilter"},{field:"accountStatus.name",headerName:"Account Status",filter:"agTextColumnFilter"},{field:"procedureType.name",headerName:"Procedure Type",filter:"agTextColumnFilter"},{field:"agreementType.name",headerName:"Agreement Type",filter:"agTextColumnFilter"},{field:"claimProcedure.name",headerName:"Claim Procedure",filter:"agTextColumnFilter"},{field:"invoiceDetail.name",headerName:"Invoice Detail",filter:"agTextColumnFilter"},{field:"contract.name",headerName:"Contract",filter:"agTextColumnFilter"},{field:"portfolio.name",headerName:"Portfolio",filter:"agTextColumnFilter"},{field:"procedureVendor.name",headerName:"Procedure Vendor",filter:"agTextColumnFilter"},{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{field:"legalCaseId",filter:"agTextColumnFilter",hide:!0},{field:"locationId",filter:"agTextColumnFilter",hide:!0},{field:"vendorId",filter:"agTextColumnFilter",hide:!0},{field:"accountStatusId",filter:"agTextColumnFilter",hide:!0},{field:"procedureTypeId",filter:"agTextColumnFilter",hide:!0},{field:"agreementTypeId",filter:"agTextColumnFilter",hide:!0},{field:"accountAgentId",filter:"agTextColumnFilter"},{field:"claimProcedureId",filter:"agTextColumnFilter",hide:!0},{field:"invoiceDetailId",filter:"agTextColumnFilter",hide:!0},{field:"contractId",filter:"agTextColumnFilter",hide:!0},{field:"portfolioId",filter:"agTextColumnFilter",hide:!0},{field:"thirdPartyFunderName",filter:"agTextColumnFilter"},{field:"originalDueDate",filter:"agDateColumnFilter"},{headerName:"Account Term",field:"accountTerm",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.accountTerm,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{field:"serviceDate",filter:"agDateColumnFilter"},{headerName:"Quantity",field:"quantity",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.quantity,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{headerName:"Original Debt",field:"originalDebt",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.originalDebt,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{headerName:"Cost",field:"cost",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.cost,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{headerName:"Balance",field:"balance",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.balance,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{headerName:"Last Balance",field:"lastBalance",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.lastBalance,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{headerName:"Reduction",field:"reduction",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.reduction,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{field:"treatmentState",filter:"agTextColumnFilter"},{field:"accountNumber",filter:"agTextColumnFilter"},{field:"servicesPerformed",filter:"agTextColumnFilter"},{field:"cptCodes",filter:"agTextColumnFilter"},{field:"treatingPhysician",filter:"agTextColumnFilter"},{field:"referringPhysician",filter:"agTextColumnFilter"},{field:"collectionsDate",filter:"agDateColumnFilter"},{field:"deemedWriteOffDate",filter:"agDateColumnFilter"},{field:"expensedBadDebtDate",filter:"agDateColumnFilter"},{field:"paidDate",filter:"agDateColumnFilter"},{headerName:"Ghost Account",field:"ghostAccount",filter:"agSetColumnFilter",cellRenderer:"checkboxRenderer"},{field:"ghostedDate",filter:"agDateColumnFilter"},{field:"ghostedBy",filter:"agTextColumnFilter"},{field:"unGhostedDate",filter:"agDateColumnFilter"},{field:"unGhostedBy",filter:"agTextColumnFilter"},{headerName:"Additional Payment",field:"additionalPayment",filter:"agSetColumnFilter",cellRenderer:"checkboxRenderer"},{headerName:"Missing Bill",field:"missingBill",filter:"agSetColumnFilter",cellRenderer:"checkboxRenderer"},{headerName:"Missing Lien",field:"missingLien",filter:"agSetColumnFilter",cellRenderer:"checkboxRenderer"},{headerName:"Missing Medical Records",field:"missingMedicalRecords",filter:"agSetColumnFilter",cellRenderer:"checkboxRenderer"},{field:"assignedTo",filter:"agTextColumnFilter"},{field:"resubmitted",filter:"agDateColumnFilter"},{field:"treatmentCity",filter:"agTextColumnFilter"},{headerName:"Origination",field:"origination",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.origination,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{headerName:"Threshold Provider Rate",field:"thresholdProviderRate",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.thresholdProviderRate,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{headerName:"Threshold Location Rate",field:"thresholdLocationRate",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.thresholdLocationRate,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{field:"teamLeaderRateSource",filter:"agTextColumnFilter"},{field:"checkNumber",filter:"agTextColumnFilter"},{field:"accountDateReceived",filter:"agDateColumnFilter"},{field:"dateApplied",filter:"agDateColumnFilter"},{headerName:"Amount Applied",field:"amountApplied",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.amountApplied,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{field:"description",filter:"agTextColumnFilter"},{field:"note",filter:"agTextColumnFilter"},{headerName:"Medicare Rate",field:"medicareRate",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.medicareRate,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{headerName:"Provider Percent of Medicare",field:"providerPercentOfMedicare",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.providerPercentOfMedicare,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{headerName:"Contracted Amount",field:"contractedAmount",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.contractedAmount,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{headerName:"Markup Percent",field:"markupPercent",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.markupPercent,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{headerName:"Reimbursed Total",field:"reimbursedTotal",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.reimbursedTotal,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{headerName:"Initial Revenue",field:"initialRevenue",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.initialRevenue,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{headerName:"Factor",field:"factor",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.factor,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{headerName:"Retail Bill",field:"retailBill",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.retailBill,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{headerName:"Est Margin",field:"estMargin",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.estMargin,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{headerName:"Roi",field:"roi",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.roi,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{headerName:"Attorney Paid",field:"attorneyPaid",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.attorneyPaid,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{headerName:"Percent of Retail",field:"percentOfRetail",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.percentOfRetail,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{headerName:"Reimbursed From PCR",field:"reimbursedFromPCR",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.reimbursedFromPCR,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{headerName:"Ingredient Cost",field:"ingredientCost",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.ingredientCost,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{headerName:"Dispensing Cost",field:"dispensingCost",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.dispensingCost,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{headerName:"Administrative Cost",field:"administrativeCost",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.administrativeCost,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{headerName:"Co Pay",field:"coPay",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.coPay,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{headerName:"Total Cost",field:"totalCost",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.totalCost,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{headerName:"Average Wholesale Price",field:"averageWholesalePrice",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.averageWholesalePrice,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{headerName:"Weighted Average Cost",field:"weightedAverageCost",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.weightedAverageCost,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{headerName:"Average Sale Price",field:"averageSalePrice",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.averageSalePrice,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{headerName:"Invoice Cost",field:"invoiceCost",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.invoiceCost,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{headerName:"Usual and Customary",field:"usualAndCustomary",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.usualAndCustomary,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{field:"nationalDrugCode",filter:"agTextColumnFilter"},{field:"procedureVendorId",filter:"agTextColumnFilter",hide:!0}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-case-account-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",caseAccounts:"caseAccounts"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.caseAccounts)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function IS(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-case-account-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","caseAccount_edit")("formControl",t.formControl)("caseAccount",t.caseAccount)}}const DS=function(){return{}};function MS(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-case-account-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","caseAccount_create")("formControl",t.formControl)("caseAccount",e.DdM(3,DS))}}function WS(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-case-account-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("caseAccounts",o.data.items)}let ES=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadCaseAccountsEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.caseAccounts$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Qs))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","caseAccount","send","close"],[1,"w-full","h-full","bg-white",3,"caseAccounts","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,IS,2,3,"ng-template",null,1,e.W1O),e.YNc(3,MS,1,4,"ng-template",null,2,e.W1O),e.YNc(5,WS,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,Hr,qr],encapsulation:2}),s})();function OS(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-case-account-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","caseAccount_edit")("caseAccount",t.value)}}const LS=function(){return{}};function $S(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-case-account-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","caseAccount_create")("caseAccount",e.DdM(2,LS))}function GS(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-case-account-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("caseAccounts",t.items)}}let RS=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:6,consts:[[3,"data","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","caseAccount","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","caseAccounts","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,OS,1,2,"ng-template",null,1,e.W1O),e.YNc(3,$S,1,3,"ng-template",null,2,e.W1O),e.YNc(5,GS,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,Hr,qr],encapsulation:2}),s})(),QS=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[Qs],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"case-account-select",component:ES,wrappers:["form-field"]},{name:"case-account-grid",component:RS}]})]}),s})(),VS=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[QS]}),s})();class Tt extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class jS extends Tt{constructor(o,t,i){super("ValidateCaseAccountPaymentExcelDataAction"),this.valid=!1,this.excelData=o,this.payments=t,this.caseAccounts=i}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name),this.validationContext.addRule(new f.mi(`paymentName_${i}_is_valid}`,"Payment Is Not Valid","payment.name",t.payment,this.payments,!0)),this.validationContext.addRule(new f.mi(`caseAccountName_${i}_is_valid}`,"Case Account Is Not Valid","caseAccount.name",t.caseAccount,this.caseAccounts,!0))}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class US extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class JS extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new US("name","The caseaccountpayment name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class zS extends Tt{constructor(o){super("CreateCaseAccountPaymentAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new JS("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateCaseAccountPayment({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class HS extends Tt{constructor(o){super("UpdateCaseAccountPaymentsAction"),this.caseAccountPayments=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.caseAccountPayments,!0))}performAction(){this.response=this.businessProvider.data.userUpdateCaseAccountPayments({input:{caseAccountPayments:this.caseAccountPayments}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class qS extends Tt{constructor(o,t){super("UpdateCaseAccountPaymentAction"),this.caseAccountPayment=o,this.caseAccountPaymentId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.caseAccountPayment,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.caseAccountPaymentId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateCaseAccountPayment({caseAccountPaymentId:this.caseAccountPaymentId,input:this.caseAccountPayment}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let Kr=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.CaseAccountPaymentBusinessProviderService",t,a),this.data=i}createCaseAccountPayment(t){const i=new zS(t);return i.Do(this),i.response}updateCaseAccountPayment(t,i){const a=new qS(t,i);return a.Do(this),a.response}importCaseAccountPayments(t){const i=new HS(t);return i.Do(this),i.response}validateCaseAccountPaymentExcelData(t,i,a){const l=new jS(t,i,a);return l.Do(this),l.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),KS=(()=>{class s extends I.nH{constructor(t,i,a){super("CaseAccountPaymentService",a,t),this.businessProvider=i}createCaseAccountPayment(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createCaseAccountPayment(i)}updateCaseAccountPayment(t,i){return this.businessProvider.updateCaseAccountPayment(t,i)}importCaseAccountPayments(t){return this.businessProvider.importCaseAccountPayments(t)}validateCaseAccountPaymentExcelData(t,i,a){return this.businessProvider.validateCaseAccountPaymentExcelData(t,i,a)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(Kr,8),e.LFG(Kr),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),Vs=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){if(super({loading:!1,caseAccountPayments:[],done:!1,searchQuery:"",formName:void 0,paymentId:void 0,caseAccountId:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.caseAccountPaymentService=H,this.errors$=this.select(n=>n.errors),this.loading$=this.select(n=>n.loading),this.done$=this.select(n=>n.done),this.item$=this.select(n=>n.item),this.caseAccountPayments$=this.select(n=>n.caseAccountPayments),this.payments$=this.select(n=>n.payments||[]),this.caseAccounts$=this.select(n=>n.caseAccounts||[]),this.paymentId$=this.select(n=>n.paymentId),this.caseAccountId$=this.select(n=>n.caseAccountId),this.paging$=this.select(n=>n.paging),this.searchQuery$=this.select(n=>n.searchQuery),this.formName$=this.select(n=>n.formName),this.actionResult$=this.select(this.item$,this.done$,(n,r)=>({item:n,done:r}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.caseAccountPayments$,this.payments$,this.caseAccounts$,(n,r,m,p,_,w,J)=>({errors:n,loading:r,item:m,formName:p,caseAccountPayments:_,payments:w,caseAccounts:J}),{debounce:!0}),this.input$=this.select(this.paging$,this.paymentId$,this.caseAccountId$,this.searchQuery$,(n,r,m,p)=>({limit:n.limit,skip:n.skip,name:p,paymentId:r,caseAccountId:m,total:n.total})),this.setFormName=this.updater((n,r)=>Object.assign(Object.assign({},n),{formName:r})),this.setPaymentId=this.updater((n,r)=>Object.assign(Object.assign({},n),{paymentId:r})),this.setCaseAccountId=this.updater((n,r)=>Object.assign(Object.assign({},n),{caseAccountId:r})),this.filterPayments=n=>this.data.userSelectPayments({input:{name:n}}).pipe((0,g._b)(r=>{let m=r.data.items;return this.patchState({payments:m}),m},r=>this.patchState({errors:r.graphQLErrors?r.graphQLErrors:r})),(0,he.U)(r=>r.data.items)),this.filterCaseAccounts=n=>this.data.userSelectCaseAccounts({input:{name:n}}).pipe((0,g._b)(r=>{let m=r.data.items;return this.patchState({caseAccounts:m}),m},r=>this.patchState({errors:r.graphQLErrors?r.graphQLErrors:r})),(0,he.U)(r=>r.data.items)),this.addPayment=this.updater((n,r)=>Object.assign(Object.assign({},n),{payments:n.payments.concat(r)})),this.addCaseAccount=this.updater((n,r)=>Object.assign(Object.assign({},n),{caseAccounts:n.caseAccounts.concat(r)})),this.setItem=this.updater((n,r)=>Object.assign(Object.assign({},n),{item:r})),this.addNewCaseAccountPayment=this.updater((n,r)=>Object.assign(Object.assign({},n),{caseAccountPayments:[...n.caseAccountPayments,r]})),this.updateCaseAccountPayment=this.updater((n,r)=>Object.assign(Object.assign({},n),{caseAccountPayments:n.caseAccountPayments.map(m=>m.id===r.id?r:m)})),this.addCaseAccountPayments=this.updater((n,r)=>Object.assign(Object.assign({},n),{caseAccountPayments:n.caseAccountPayments.concat(r)})),this.updateCaseAccountPayments=this.updater((n,r)=>Object.assign(Object.assign({},n),{caseAccountPayments:n.caseAccountPayments.map(m=>r.find(_=>_.id===m.id)||m)})),this.setSearchQuery=this.updater((n,r)=>Object.assign(Object.assign({},n),{searchQuery:r})),this.loadCaseAccountPaymentEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(r=>this.data.userCaseAccountPayment({caseAccountPaymentId:r}).pipe((0,g._b)(m=>{this.patchState({item:m.data.item,errors:m.errors,loading:!1})},m=>this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})))))),this.loadCaseAccountPaymentsEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([r,m])=>this.data.userCaseAccountPayments({input:m}).pipe((0,g._b)(p=>this.patchState({paging:{limit:m.limit,skip:m.skip,total:p.data.count.total},caseAccountPayments:p.data.items,errors:p.errors,loading:!1}),p=>this.patchState({loading:!1,errors:p.graphQLErrors?p.graphQLErrors:p})))))),this.createCaseAccountPaymentEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(r=>this.caseAccountPaymentService.createCaseAccountPayment(Object.assign({},r)).pipe((0,g._b)(m=>{this.addNewCaseAccountPayment(m),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:m,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},m=>{m.graphQLErrors?(this.toast.error(m.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})):(this.toast.error(m.Message),this.formService.setErrors(m.Data))}))))),this.updateCaseAccountPaymentEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([r,m])=>this.caseAccountPaymentService.updateCaseAccountPayment(r,r.id).pipe((0,g._b)(p=>{this.updateCaseAccountPayment(p),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:p,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},p=>{p.graphQLErrors?(this.toast.error(p.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:p.graphQLErrors?p.graphQLErrors:p})):(this.toast.error(p.Message),this.formService.setErrors(p.Data))}))))),this.deleteCaseAccountPaymentEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([r,m])=>this.data.userDeleteCaseAccountPayment({caseAccountPaymentId:m.id}).pipe((0,g._b)(p=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:p.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},p=>{p.graphQLErrors?(this.toast.error(p.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:p.graphQLErrors?p.graphQLErrors:p})):(this.toast.error(p.Message),this.formService.setErrors(p.Data))}))))),this.importExcelEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(r=>this.caseAccountPaymentService.importCaseAccountPayments(r).pipe((0,ce.K)(m=>{var p;return this.toast.error(null!==(p=m.Message)&&void 0!==p?p:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(m=>{const p=JSON.parse(m.created),_=JSON.parse(m.updated),w=JSON.parse(m.failed),J=p.length+_.length+w.length;this.addCaseAccountPayments(p),this.updateCaseAccountPayments(_),this.toast.success(`${p.length} created, ${_.length} updated, ${w.length} failed of total ${J}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("caseAccountPaymentId")?(this.route.snapshot.paramMap.get("caseAccountPaymentId"),this.setFormName("caseAccountPayment_edit")):this.setFormName("caseAccountPayment_create"),this.route.snapshot.paramMap.has("paymentId")){var c=this.route.snapshot.paramMap.get("paymentId");this.setPaymentId(c)}if(this.route.snapshot.paramMap.has("caseAccountId")){var d=this.route.snapshot.paramMap.get("caseAccountId");this.setCaseAccountId(d)}}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.caseAccountPaymentService.validateCaseAccountPaymentExcelData(t,i.payments,i.caseAccounts)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(KS))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function ZS(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.caseAccountPayment)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let Zr=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"caseAccountPayment_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.caseAccountPayment=i.item})):t.formName&&t.formName.currentValue&&"caseAccountPayment_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadCaseAccountPaymentEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.caseAccountPayment=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Vs),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-case-account-payment-form"]],inputs:{caseAccountPayment:"caseAccountPayment",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,ZS,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),kr=(()=>{class s{constructor(){this.autoHeight=!1,this.caseAccountPayments=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[{field:"payment.name",headerName:"Payment",filter:"agTextColumnFilter"},{field:"caseAccount.name",headerName:"Case Account",filter:"agTextColumnFilter"},{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{headerName:"Amount Applied",field:"amountApplied",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.amountApplied,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{field:"paymentId",filter:"agTextColumnFilter",hide:!0},{field:"caseAccountId",filter:"agTextColumnFilter",hide:!0}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-case-account-payment-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",caseAccountPayments:"caseAccountPayments"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.caseAccountPayments)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function kS(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-case-account-payment-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","caseAccountPayment_edit")("formControl",t.formControl)("caseAccountPayment",t.caseAccountPayment)}}const BS=function(){return{}};function YS(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-case-account-payment-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","caseAccountPayment_create")("formControl",t.formControl)("caseAccountPayment",e.DdM(3,BS))}}function XS(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-case-account-payment-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("caseAccountPayments",o.data.items)}let eb=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadCaseAccountPaymentsEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.caseAccountPayments$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Vs))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","caseAccountPayment","send","close"],[1,"w-full","h-full","bg-white",3,"caseAccountPayments","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,kS,2,3,"ng-template",null,1,e.W1O),e.YNc(3,YS,1,4,"ng-template",null,2,e.W1O),e.YNc(5,XS,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,Zr,kr],encapsulation:2}),s})();function tb(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-case-account-payment-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","caseAccountPayment_edit")("caseAccountPayment",t.value)}}const ib=function(){return{}};function sb(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-case-account-payment-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","caseAccountPayment_create")("caseAccountPayment",e.DdM(2,ib))}function ob(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-case-account-payment-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("caseAccountPayments",t.items)}}let ab=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","caseAccountPayment","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","caseAccountPayments","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,tb,1,2,"ng-template",null,1,e.W1O),e.YNc(3,sb,1,3,"ng-template",null,2,e.W1O),e.YNc(5,ob,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,Zr,kr],encapsulation:2}),s})(),rb=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[Vs],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"case-account-payment-select",component:eb,wrappers:["form-field"]},{name:"case-account-payment-grid",component:ab}]})]}),s})(),nb=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[rb]}),s})();class yt extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class lb extends yt{constructor(o,t,i){super("ValidateCasePreAccidentExcelDataAction"),this.valid=!1,this.excelData=o,this.legalCases=t,this.legalCaseId=i}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name),this.validationContext.addRule(new f.mi(`legalCaseName_${i}_is_valid}`,"Legal Case Is Not Valid","legalCase.name",t.legalCase,this.legalCases,!0))}),this.legalCaseId&&this.excelData.map(t=>(t.legalCaseId=this.legalCaseId,t)),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class cb extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class db extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new cb("name","The casepreaccident name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class ub extends yt{constructor(o){super("CreateCasePreAccidentAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new db("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateCasePreAccident({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class mb extends yt{constructor(o,t){super("UpdateCasePreAccidentsAction"),this.casePreAccidents=o,this.legalCaseId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.casePreAccidents,!0))}performAction(){this.response=this.businessProvider.data.userUpdateCasePreAccidents({input:{casePreAccidents:this.casePreAccidents}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class pb extends yt{constructor(o,t){super("UpdateCasePreAccidentAction"),this.casePreAccident=o,this.casePreAccidentId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.casePreAccident,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.casePreAccidentId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateCasePreAccident({casePreAccidentId:this.casePreAccidentId,input:this.casePreAccident}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let Br=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.CasePreAccidentBusinessProviderService",t,a),this.data=i}createCasePreAccident(t){const i=new ub(t);return i.Do(this),i.response}updateCasePreAccident(t,i){const a=new pb(t,i);return a.Do(this),a.response}importCasePreAccidents(t){const i=new mb(t);return i.Do(this),i.response}validateCasePreAccidentExcelData(t,i,a){const l=new lb(t,i,a);return l.Do(this),l.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),hb=(()=>{class s extends I.nH{constructor(t,i,a){super("CasePreAccidentService",a,t),this.businessProvider=i}createCasePreAccident(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createCasePreAccident(i)}updateCasePreAccident(t,i){return this.businessProvider.updateCasePreAccident(t,i)}importCasePreAccidents(t){return this.businessProvider.importCasePreAccidents(t)}validateCasePreAccidentExcelData(t,i,a){return this.businessProvider.validateCasePreAccidentExcelData(t,i,a)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(Br,8),e.LFG(Br),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),js=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){if(super({loading:!1,casePreAccidents:[],done:!1,searchQuery:"",formName:void 0,legalCaseId:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.casePreAccidentService=H,this.errors$=this.select(d=>d.errors),this.loading$=this.select(d=>d.loading),this.done$=this.select(d=>d.done),this.item$=this.select(d=>d.item),this.casePreAccidents$=this.select(d=>d.casePreAccidents),this.legalCases$=this.select(d=>d.legalCases||[]),this.legalCaseId$=this.select(d=>d.legalCaseId),this.paging$=this.select(d=>d.paging),this.searchQuery$=this.select(d=>d.searchQuery),this.formName$=this.select(d=>d.formName),this.actionResult$=this.select(this.item$,this.done$,(d,n)=>({item:d,done:n}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.casePreAccidents$,this.legalCases$,this.legalCaseId$,(d,n,r,m,p,_,w)=>({errors:d,loading:n,item:r,formName:m,casePreAccidents:p,legalCases:_,legalCaseId:w}),{debounce:!0}),this.input$=this.select(this.paging$,this.legalCaseId$,this.searchQuery$,(d,n,r)=>({limit:d.limit,skip:d.skip,name:r,legalCaseId:n,total:d.total})),this.setFormName=this.updater((d,n)=>Object.assign(Object.assign({},d),{formName:n})),this.setLegalCaseId=this.updater((d,n)=>Object.assign(Object.assign({},d),{legalCaseId:n})),this.filterLegalCases=d=>this.data.userSelectLegalCases({input:{name:d}}).pipe((0,g._b)(n=>{let r=n.data.items;return this.patchState({legalCases:r}),r},n=>this.patchState({errors:n.graphQLErrors?n.graphQLErrors:n})),(0,he.U)(n=>n.data.items)),this.addLegalCase=this.updater((d,n)=>Object.assign(Object.assign({},d),{legalCases:d.legalCases.concat(n)})),this.setItem=this.updater((d,n)=>Object.assign(Object.assign({},d),{item:n})),this.addNewCasePreAccident=this.updater((d,n)=>Object.assign(Object.assign({},d),{casePreAccidents:[...d.casePreAccidents,n]})),this.updateCasePreAccident=this.updater((d,n)=>Object.assign(Object.assign({},d),{casePreAccidents:d.casePreAccidents.map(r=>r.id===n.id?n:r)})),this.addCasePreAccidents=this.updater((d,n)=>Object.assign(Object.assign({},d),{casePreAccidents:d.casePreAccidents.concat(n)})),this.updateCasePreAccidents=this.updater((d,n)=>Object.assign(Object.assign({},d),{casePreAccidents:d.casePreAccidents.map(r=>n.find(p=>p.id===r.id)||r)})),this.setSearchQuery=this.updater((d,n)=>Object.assign(Object.assign({},d),{searchQuery:n})),this.loadCasePreAccidentEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(n=>this.data.userCasePreAccident({casePreAccidentId:n}).pipe((0,g._b)(r=>{this.patchState({item:r.data.item,errors:r.errors,loading:!1})},r=>this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})))))),this.loadCasePreAccidentsEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([n,r])=>this.data.userCasePreAccidents({input:r}).pipe((0,g._b)(m=>this.patchState({paging:{limit:r.limit,skip:r.skip,total:m.data.count.total},casePreAccidents:m.data.items,errors:m.errors,loading:!1}),m=>this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})))))),this.createCasePreAccidentEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(n=>this.casePreAccidentService.createCasePreAccident(Object.assign({},n)).pipe((0,g._b)(r=>{this.addNewCasePreAccident(r),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:r,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.updateCasePreAccidentEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([n,r])=>this.casePreAccidentService.updateCasePreAccident(n,n.id).pipe((0,g._b)(m=>{this.updateCasePreAccident(m),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:m,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},m=>{m.graphQLErrors?(this.toast.error(m.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})):(this.toast.error(m.Message),this.formService.setErrors(m.Data))}))))),this.deleteCasePreAccidentEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([n,r])=>this.data.userDeleteCasePreAccident({casePreAccidentId:r.id}).pipe((0,g._b)(m=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:m.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},m=>{m.graphQLErrors?(this.toast.error(m.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})):(this.toast.error(m.Message),this.formService.setErrors(m.Data))}))))),this.importExcelEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(n=>this.casePreAccidentService.importCasePreAccidents(n).pipe((0,ce.K)(r=>{var m;return this.toast.error(null!==(m=r.Message)&&void 0!==m?m:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(r=>{const m=JSON.parse(r.created),p=JSON.parse(r.updated),_=JSON.parse(r.failed),w=m.length+p.length+_.length;this.addCasePreAccidents(m),this.updateCasePreAccidents(p),this.toast.success(`${m.length} created, ${p.length} updated, ${_.length} failed of total ${w}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("casePreAccidentId")?(this.route.snapshot.paramMap.get("casePreAccidentId"),this.setFormName("casePreAccident_edit")):this.setFormName("casePreAccident_create"),this.route.snapshot.paramMap.has("legalCaseId")){var c=this.route.snapshot.paramMap.get("legalCaseId");this.setLegalCaseId(c)}}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>{const a=i.legalCaseId;return console.log("legalCaseId",a),this.casePreAccidentService.validateCasePreAccidentExcelData(t,i.legalCases,a)}))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(hb))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function fb(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.casePreAccident)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let Yr=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"casePreAccident_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.casePreAccident=i.item})):t.formName&&t.formName.currentValue&&"casePreAccident_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadCasePreAccidentEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.casePreAccident=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(js),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-case-pre-accident-form"]],inputs:{casePreAccident:"casePreAccident",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,fb,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),Xr=(()=>{class s{constructor(){this.autoHeight=!1,this.casePreAccidents=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[{field:"legalCase.name",headerName:"Legal Case",filter:"agTextColumnFilter"},{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{field:"legalCaseId",filter:"agTextColumnFilter",hide:!0},{field:"accidentDate",filter:"agTextColumnFilter"},{field:"injuries",filter:"agTextColumnFilter"},{field:"symptoms",filter:"agTextColumnFilter"},{field:"dateCreated",filter:"agDateColumnFilter"},{headerName:"Removed",field:"removed",filter:"agSetColumnFilter",cellRenderer:"checkboxRenderer"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-case-pre-accident-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",casePreAccidents:"casePreAccidents"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.casePreAccidents)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function _b(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-case-pre-accident-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","casePreAccident_edit")("formControl",t.formControl)("casePreAccident",t.casePreAccident)}}const gb=function(){return{}};function Cb(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-case-pre-accident-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","casePreAccident_create")("formControl",t.formControl)("casePreAccident",e.DdM(3,gb))}}function vb(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-case-pre-accident-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("casePreAccidents",o.data.items)}let Sb=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadCasePreAccidentsEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.casePreAccidents$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(js))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","casePreAccident","send","close"],[1,"w-full","h-full","bg-white",3,"casePreAccidents","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,_b,2,3,"ng-template",null,1,e.W1O),e.YNc(3,Cb,1,4,"ng-template",null,2,e.W1O),e.YNc(5,vb,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,Yr,Xr],encapsulation:2}),s})();function bb(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-case-pre-accident-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","casePreAccident_edit")("casePreAccident",t.value)}}const Tb=function(){return{}};function yb(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-case-pre-accident-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","casePreAccident_create")("casePreAccident",e.DdM(2,Tb))}function wb(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-case-pre-accident-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("casePreAccidents",t.items)}}let xb=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","casePreAccident","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","casePreAccidents","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,bb,1,2,"ng-template",null,1,e.W1O),e.YNc(3,yb,1,3,"ng-template",null,2,e.W1O),e.YNc(5,wb,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,Yr,Xr],encapsulation:2}),s})(),Nb=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[js],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"case-pre-accident-select",component:Sb,wrappers:["form-field"]},{name:"case-pre-accident-grid",component:xb}]})]}),s})(),Ab=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[Nb]}),s})();class wt extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class Fb extends wt{constructor(o,t){super("ValidateCasePreInjuryExcelDataAction"),this.valid=!1,this.excelData=o,this.legalCases=t}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name),this.validationContext.addRule(new f.mi(`legalCaseName_${i}_is_valid}`,"Legal Case Is Not Valid","legalCase.name",t.legalCase,this.legalCases,!0))}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class Pb extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class Ib extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new Pb("name","The casepreinjury name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class Db extends wt{constructor(o){super("CreateCasePreInjuryAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new Ib("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateCasePreInjury({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class Mb extends wt{constructor(o){super("UpdateCasePreInjuriesAction"),this.casePreInjuries=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.casePreInjuries,!0))}performAction(){this.response=this.businessProvider.data.userUpdateCasePreInjuries({input:{casePreInjuries:this.casePreInjuries}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class Wb extends wt{constructor(o,t){super("UpdateCasePreInjuryAction"),this.casePreInjury=o,this.casePreInjuryId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.casePreInjury,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.casePreInjuryId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateCasePreInjury({casePreInjuryId:this.casePreInjuryId,input:this.casePreInjury}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let en=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.CasePreInjuryBusinessProviderService",t,a),this.data=i}createCasePreInjury(t){const i=new Db(t);return i.Do(this),i.response}updateCasePreInjury(t,i){const a=new Wb(t,i);return a.Do(this),a.response}importCasePreInjuries(t){const i=new Mb(t);return i.Do(this),i.response}validateCasePreInjuryExcelData(t,i){const a=new Fb(t,i);return a.Do(this),a.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),Eb=(()=>{class s extends I.nH{constructor(t,i,a){super("CasePreInjuryService",a,t),this.businessProvider=i}createCasePreInjury(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createCasePreInjury(i)}updateCasePreInjury(t,i){return this.businessProvider.updateCasePreInjury(t,i)}importCasePreInjuries(t){return this.businessProvider.importCasePreInjuries(t)}validateCasePreInjuryExcelData(t,i){return this.businessProvider.validateCasePreInjuryExcelData(t,i)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(en,8),e.LFG(en),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),Us=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){if(super({loading:!1,casePreInjuries:[],done:!1,searchQuery:"",formName:void 0,legalCaseId:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.casePreInjuryService=H,this.errors$=this.select(d=>d.errors),this.loading$=this.select(d=>d.loading),this.done$=this.select(d=>d.done),this.item$=this.select(d=>d.item),this.casePreInjuries$=this.select(d=>d.casePreInjuries),this.legalCases$=this.select(d=>d.legalCases||[]),this.legalCaseId$=this.select(d=>d.legalCaseId),this.paging$=this.select(d=>d.paging),this.searchQuery$=this.select(d=>d.searchQuery),this.formName$=this.select(d=>d.formName),this.actionResult$=this.select(this.item$,this.done$,(d,n)=>({item:d,done:n}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.casePreInjuries$,this.legalCases$,(d,n,r,m,p,_)=>({errors:d,loading:n,item:r,formName:m,casePreInjuries:p,legalCases:_}),{debounce:!0}),this.input$=this.select(this.paging$,this.legalCaseId$,this.searchQuery$,(d,n,r)=>({limit:d.limit,skip:d.skip,name:r,legalCaseId:n,total:d.total})),this.setFormName=this.updater((d,n)=>Object.assign(Object.assign({},d),{formName:n})),this.setLegalCaseId=this.updater((d,n)=>Object.assign(Object.assign({},d),{legalCaseId:n})),this.filterLegalCases=d=>this.data.userSelectLegalCases({input:{name:d}}).pipe((0,g._b)(n=>{let r=n.data.items;return this.patchState({legalCases:r}),r},n=>this.patchState({errors:n.graphQLErrors?n.graphQLErrors:n})),(0,he.U)(n=>n.data.items)),this.addLegalCase=this.updater((d,n)=>Object.assign(Object.assign({},d),{legalCases:d.legalCases.concat(n)})),this.setItem=this.updater((d,n)=>Object.assign(Object.assign({},d),{item:n})),this.addNewCasePreInjury=this.updater((d,n)=>Object.assign(Object.assign({},d),{casePreInjuries:[...d.casePreInjuries,n]})),this.updateCasePreInjury=this.updater((d,n)=>Object.assign(Object.assign({},d),{casePreInjuries:d.casePreInjuries.map(r=>r.id===n.id?n:r)})),this.addCasePreInjuries=this.updater((d,n)=>Object.assign(Object.assign({},d),{casePreInjuries:d.casePreInjuries.concat(n)})),this.updateCasePreInjuries=this.updater((d,n)=>Object.assign(Object.assign({},d),{casePreInjuries:d.casePreInjuries.map(r=>n.find(p=>p.id===r.id)||r)})),this.setSearchQuery=this.updater((d,n)=>Object.assign(Object.assign({},d),{searchQuery:n})),this.loadCasePreInjuryEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(n=>this.data.userCasePreInjury({casePreInjuryId:n}).pipe((0,g._b)(r=>{this.patchState({item:r.data.item,errors:r.errors,loading:!1})},r=>this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})))))),this.loadCasePreInjuriesEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([n,r])=>this.data.userCasePreInjuries({input:r}).pipe((0,g._b)(m=>this.patchState({paging:{limit:r.limit,skip:r.skip,total:m.data.count.total},casePreInjuries:m.data.items,errors:m.errors,loading:!1}),m=>this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})))))),this.createCasePreInjuryEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(n=>this.casePreInjuryService.createCasePreInjury(Object.assign({},n)).pipe((0,g._b)(r=>{this.addNewCasePreInjury(r),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:r,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.updateCasePreInjuryEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([n,r])=>this.casePreInjuryService.updateCasePreInjury(n,n.id).pipe((0,g._b)(m=>{this.updateCasePreInjury(m),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:m,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},m=>{m.graphQLErrors?(this.toast.error(m.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})):(this.toast.error(m.Message),this.formService.setErrors(m.Data))}))))),this.deleteCasePreInjuryEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([n,r])=>this.data.userDeleteCasePreInjury({casePreInjuryId:r.id}).pipe((0,g._b)(m=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:m.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},m=>{m.graphQLErrors?(this.toast.error(m.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})):(this.toast.error(m.Message),this.formService.setErrors(m.Data))}))))),this.importExcelEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(n=>this.casePreInjuryService.importCasePreInjuries(n).pipe((0,ce.K)(r=>{var m;return this.toast.error(null!==(m=r.Message)&&void 0!==m?m:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(r=>{const m=JSON.parse(r.created),p=JSON.parse(r.updated),_=JSON.parse(r.failed),w=m.length+p.length+_.length;this.addCasePreInjuries(m),this.updateCasePreInjuries(p),this.toast.success(`${m.length} created, ${p.length} updated, ${_.length} failed of total ${w}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("casePreInjuryId")?(this.route.snapshot.paramMap.get("casePreInjuryId"),this.setFormName("casePreInjury_edit")):this.setFormName("casePreInjury_create"),this.route.snapshot.paramMap.has("legalCaseId")){var c=this.route.snapshot.paramMap.get("legalCaseId");this.setLegalCaseId(c)}}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.casePreInjuryService.validateCasePreInjuryExcelData(t,i.legalCases)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(Eb))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function Ob(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.casePreInjury)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let tn=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"casePreInjury_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.casePreInjury=i.item})):t.formName&&t.formName.currentValue&&"casePreInjury_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadCasePreInjuryEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.casePreInjury=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Us),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-case-pre-injury-form"]],inputs:{casePreInjury:"casePreInjury",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,Ob,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),sn=(()=>{class s{constructor(){this.autoHeight=!1,this.casePreInjuries=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[{field:"legalCase.name",headerName:"Legal Case",filter:"agTextColumnFilter"},{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{field:"legalCaseId",filter:"agTextColumnFilter",hide:!0},{headerName:"Affects Injury",field:"affectsInjury",filter:"agSetColumnFilter",cellRenderer:"checkboxRenderer"},{field:"injuryDate",filter:"agTextColumnFilter"},{field:"injured",filter:"agTextColumnFilter"},{field:"anatomic",filter:"agTextColumnFilter"},{field:"dateCreated",filter:"agDateColumnFilter"},{headerName:"Removed",field:"removed",filter:"agSetColumnFilter",cellRenderer:"checkboxRenderer"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-case-pre-injury-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",casePreInjuries:"casePreInjuries"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.casePreInjuries)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function Lb(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-case-pre-injury-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","casePreInjury_edit")("formControl",t.formControl)("casePreInjury",t.casePreInjury)}}const $b=function(){return{}};function Gb(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-case-pre-injury-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","casePreInjury_create")("formControl",t.formControl)("casePreInjury",e.DdM(3,$b))}}function Rb(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-case-pre-injury-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("casePreInjuries",o.data.items)}let Qb=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadCasePreInjuriesEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.casePreInjuries$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Us))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","casePreInjury","send","close"],[1,"w-full","h-full","bg-white",3,"casePreInjuries","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,Lb,2,3,"ng-template",null,1,e.W1O),e.YNc(3,Gb,1,4,"ng-template",null,2,e.W1O),e.YNc(5,Rb,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,tn,sn],encapsulation:2}),s})();function Vb(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-case-pre-injury-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","casePreInjury_edit")("casePreInjury",t.value)}}const jb=function(){return{}};function Ub(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-case-pre-injury-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","casePreInjury_create")("casePreInjury",e.DdM(2,jb))}function Jb(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-case-pre-injury-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("casePreInjuries",t.items)}}let zb=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","casePreInjury","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","casePreInjuries","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,Vb,1,2,"ng-template",null,1,e.W1O),e.YNc(3,Ub,1,3,"ng-template",null,2,e.W1O),e.YNc(5,Jb,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,tn,sn],encapsulation:2}),s})(),Hb=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[Us],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"case-pre-injury-select",component:Qb,wrappers:["form-field"]},{name:"case-pre-injury-grid",component:zb}]})]}),s})(),qb=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[Hb]}),s})();class xt extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class Kb extends xt{constructor(o,t){super("ValidateCasePreProblemExcelDataAction"),this.valid=!1,this.excelData=o,this.legalCases=t}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name),this.validationContext.addRule(new f.mi(`legalCaseName_${i}_is_valid}`,"Legal Case Is Not Valid","legalCase.name",t.legalCase,this.legalCases,!0))}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class Zb extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class kb extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new Zb("name","The casepreproblem name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class Bb extends xt{constructor(o){super("CreateCasePreProblemAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new kb("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateCasePreProblem({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class Yb extends xt{constructor(o){super("UpdateCasePreProblemsAction"),this.casePreProblems=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.casePreProblems,!0))}performAction(){this.response=this.businessProvider.data.userUpdateCasePreProblems({input:{casePreProblems:this.casePreProblems}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class Xb extends xt{constructor(o,t){super("UpdateCasePreProblemAction"),this.casePreProblem=o,this.casePreProblemId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.casePreProblem,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.casePreProblemId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateCasePreProblem({casePreProblemId:this.casePreProblemId,input:this.casePreProblem}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let on=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.CasePreProblemBusinessProviderService",t,a),this.data=i}createCasePreProblem(t){const i=new Bb(t);return i.Do(this),i.response}updateCasePreProblem(t,i){const a=new Xb(t,i);return a.Do(this),a.response}importCasePreProblems(t){const i=new Yb(t);return i.Do(this),i.response}validateCasePreProblemExcelData(t,i){const a=new Kb(t,i);return a.Do(this),a.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),e0=(()=>{class s extends I.nH{constructor(t,i,a){super("CasePreProblemService",a,t),this.businessProvider=i}createCasePreProblem(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createCasePreProblem(i)}updateCasePreProblem(t,i){return this.businessProvider.updateCasePreProblem(t,i)}importCasePreProblems(t){return this.businessProvider.importCasePreProblems(t)}validateCasePreProblemExcelData(t,i){return this.businessProvider.validateCasePreProblemExcelData(t,i)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(on,8),e.LFG(on),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),Js=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){if(super({loading:!1,casePreProblems:[],done:!1,searchQuery:"",formName:void 0,legalCaseId:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.casePreProblemService=H,this.errors$=this.select(d=>d.errors),this.loading$=this.select(d=>d.loading),this.done$=this.select(d=>d.done),this.item$=this.select(d=>d.item),this.casePreProblems$=this.select(d=>d.casePreProblems),this.legalCases$=this.select(d=>d.legalCases||[]),this.legalCaseId$=this.select(d=>d.legalCaseId),this.paging$=this.select(d=>d.paging),this.searchQuery$=this.select(d=>d.searchQuery),this.formName$=this.select(d=>d.formName),this.actionResult$=this.select(this.item$,this.done$,(d,n)=>({item:d,done:n}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.casePreProblems$,this.legalCases$,(d,n,r,m,p,_)=>({errors:d,loading:n,item:r,formName:m,casePreProblems:p,legalCases:_}),{debounce:!0}),this.input$=this.select(this.paging$,this.legalCaseId$,this.searchQuery$,(d,n,r)=>({limit:d.limit,skip:d.skip,name:r,legalCaseId:n,total:d.total})),this.setFormName=this.updater((d,n)=>Object.assign(Object.assign({},d),{formName:n})),this.setLegalCaseId=this.updater((d,n)=>Object.assign(Object.assign({},d),{legalCaseId:n})),this.filterLegalCases=d=>this.data.userSelectLegalCases({input:{name:d}}).pipe((0,g._b)(n=>{let r=n.data.items;return this.patchState({legalCases:r}),r},n=>this.patchState({errors:n.graphQLErrors?n.graphQLErrors:n})),(0,he.U)(n=>n.data.items)),this.addLegalCase=this.updater((d,n)=>Object.assign(Object.assign({},d),{legalCases:d.legalCases.concat(n)})),this.setItem=this.updater((d,n)=>Object.assign(Object.assign({},d),{item:n})),this.addNewCasePreProblem=this.updater((d,n)=>Object.assign(Object.assign({},d),{casePreProblems:[...d.casePreProblems,n]})),this.updateCasePreProblem=this.updater((d,n)=>Object.assign(Object.assign({},d),{casePreProblems:d.casePreProblems.map(r=>r.id===n.id?n:r)})),this.addCasePreProblems=this.updater((d,n)=>Object.assign(Object.assign({},d),{casePreProblems:d.casePreProblems.concat(n)})),this.updateCasePreProblems=this.updater((d,n)=>Object.assign(Object.assign({},d),{casePreProblems:d.casePreProblems.map(r=>n.find(p=>p.id===r.id)||r)})),this.setSearchQuery=this.updater((d,n)=>Object.assign(Object.assign({},d),{searchQuery:n})),this.loadCasePreProblemEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(n=>this.data.userCasePreProblem({casePreProblemId:n}).pipe((0,g._b)(r=>{this.patchState({item:r.data.item,errors:r.errors,loading:!1})},r=>this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})))))),this.loadCasePreProblemsEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([n,r])=>this.data.userCasePreProblems({input:r}).pipe((0,g._b)(m=>this.patchState({paging:{limit:r.limit,skip:r.skip,total:m.data.count.total},casePreProblems:m.data.items,errors:m.errors,loading:!1}),m=>this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})))))),this.createCasePreProblemEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(n=>this.casePreProblemService.createCasePreProblem(Object.assign({},n)).pipe((0,g._b)(r=>{this.addNewCasePreProblem(r),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:r,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.updateCasePreProblemEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([n,r])=>this.casePreProblemService.updateCasePreProblem(n,n.id).pipe((0,g._b)(m=>{this.updateCasePreProblem(m),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:m,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},m=>{m.graphQLErrors?(this.toast.error(m.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})):(this.toast.error(m.Message),this.formService.setErrors(m.Data))}))))),this.deleteCasePreProblemEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([n,r])=>this.data.userDeleteCasePreProblem({casePreProblemId:r.id}).pipe((0,g._b)(m=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:m.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},m=>{m.graphQLErrors?(this.toast.error(m.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})):(this.toast.error(m.Message),this.formService.setErrors(m.Data))}))))),this.importExcelEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(n=>this.casePreProblemService.importCasePreProblems(n).pipe((0,ce.K)(r=>{var m;return this.toast.error(null!==(m=r.Message)&&void 0!==m?m:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(r=>{const m=JSON.parse(r.created),p=JSON.parse(r.updated),_=JSON.parse(r.failed),w=m.length+p.length+_.length;this.addCasePreProblems(m),this.updateCasePreProblems(p),this.toast.success(`${m.length} created, ${p.length} updated, ${_.length} failed of total ${w}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("casePreProblemId")?(this.route.snapshot.paramMap.get("casePreProblemId"),this.setFormName("casePreProblem_edit")):this.setFormName("casePreProblem_create"),this.route.snapshot.paramMap.has("legalCaseId")){var c=this.route.snapshot.paramMap.get("legalCaseId");this.setLegalCaseId(c)}}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.casePreProblemService.validateCasePreProblemExcelData(t,i.legalCases)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(e0))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function t0(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.casePreProblem)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let an=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"casePreProblem_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.casePreProblem=i.item})):t.formName&&t.formName.currentValue&&"casePreProblem_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadCasePreProblemEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.casePreProblem=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Js),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-case-pre-problem-form"]],inputs:{casePreProblem:"casePreProblem",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,t0,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),rn=(()=>{class s{constructor(){this.autoHeight=!1,this.casePreProblems=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[{field:"legalCase.name",headerName:"Legal Case",filter:"agTextColumnFilter"},{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{field:"legalCaseId",filter:"agTextColumnFilter",hide:!0},{headerName:"Same Region",field:"sameRegion",filter:"agSetColumnFilter",cellRenderer:"checkboxRenderer"},{field:"problemDate",filter:"agDateColumnFilter"},{field:"duration",filter:"agTextColumnFilter"},{field:"symptoms",filter:"agTextColumnFilter"},{field:"regions",filter:"agTextColumnFilter"},{headerName:"Removed",field:"removed",filter:"agSetColumnFilter",cellRenderer:"checkboxRenderer"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-case-pre-problem-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",casePreProblems:"casePreProblems"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.casePreProblems)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function i0(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-case-pre-problem-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","casePreProblem_edit")("formControl",t.formControl)("casePreProblem",t.casePreProblem)}}const s0=function(){return{}};function o0(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-case-pre-problem-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","casePreProblem_create")("formControl",t.formControl)("casePreProblem",e.DdM(3,s0))}}function a0(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-case-pre-problem-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("casePreProblems",o.data.items)}let r0=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadCasePreProblemsEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.casePreProblems$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Js))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","casePreProblem","send","close"],[1,"w-full","h-full","bg-white",3,"casePreProblems","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,i0,2,3,"ng-template",null,1,e.W1O),e.YNc(3,o0,1,4,"ng-template",null,2,e.W1O),e.YNc(5,a0,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,an,rn],encapsulation:2}),s})();function n0(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-case-pre-problem-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","casePreProblem_edit")("casePreProblem",t.value)}}const l0=function(){return{}};function c0(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-case-pre-problem-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","casePreProblem_create")("casePreProblem",e.DdM(2,l0))}function d0(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-case-pre-problem-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("casePreProblems",t.items)}}let u0=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","casePreProblem","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","casePreProblems","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,n0,1,2,"ng-template",null,1,e.W1O),e.YNc(3,c0,1,3,"ng-template",null,2,e.W1O),e.YNc(5,d0,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,an,rn],encapsulation:2}),s})(),m0=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[Js],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"case-pre-problem-select",component:r0,wrappers:["form-field"]},{name:"case-pre-problem-grid",component:u0}]})]}),s})(),p0=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[m0]}),s})();class Nt extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class h0 extends Nt{constructor(o,t){super("ValidateCasePreProcedureExcelDataAction"),this.valid=!1,this.excelData=o,this.legalCases=t}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name),this.validationContext.addRule(new f.mi(`legalCaseName_${i}_is_valid}`,"Legal Case Is Not Valid","legalCase.name",t.legalCase,this.legalCases,!0))}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class f0 extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class _0 extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new f0("name","The casepreprocedure name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class g0 extends Nt{constructor(o){super("CreateCasePreProcedureAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new _0("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateCasePreProcedure({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class C0 extends Nt{constructor(o){super("UpdateCasePreProceduresAction"),this.casePreProcedures=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.casePreProcedures,!0))}performAction(){this.response=this.businessProvider.data.userUpdateCasePreProcedures({input:{casePreProcedures:this.casePreProcedures}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class v0 extends Nt{constructor(o,t){super("UpdateCasePreProcedureAction"),this.casePreProcedure=o,this.casePreProcedureId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.casePreProcedure,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.casePreProcedureId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateCasePreProcedure({casePreProcedureId:this.casePreProcedureId,input:this.casePreProcedure}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let nn=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.CasePreProcedureBusinessProviderService",t,a),this.data=i}createCasePreProcedure(t){const i=new g0(t);return i.Do(this),i.response}updateCasePreProcedure(t,i){const a=new v0(t,i);return a.Do(this),a.response}importCasePreProcedures(t){const i=new C0(t);return i.Do(this),i.response}validateCasePreProcedureExcelData(t,i){const a=new h0(t,i);return a.Do(this),a.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),S0=(()=>{class s extends I.nH{constructor(t,i,a){super("CasePreProcedureService",a,t),this.businessProvider=i}createCasePreProcedure(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createCasePreProcedure(i)}updateCasePreProcedure(t,i){return this.businessProvider.updateCasePreProcedure(t,i)}importCasePreProcedures(t){return this.businessProvider.importCasePreProcedures(t)}validateCasePreProcedureExcelData(t,i){return this.businessProvider.validateCasePreProcedureExcelData(t,i)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(nn,8),e.LFG(nn),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),zs=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){if(super({loading:!1,casePreProcedures:[],done:!1,searchQuery:"",formName:void 0,legalCaseId:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.casePreProcedureService=H,this.errors$=this.select(d=>d.errors),this.loading$=this.select(d=>d.loading),this.done$=this.select(d=>d.done),this.item$=this.select(d=>d.item),this.casePreProcedures$=this.select(d=>d.casePreProcedures),this.legalCases$=this.select(d=>d.legalCases||[]),this.legalCaseId$=this.select(d=>d.legalCaseId),this.paging$=this.select(d=>d.paging),this.searchQuery$=this.select(d=>d.searchQuery),this.formName$=this.select(d=>d.formName),this.actionResult$=this.select(this.item$,this.done$,(d,n)=>({item:d,done:n}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.casePreProcedures$,this.legalCases$,(d,n,r,m,p,_)=>({errors:d,loading:n,item:r,formName:m,casePreProcedures:p,legalCases:_}),{debounce:!0}),this.input$=this.select(this.paging$,this.legalCaseId$,this.searchQuery$,(d,n,r)=>({limit:d.limit,skip:d.skip,name:r,legalCaseId:n,total:d.total})),this.setFormName=this.updater((d,n)=>Object.assign(Object.assign({},d),{formName:n})),this.setLegalCaseId=this.updater((d,n)=>Object.assign(Object.assign({},d),{legalCaseId:n})),this.filterLegalCases=d=>this.data.userSelectLegalCases({input:{name:d}}).pipe((0,g._b)(n=>{let r=n.data.items;return this.patchState({legalCases:r}),r},n=>this.patchState({errors:n.graphQLErrors?n.graphQLErrors:n})),(0,he.U)(n=>n.data.items)),this.addLegalCase=this.updater((d,n)=>Object.assign(Object.assign({},d),{legalCases:d.legalCases.concat(n)})),this.setItem=this.updater((d,n)=>Object.assign(Object.assign({},d),{item:n})),this.addNewCasePreProcedure=this.updater((d,n)=>Object.assign(Object.assign({},d),{casePreProcedures:[...d.casePreProcedures,n]})),this.updateCasePreProcedure=this.updater((d,n)=>Object.assign(Object.assign({},d),{casePreProcedures:d.casePreProcedures.map(r=>r.id===n.id?n:r)})),this.addCasePreProcedures=this.updater((d,n)=>Object.assign(Object.assign({},d),{casePreProcedures:d.casePreProcedures.concat(n)})),this.updateCasePreProcedures=this.updater((d,n)=>Object.assign(Object.assign({},d),{casePreProcedures:d.casePreProcedures.map(r=>n.find(p=>p.id===r.id)||r)})),this.setSearchQuery=this.updater((d,n)=>Object.assign(Object.assign({},d),{searchQuery:n})),this.loadCasePreProcedureEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(n=>this.data.userCasePreProcedure({casePreProcedureId:n}).pipe((0,g._b)(r=>{this.patchState({item:r.data.item,errors:r.errors,loading:!1})},r=>this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})))))),this.loadCasePreProceduresEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([n,r])=>this.data.userCasePreProcedures({input:r}).pipe((0,g._b)(m=>this.patchState({paging:{limit:r.limit,skip:r.skip,total:m.data.count.total},casePreProcedures:m.data.items,errors:m.errors,loading:!1}),m=>this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})))))),this.createCasePreProcedureEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(n=>this.casePreProcedureService.createCasePreProcedure(Object.assign({},n)).pipe((0,g._b)(r=>{this.addNewCasePreProcedure(r),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:r,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.updateCasePreProcedureEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([n,r])=>this.casePreProcedureService.updateCasePreProcedure(n,n.id).pipe((0,g._b)(m=>{this.updateCasePreProcedure(m),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:m,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},m=>{m.graphQLErrors?(this.toast.error(m.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})):(this.toast.error(m.Message),this.formService.setErrors(m.Data))}))))),this.deleteCasePreProcedureEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([n,r])=>this.data.userDeleteCasePreProcedure({casePreProcedureId:r.id}).pipe((0,g._b)(m=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:m.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},m=>{m.graphQLErrors?(this.toast.error(m.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})):(this.toast.error(m.Message),this.formService.setErrors(m.Data))}))))),this.importExcelEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(n=>this.casePreProcedureService.importCasePreProcedures(n).pipe((0,ce.K)(r=>{var m;return this.toast.error(null!==(m=r.Message)&&void 0!==m?m:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(r=>{const m=JSON.parse(r.created),p=JSON.parse(r.updated),_=JSON.parse(r.failed),w=m.length+p.length+_.length;this.addCasePreProcedures(m),this.updateCasePreProcedures(p),this.toast.success(`${m.length} created, ${p.length} updated, ${_.length} failed of total ${w}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("casePreProcedureId")?(this.route.snapshot.paramMap.get("casePreProcedureId"),this.setFormName("casePreProcedure_edit")):this.setFormName("casePreProcedure_create"),this.route.snapshot.paramMap.has("legalCaseId")){var c=this.route.snapshot.paramMap.get("legalCaseId");this.setLegalCaseId(c)}}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.casePreProcedureService.validateCasePreProcedureExcelData(t,i.legalCases)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(S0))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function b0(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.casePreProcedure)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let ln=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"casePreProcedure_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.casePreProcedure=i.item})):t.formName&&t.formName.currentValue&&"casePreProcedure_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadCasePreProcedureEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.casePreProcedure=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(zs),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-case-pre-procedure-form"]],inputs:{casePreProcedure:"casePreProcedure",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,b0,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),cn=(()=>{class s{constructor(){this.autoHeight=!1,this.casePreProcedures=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[{field:"legalCase.name",headerName:"Legal Case",filter:"agTextColumnFilter"},{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{field:"legalCaseId",filter:"agTextColumnFilter",hide:!0},{field:"procedureType",filter:"agTextColumnFilter"},{field:"procedureDate",filter:"agDateColumnFilter"},{field:"dateCreated",filter:"agDateColumnFilter"},{headerName:"Removed",field:"removed",filter:"agSetColumnFilter",cellRenderer:"checkboxRenderer"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-case-pre-procedure-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",casePreProcedures:"casePreProcedures"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.casePreProcedures)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function T0(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-case-pre-procedure-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","casePreProcedure_edit")("formControl",t.formControl)("casePreProcedure",t.casePreProcedure)}}const y0=function(){return{}};function w0(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-case-pre-procedure-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","casePreProcedure_create")("formControl",t.formControl)("casePreProcedure",e.DdM(3,y0))}}function x0(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-case-pre-procedure-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("casePreProcedures",o.data.items)}let N0=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadCasePreProceduresEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.casePreProcedures$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(zs))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","casePreProcedure","send","close"],[1,"w-full","h-full","bg-white",3,"casePreProcedures","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,T0,2,3,"ng-template",null,1,e.W1O),e.YNc(3,w0,1,4,"ng-template",null,2,e.W1O),e.YNc(5,x0,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,ln,cn],encapsulation:2}),s})();function A0(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-case-pre-procedure-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","casePreProcedure_edit")("casePreProcedure",t.value)}}const F0=function(){return{}};function P0(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-case-pre-procedure-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","casePreProcedure_create")("casePreProcedure",e.DdM(2,F0))}function I0(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-case-pre-procedure-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("casePreProcedures",t.items)}}let D0=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","casePreProcedure","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","casePreProcedures","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,A0,1,2,"ng-template",null,1,e.W1O),e.YNc(3,P0,1,3,"ng-template",null,2,e.W1O),e.YNc(5,I0,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,ln,cn],encapsulation:2}),s})(),M0=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[zs],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"case-pre-procedure-select",component:N0,wrappers:["form-field"]},{name:"case-pre-procedure-grid",component:D0}]})]}),s})(),W0=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[M0]}),s})();class At extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class E0 extends At{constructor(o,t,i,a){super("ValidateCaseProcedureExcelDataAction"),this.valid=!1,this.excelData=o,this.legalCases=t,this.appointments=i,this.locations=a}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name),this.validationContext.addRule(new f.mi(`legalCaseName_${i}_is_valid}`,"Legal Case Is Not Valid","legalCase.name",t.legalCase,this.legalCases,!0)),this.validationContext.addRule(new f.mi(`appointmentName_${i}_is_valid}`,"Appointment Is Not Valid","appointment.name",t.appointment,this.appointments,!0)),this.validationContext.addRule(new f.mi(`locationName_${i}_is_valid}`,"Location Is Not Valid","location.name",t.location,this.locations,!0))}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class O0 extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class L0 extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new O0("name","The caseprocedure name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class $0 extends At{constructor(o){super("CreateCaseProcedureAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new L0("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateCaseProcedure({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class G0 extends At{constructor(o){super("UpdateCaseProceduresAction"),this.caseProcedures=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.caseProcedures,!0))}performAction(){this.response=this.businessProvider.data.userUpdateCaseProcedures({input:{caseProcedures:this.caseProcedures}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class R0 extends At{constructor(o,t){super("UpdateCaseProcedureAction"),this.caseProcedure=o,this.caseProcedureId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.caseProcedure,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.caseProcedureId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateCaseProcedure({caseProcedureId:this.caseProcedureId,input:this.caseProcedure}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let dn=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.CaseProcedureBusinessProviderService",t,a),this.data=i}createCaseProcedure(t){const i=new $0(t);return i.Do(this),i.response}updateCaseProcedure(t,i){const a=new R0(t,i);return a.Do(this),a.response}importCaseProcedures(t){const i=new G0(t);return i.Do(this),i.response}validateCaseProcedureExcelData(t,i,a,l){const u=new E0(t,i,a,l);return u.Do(this),u.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),Q0=(()=>{class s extends I.nH{constructor(t,i,a){super("CaseProcedureService",a,t),this.businessProvider=i}createCaseProcedure(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createCaseProcedure(i)}updateCaseProcedure(t,i){return this.businessProvider.updateCaseProcedure(t,i)}importCaseProcedures(t){return this.businessProvider.importCaseProcedures(t)}validateCaseProcedureExcelData(t,i,a,l){return this.businessProvider.validateCaseProcedureExcelData(t,i,a,l)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(dn,8),e.LFG(dn),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),Hs=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){if(super({loading:!1,caseProcedures:[],done:!1,searchQuery:"",formName:void 0,legalCaseId:void 0,appointmentId:void 0,locationId:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.caseProcedureService=H,this.errors$=this.select(r=>r.errors),this.loading$=this.select(r=>r.loading),this.done$=this.select(r=>r.done),this.item$=this.select(r=>r.item),this.caseProcedures$=this.select(r=>r.caseProcedures),this.legalCases$=this.select(r=>r.legalCases||[]),this.appointments$=this.select(r=>r.appointments||[]),this.locations$=this.select(r=>r.locations||[]),this.legalCaseId$=this.select(r=>r.legalCaseId),this.appointmentId$=this.select(r=>r.appointmentId),this.locationId$=this.select(r=>r.locationId),this.paging$=this.select(r=>r.paging),this.searchQuery$=this.select(r=>r.searchQuery),this.formName$=this.select(r=>r.formName),this.actionResult$=this.select(this.item$,this.done$,(r,m)=>({item:r,done:m}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.caseProcedures$,this.legalCases$,this.appointments$,this.locations$,(r,m,p,_,w,J,_e,ve)=>({errors:r,loading:m,item:p,formName:_,caseProcedures:w,legalCases:J,appointments:_e,locations:ve}),{debounce:!0}),this.input$=this.select(this.paging$,this.legalCaseId$,this.appointmentId$,this.locationId$,this.searchQuery$,(r,m,p,_,w)=>({limit:r.limit,skip:r.skip,name:w,legalCaseId:m,appointmentId:p,locationId:_,total:r.total})),this.setFormName=this.updater((r,m)=>Object.assign(Object.assign({},r),{formName:m})),this.setLegalCaseId=this.updater((r,m)=>Object.assign(Object.assign({},r),{legalCaseId:m})),this.setAppointmentId=this.updater((r,m)=>Object.assign(Object.assign({},r),{appointmentId:m})),this.setLocationId=this.updater((r,m)=>Object.assign(Object.assign({},r),{locationId:m})),this.setSelectedCaseProcedures=this.updater((r,m)=>Object.assign(Object.assign({},r),{selectedCaseProcedure:m})),this.filterLegalCases=r=>this.data.userSelectLegalCases({input:{name:r}}).pipe((0,g._b)(m=>{let p=m.data.items;return this.patchState({legalCases:p}),p},m=>this.patchState({errors:m.graphQLErrors?m.graphQLErrors:m})),(0,he.U)(m=>m.data.items)),this.filterAppointments=r=>this.data.userSelectAppointments({input:{name:r}}).pipe((0,g._b)(m=>{let p=m.data.items;return this.patchState({appointments:p}),p},m=>this.patchState({errors:m.graphQLErrors?m.graphQLErrors:m})),(0,he.U)(m=>m.data.items)),this.filterLocations=r=>this.data.userSelectLocations({input:{name:r}}).pipe((0,g._b)(m=>{let p=m.data.items;return this.patchState({locations:p}),p},m=>this.patchState({errors:m.graphQLErrors?m.graphQLErrors:m})),(0,he.U)(m=>m.data.items)),this.addLegalCase=this.updater((r,m)=>Object.assign(Object.assign({},r),{legalCases:r.legalCases.concat(m)})),this.addAppointment=this.updater((r,m)=>Object.assign(Object.assign({},r),{appointments:r.appointments.concat(m)})),this.addLocation=this.updater((r,m)=>Object.assign(Object.assign({},r),{locations:r.locations.concat(m)})),this.setItem=this.updater((r,m)=>Object.assign(Object.assign({},r),{item:m})),this.addNewCaseProcedure=this.updater((r,m)=>Object.assign(Object.assign({},r),{caseProcedures:[...r.caseProcedures,m]})),this.updateCaseProcedure=this.updater((r,m)=>Object.assign(Object.assign({},r),{caseProcedures:r.caseProcedures.map(p=>p.id===m.id?m:p)})),this.addCaseProcedures=this.updater((r,m)=>Object.assign(Object.assign({},r),{caseProcedures:r.caseProcedures.concat(m)})),this.updateCaseProcedures=this.updater((r,m)=>Object.assign(Object.assign({},r),{caseProcedures:r.caseProcedures.map(p=>m.find(w=>w.id===p.id)||p)})),this.setSearchQuery=this.updater((r,m)=>Object.assign(Object.assign({},r),{searchQuery:m})),this.loadCaseProcedureEffect=this.effect(r=>r.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(m=>this.data.userCaseProcedure({caseProcedureId:m}).pipe((0,g._b)(p=>{this.patchState({item:p.data.item,errors:p.errors,loading:!1})},p=>this.patchState({loading:!1,errors:p.graphQLErrors?p.graphQLErrors:p})))))),this.loadCaseProceduresEffect=this.effect(r=>r.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([m,p])=>(console.log("hit the load effect"),this.data.userSelectDetailCaseProcedures({input:p}).pipe((0,g._b)(_=>{console.log(_.data.items),this.patchState({paging:{limit:p.limit,skip:p.skip,total:_.data.count.total},caseProcedures:_.data.items,errors:_.errors,loading:!1})},_=>this.patchState({loading:!1,errors:_.graphQLErrors?_.graphQLErrors:_}))))))),this.createCaseProcedureEffect=this.effect(r=>r.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(m=>this.caseProcedureService.createCaseProcedure(Object.assign({},m)).pipe((0,g._b)(p=>{this.addNewCaseProcedure(p),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:p,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},p=>{p.graphQLErrors?(this.toast.error(p.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:p.graphQLErrors?p.graphQLErrors:p})):(this.toast.error(p.Message),this.formService.setErrors(p.Data))}))))),this.updateCaseProcedureEffect=this.effect(r=>r.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([m,p])=>this.caseProcedureService.updateCaseProcedure(m,m.id).pipe((0,g._b)(_=>{this.updateCaseProcedure(_),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:_,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},_=>{_.graphQLErrors?(this.toast.error(_.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:_.graphQLErrors?_.graphQLErrors:_})):(this.toast.error(_.Message),this.formService.setErrors(_.Data))}))))),this.deleteCaseProcedureEffect=this.effect(r=>r.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([m,p])=>this.data.userDeleteCaseProcedure({caseProcedureId:p.id}).pipe((0,g._b)(_=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:_.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},_=>{_.graphQLErrors?(this.toast.error(_.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:_.graphQLErrors?_.graphQLErrors:_})):(this.toast.error(_.Message),this.formService.setErrors(_.Data))}))))),this.importExcelEffect=this.effect(r=>r.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(m=>this.caseProcedureService.importCaseProcedures(m).pipe((0,ce.K)(p=>{var _;return this.toast.error(null!==(_=p.Message)&&void 0!==_?_:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(p=>{const _=JSON.parse(p.created),w=JSON.parse(p.updated),J=JSON.parse(p.failed),_e=_.length+w.length+J.length;this.addCaseProcedures(_),this.updateCaseProcedures(w),this.toast.success(`${_.length} created, ${w.length} updated, ${J.length} failed of total ${_e}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("caseProcedureId")?(this.route.snapshot.paramMap.get("caseProcedureId"),this.setFormName("caseProcedure_edit")):this.setFormName("caseProcedure_create"),this.route.snapshot.paramMap.has("legalCaseId")){var c=this.route.snapshot.paramMap.get("legalCaseId");this.setLegalCaseId(c)}if(this.route.snapshot.paramMap.has("appointmentId")){var d=this.route.snapshot.paramMap.get("appointmentId");this.setAppointmentId(d)}if(this.route.snapshot.paramMap.has("locationId")){var n=this.route.snapshot.paramMap.get("locationId");this.setLocationId(n)}}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.caseProcedureService.validateCaseProcedureExcelData(t,i.legalCases,i.appointments,i.locations)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(Q0))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function V0(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.caseProcedure)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let un=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"caseProcedure_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({id:null,name:""}),this.store.vm$.subscribe(i=>{this.caseProcedure=i.item})):t.formName&&t.formName.currentValue&&"caseProcedure_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadCaseProcedureEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.caseProcedure=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Hs),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-case-procedure-form"]],inputs:{caseProcedure:"caseProcedure",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,V0,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),mn=(()=>{class s{constructor(){this.autoHeight=!1,this.caseProcedures=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[{field:"legalCase.name",headerName:"Legal Case",filter:"agTextColumnFilter"},{field:"appointment.name",headerName:"Appointment",filter:"agTextColumnFilter"},{field:"procedureStatus.name",headerName:"Procedure Status",filter:"agTextColumnFilter"},{field:"procedureType.name",headerName:"Procedure Type",filter:"agTextColumnFilter"},{field:"location.name",headerName:"Location",filter:"agTextColumnFilter"},{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{field:"legalCaseId",filter:"agTextColumnFilter",hide:!0},{field:"appointmentId",filter:"agTextColumnFilter",hide:!0},{field:"locationId",filter:"agTextColumnFilter",hide:!0},{field:"procedureDate",filter:"agDateColumnFilter"},{headerName:"Cost",field:"cost",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.cost,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{field:"notes",filter:"agTextColumnFilter"},{field:"createdBy",filter:"agTextColumnFilter"},{field:"dateCreated",filter:"agDateColumnFilter"},{headerName:"Removed",field:"removed",filter:"agSetColumnFilter",cellRenderer:"checkboxRenderer"},{field:"approvedDate",filter:"agDateColumnFilter"},{field:"procedureReasonName",filter:"agTextColumnFilter"},{field:"decisionDate",filter:"agDateColumnFilter"},{field:"nextActionDate",filter:"agDateColumnFilter"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-case-procedure-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",caseProcedures:"caseProcedures"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.caseProcedures)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function j0(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-case-procedure-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","caseProcedure_edit")("formControl",t.formControl)("caseProcedure",t.caseProcedure)}}const U0=function(){return{}};function J0(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-case-procedure-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","caseProcedure_create")("formControl",t.formControl)("caseProcedure",e.DdM(3,U0))}}function z0(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-case-procedure-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("caseProcedures",o.data.items)}let H0=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadCaseProceduresEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.caseProcedures$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Hs))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","caseProcedure","send","close"],[1,"w-full","h-full","bg-white",3,"caseProcedures","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,j0,2,3,"ng-template",null,1,e.W1O),e.YNc(3,J0,1,4,"ng-template",null,2,e.W1O),e.YNc(5,z0,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,un,mn],encapsulation:2}),s})();function q0(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-case-procedure-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","caseProcedure_edit")("caseProcedure",t.value)}}const K0=function(){return{}};function Z0(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-case-procedure-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","caseProcedure_create")("caseProcedure",e.DdM(2,K0))}function k0(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-case-procedure-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("caseProcedures",t.items)}}let B0=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","caseProcedure","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","caseProcedures","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,q0,1,2,"ng-template",null,1,e.W1O),e.YNc(3,Z0,1,3,"ng-template",null,2,e.W1O),e.YNc(5,k0,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,un,mn],encapsulation:2}),s})(),Y0=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[Hs],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"case-procedure-select",component:H0,wrappers:["form-field"]},{name:"case-procedure-grid",component:B0}]})]}),s})(),X0=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[Y0]}),s})();class Ft extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class eT extends Ft{constructor(o){super("ValidateCaseProgressStatusExcelDataAction"),this.valid=!1,this.excelData=o}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name)}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class tT extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class iT extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new tT("name","The caseprogressstatus name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class sT extends Ft{constructor(o){super("CreateCaseProgressStatusAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new iT("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateCaseProgressStatus({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class oT extends Ft{constructor(o){super("UpdateCaseProgressStatusesAction"),this.caseProgressStatuses=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.caseProgressStatuses,!0))}performAction(){this.response=this.businessProvider.data.userUpdateCaseProgressStatuses({input:{caseProgressStatuses:this.caseProgressStatuses}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class aT extends Ft{constructor(o,t){super("UpdateCaseProgressStatusAction"),this.caseProgressStatus=o,this.caseProgressStatusId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.caseProgressStatus,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.caseProgressStatusId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateCaseProgressStatus({caseProgressStatusId:this.caseProgressStatusId,input:this.caseProgressStatus}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let pn=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.CaseProgressStatusBusinessProviderService",t,a),this.data=i}createCaseProgressStatus(t){const i=new sT(t);return i.Do(this),i.response}updateCaseProgressStatus(t,i){const a=new aT(t,i);return a.Do(this),a.response}importCaseProgressStatuses(t){const i=new oT(t);return i.Do(this),i.response}validateCaseProgressStatusExcelData(t){const i=new eT(t);return i.Do(this),i.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),rT=(()=>{class s extends I.nH{constructor(t,i,a){super("CaseProgressStatusService",a,t),this.businessProvider=i}createCaseProgressStatus(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createCaseProgressStatus(i)}updateCaseProgressStatus(t,i){return this.businessProvider.updateCaseProgressStatus(t,i)}importCaseProgressStatuses(t){return this.businessProvider.importCaseProgressStatuses(t)}validateCaseProgressStatusExcelData(t){return this.businessProvider.validateCaseProgressStatusExcelData(t)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(pn,8),e.LFG(pn),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),qs=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){super({loading:!1,caseProgressStatuses:[],done:!1,searchQuery:"",formName:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.caseProgressStatusService=H,this.errors$=this.select(c=>c.errors),this.loading$=this.select(c=>c.loading),this.done$=this.select(c=>c.done),this.item$=this.select(c=>c.item),this.caseProgressStatuses$=this.select(c=>c.caseProgressStatuses),this.paging$=this.select(c=>c.paging),this.searchQuery$=this.select(c=>c.searchQuery),this.formName$=this.select(c=>c.formName),this.actionResult$=this.select(this.item$,this.done$,(c,d)=>({item:c,done:d}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.caseProgressStatuses$,(c,d,n,r,m)=>({errors:c,loading:d,item:n,formName:r,caseProgressStatuses:m}),{debounce:!0}),this.input$=this.select(this.paging$,this.searchQuery$,(c,d)=>({limit:c.limit,skip:c.skip,name:d,total:c.total})),this.setFormName=this.updater((c,d)=>Object.assign(Object.assign({},c),{formName:d})),this.setItem=this.updater((c,d)=>Object.assign(Object.assign({},c),{item:d})),this.addNewCaseProgressStatus=this.updater((c,d)=>Object.assign(Object.assign({},c),{caseProgressStatuses:[...c.caseProgressStatuses,d]})),this.updateCaseProgressStatus=this.updater((c,d)=>Object.assign(Object.assign({},c),{caseProgressStatuses:c.caseProgressStatuses.map(n=>n.id===d.id?d:n)})),this.addCaseProgressStatuses=this.updater((c,d)=>Object.assign(Object.assign({},c),{caseProgressStatuses:c.caseProgressStatuses.concat(d)})),this.updateCaseProgressStatuses=this.updater((c,d)=>Object.assign(Object.assign({},c),{caseProgressStatuses:c.caseProgressStatuses.map(n=>d.find(m=>m.id===n.id)||n)})),this.setSearchQuery=this.updater((c,d)=>Object.assign(Object.assign({},c),{searchQuery:d})),this.loadCaseProgressStatusEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.data.userCaseProgressStatus({caseProgressStatusId:d}).pipe((0,g._b)(n=>{this.patchState({item:n.data.item,errors:n.errors,loading:!1})},n=>this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})))))),this.loadCaseProgressStatusesEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([d,n])=>this.data.userCaseProgressStatuses({input:n}).pipe((0,g._b)(r=>this.patchState({paging:{limit:n.limit,skip:n.skip,total:r.data.count.total},caseProgressStatuses:r.data.items,errors:r.errors,loading:!1}),r=>this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})))))),this.createCaseProgressStatusEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.caseProgressStatusService.createCaseProgressStatus(Object.assign({},d)).pipe((0,g._b)(n=>{this.addNewCaseProgressStatus(n),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:n,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},n=>{n.graphQLErrors?(this.toast.error(n.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})):(this.toast.error(n.Message),this.formService.setErrors(n.Data))}))))),this.updateCaseProgressStatusEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.caseProgressStatusService.updateCaseProgressStatus(d,d.id).pipe((0,g._b)(r=>{this.updateCaseProgressStatus(r),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:r,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.deleteCaseProgressStatusEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.data.userDeleteCaseProgressStatus({caseProgressStatusId:n.id}).pipe((0,g._b)(r=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:r.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.importExcelEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.caseProgressStatusService.importCaseProgressStatuses(d).pipe((0,ce.K)(n=>{var r;return this.toast.error(null!==(r=n.Message)&&void 0!==r?r:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(n=>{const r=JSON.parse(n.created),m=JSON.parse(n.updated),p=JSON.parse(n.failed),_=r.length+m.length+p.length;this.addCaseProgressStatuses(r),this.updateCaseProgressStatuses(m),this.toast.success(`${r.length} created, ${m.length} updated, ${p.length} failed of total ${_}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("caseProgressStatusId")?(this.route.snapshot.paramMap.get("caseProgressStatusId"),this.setFormName("caseProgressStatus_edit")):this.setFormName("caseProgressStatus_create")}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.caseProgressStatusService.validateCaseProgressStatusExcelData(t)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(rT))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function nT(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.caseProgressStatus)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let hn=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"caseProgressStatus_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.caseProgressStatus=i.item})):t.formName&&t.formName.currentValue&&"caseProgressStatus_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadCaseProgressStatusEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.caseProgressStatus=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(qs),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-case-progress-status-form"]],inputs:{caseProgressStatus:"caseProgressStatus",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,nT,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),fn=(()=>{class s{constructor(){this.autoHeight=!1,this.caseProgressStatuses=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[,{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-case-progress-status-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",caseProgressStatuses:"caseProgressStatuses"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.caseProgressStatuses)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function lT(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-case-progress-status-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","caseProgressStatus_edit")("formControl",t.formControl)("caseProgressStatus",t.caseProgressStatus)}}const cT=function(){return{}};function dT(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-case-progress-status-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","caseProgressStatus_create")("formControl",t.formControl)("caseProgressStatus",e.DdM(3,cT))}}function uT(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-case-progress-status-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("caseProgressStatuses",o.data.items)}let mT=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadCaseProgressStatusesEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.caseProgressStatuses$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(qs))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","caseProgressStatus","send","close"],[1,"w-full","h-full","bg-white",3,"caseProgressStatuses","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,lT,2,3,"ng-template",null,1,e.W1O),e.YNc(3,dT,1,4,"ng-template",null,2,e.W1O),e.YNc(5,uT,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,hn,fn],encapsulation:2}),s})();function pT(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-case-progress-status-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","caseProgressStatus_edit")("caseProgressStatus",t.value)}}const hT=function(){return{}};function fT(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-case-progress-status-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","caseProgressStatus_create")("caseProgressStatus",e.DdM(2,hT))}function _T(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-case-progress-status-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("caseProgressStatuses",t.items)}}let gT=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","caseProgressStatus","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","caseProgressStatuses","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,pT,1,2,"ng-template",null,1,e.W1O),e.YNc(3,fT,1,3,"ng-template",null,2,e.W1O),e.YNc(5,_T,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,hn,fn],encapsulation:2}),s})(),CT=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[qs],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"case-progress-status-select",component:mT,wrappers:["form-field"]},{name:"case-progress-status-grid",component:gT}]})]}),s})(),vT=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[CT]}),s})();var Ks=Q(78649);function ST(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.caseStatus)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let _n=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"caseStatus_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.caseStatus=i.item})):t.formName&&t.formName.currentValue&&"caseStatus_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadCaseStatusEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.caseStatus=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Ks.I),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-case-status-form"]],inputs:{caseStatus:"caseStatus",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,ST,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),gn=(()=>{class s{constructor(){this.autoHeight=!1,this.caseStatuses=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[,{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{headerName:"Order Index",field:"orderIndex",filter:"agNumberColumnFilter",aggFunc:"sum"},{field:"color",filter:"agTextColumnFilter"},{headerName:"Is Default",field:"isDefault",filter:"agSetColumnFilter",cellRenderer:"checkboxRenderer"},{headerName:"Ticker Date",field:"tickerDate",filter:"agNumberColumnFilter",aggFunc:"sum"},{headerName:"Max Ticker Date",field:"maxTickerDate",filter:"agNumberColumnFilter",aggFunc:"sum"},{headerName:"Move Docs",field:"moveDocs",filter:"agSetColumnFilter",cellRenderer:"checkboxRenderer"},{field:"dateCreated",filter:"agDateColumnFilter"},{headerName:"Removed",field:"removed",filter:"agSetColumnFilter",cellRenderer:"checkboxRenderer"},{field:"createdBy",filter:"agTextColumnFilter"},{field:"migSource",filter:"agTextColumnFilter"},{field:"entity",filter:"agTextColumnFilter"},{field:"temp",filter:"agTextColumnFilter"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-case-status-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",caseStatuses:"caseStatuses"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.caseStatuses)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function bT(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-case-status-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","caseStatus_edit")("formControl",t.formControl)("caseStatus",t.caseStatus)}}const TT=function(){return{}};function yT(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-case-status-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","caseStatus_create")("formControl",t.formControl)("caseStatus",e.DdM(3,TT))}}function wT(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-case-status-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("caseStatuses",o.data.items)}let xT=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadCaseStatusesEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.caseStatuses$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Ks.I))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","caseStatus","send","close"],[1,"w-full","h-full","bg-white",3,"caseStatuses","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,bT,2,3,"ng-template",null,1,e.W1O),e.YNc(3,yT,1,4,"ng-template",null,2,e.W1O),e.YNc(5,wT,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,_n,gn],encapsulation:2}),s})();function NT(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-case-status-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","caseStatus_edit")("caseStatus",t.value)}}const AT=function(){return{}};function FT(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-case-status-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","caseStatus_create")("caseStatus",e.DdM(2,AT))}function PT(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-case-status-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("caseStatuses",t.items)}}let IT=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","caseStatus","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","caseStatuses","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,NT,1,2,"ng-template",null,1,e.W1O),e.YNc(3,FT,1,3,"ng-template",null,2,e.W1O),e.YNc(5,PT,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,_n,gn],encapsulation:2}),s})(),DT=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[Ks.I],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"case-status-select",component:xT,wrappers:["form-field"]},{name:"case-status-grid",component:IT}]})]}),s})(),MT=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[DT]}),s})();class Pt extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class WT extends Pt{constructor(o){super("ValidateCaseTypeExcelDataAction"),this.valid=!1,this.excelData=o}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name)}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class ET extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class OT extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new ET("name","The casetype name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class LT extends Pt{constructor(o){super("CreateCaseTypeAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new OT("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateCaseType({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class $T extends Pt{constructor(o){super("UpdateCaseTypesAction"),this.caseTypes=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.caseTypes,!0))}performAction(){this.response=this.businessProvider.data.userUpdateCaseTypes({input:{caseTypes:this.caseTypes}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class GT extends Pt{constructor(o,t){super("UpdateCaseTypeAction"),this.caseType=o,this.caseTypeId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.caseType,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.caseTypeId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateCaseType({caseTypeId:this.caseTypeId,input:this.caseType}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let Cn=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.CaseTypeBusinessProviderService",t,a),this.data=i}createCaseType(t){const i=new LT(t);return i.Do(this),i.response}updateCaseType(t,i){const a=new GT(t,i);return a.Do(this),a.response}importCaseTypes(t){const i=new $T(t);return i.Do(this),i.response}validateCaseTypeExcelData(t){const i=new WT(t);return i.Do(this),i.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),RT=(()=>{class s extends I.nH{constructor(t,i,a){super("CaseTypeService",a,t),this.businessProvider=i}createCaseType(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createCaseType(i)}updateCaseType(t,i){return this.businessProvider.updateCaseType(t,i)}importCaseTypes(t){return this.businessProvider.importCaseTypes(t)}validateCaseTypeExcelData(t){return this.businessProvider.validateCaseTypeExcelData(t)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(Cn,8),e.LFG(Cn),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),Zs=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){super({loading:!1,caseTypes:[],done:!1,searchQuery:"",formName:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.caseTypeService=H,this.errors$=this.select(c=>c.errors),this.loading$=this.select(c=>c.loading),this.done$=this.select(c=>c.done),this.item$=this.select(c=>c.item),this.caseTypes$=this.select(c=>c.caseTypes),this.paging$=this.select(c=>c.paging),this.searchQuery$=this.select(c=>c.searchQuery),this.formName$=this.select(c=>c.formName),this.actionResult$=this.select(this.item$,this.done$,(c,d)=>({item:c,done:d}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.caseTypes$,(c,d,n,r,m)=>({errors:c,loading:d,item:n,formName:r,caseTypes:m}),{debounce:!0}),this.input$=this.select(this.paging$,this.searchQuery$,(c,d)=>({limit:c.limit,skip:c.skip,name:d,total:c.total})),this.setFormName=this.updater((c,d)=>Object.assign(Object.assign({},c),{formName:d})),this.setItem=this.updater((c,d)=>Object.assign(Object.assign({},c),{item:d})),this.addNewCaseType=this.updater((c,d)=>Object.assign(Object.assign({},c),{caseTypes:[...c.caseTypes,d]})),this.updateCaseType=this.updater((c,d)=>Object.assign(Object.assign({},c),{caseTypes:c.caseTypes.map(n=>n.id===d.id?d:n)})),this.addCaseTypes=this.updater((c,d)=>Object.assign(Object.assign({},c),{caseTypes:c.caseTypes.concat(d)})),this.updateCaseTypes=this.updater((c,d)=>Object.assign(Object.assign({},c),{caseTypes:c.caseTypes.map(n=>d.find(m=>m.id===n.id)||n)})),this.setSearchQuery=this.updater((c,d)=>Object.assign(Object.assign({},c),{searchQuery:d})),this.loadCaseTypeEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.data.userCaseType({caseTypeId:d}).pipe((0,g._b)(n=>{this.patchState({item:n.data.item,errors:n.errors,loading:!1})},n=>this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})))))),this.loadCaseTypesEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([d,n])=>this.data.userCaseTypes({input:n}).pipe((0,g._b)(r=>this.patchState({paging:{limit:n.limit,skip:n.skip,total:r.data.count.total},caseTypes:r.data.items,errors:r.errors,loading:!1}),r=>this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})))))),this.createCaseTypeEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.caseTypeService.createCaseType(Object.assign({},d)).pipe((0,g._b)(n=>{this.addNewCaseType(n),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:n,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},n=>{n.graphQLErrors?(this.toast.error(n.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})):(this.toast.error(n.Message),this.formService.setErrors(n.Data))}))))),this.updateCaseTypeEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.caseTypeService.updateCaseType(d,d.id).pipe((0,g._b)(r=>{this.updateCaseType(r),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:r,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.deleteCaseTypeEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.data.userDeleteCaseType({caseTypeId:n.id}).pipe((0,g._b)(r=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:r.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.importExcelEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.caseTypeService.importCaseTypes(d).pipe((0,ce.K)(n=>{var r;return this.toast.error(null!==(r=n.Message)&&void 0!==r?r:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(n=>{const r=JSON.parse(n.created),m=JSON.parse(n.updated),p=JSON.parse(n.failed),_=r.length+m.length+p.length;this.addCaseTypes(r),this.updateCaseTypes(m),this.toast.success(`${r.length} created, ${m.length} updated, ${p.length} failed of total ${_}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("caseTypeId")?(this.route.snapshot.paramMap.get("caseTypeId"),this.setFormName("caseType_edit")):this.setFormName("caseType_create")}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.caseTypeService.validateCaseTypeExcelData(t)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(RT))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function QT(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.caseType)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let vn=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"caseType_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.caseType=i.item})):t.formName&&t.formName.currentValue&&"caseType_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadCaseTypeEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.caseType=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Zs),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-case-type-form"]],inputs:{caseType:"caseType",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,QT,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),Sn=(()=>{class s{constructor(){this.autoHeight=!1,this.caseTypes=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[,{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{headerName:"Order Index",field:"orderIndex",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.orderIndex,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{field:"dateCreated",filter:"agDateColumnFilter"},{headerName:"Removed",field:"removed",filter:"agSetColumnFilter",cellRenderer:"checkboxRenderer"},{field:"migSource",filter:"agTextColumnFilter"},{field:"entity",filter:"agTextColumnFilter"},{field:"temp",filter:"agTextColumnFilter"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-case-type-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",caseTypes:"caseTypes"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.caseTypes)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function VT(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-case-type-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","caseType_edit")("formControl",t.formControl)("caseType",t.caseType)}}const jT=function(){return{}};function UT(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-case-type-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","caseType_create")("formControl",t.formControl)("caseType",e.DdM(3,jT))}}function JT(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-case-type-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("caseTypes",o.data.items)}let zT=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadCaseTypesEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.caseTypes$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Zs))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","caseType","send","close"],[1,"w-full","h-full","bg-white",3,"caseTypes","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,VT,2,3,"ng-template",null,1,e.W1O),e.YNc(3,UT,1,4,"ng-template",null,2,e.W1O),e.YNc(5,JT,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,vn,Sn],encapsulation:2}),s})();function HT(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-case-type-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","caseType_edit")("caseType",t.value)}}const qT=function(){return{}};function KT(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-case-type-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","caseType_create")("caseType",e.DdM(2,qT))}function ZT(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-case-type-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("caseTypes",t.items)}}let kT=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","caseType","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","caseTypes","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,HT,1,2,"ng-template",null,1,e.W1O),e.YNc(3,KT,1,3,"ng-template",null,2,e.W1O),e.YNc(5,ZT,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,vn,Sn],encapsulation:2}),s})(),BT=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[Zs],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"case-type-select",component:zT,wrappers:["form-field"]},{name:"case-type-grid",component:kT}]})]}),s})(),YT=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[BT]}),s})();class It extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class XT extends It{constructor(o){super("ValidateCategoryExcelDataAction"),this.valid=!1,this.excelData=o}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name)}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class ey extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class ty extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new ey("name","The category name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class iy extends It{constructor(o){super("CreateCategoryAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new ty("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateCategory({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class sy extends It{constructor(o){super("UpdateCategoriesAction"),this.categories=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.categories,!0))}performAction(){this.response=this.businessProvider.data.userUpdateCategories({input:{categories:this.categories}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class oy extends It{constructor(o,t){super("UpdateCategoryAction"),this.category=o,this.categoryId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.category,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.categoryId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateCategory({categoryId:this.categoryId,input:this.category}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let bn=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.CategoryBusinessProviderService",t,a),this.data=i}createCategory(t){const i=new iy(t);return i.Do(this),i.response}updateCategory(t,i){const a=new oy(t,i);return a.Do(this),a.response}importCategories(t){const i=new sy(t);return i.Do(this),i.response}validateCategoryExcelData(t){const i=new XT(t);return i.Do(this),i.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),ay=(()=>{class s extends I.nH{constructor(t,i,a){super("CategoryService",a,t),this.businessProvider=i}createCategory(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createCategory(i)}updateCategory(t,i){return this.businessProvider.updateCategory(t,i)}importCategories(t){return this.businessProvider.importCategories(t)}validateCategoryExcelData(t){return this.businessProvider.validateCategoryExcelData(t)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(bn,8),e.LFG(bn),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),ks=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){super({loading:!1,categories:[],done:!1,searchQuery:"",formName:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.categoryService=H,this.errors$=this.select(c=>c.errors),this.loading$=this.select(c=>c.loading),this.done$=this.select(c=>c.done),this.item$=this.select(c=>c.item),this.categories$=this.select(c=>c.categories),this.paging$=this.select(c=>c.paging),this.searchQuery$=this.select(c=>c.searchQuery),this.formName$=this.select(c=>c.formName),this.actionResult$=this.select(this.item$,this.done$,(c,d)=>({item:c,done:d}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.categories$,(c,d,n,r,m)=>({errors:c,loading:d,item:n,formName:r,categories:m}),{debounce:!0}),this.input$=this.select(this.paging$,this.searchQuery$,(c,d)=>({limit:c.limit,skip:c.skip,name:d,total:c.total})),this.setFormName=this.updater((c,d)=>Object.assign(Object.assign({},c),{formName:d})),this.setItem=this.updater((c,d)=>Object.assign(Object.assign({},c),{item:d})),this.addNewCategory=this.updater((c,d)=>Object.assign(Object.assign({},c),{categories:[...c.categories,d]})),this.updateCategory=this.updater((c,d)=>Object.assign(Object.assign({},c),{categories:c.categories.map(n=>n.id===d.id?d:n)})),this.addCategories=this.updater((c,d)=>Object.assign(Object.assign({},c),{categories:c.categories.concat(d)})),this.updateCategories=this.updater((c,d)=>Object.assign(Object.assign({},c),{categories:c.categories.map(n=>d.find(m=>m.id===n.id)||n)})),this.setSearchQuery=this.updater((c,d)=>Object.assign(Object.assign({},c),{searchQuery:d})),this.loadCategoryEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.data.userCategory({categoryId:d}).pipe((0,g._b)(n=>{this.patchState({item:n.data.item,errors:n.errors,loading:!1})},n=>this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})))))),this.loadCategoriesEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([d,n])=>this.data.userCategories({input:n}).pipe((0,g._b)(r=>this.patchState({paging:{limit:n.limit,skip:n.skip,total:r.data.count.total},categories:r.data.items,errors:r.errors,loading:!1}),r=>this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})))))),this.createCategoryEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.categoryService.createCategory(Object.assign({},d)).pipe((0,g._b)(n=>{this.addNewCategory(n),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:n,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},n=>{n.graphQLErrors?(this.toast.error(n.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})):(this.toast.error(n.Message),this.formService.setErrors(n.Data))}))))),this.updateCategoryEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.categoryService.updateCategory(d,d.id).pipe((0,g._b)(r=>{this.updateCategory(r),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:r,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.deleteCategoryEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.data.userDeleteCategory({categoryId:n.id}).pipe((0,g._b)(r=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:r.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.importExcelEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.categoryService.importCategories(d).pipe((0,ce.K)(n=>{var r;return this.toast.error(null!==(r=n.Message)&&void 0!==r?r:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(n=>{const r=JSON.parse(n.created),m=JSON.parse(n.updated),p=JSON.parse(n.failed),_=r.length+m.length+p.length;this.addCategories(r),this.updateCategories(m),this.toast.success(`${r.length} created, ${m.length} updated, ${p.length} failed of total ${_}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("categoryId")?(this.route.snapshot.paramMap.get("categoryId"),this.setFormName("category_edit")):this.setFormName("category_create")}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.categoryService.validateCategoryExcelData(t)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(ay))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function ry(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.category)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let Tn=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"category_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.category=i.item})):t.formName&&t.formName.currentValue&&"category_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadCategoryEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.category=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(ks),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-category-form"]],inputs:{category:"category",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,ry,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),yn=(()=>{class s{constructor(){this.autoHeight=!1,this.categories=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[,{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-category-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",categories:"categories"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.categories)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function ny(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-category-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","category_edit")("formControl",t.formControl)("category",t.category)}}const ly=function(){return{}};function cy(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-category-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","category_create")("formControl",t.formControl)("category",e.DdM(3,ly))}}function dy(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-category-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("categories",o.data.items)}let uy=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadCategoriesEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.categories$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(ks))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","category","send","close"],[1,"w-full","h-full","bg-white",3,"categories","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,ny,2,3,"ng-template",null,1,e.W1O),e.YNc(3,cy,1,4,"ng-template",null,2,e.W1O),e.YNc(5,dy,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,Tn,yn],encapsulation:2}),s})();function my(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-category-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","category_edit")("category",t.value)}}const py=function(){return{}};function hy(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-category-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","category_create")("category",e.DdM(2,py))}function fy(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-category-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("categories",t.items)}}let _y=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","category","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","categories","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,my,1,2,"ng-template",null,1,e.W1O),e.YNc(3,hy,1,3,"ng-template",null,2,e.W1O),e.YNc(5,fy,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,Tn,yn],encapsulation:2}),s})(),gy=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[ks],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"category-select",component:uy,wrappers:["form-field"]},{name:"category-grid",component:_y}]})]}),s})(),Cy=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[gy]}),s})();class Dt extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class vy extends Dt{constructor(o,t,i,a,l){super("ValidateClaimExcelDataAction"),this.valid=!1,this.excelData=o,this.priorAuthorizationRequests=t,this.claims=i,this.explanationOfPayments=a,this.patients=l}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name),this.validationContext.addRule(new f.mi(`priorAuthorizationRequestName_${i}_is_valid}`,"Prior Authorization Request Is Not Valid","priorAuthorizationRequest.name",t.priorAuthorizationRequest,this.priorAuthorizationRequests,!0)),this.validationContext.addRule(new f.mi(`claimName_${i}_is_valid}`,"Claim Is Not Valid","claim.name",t.claim,this.claims,!0)),this.validationContext.addRule(new f.mi(`explanationOfPaymentName_${i}_is_valid}`,"Explanation of Payment Is Not Valid","explanationOfPayment.name",t.explanationOfPayment,this.explanationOfPayments,!0)),this.validationContext.addRule(new f.mi(`patientName_${i}_is_valid}`,"Patient Is Not Valid","patient.name",t.patient,this.patients,!0))}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class Sy extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class by extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new Sy("name","The claim name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class Ty extends Dt{constructor(o){super("CreateClaimAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new by("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateClaim({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class yy extends Dt{constructor(o){super("UpdateClaimsAction"),this.claims=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.claims,!0))}performAction(){this.response=this.businessProvider.data.userUpdateClaims({input:{claims:this.claims}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class wy extends Dt{constructor(o,t){super("UpdateClaimAction"),this.claim=o,this.claimId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.claim,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.claimId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateClaim({claimId:this.claimId,input:this.claim}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let wn=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.ClaimBusinessProviderService",t,a),this.data=i}createClaim(t){const i=new Ty(t);return i.Do(this),i.response}updateClaim(t,i){const a=new wy(t,i);return a.Do(this),a.response}importClaims(t){const i=new yy(t);return i.Do(this),i.response}validateClaimExcelData(t,i,a,l,u){const H=new vy(t,i,a,l,u);return H.Do(this),H.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),xy=(()=>{class s extends I.nH{constructor(t,i,a){super("ClaimService",a,t),this.businessProvider=i}createClaim(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createClaim(i)}updateClaim(t,i){return this.businessProvider.updateClaim(t,i)}importClaims(t){return this.businessProvider.importClaims(t)}validateClaimExcelData(t,i,a,l,u){return this.businessProvider.validateClaimExcelData(t,i,a,l,u)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(wn,8),e.LFG(wn),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),Bs=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){if(super({loading:!1,claims:[],done:!1,searchQuery:"",formName:void 0,priorAuthorizationRequestId:void 0,claimId:void 0,explanationOfPaymentId:void 0,patientId:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.claimService=H,this.errors$=this.select(r=>r.errors),this.loading$=this.select(r=>r.loading),this.done$=this.select(r=>r.done),this.item$=this.select(r=>r.item),this.claims$=this.select(r=>r.claims),this.priorAuthorizationRequests$=this.select(r=>r.priorAuthorizationRequests||[]),this.documents$=this.select(r=>r.documents||[]),this.patients$=this.select(r=>r.patients||[]),this.priorAuthorizationRequestId$=this.select(r=>r.priorAuthorizationRequestId),this.claimId$=this.select(r=>r.claimId),this.explanationOfPaymentId$=this.select(r=>r.explanationOfPaymentId),this.patientId$=this.select(r=>r.patientId),this.paging$=this.select(r=>r.paging),this.searchQuery$=this.select(r=>r.searchQuery),this.formName$=this.select(r=>r.formName),this.actionResult$=this.select(this.item$,this.done$,(r,m)=>({item:r,done:m}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.claims$,this.priorAuthorizationRequests$,this.documents$,this.patients$,(r,m,p,_,w,J,_e,ve)=>({errors:r,loading:m,item:p,formName:_,claims:w,priorAuthorizationRequests:J,documents:_e,patients:ve}),{debounce:!0}),this.input$=this.select(this.paging$,this.priorAuthorizationRequestId$,this.claimId$,this.explanationOfPaymentId$,this.patientId$,this.searchQuery$,(r,m,p,_,w,J)=>({limit:r.limit,skip:r.skip,name:J,priorAuthorizationRequestId:m,claimId:p,explanationOfPaymentId:_,patientId:w,total:r.total})),this.setFormName=this.updater((r,m)=>Object.assign(Object.assign({},r),{formName:m})),this.setPriorAuthorizationRequestId=this.updater((r,m)=>Object.assign(Object.assign({},r),{priorAuthorizationRequestId:m})),this.setClaimId=this.updater((r,m)=>Object.assign(Object.assign({},r),{claimId:m})),this.setExplanationOfPaymentId=this.updater((r,m)=>Object.assign(Object.assign({},r),{explanationOfPaymentId:m})),this.setPatientId=this.updater((r,m)=>Object.assign(Object.assign({},r),{patientId:m})),this.filterPriorAuthorizationRequests=r=>this.data.userSelectPriorAuthorizationRequests({input:{name:r}}).pipe((0,g._b)(m=>{let p=m.data.items;return this.patchState({priorAuthorizationRequests:p}),p},m=>this.patchState({errors:m.graphQLErrors?m.graphQLErrors:m})),(0,he.U)(m=>m.data.items)),this.filterDocuments=r=>this.data.userSelectDocuments({input:{name:r}}).pipe((0,g._b)(m=>{let p=m.data.items;return this.patchState({documents:p}),p},m=>this.patchState({errors:m.graphQLErrors?m.graphQLErrors:m})),(0,he.U)(m=>m.data.items)),this.filterPatients=r=>this.data.userSelectPatients({input:{name:r}}).pipe((0,g._b)(m=>{let p=m.data.items;return this.patchState({patients:p}),p},m=>this.patchState({errors:m.graphQLErrors?m.graphQLErrors:m})),(0,he.U)(m=>m.data.items)),this.addPriorAuthorizationRequest=this.updater((r,m)=>Object.assign(Object.assign({},r),{priorAuthorizationRequests:r.priorAuthorizationRequests.concat(m)})),this.addDocument=this.updater((r,m)=>Object.assign(Object.assign({},r),{documents:r.documents.concat(m)})),this.addPatient=this.updater((r,m)=>Object.assign(Object.assign({},r),{patients:r.patients.concat(m)})),this.setItem=this.updater((r,m)=>Object.assign(Object.assign({},r),{item:m})),this.addNewClaim=this.updater((r,m)=>Object.assign(Object.assign({},r),{claims:[...r.claims,m]})),this.updateClaim=this.updater((r,m)=>Object.assign(Object.assign({},r),{claims:r.claims.map(p=>p.id===m.id?m:p)})),this.addClaims=this.updater((r,m)=>Object.assign(Object.assign({},r),{claims:r.claims.concat(m)})),this.updateClaims=this.updater((r,m)=>Object.assign(Object.assign({},r),{claims:r.claims.map(p=>m.find(w=>w.id===p.id)||p)})),this.setSearchQuery=this.updater((r,m)=>Object.assign(Object.assign({},r),{searchQuery:m})),this.loadClaimEffect=this.effect(r=>r.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(m=>this.data.userClaim({claimId:m}).pipe((0,g._b)(p=>{this.patchState({item:p.data.item,errors:p.errors,loading:!1})},p=>this.patchState({loading:!1,errors:p.graphQLErrors?p.graphQLErrors:p})))))),this.loadClaimsEffect=this.effect(r=>r.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([m,p])=>this.data.userClaims({input:p}).pipe((0,g._b)(_=>this.patchState({paging:{limit:p.limit,skip:p.skip,total:_.data.count.total},claims:_.data.items,errors:_.errors,loading:!1}),_=>this.patchState({loading:!1,errors:_.graphQLErrors?_.graphQLErrors:_})))))),this.createClaimEffect=this.effect(r=>r.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(m=>this.claimService.createClaim(Object.assign({},m)).pipe((0,g._b)(p=>{this.addNewClaim(p),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:p,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},p=>{p.graphQLErrors?(this.toast.error(p.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:p.graphQLErrors?p.graphQLErrors:p})):(this.toast.error(p.Message),this.formService.setErrors(p.Data))}))))),this.updateClaimEffect=this.effect(r=>r.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([m,p])=>this.claimService.updateClaim(m,m.id).pipe((0,g._b)(_=>{this.updateClaim(_),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:_,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},_=>{_.graphQLErrors?(this.toast.error(_.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:_.graphQLErrors?_.graphQLErrors:_})):(this.toast.error(_.Message),this.formService.setErrors(_.Data))}))))),this.deleteClaimEffect=this.effect(r=>r.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([m,p])=>this.data.userDeleteClaim({claimId:p.id}).pipe((0,g._b)(_=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:_.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},_=>{_.graphQLErrors?(this.toast.error(_.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:_.graphQLErrors?_.graphQLErrors:_})):(this.toast.error(_.Message),this.formService.setErrors(_.Data))}))))),this.importExcelEffect=this.effect(r=>r.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(m=>this.claimService.importClaims(m).pipe((0,ce.K)(p=>{var _;return this.toast.error(null!==(_=p.Message)&&void 0!==_?_:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(p=>{const _=JSON.parse(p.created),w=JSON.parse(p.updated),J=JSON.parse(p.failed),_e=_.length+w.length+J.length;this.addClaims(_),this.updateClaims(w),this.toast.success(`${_.length} created, ${w.length} updated, ${J.length} failed of total ${_e}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("claimId")){var A=this.route.snapshot.paramMap.get("claimId");this.setFormName("claim_edit")}else this.setFormName("claim_create");if(this.route.snapshot.paramMap.has("priorAuthorizationRequestId")){var c=this.route.snapshot.paramMap.get("priorAuthorizationRequestId");this.setPriorAuthorizationRequestId(c)}if(this.route.snapshot.paramMap.has("claimId")&&(A=this.route.snapshot.paramMap.get("claimId"),this.setClaimId(A)),this.route.snapshot.paramMap.has("explanationOfPaymentId")){var d=this.route.snapshot.paramMap.get("explanationOfPaymentId");this.setExplanationOfPaymentId(d)}if(this.route.snapshot.paramMap.has("patientId")){var n=this.route.snapshot.paramMap.get("patientId");this.setPatientId(n)}}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.claimService.validateClaimExcelData(t,i.priorAuthorizationRequests,i.documents,i.documents,i.patients)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(xy))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function Ny(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.claim)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let xn=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"claim_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.claim=i.item})):t.formName&&t.formName.currentValue&&"claim_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadClaimEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.claim=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Bs),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-claim-form"]],inputs:{claim:"claim",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,Ny,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),Nn=(()=>{class s{constructor(){this.autoHeight=!1,this.claims=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[{field:"priorAuthorizationRequest.name",headerName:"Prior Authorization Request",filter:"agTextColumnFilter"},{field:"claim.name",headerName:"Claim",filter:"agTextColumnFilter"},{field:"explanationOfPayment.name",headerName:"Explanation of Payment",filter:"agTextColumnFilter"},{field:"patient.name",headerName:"Patient",filter:"agTextColumnFilter"},{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{field:"originalRecordDate",filter:"agDateColumnFilter"},{field:"receivedDate",filter:"agDateColumnFilter"},{field:"dueDate",filter:"agDateColumnFilter"},{field:"patientName",filter:"agTextColumnFilter"},{field:"patientPhoneNumber",filter:"agTextColumnFilter"},{field:"patientDob",filter:"agTextColumnFilter"},{field:"patientAddressLine1",filter:"agTextColumnFilter"},{field:"patientAddressCity",filter:"agTextColumnFilter"},{field:"patientAddressState",filter:"agTextColumnFilter"},{field:"patientAddressPostalCode",filter:"agTextColumnFilter"},{field:"carrierName",filter:"agTextColumnFilter"},{field:"carrierLine1",filter:"agTextColumnFilter"},{field:"carrierLine2",filter:"agTextColumnFilter"},{field:"carrierCity",filter:"agTextColumnFilter"},{field:"carrierState",filter:"agTextColumnFilter"},{field:"carrierPostalCode",filter:"agTextColumnFilter"},{field:"insuredName",filter:"agTextColumnFilter"},{field:"insuredLine1",filter:"agTextColumnFilter"},{field:"insuredCity",filter:"agTextColumnFilter"},{field:"insuredState",filter:"agTextColumnFilter"},{field:"insuredPostalCode",filter:"agTextColumnFilter"},{field:"patientSignature",filter:"agTextColumnFilter"},{field:"diagnosisCode1",filter:"agTextColumnFilter"},{field:"diagnosisCode2",filter:"agTextColumnFilter"},{field:"diagnosisCode3",filter:"agTextColumnFilter"},{field:"diagnosisCode4",filter:"agTextColumnFilter"},{field:"diagnosisCode5",filter:"agTextColumnFilter"},{field:"diagnosisCode6",filter:"agTextColumnFilter"},{field:"diagnosisCode7",filter:"agTextColumnFilter"},{field:"diagnosisCode8",filter:"agTextColumnFilter"},{field:"federalTaxId",filter:"agTextColumnFilter"},{field:"totalCharges",filter:"agTextColumnFilter"},{field:"amountPaid",filter:"agTextColumnFilter"},{field:"physicianSignature",filter:"agTextColumnFilter"},{field:"physicianSignedOn",filter:"agTextColumnFilter"},{field:"serviceFacility",filter:"agTextColumnFilter"},{field:"serviceFacilityLine1",filter:"agTextColumnFilter"},{field:"serviceFacilityCity",filter:"agTextColumnFilter"},{field:"serviceFacilityState",filter:"agTextColumnFilter"},{field:"serviceFacilityPostalCode",filter:"agTextColumnFilter"},{field:"serviceFacilityNpi",filter:"agTextColumnFilter"},{field:"billingFacility",filter:"agTextColumnFilter"},{field:"billingLine1",filter:"agTextColumnFilter"},{field:"billingCity",filter:"agTextColumnFilter"},{field:"billingState",filter:"agTextColumnFilter"},{field:"billingPostalCode",filter:"agTextColumnFilter"},{field:"billingNpi",filter:"agTextColumnFilter"},{field:"billingPhoneNumber",filter:"agTextColumnFilter"},{field:"billingOther",filter:"agTextColumnFilter"},{field:"sessionNotes",filter:"agTextColumnFilter"},{field:"referringProvider",filter:"agTextColumnFilter"},{field:"referringProviderNpi",filter:"agTextColumnFilter"},{field:"additionalClaimInfo",filter:"agTextColumnFilter"},{field:"accountNumber",filter:"agTextColumnFilter"},{field:"referenceNumber",filter:"agTextColumnFilter"},{field:"facility",filter:"agTextColumnFilter"},{field:"priorAuthorizationNumber",filter:"agTextColumnFilter"},{field:"priorAuthorizationRequestId",filter:"agTextColumnFilter",hide:!0},{field:"providerName",filter:"agTextColumnFilter"},{field:"providerNumber",filter:"agTextColumnFilter"},{field:"vendor",filter:"agTextColumnFilter"},{field:"vendorLine1",filter:"agTextColumnFilter"},{field:"vendorCSZ",filter:"agTextColumnFilter"},{field:"vendorTaxId",filter:"agTextColumnFilter"},{headerName:"Total Approved Amount",field:"totalApprovedAmount",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.totalApprovedAmount,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{headerName:"Total Billed Amount",field:"totalBilledAmount",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.totalBilledAmount,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{headerName:"Total Net Pay Amount",field:"totalNetPayAmount",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.totalNetPayAmount,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{field:"notes",filter:"agTextColumnFilter"},{field:"claimId",filter:"agTextColumnFilter",hide:!0},{field:"explanationOfPaymentId",filter:"agTextColumnFilter",hide:!0},{field:"patientId",filter:"agTextColumnFilter",hide:!0}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-claim-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",claims:"claims"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.claims)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function Ay(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-claim-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","claim_edit")("formControl",t.formControl)("claim",t.claim)}}const Fy=function(){return{}};function Py(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-claim-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","claim_create")("formControl",t.formControl)("claim",e.DdM(3,Fy))}}function Iy(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-claim-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("claims",o.data.items)}let Dy=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadClaimsEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.claims$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Bs))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:5,consts:[[3,"to","control","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","claim","send","close"],[1,"w-full","h-full","bg-white",3,"claims","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"ui-select-form",0),e.YNc(1,Ay,2,3,"ng-template",null,1,e.W1O),e.YNc(3,Py,1,4,"ng-template",null,2,e.W1O),e.YNc(5,Iy,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[W.JJ,W.oH,Z.$,xn,Nn],encapsulation:2}),s})();function My(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-claim-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","claim_edit")("claim",t.value)}}const Wy=function(){return{}};function Ey(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-claim-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","claim_create")("claim",e.DdM(2,Wy))}function Oy(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-claim-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("claims",t.items)}}let Ly=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:6,consts:[[3,"data","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","claim","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","claims","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,My,1,2,"ng-template",null,1,e.W1O),e.YNc(3,Ey,1,3,"ng-template",null,2,e.W1O),e.YNc(5,Oy,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,xn,Nn],encapsulation:2}),s})(),$y=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[Bs],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"claim-select",component:Dy,wrappers:["form-field"]},{name:"claim-grid",component:Ly}]})]}),s})(),Gy=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[$y]}),s})();class Mt extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class Ry extends Mt{constructor(o,t,i,a,l,u){super("ValidateClaimProcedureExcelDataAction"),this.valid=!1,this.excelData=o,this.placeOfServices=t,this.claimStatuses=i,this.claims=a,this.appointments=l,this.procedures=u}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name),this.validationContext.addRule(new f.mi(`placeOfServiceName_${i}_is_valid}`,"Place of Service Is Not Valid","placeOfService.name",t.placeOfService,this.placeOfServices,!0)),this.validationContext.addRule(new f.mi(`claimStatusName_${i}_is_valid}`,"Claim Status Is Not Valid","claimStatus.name",t.claimStatus,this.claimStatuses,!0)),this.validationContext.addRule(new f.mi(`claimName_${i}_is_valid}`,"Claim Is Not Valid","claim.name",t.claim,this.claims,!0)),this.validationContext.addRule(new f.mi(`appointmentName_${i}_is_valid}`,"Appointment Is Not Valid","appointment.name",t.appointment,this.appointments,!0)),this.validationContext.addRule(new f.mi(`procedureName_${i}_is_valid}`,"Procedure Is Not Valid","procedure.name",t.procedure,this.procedures,!0))}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class Qy extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class Vy extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new Qy("name","The claimprocedure name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class jy extends Mt{constructor(o){super("CreateClaimProcedureAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new Vy("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateClaimProcedure({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class Uy extends Mt{constructor(o){super("UpdateClaimProceduresAction"),this.claimProcedures=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.claimProcedures,!0))}performAction(){this.response=this.businessProvider.data.userUpdateClaimProcedures({input:{claimProcedures:this.claimProcedures}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class Jy extends Mt{constructor(o,t){super("UpdateClaimProcedureAction"),this.claimProcedure=o,this.claimProcedureId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.claimProcedure,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.claimProcedureId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateClaimProcedure({claimProcedureId:this.claimProcedureId,input:this.claimProcedure}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let An=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.ClaimProcedureBusinessProviderService",t,a),this.data=i}createClaimProcedure(t){const i=new jy(t);return i.Do(this),i.response}updateClaimProcedure(t,i){const a=new Jy(t,i);return a.Do(this),a.response}importClaimProcedures(t){const i=new Uy(t);return i.Do(this),i.response}validateClaimProcedureExcelData(t,i,a,l,u,H){const A=new Ry(t,i,a,l,u,H);return A.Do(this),A.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),zy=(()=>{class s extends I.nH{constructor(t,i,a){super("ClaimProcedureService",a,t),this.businessProvider=i}createClaimProcedure(t){return this.businessProvider.createClaimProcedure(t)}updateClaimProcedure(t,i){return this.businessProvider.updateClaimProcedure(t,i)}importClaimProcedures(t){return this.businessProvider.importClaimProcedures(t)}validateClaimProcedureExcelData(t,i,a,l,u,H){return this.businessProvider.validateClaimProcedureExcelData(t,i,a,l,u,H)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(An,8),e.LFG(An),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),Wt=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){if(super({loading:!1,claimProcedures:[],done:!1,searchQuery:"",formName:void 0,placeOfServiceId:void 0,claimStatusId:void 0,claimId:void 0,appointmentId:void 0,procedureId:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.claimProcedureService=H,this.errors$=this.select(p=>p.errors),this.loading$=this.select(p=>p.loading),this.done$=this.select(p=>p.done),this.item$=this.select(p=>p.item),this.claimProcedures$=this.select(p=>p.claimProcedures),this.placeOfServices$=this.select(p=>p.placeOfServices||[]),this.claimStatuses$=this.select(p=>p.claimStatuses||[]),this.claims$=this.select(p=>p.claims||[]),this.appointments$=this.select(p=>p.appointments||[]),this.procedures$=this.select(p=>p.procedures||[]),this.placeOfServiceId$=this.select(p=>p.placeOfServiceId),this.claimStatusId$=this.select(p=>p.claimStatusId),this.claimId$=this.select(p=>p.claimId),this.appointmentId$=this.select(p=>p.appointmentId),this.procedureId$=this.select(p=>p.procedureId),this.paging$=this.select(p=>p.paging),this.searchQuery$=this.select(p=>p.searchQuery),this.formName$=this.select(p=>p.formName),this.actionResult$=this.select(this.item$,this.done$,(p,_)=>({item:p,done:_}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.claimProcedures$,this.placeOfServices$,this.claimStatuses$,this.claims$,this.appointments$,this.procedures$,(p,_,w,J,_e,ve,ae,le,Y,oe)=>({errors:p,loading:_,item:w,formName:J,claimProcedures:_e,placeOfServices:ve,claimStatuses:ae,claims:le,appointments:Y,procedures:oe}),{debounce:!0}),this.input$=this.select(this.paging$,this.placeOfServiceId$,this.claimStatusId$,this.claimId$,this.appointmentId$,this.procedureId$,this.searchQuery$,(p,_,w,J,_e,ve,ae)=>({limit:p.limit,skip:p.skip,name:ae,placeOfServiceId:_,claimStatusId:w,claimId:J,appointmentId:_e,procedureId:ve,total:p.total})),this.setFormName=this.updater((p,_)=>Object.assign(Object.assign({},p),{formName:_})),this.setPlaceOfServiceId=this.updater((p,_)=>Object.assign(Object.assign({},p),{placeOfServiceId:_})),this.setClaimStatusId=this.updater((p,_)=>Object.assign(Object.assign({},p),{claimStatusId:_})),this.setClaimId=this.updater((p,_)=>Object.assign(Object.assign({},p),{claimId:_})),this.setAppointmentId=this.updater((p,_)=>Object.assign(Object.assign({},p),{appointmentId:_})),this.setProcedureId=this.updater((p,_)=>Object.assign(Object.assign({},p),{procedureId:_})),this.filterPlaceOfServices=p=>this.data.userSelectPlaceOfServices({input:{name:p}}).pipe((0,g._b)(_=>{let w=_.data.items;return this.patchState({placeOfServices:w}),w},_=>this.patchState({errors:_.graphQLErrors?_.graphQLErrors:_})),(0,he.U)(_=>_.data.items)),this.filterClaimStatuses=p=>this.data.userSelectClaimStatuses({input:{name:p}}).pipe((0,g._b)(_=>{let w=_.data.items;return this.patchState({claimStatuses:w}),w},_=>this.patchState({errors:_.graphQLErrors?_.graphQLErrors:_})),(0,he.U)(_=>_.data.items)),this.filterClaims=p=>this.data.userSelectClaims({input:{name:p}}).pipe((0,g._b)(_=>{let w=_.data.items;return this.patchState({claims:w}),w},_=>this.patchState({errors:_.graphQLErrors?_.graphQLErrors:_})),(0,he.U)(_=>_.data.items)),this.filterAppointments=p=>this.data.userSelectAppointments({input:{name:p}}).pipe((0,g._b)(_=>{let w=_.data.items;return this.patchState({appointments:w}),w},_=>this.patchState({errors:_.graphQLErrors?_.graphQLErrors:_})),(0,he.U)(_=>_.data.items)),this.filterProcedures=p=>this.data.userSelectProcedures({input:{name:p}}).pipe((0,g._b)(_=>{let w=_.data.items;return this.patchState({procedures:w}),w},_=>this.patchState({errors:_.graphQLErrors?_.graphQLErrors:_})),(0,he.U)(_=>_.data.items)),this.addPlaceOfService=this.updater((p,_)=>Object.assign(Object.assign({},p),{placeOfServices:p.placeOfServices.concat(_)})),this.addClaimStatus=this.updater((p,_)=>Object.assign(Object.assign({},p),{claimStatuses:p.claimStatuses.concat(_)})),this.addClaim=this.updater((p,_)=>Object.assign(Object.assign({},p),{claims:p.claims.concat(_)})),this.addAppointment=this.updater((p,_)=>Object.assign(Object.assign({},p),{appointments:p.appointments.concat(_)})),this.addProcedure=this.updater((p,_)=>Object.assign(Object.assign({},p),{procedures:p.procedures.concat(_)})),this.setItem=this.updater((p,_)=>Object.assign(Object.assign({},p),{item:_})),this.addNewClaimProcedure=this.updater((p,_)=>Object.assign(Object.assign({},p),{claimProcedures:[...p.claimProcedures,_]})),this.updateClaimProcedure=this.updater((p,_)=>Object.assign(Object.assign({},p),{claimProcedures:p.claimProcedures.map(w=>w.id===_.id?_:w)})),this.addClaimProcedures=this.updater((p,_)=>Object.assign(Object.assign({},p),{claimProcedures:p.claimProcedures.concat(_)})),this.updateClaimProcedures=this.updater((p,_)=>Object.assign(Object.assign({},p),{claimProcedures:p.claimProcedures.map(w=>_.find(_e=>_e.id===w.id)||w)})),this.setSearchQuery=this.updater((p,_)=>Object.assign(Object.assign({},p),{searchQuery:_})),this.loadClaimProcedureEffect=this.effect(p=>p.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(_=>this.data.userClaimProcedure({claimProcedureId:_}).pipe((0,g._b)(w=>{this.patchState({item:w.data.item,errors:w.errors,loading:!1})},w=>this.patchState({loading:!1,errors:w.graphQLErrors?w.graphQLErrors:w})))))),this.loadClaimProceduresEffect=this.effect(p=>p.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([_,w])=>this.data.userClaimProcedures({input:w}).pipe((0,g._b)(J=>this.patchState({paging:{limit:w.limit,skip:w.skip,total:J.data.count.total},claimProcedures:J.data.items,errors:J.errors,loading:!1}),J=>this.patchState({loading:!1,errors:J.graphQLErrors?J.graphQLErrors:J})))))),this.createClaimProcedureEffect=this.effect(p=>p.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(_=>this.claimProcedureService.createClaimProcedure(Object.assign({},_)).pipe((0,g._b)(w=>{this.addNewClaimProcedure(w),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:w,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},w=>{w.graphQLErrors?(this.toast.error(w.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:w.graphQLErrors?w.graphQLErrors:w})):(this.toast.error(w.Message),this.formService.setErrors(w.Data))}))))),this.updateClaimProcedureEffect=this.effect(p=>p.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([_,w])=>this.claimProcedureService.updateClaimProcedure(_,_.id).pipe((0,g._b)(J=>{this.updateClaimProcedure(J),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:J,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},J=>{J.graphQLErrors?(this.toast.error(J.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:J.graphQLErrors?J.graphQLErrors:J})):(this.toast.error(J.Message),this.formService.setErrors(J.Data))}))))),this.deleteClaimProcedureEffect=this.effect(p=>p.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([_,w])=>this.data.userDeleteClaimProcedure({claimProcedureId:w.id}).pipe((0,g._b)(J=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:J.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},J=>{J.graphQLErrors?(this.toast.error(J.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:J.graphQLErrors?J.graphQLErrors:J})):(this.toast.error(J.Message),this.formService.setErrors(J.Data))}))))),this.importExcelEffect=this.effect(p=>p.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(_=>this.claimProcedureService.importClaimProcedures(_).pipe((0,ce.K)(w=>{var J;return this.toast.error(null!==(J=w.Message)&&void 0!==J?J:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(w=>{const J=JSON.parse(w.created),_e=JSON.parse(w.updated),ve=JSON.parse(w.failed),ae=J.length+_e.length+ve.length;this.addClaimProcedures(J),this.updateClaimProcedures(_e),this.toast.success(`${J.length} created, ${_e.length} updated, ${ve.length} failed of total ${ae}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("claimProcedureId")?(this.route.snapshot.paramMap.get("claimProcedureId"),this.setFormName("claimProcedure_edit")):this.setFormName("claimProcedure_create"),this.route.snapshot.paramMap.has("placeOfServiceId")){var c=this.route.snapshot.paramMap.get("placeOfServiceId");this.setPlaceOfServiceId(c)}if(this.route.snapshot.paramMap.has("claimStatusId")){var d=this.route.snapshot.paramMap.get("claimStatusId");this.setClaimStatusId(d)}if(this.route.snapshot.paramMap.has("claimId")){var n=this.route.snapshot.paramMap.get("claimId");this.setClaimId(n)}if(this.route.snapshot.paramMap.has("appointmentId")){var r=this.route.snapshot.paramMap.get("appointmentId");this.setAppointmentId(r)}if(this.route.snapshot.paramMap.has("procedureId")){var m=this.route.snapshot.paramMap.get("procedureId");this.setProcedureId(m)}}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.claimProcedureService.validateClaimProcedureExcelData(t,i.placeOfServices,i.claimStatuses,i.claims,i.appointments,i.procedures)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(zy))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function Hy(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.claimProcedure)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let Fn=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"claimProcedure_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({id:null,name:""}),this.store.vm$.subscribe(i=>{this.claimProcedure=i.item})):t.formName&&t.formName.currentValue&&"claimProcedure_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadClaimProcedureEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.claimProcedure=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Wt),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-claim-procedure-form"]],inputs:{claimProcedure:"claimProcedure",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,Hy,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),Pn=(()=>{class s{constructor(){this.autoHeight=!1,this.claimProcedures=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[{field:"placeOfService.name",headerName:"Place of Service",filter:"agTextColumnFilter"},{field:"claimStatus.name",headerName:"Claim Status",filter:"agTextColumnFilter"},{field:"claim.name",headerName:"Claim",filter:"agTextColumnFilter"},{field:"appointment.name",headerName:"Appointment",filter:"agTextColumnFilter"},{field:"procedure.name",headerName:"Procedure",filter:"agTextColumnFilter"},{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{field:"claimProcedureCodeId",filter:"agTextColumnFilter"},{field:"procedureCodeId",filter:"agTextColumnFilter"},{field:"claimId",filter:"agTextColumnFilter",hide:!0},{field:"fromDateOfService",filter:"agDateColumnFilter"},{field:"toDateOfService",filter:"agDateColumnFilter"},{field:"placeOfServiceId",filter:"agTextColumnFilter",hide:!0},{field:"nationalDrugCode",filter:"agTextColumnFilter"},{field:"drugUnit",filter:"agTextColumnFilter"},{field:"drugQuantity",filter:"agTextColumnFilter"},{headerName:"Quantity",field:"quantity",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.quantity,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{headerName:"Billed Amount",field:"billedAmount",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.billedAmount,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{headerName:"Approved Amount",field:"approvedAmount",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.approvedAmount,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{headerName:"Adjustment Amount",field:"adjustmentAmount",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.adjustmentAmount,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{headerName:"Net Payment Amount",field:"netPaymentAmount",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.netPaymentAmount,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{field:"paymentMethod",filter:"agTextColumnFilter"},{field:"internalMemo",filter:"agTextColumnFilter"},{field:"explainationOfBenefitsComment",filter:"agTextColumnFilter"},{field:"claimStatusId",filter:"agTextColumnFilter",hide:!0},{field:"reason",filter:"agTextColumnFilter"},{field:"procedureCode",filter:"agTextColumnFilter"},{field:"diagnosisPointer",filter:"agTextColumnFilter"},{field:"modifier1",filter:"agTextColumnFilter"},{field:"modifier2",filter:"agTextColumnFilter"},{field:"modifier3",filter:"agTextColumnFilter"},{field:"modifier4",filter:"agTextColumnFilter"},{field:"appointmentId",filter:"agTextColumnFilter",hide:!0},{field:"procedureId",filter:"agTextColumnFilter",hide:!0}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-claim-procedure-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",claimProcedures:"claimProcedures"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","data","showSidebar","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("data",i.claimProcedures)("showSidebar",!1)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function qy(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-claim-procedure-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","claimProcedure_edit")("formControl",t.formControl)("claimProcedure",t.claimProcedure)}}const Ky=function(){return{}};function Zy(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-claim-procedure-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","claimProcedure_create")("formControl",t.formControl)("claimProcedure",e.DdM(3,Ky))}}function ky(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-claim-procedure-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("claimProcedures",o.data.items)}let By=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadClaimProceduresEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.claimProcedures$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Wt))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e._Bn([Wt]),e.qOj],decls:7,vars:5,consts:[[3,"to","control","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","claimProcedure","send","close"],[1,"w-full","h-full","bg-white",3,"claimProcedures","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"ui-select-form",0),e.YNc(1,qy,2,3,"ng-template",null,1,e.W1O),e.YNc(3,Zy,1,4,"ng-template",null,2,e.W1O),e.YNc(5,ky,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[W.JJ,W.oH,Z.$,Fn,Pn],encapsulation:2}),s})();function Yy(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-claim-procedure-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","claimProcedure_edit")("claimProcedure",t.value)}}const Xy=function(){return{}};function ew(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-claim-procedure-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","claimProcedure_create")("claimProcedure",e.DdM(2,Xy))}function tw(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-claim-procedure-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("claimProcedures",t.items)}}let iw=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:6,consts:[[3,"data","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","claimProcedure","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","claimProcedures","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,Yy,1,2,"ng-template",null,1,e.W1O),e.YNc(3,ew,1,3,"ng-template",null,2,e.W1O),e.YNc(5,tw,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,Fn,Pn],encapsulation:2}),s})(),sw=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[Wt],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"claim-procedure-select",component:By,wrappers:["form-field"]},{name:"claim-procedure-grid",component:iw}]})]}),s})(),ow=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[sw]}),s})();class Et extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class aw extends Et{constructor(o){super("ValidateClaimStatusExcelDataAction"),this.valid=!1,this.excelData=o}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name)}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class rw extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class nw extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new rw("name","The claimstatus name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class lw extends Et{constructor(o){super("CreateClaimStatusAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new nw("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateClaimStatus({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class cw extends Et{constructor(o){super("UpdateClaimStatusesAction"),this.claimStatuses=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.claimStatuses,!0))}performAction(){this.response=this.businessProvider.data.userUpdateClaimStatuses({input:{claimStatuses:this.claimStatuses}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class dw extends Et{constructor(o,t){super("UpdateClaimStatusAction"),this.claimStatus=o,this.claimStatusId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.claimStatus,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.claimStatusId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateClaimStatus({claimStatusId:this.claimStatusId,input:this.claimStatus}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let In=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.ClaimStatusBusinessProviderService",t,a),this.data=i}createClaimStatus(t){const i=new lw(t);return i.Do(this),i.response}updateClaimStatus(t,i){const a=new dw(t,i);return a.Do(this),a.response}importClaimStatuses(t){const i=new cw(t);return i.Do(this),i.response}validateClaimStatusExcelData(t){const i=new aw(t);return i.Do(this),i.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),uw=(()=>{class s extends I.nH{constructor(t,i,a){super("ClaimStatusService",a,t),this.businessProvider=i}createClaimStatus(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createClaimStatus(i)}updateClaimStatus(t,i){return this.businessProvider.updateClaimStatus(t,i)}importClaimStatuses(t){return this.businessProvider.importClaimStatuses(t)}validateClaimStatusExcelData(t){return this.businessProvider.validateClaimStatusExcelData(t)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(In,8),e.LFG(In),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),Ys=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){super({loading:!1,claimStatuses:[],done:!1,searchQuery:"",formName:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.claimStatusService=H,this.errors$=this.select(c=>c.errors),this.loading$=this.select(c=>c.loading),this.done$=this.select(c=>c.done),this.item$=this.select(c=>c.item),this.claimStatuses$=this.select(c=>c.claimStatuses),this.paging$=this.select(c=>c.paging),this.searchQuery$=this.select(c=>c.searchQuery),this.formName$=this.select(c=>c.formName),this.actionResult$=this.select(this.item$,this.done$,(c,d)=>({item:c,done:d}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.claimStatuses$,(c,d,n,r,m)=>({errors:c,loading:d,item:n,formName:r,claimStatuses:m}),{debounce:!0}),this.input$=this.select(this.paging$,this.searchQuery$,(c,d)=>({limit:c.limit,skip:c.skip,name:d,total:c.total})),this.setFormName=this.updater((c,d)=>Object.assign(Object.assign({},c),{formName:d})),this.setItem=this.updater((c,d)=>Object.assign(Object.assign({},c),{item:d})),this.addNewClaimStatus=this.updater((c,d)=>Object.assign(Object.assign({},c),{claimStatuses:[...c.claimStatuses,d]})),this.updateClaimStatus=this.updater((c,d)=>Object.assign(Object.assign({},c),{claimStatuses:c.claimStatuses.map(n=>n.id===d.id?d:n)})),this.addClaimStatuses=this.updater((c,d)=>Object.assign(Object.assign({},c),{claimStatuses:c.claimStatuses.concat(d)})),this.updateClaimStatuses=this.updater((c,d)=>Object.assign(Object.assign({},c),{claimStatuses:c.claimStatuses.map(n=>d.find(m=>m.id===n.id)||n)})),this.setSearchQuery=this.updater((c,d)=>Object.assign(Object.assign({},c),{searchQuery:d})),this.loadClaimStatusEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.data.userClaimStatus({claimStatusId:d}).pipe((0,g._b)(n=>{this.patchState({item:n.data.item,errors:n.errors,loading:!1})},n=>this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})))))),this.loadClaimStatusesEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([d,n])=>this.data.userClaimStatuses({input:n}).pipe((0,g._b)(r=>this.patchState({paging:{limit:n.limit,skip:n.skip,total:r.data.count.total},claimStatuses:r.data.items,errors:r.errors,loading:!1}),r=>this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})))))),this.createClaimStatusEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.claimStatusService.createClaimStatus(Object.assign({},d)).pipe((0,g._b)(n=>{this.addNewClaimStatus(n),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:n,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},n=>{n.graphQLErrors?(this.toast.error(n.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})):(this.toast.error(n.Message),this.formService.setErrors(n.Data))}))))),this.updateClaimStatusEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.claimStatusService.updateClaimStatus(d,d.id).pipe((0,g._b)(r=>{this.updateClaimStatus(r),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:r,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.deleteClaimStatusEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.data.userDeleteClaimStatus({claimStatusId:n.id}).pipe((0,g._b)(r=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:r.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.importExcelEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.claimStatusService.importClaimStatuses(d).pipe((0,ce.K)(n=>{var r;return this.toast.error(null!==(r=n.Message)&&void 0!==r?r:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(n=>{const r=JSON.parse(n.created),m=JSON.parse(n.updated),p=JSON.parse(n.failed),_=r.length+m.length+p.length;this.addClaimStatuses(r),this.updateClaimStatuses(m),this.toast.success(`${r.length} created, ${m.length} updated, ${p.length} failed of total ${_}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("claimStatusId")?(this.route.snapshot.paramMap.get("claimStatusId"),this.setFormName("claimStatus_edit")):this.setFormName("claimStatus_create")}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.claimStatusService.validateClaimStatusExcelData(t)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(uw))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function mw(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.claimStatus)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let Dn=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"claimStatus_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.claimStatus=i.item})):t.formName&&t.formName.currentValue&&"claimStatus_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadClaimStatusEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.claimStatus=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Ys),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-claim-status-form"]],inputs:{claimStatus:"claimStatus",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,mw,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),Mn=(()=>{class s{constructor(){this.autoHeight=!1,this.claimStatuses=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[,{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-claim-status-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",claimStatuses:"claimStatuses"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.claimStatuses)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function pw(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-claim-status-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","claimStatus_edit")("formControl",t.formControl)("claimStatus",t.claimStatus)}}const hw=function(){return{}};function fw(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-claim-status-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","claimStatus_create")("formControl",t.formControl)("claimStatus",e.DdM(3,hw))}}function _w(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-claim-status-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("claimStatuses",o.data.items)}let gw=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadClaimStatusesEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.claimStatuses$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Ys))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","claimStatus","send","close"],[1,"w-full","h-full","bg-white",3,"claimStatuses","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,pw,2,3,"ng-template",null,1,e.W1O),e.YNc(3,fw,1,4,"ng-template",null,2,e.W1O),e.YNc(5,_w,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,Dn,Mn],encapsulation:2}),s})();function Cw(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-claim-status-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","claimStatus_edit")("claimStatus",t.value)}}const vw=function(){return{}};function Sw(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-claim-status-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","claimStatus_create")("claimStatus",e.DdM(2,vw))}function bw(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-claim-status-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("claimStatuses",t.items)}}let Tw=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","claimStatus","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","claimStatuses","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,Cw,1,2,"ng-template",null,1,e.W1O),e.YNc(3,Sw,1,3,"ng-template",null,2,e.W1O),e.YNc(5,bw,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,Dn,Mn],encapsulation:2}),s})(),yw=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[Ys],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"claim-status-select",component:gw,wrappers:["form-field"]},{name:"claim-status-grid",component:Tw}]})]}),s})(),ww=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[yw]}),s})();class Ot extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class xw extends Ot{constructor(o,t){super("ValidateClinicalProviderLocationAvailabilityExcelDataAction"),this.valid=!1,this.excelData=o,this.clinicalProviderLocations=t}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name),this.validationContext.addRule(new f.mi(`clinicalProviderLocationName_${i}_is_valid}`,"Clinical Provider Location Is Not Valid","clinicalProviderLocation.name",t.clinicalProviderLocation,this.clinicalProviderLocations,!0))}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class Nw extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class Aw extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new Nw("name","The clinicalproviderlocationavailability name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class Fw extends Ot{constructor(o){super("CreateClinicalProviderLocationAvailabilityAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new Aw("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateClinicalProviderLocationAvailability({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class Pw extends Ot{constructor(o){super("UpdateClinicalProviderLocationAvailabilitiesAction"),this.clinicalProviderLocationAvailabilities=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.clinicalProviderLocationAvailabilities,!0))}performAction(){this.response=this.businessProvider.data.userUpdateClinicalProviderLocationAvailabilities({input:{clinicalProviderLocationAvailabilities:this.clinicalProviderLocationAvailabilities}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class Iw extends Ot{constructor(o,t){super("UpdateClinicalProviderLocationAvailabilityAction"),this.clinicalProviderLocationAvailability=o,this.clinicalProviderLocationAvailabilityId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.clinicalProviderLocationAvailability,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.clinicalProviderLocationAvailabilityId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateClinicalProviderLocationAvailability({clinicalProviderLocationAvailabilityId:this.clinicalProviderLocationAvailabilityId,input:this.clinicalProviderLocationAvailability}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let Wn=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.ClinicalProviderLocationAvailabilityBusinessProviderService",t,a),this.data=i}createClinicalProviderLocationAvailability(t){const i=new Fw(t);return i.Do(this),i.response}updateClinicalProviderLocationAvailability(t,i){const a=new Iw(t,i);return a.Do(this),a.response}importClinicalProviderLocationAvailabilities(t){const i=new Pw(t);return i.Do(this),i.response}validateClinicalProviderLocationAvailabilityExcelData(t,i){const a=new xw(t,i);return a.Do(this),a.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),Dw=(()=>{class s extends I.nH{constructor(t,i,a){super("ClinicalProviderLocationAvailabilityService",a,t),this.businessProvider=i}createClinicalProviderLocationAvailability(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createClinicalProviderLocationAvailability(i)}updateClinicalProviderLocationAvailability(t,i){return this.businessProvider.updateClinicalProviderLocationAvailability(t,i)}importClinicalProviderLocationAvailabilities(t){return this.businessProvider.importClinicalProviderLocationAvailabilities(t)}validateClinicalProviderLocationAvailabilityExcelData(t,i){return this.businessProvider.validateClinicalProviderLocationAvailabilityExcelData(t,i)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(Wn,8),e.LFG(Wn),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),Xs=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){if(super({loading:!1,clinicalProviderLocationAvailabilities:[],done:!1,searchQuery:"",formName:void 0,clinicalProviderLocationId:"-----",paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.clinicalProviderLocationAvailabilityService=H,this.errors$=this.select(A=>A.errors),this.loading$=this.select(A=>A.loading),this.done$=this.select(A=>A.done),this.item$=this.select(A=>A.item),this.clinicalProviderLocationAvailabilities$=this.select(A=>A.clinicalProviderLocationAvailabilities),this.clinicalProviderLocations$=this.select(A=>A.clinicalProviderLocations||[]),this.paging$=this.select(A=>A.paging),this.searchQuery$=this.select(A=>A.searchQuery),this.formName$=this.select(A=>A.formName),this.startTime$=this.select(A=>A.startTime),this.endTime$=this.select(A=>A.endTime),this.day$=this.select(A=>A.day),this.clinicalProviderLocationId$=this.select(A=>A.clinicalProviderLocationId),this.actionResult$=this.select(this.item$,this.done$,(A,c)=>({item:A,done:c}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.clinicalProviderLocationAvailabilities$,this.clinicalProviderLocations$,(A,c,d,n,r,m)=>({errors:A,loading:c,item:d,formName:n,clinicalProviderLocationAvailabilities:r,clinicalProviderLocations:m}),{debounce:!0}),this.input$=this.select(this.paging$,this.searchQuery$,this.clinicalProviderLocationId$,this.startTime$,this.endTime$,this.day$,(A,c,d,n,r,m)=>({limit:A.limit,skip:A.skip,name:c,total:A.total,clinicalProviderLocationId:d,startTime:n,endTime:r,day:m})),this.setFormName=this.updater((A,c)=>Object.assign(Object.assign({},A),{formName:c})),this.setStartTime=this.updater((A,c)=>Object.assign(Object.assign({},A),{startTime:c})),this.setDay=this.updater((A,c)=>(console.log("day",c),Object.assign(Object.assign({},A),{day:c}))),this.setEndTime=this.updater((A,c)=>Object.assign(Object.assign({},A),{endTime:c})),this.setClinicalProviderLocationId=this.updater((A,c)=>(console.log("clinicalProviderLocationId",c),Object.assign(Object.assign({},A),{clinicalProviderLocationId:c}))),this.filterClinicalProviderLocations=A=>this.data.userSelectClinicalProviderLocations({input:{name:A}}).pipe((0,g._b)(c=>{const d=c.data.items;return this.patchState({clinicalProviderLocations:d}),d},c=>this.patchState({errors:c.graphQLErrors?c.graphQLErrors:c})),(0,he.U)(c=>c.data.items)),this.addClinicalProviderLocation=this.updater((A,c)=>Object.assign(Object.assign({},A),{clinicalProviderLocations:A.clinicalProviderLocations.concat(c)})),this.setItem=this.updater((A,c)=>Object.assign(Object.assign({},A),{item:c})),this.addNewClinicalProviderLocationAvailability=this.updater((A,c)=>Object.assign(Object.assign({},A),{clinicalProviderLocationAvailabilities:[...A.clinicalProviderLocationAvailabilities,c]})),this.updateClinicalProviderLocationAvailability=this.updater((A,c)=>Object.assign(Object.assign({},A),{clinicalProviderLocationAvailabilities:A.clinicalProviderLocationAvailabilities.map(d=>d.id===c.id?c:d)})),this.deleteClinicalProviderLocationAvailability=this.updater((A,c)=>Object.assign(Object.assign({},A),{clinicalProviderLocationAvailabilities:A.clinicalProviderLocationAvailabilities.filter(d=>d.id!==c.id)})),this.addClinicalProviderLocationAvailabilities=this.updater((A,c)=>Object.assign(Object.assign({},A),{clinicalProviderLocationAvailabilities:A.clinicalProviderLocationAvailabilities.concat(c)})),this.updateClinicalProviderLocationAvailabilities=this.updater((A,c)=>Object.assign(Object.assign({},A),{clinicalProviderLocationAvailabilities:A.clinicalProviderLocationAvailabilities.map(d=>c.find(r=>r.id===d.id)||d)})),this.setSearchQuery=this.updater((A,c)=>Object.assign(Object.assign({},A),{searchQuery:c})),this.loadClinicalProviderLocationAvailabilityEffect=this.effect(A=>A.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(c=>this.data.userClinicalProviderLocationAvailability({clinicalProviderLocationAvailabilityId:c}).pipe((0,g._b)(d=>{this.patchState({item:d.data.item,errors:d.errors,loading:!1})},d=>this.patchState({loading:!1,errors:d.graphQLErrors?d.graphQLErrors:d})))))),this.loadClinicalProviderLocationAvailabilitiesEffect=this.effect(A=>A.pipe((0,S.b)(()=>{this.patchState({loading:!0})}),(0,L.M)(this.input$),(0,h.w)(([c,d])=>(console.log("input",d),this.data.userClinicalProviderLocationAvailabilities({input:d}).pipe((0,g._b)(n=>{console.log("res",n.data.items),this.patchState({paging:{limit:d.limit,skip:d.skip,total:n.data.count.total},clinicalProviderLocationAvailabilities:n.data.items,errors:n.errors,loading:!1})},n=>this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n}))))))),this.createClinicalProviderLocationAvailabilityEffect=this.effect(A=>A.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(c=>this.clinicalProviderLocationAvailabilityService.createClinicalProviderLocationAvailability(Object.assign({},c)).pipe((0,g._b)(d=>{this.addNewClinicalProviderLocationAvailability(d),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:d,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},d=>{d.graphQLErrors?(this.toast.error(d.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:d.graphQLErrors?d.graphQLErrors:d})):(this.toast.error(d.Message),this.formService.setErrors(d.Data))}))))),this.updateClinicalProviderLocationAvailabilityEffect=this.effect(A=>A.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([c,d])=>this.clinicalProviderLocationAvailabilityService.updateClinicalProviderLocationAvailability(c,c.id).pipe((0,g._b)(n=>{this.updateClinicalProviderLocationAvailability(n),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:n,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},n=>{n.graphQLErrors?(this.toast.error(n.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})):(this.toast.error(n.Message),this.formService.setErrors(n.Data))}))))),this.deleteClinicalProviderLocationAvailabilityEffect=this.effect(A=>A.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([c,d])=>(console.log(d),this.data.userDeleteClinicalProviderLocationAvailability({clinicalProviderLocationAvailabilityId:d.id}).pipe((0,g._b)(n=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:n.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},n=>{n.graphQLErrors?(this.toast.error(n.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})):(this.toast.error(n.Message),this.formService.setErrors(n.Data))})))))),this.deleteClinicalProviderLocationAvailabilityInScheduleTimeEffect=this.effect(A=>A.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([c,d])=>(console.log(d),this.data.userDeleteClinicalProviderLocationAvailability({clinicalProviderLocationAvailabilityId:d.id}).pipe((0,g._b)(n=>{this.deleteClinicalProviderLocationAvailability(n.data.deleted),this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:n.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},n=>{n.graphQLErrors?(this.toast.error(n.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})):(this.toast.error(n.Message),this.formService.setErrors(n.Data))})))))),this.importExcelEffect=this.effect(A=>A.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(c=>this.clinicalProviderLocationAvailabilityService.importClinicalProviderLocationAvailabilities(c).pipe((0,ce.K)(d=>{var n;return this.toast.error(null!==(n=d.Message)&&void 0!==n?n:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(d=>{const n=JSON.parse(d.created),r=JSON.parse(d.updated),m=JSON.parse(d.failed),p=n.length+r.length+m.length;this.addClinicalProviderLocationAvailabilities(n),this.updateClinicalProviderLocationAvailabilities(r),this.toast.success(`${n.length} created, ${r.length} updated, ${m.length} failed of total ${p}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("clinicalProviderLocationAvailabilityId")?this.setFormName("clinicalProviderLocationAvailability_edit"):this.setFormName("clinicalProviderLocationAvailability_create"),this.route.snapshot.paramMap.has("clinicalProviderLocationId")){const A=this.route.snapshot.paramMap.get("clinicalProviderLocationId");this.setClinicalProviderLocationId(A)}}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.clinicalProviderLocationAvailabilityService.validateClinicalProviderLocationAvailabilityExcelData(t,i.clinicalProviderLocations)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(Dw))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function Mw(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.clinicalProviderLocationAvailability)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let En=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"clinicalProviderLocationAvailability_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.clinicalProviderLocationAvailability=i.item})):t.formName&&t.formName.currentValue&&"clinicalProviderLocationAvailability_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadClinicalProviderLocationAvailabilityEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.clinicalProviderLocationAvailability=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Xs),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-clinical-provider-location-availability-form"]],inputs:{clinicalProviderLocationAvailability:"clinicalProviderLocationAvailability",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,Mw,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),On=(()=>{class s{constructor(){this.autoHeight=!1,this.clinicalProviderLocationAvailabilities=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[{field:"clinicalProviderLocation.name",headerName:"Clinical Provider Location",filter:"agTextColumnFilter"},{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{field:"day",filter:"agTextColumnFilter"},{field:"startTime",filter:"agTextColumnFilter"},{field:"endTime",filter:"agTextColumnFilter"},{field:"clinicalProviderLocationId",filter:"agTextColumnFilter",hide:!0}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-clinical-provider-location-availability-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",clinicalProviderLocationAvailabilities:"clinicalProviderLocationAvailabilities"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.clinicalProviderLocationAvailabilities)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function Ww(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-clinical-provider-location-availability-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","clinicalProviderLocationAvailability_edit")("formControl",t.formControl)("clinicalProviderLocationAvailability",t.clinicalProviderLocationAvailability)}}const Ew=function(){return{}};function Ow(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-clinical-provider-location-availability-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","clinicalProviderLocationAvailability_create")("formControl",t.formControl)("clinicalProviderLocationAvailability",e.DdM(3,Ew))}}function Lw(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-clinical-provider-location-availability-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("clinicalProviderLocationAvailabilities",o.data.items)}let $w=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadClinicalProviderLocationAvailabilitiesEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.clinicalProviderLocationAvailabilities$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Xs))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","clinicalProviderLocationAvailability","send","close"],[1,"w-full","h-full","bg-white",3,"clinicalProviderLocationAvailabilities","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,Ww,2,3,"ng-template",null,1,e.W1O),e.YNc(3,Ow,1,4,"ng-template",null,2,e.W1O),e.YNc(5,Lw,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,En,On],encapsulation:2}),s})();function Gw(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-clinical-provider-location-availability-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","clinicalProviderLocationAvailability_edit")("clinicalProviderLocationAvailability",t.value)}}const Rw=function(){return{}};function Qw(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-clinical-provider-location-availability-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","clinicalProviderLocationAvailability_create")("clinicalProviderLocationAvailability",e.DdM(2,Rw))}function Vw(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-clinical-provider-location-availability-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("clinicalProviderLocationAvailabilities",t.items)}}let jw=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","clinicalProviderLocationAvailability","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","clinicalProviderLocationAvailabilities","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,Gw,1,2,"ng-template",null,1,e.W1O),e.YNc(3,Qw,1,3,"ng-template",null,2,e.W1O),e.YNc(5,Vw,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,En,On],encapsulation:2}),s})(),Uw=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[Xs],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"clinical-provider-location-availability-select",component:$w,wrappers:["form-field"]},{name:"clinical-provider-location-availability-grid",component:jw}]})]}),s})(),Jw=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[Uw]}),s})();var eo=Q(30760);function zw(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.clinicalProviderLocation)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let Ln=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"clinicalProviderLocation_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({id:null,name:""}),this.store.vm$.subscribe(i=>{this.clinicalProviderLocation=i.item})):t.formName&&t.formName.currentValue&&"clinicalProviderLocation_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadClinicalProviderLocationEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.clinicalProviderLocation=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(eo.j),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-clinical-provider-location-form"]],inputs:{clinicalProviderLocation:"clinicalProviderLocation",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,zw,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),$n=(()=>{class s{constructor(){this.autoHeight=!1,this.clinicalProviderLocations=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[{field:"clinicalProvider.name",headerName:"Clinical Provider",filter:"agTextColumnFilter"},{field:"location.name",headerName:"Location",filter:"agTextColumnFilter"},{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{field:"clinicalProviderId",filter:"agTextColumnFilter",hide:!0},{field:"locationId",filter:"agTextColumnFilter",hide:!0}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-clinical-provider-location-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",clinicalProviderLocations:"clinicalProviderLocations"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.clinicalProviderLocations)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function Hw(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-clinical-provider-location-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","clinicalProviderLocation_edit")("formControl",t.formControl)("clinicalProviderLocation",t.clinicalProviderLocation)}}const qw=function(){return{}};function Kw(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-clinical-provider-location-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","clinicalProviderLocation_create")("formControl",t.formControl)("clinicalProviderLocation",e.DdM(3,qw))}}function Zw(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-clinical-provider-location-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("clinicalProviderLocations",o.data.items)}let kw=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadClinicalProviderLocationsEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.clinicalProviderLocations$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(eo.j))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","clinicalProviderLocation","send","close"],[1,"w-full","h-full","bg-white",3,"clinicalProviderLocations","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,Hw,2,3,"ng-template",null,1,e.W1O),e.YNc(3,Kw,1,4,"ng-template",null,2,e.W1O),e.YNc(5,Zw,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,Ln,$n],encapsulation:2}),s})();function Bw(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-clinical-provider-location-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","clinicalProviderLocation_edit")("clinicalProviderLocation",t.value)}}const Yw=function(){return{}};function Xw(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-clinical-provider-location-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","clinicalProviderLocation_create")("clinicalProviderLocation",e.DdM(2,Yw))}function ex(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-clinical-provider-location-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("clinicalProviderLocations",t.items)}}let tx=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","clinicalProviderLocation","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","clinicalProviderLocations","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,Bw,1,2,"ng-template",null,1,e.W1O),e.YNc(3,Xw,1,3,"ng-template",null,2,e.W1O),e.YNc(5,ex,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,Ln,$n],encapsulation:2}),s})(),ix=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[eo.j],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"clinical-provider-location-select",component:kw,wrappers:["form-field"]},{name:"clinical-provider-location-grid",component:tx}]})]}),s})(),sx=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[ix]}),s})();var to=Q(94929);function ox(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.clinicalProvider)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let Gn=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"clinicalProvider_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.clinicalProvider=i.item})):t.formName&&t.formName.currentValue&&"clinicalProvider_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadClinicalProviderEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.clinicalProvider=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(to.D),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-clinical-provider-form"]],inputs:{clinicalProvider:"clinicalProvider",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,ox,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),Rn=(()=>{class s{constructor(){this.autoHeight=!1,this.clinicalProviders=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[{field:"vendor.name",headerName:"Vendor",filter:"agTextColumnFilter"},{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{field:"vendorId",filter:"agTextColumnFilter",hide:!0},{field:"expertId",filter:"agTextColumnFilter",hide:!0},{field:"npi",filter:"agTextColumnFilter"},{field:"honorific",filter:"agTextColumnFilter"},{field:"firstName",filter:"agTextColumnFilter"},{field:"lastName",filter:"agTextColumnFilter"},{field:"suffix",filter:"agTextColumnFilter"},{field:"phoneNumber",filter:"agTextColumnFilter"},{field:"emailAddress",filter:"agTextColumnFilter"},{field:"profilePictureId",filter:"agTextColumnFilter",hide:!0},{field:"compressProfilePictureId",filter:"agTextColumnFilter",hide:!0}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-clinical-provider-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",clinicalProviders:"clinicalProviders"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.clinicalProviders)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function ax(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-clinical-provider-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","clinicalProvider_edit")("formControl",t.formControl)("clinicalProvider",t.clinicalProvider)}}const rx=function(){return{}};function nx(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-clinical-provider-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","clinicalProvider_create")("formControl",t.formControl)("clinicalProvider",e.DdM(3,rx))}}function lx(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-clinical-provider-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("clinicalProviders",o.data.items)}let cx=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadClinicalProvidersEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.clinicalProviders$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(to.D))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","clinicalProvider","send","close"],[1,"w-full","h-full","bg-white",3,"clinicalProviders","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,ax,2,3,"ng-template",null,1,e.W1O),e.YNc(3,nx,1,4,"ng-template",null,2,e.W1O),e.YNc(5,lx,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,Gn,Rn],encapsulation:2}),s})();function dx(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-clinical-provider-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","clinicalProvider_edit")("clinicalProvider",t.value)}}const ux=function(){return{}};function mx(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-clinical-provider-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","clinicalProvider_create")("clinicalProvider",e.DdM(2,ux))}function px(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-clinical-provider-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("clinicalProviders",t.items)}}let hx=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","clinicalProvider","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","clinicalProviders","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,dx,1,2,"ng-template",null,1,e.W1O),e.YNc(3,mx,1,3,"ng-template",null,2,e.W1O),e.YNc(5,px,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,Gn,Rn],encapsulation:2}),s})(),fx=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[to.D],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"clinical-provider-select",component:cx,wrappers:["form-field"]},{name:"clinical-provider-grid",component:hx}]})]}),s})(),_x=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[fx]}),s})();class Lt extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class gx extends Lt{constructor(o,t,i){super("ValidateClinicalProviderSpecialtyExcelDataAction"),this.valid=!1,this.excelData=o,this.clinicalProviders=t,this.specialties=i}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name),this.validationContext.addRule(new f.mi(`clinicalProviderName_${i}_is_valid}`,"Clinical Provider Is Not Valid","clinicalProvider.name",t.clinicalProvider,this.clinicalProviders,!0)).addRule(new f.mi(`specialtyName_${i}_is_valid}`,"Specialty Is Not Valid","specialty.name",t.specialty,this.specialties,!0))}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class Cx extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class vx extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new Cx("name","The clinicalproviderspecialty name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class Sx extends Lt{constructor(o){super("CreateClinicalProviderSpecialtyAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new vx("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateClinicalProviderSpecialty({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class bx extends Lt{constructor(o){super("UpdateClinicalProviderSpecialtiesAction"),this.clinicalProviderSpecialties=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.clinicalProviderSpecialties,!0))}performAction(){this.response=this.businessProvider.data.userUpdateClinicalProviderSpecialties({input:{clinicalProviderSpecialties:this.clinicalProviderSpecialties}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class Tx extends Lt{constructor(o,t){super("UpdateClinicalProviderSpecialtyAction"),this.clinicalProviderSpecialty=o,this.clinicalProviderSpecialtyId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.clinicalProviderSpecialty,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.clinicalProviderSpecialtyId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateClinicalProviderSpecialty({clinicalProviderSpecialtyId:this.clinicalProviderSpecialtyId,input:this.clinicalProviderSpecialty}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let Qn=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.ClinicalProviderSpecialtyBusinessProviderService",t,a),this.data=i}createClinicalProviderSpecialty(t){const i=new Sx(t);return i.Do(this),i.response}updateClinicalProviderSpecialty(t,i){const a=new Tx(t,i);return a.Do(this),a.response}importClinicalProviderSpecialties(t){const i=new bx(t);return i.Do(this),i.response}validateClinicalProviderSpecialtyExcelData(t,i,a){const l=new gx(t,i,a);return l.Do(this),l.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),yx=(()=>{class s extends I.nH{constructor(t,i,a){super("ClinicalProviderSpecialtyService",a,t),this.businessProvider=i}createClinicalProviderSpecialty(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createClinicalProviderSpecialty(i)}updateClinicalProviderSpecialty(t,i){return this.businessProvider.updateClinicalProviderSpecialty(t,i)}importClinicalProviderSpecialties(t){return this.businessProvider.importClinicalProviderSpecialties(t)}validateClinicalProviderSpecialtyExcelData(t,i,a){return this.businessProvider.validateClinicalProviderSpecialtyExcelData(t,i,a)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(Qn,8),e.LFG(Qn),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),$t=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){if(super({loading:!1,clinicalProviderSpecialties:[],done:!1,searchQuery:"",formName:void 0,clinicalProviderId:void 0,specialtyId:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.clinicalProviderSpecialtyService=H,this.errors$=this.select(n=>n.errors),this.loading$=this.select(n=>n.loading),this.done$=this.select(n=>n.done),this.item$=this.select(n=>n.item),this.clinicalProviderSpecialties$=this.select(n=>n.clinicalProviderSpecialties),this.clinicalProviders$=this.select(n=>n.clinicalProviders||[]),this.specialties$=this.select(n=>n.specialties||[]),this.clinicalProviderId$=this.select(n=>n.clinicalProviderId),this.specialtyId$=this.select(n=>n.specialtyId),this.paging$=this.select(n=>n.paging),this.searchQuery$=this.select(n=>n.searchQuery),this.formName$=this.select(n=>n.formName),this.actionResult$=this.select(this.item$,this.done$,(n,r)=>({item:n,done:r}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.clinicalProviderSpecialties$,this.clinicalProviders$,this.specialties$,(n,r,m,p,_,w,J)=>({errors:n,loading:r,item:m,formName:p,clinicalProviderSpecialties:_,clinicalProviders:w,specialties:J}),{debounce:!0}),this.input$=this.select(this.paging$,this.clinicalProviderId$,this.specialtyId$,this.searchQuery$,(n,r,m,p)=>({limit:n.limit,skip:n.skip,name:p,clinicalProviderId:r,specialtyId:m,total:n.total})),this.setFormName=this.updater((n,r)=>Object.assign(Object.assign({},n),{formName:r})),this.setClinicalProviderId=this.updater((n,r)=>Object.assign(Object.assign({},n),{clinicalProviderId:r})),this.setSpecialtyId=this.updater((n,r)=>Object.assign(Object.assign({},n),{specialtyId:r})),this.filterClinicalProviders=n=>this.data.userSelectClinicalProviders({input:{name:n}}).pipe((0,g._b)(r=>{let m=r.data.items;return this.patchState({clinicalProviders:m}),m},r=>this.patchState({errors:r.graphQLErrors?r.graphQLErrors:r})),(0,he.U)(r=>r.data.items)),this.filterSpecialties=n=>this.data.userSelectSpecialties({input:{name:n}}).pipe((0,g._b)(r=>{let m=r.data.items;return this.patchState({specialties:m}),m},r=>this.patchState({errors:r.graphQLErrors?r.graphQLErrors:r})),(0,he.U)(r=>r.data.items)),this.addClinicalProvider=this.updater((n,r)=>Object.assign(Object.assign({},n),{clinicalProviders:n.clinicalProviders.concat(r)})),this.addSpecialty=this.updater((n,r)=>Object.assign(Object.assign({},n),{specialties:n.specialties.concat(r)})),this.setItem=this.updater((n,r)=>Object.assign(Object.assign({},n),{item:r})),this.addNewClinicalProviderSpecialty=this.updater((n,r)=>Object.assign(Object.assign({},n),{clinicalProviderSpecialties:[...n.clinicalProviderSpecialties,r]})),this.updateClinicalProviderSpecialty=this.updater((n,r)=>Object.assign(Object.assign({},n),{clinicalProviderSpecialties:n.clinicalProviderSpecialties.map(m=>m.id===r.id?r:m)})),this.addClinicalProviderSpecialties=this.updater((n,r)=>Object.assign(Object.assign({},n),{clinicalProviderSpecialties:n.clinicalProviderSpecialties.concat(r)})),this.updateClinicalProviderSpecialties=this.updater((n,r)=>Object.assign(Object.assign({},n),{clinicalProviderSpecialties:n.clinicalProviderSpecialties.map(m=>r.find(_=>_.id===m.id)||m)})),this.setSearchQuery=this.updater((n,r)=>Object.assign(Object.assign({},n),{searchQuery:r})),this.loadClinicalProviderSpecialtyEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(r=>this.data.userClinicalProviderSpecialty({clinicalProviderSpecialtyId:r}).pipe((0,g._b)(m=>{this.patchState({item:m.data.item,errors:m.errors,loading:!1})},m=>this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})))))),this.loadClinicalProviderSpecialtiesEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([r,m])=>this.data.userClinicalProviderSpecialties({input:m}).pipe((0,g._b)(p=>this.patchState({paging:{limit:m.limit,skip:m.skip,total:p.data.count.total},clinicalProviderSpecialties:p.data.items,errors:p.errors,loading:!1}),p=>this.patchState({loading:!1,errors:p.graphQLErrors?p.graphQLErrors:p})))))),this.createClinicalProviderSpecialtyEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(r=>this.clinicalProviderSpecialtyService.createClinicalProviderSpecialty(Object.assign({},r)).pipe((0,g._b)(m=>{this.addNewClinicalProviderSpecialty(m),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:m,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},m=>{m.graphQLErrors?(this.toast.error(m.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})):(this.toast.error(m.Message),this.formService.setErrors(m.Data))}))))),this.updateClinicalProviderSpecialtyEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([r,m])=>this.clinicalProviderSpecialtyService.updateClinicalProviderSpecialty(r,r.id).pipe((0,g._b)(p=>{this.updateClinicalProviderSpecialty(p),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:p,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},p=>{p.graphQLErrors?(this.toast.error(p.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:p.graphQLErrors?p.graphQLErrors:p})):(this.toast.error(p.Message),this.formService.setErrors(p.Data))}))))),this.deleteClinicalProviderSpecialtyEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([r,m])=>this.data.userDeleteClinicalProviderSpecialty({clinicalProviderSpecialtyId:m.id}).pipe((0,g._b)(p=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:p.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},p=>{p.graphQLErrors?(this.toast.error(p.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:p.graphQLErrors?p.graphQLErrors:p})):(this.toast.error(p.Message),this.formService.setErrors(p.Data))}))))),this.importExcelEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(r=>this.clinicalProviderSpecialtyService.importClinicalProviderSpecialties(r).pipe((0,ce.K)(m=>{var p;return this.toast.error(null!==(p=m.Message)&&void 0!==p?p:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(m=>{const p=JSON.parse(m.created),_=JSON.parse(m.updated),w=JSON.parse(m.failed),J=p.length+_.length+w.length;this.addClinicalProviderSpecialties(p),this.updateClinicalProviderSpecialties(_),this.toast.success(`${p.length} created, ${_.length} updated, ${w.length} failed of total ${J}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("clinicalProviderSpecialtyId")?(this.route.snapshot.paramMap.get("clinicalProviderSpecialtyId"),this.setFormName("clinicalProviderSpecialty_edit")):this.setFormName("clinicalProviderSpecialty_create"),this.route.snapshot.paramMap.has("clinicalProviderId")){var c=this.route.snapshot.paramMap.get("clinicalProviderId");this.setClinicalProviderId(c)}if(this.route.snapshot.paramMap.has("specialtyId")){var d=this.route.snapshot.paramMap.get("specialtyId");this.setSpecialtyId(d)}}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.clinicalProviderSpecialtyService.validateClinicalProviderSpecialtyExcelData(t,i.clinicalProviders,i.specialties)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(yx))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function wx(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.clinicalProviderSpecialty)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let Vn=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"clinicalProviderSpecialty_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({id:null,name:""}),this.store.vm$.subscribe(i=>{this.clinicalProviderSpecialty=i.item})):t.formName&&t.formName.currentValue&&"clinicalProviderSpecialty_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadClinicalProviderSpecialtyEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.clinicalProviderSpecialty=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36($t),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-clinical-provider-specialty-form"]],inputs:{clinicalProviderSpecialty:"clinicalProviderSpecialty",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,wx,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),jn=(()=>{class s{constructor(){this.autoHeight=!1,this.clinicalProviderSpecialties=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[{field:"clinicalProvider.name",headerName:"Clinical Provider",filter:"agTextColumnFilter"},{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{field:"npi",filter:"agTextColumnFilter"},{field:"clinicalProviderId",filter:"agTextColumnFilter",hide:!0},{field:"clinicalProvider.name",header:"ClinicalProvider",filter:"agTextColumnFilter",hide:!0},{field:"specialtyId",filter:"agTextColumnFilter",hide:!0},{field:"specialty.name",header:"Specialty",filter:"agTextColumnFilter"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-clinical-provider-specialty-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",clinicalProviderSpecialties:"clinicalProviderSpecialties"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","data","showSidebar","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("data",i.clinicalProviderSpecialties)("showSidebar",!1)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function xx(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-clinical-provider-specialty-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","clinicalProviderSpecialty_edit")("formControl",t.formControl)("clinicalProviderSpecialty",t.clinicalProviderSpecialty)}}const Nx=function(){return{}};function Ax(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-clinical-provider-specialty-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","clinicalProviderSpecialty_create")("formControl",t.formControl)("clinicalProviderSpecialty",e.DdM(3,Nx))}}function Fx(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-clinical-provider-specialty-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("clinicalProviderSpecialties",o.data.items)}let Px=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadClinicalProviderSpecialtiesEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.clinicalProviderSpecialties$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36($t))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e._Bn([$t]),e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","clinicalProviderSpecialty","send","close"],[1,"w-full","h-full","bg-white",3,"clinicalProviderSpecialties","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,xx,2,3,"ng-template",null,1,e.W1O),e.YNc(3,Ax,1,4,"ng-template",null,2,e.W1O),e.YNc(5,Fx,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,Vn,jn],encapsulation:2}),s})();function Ix(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-clinical-provider-specialty-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","clinicalProviderSpecialty_edit")("clinicalProviderSpecialty",t.value)}}const Dx=function(){return{}};function Mx(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-clinical-provider-specialty-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","clinicalProviderSpecialty_create")("clinicalProviderSpecialty",e.DdM(2,Dx))}function Wx(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-clinical-provider-specialty-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("clinicalProviderSpecialties",t.items)}}let Ex=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","clinicalProviderSpecialty","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","clinicalProviderSpecialties","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,Ix,1,2,"ng-template",null,1,e.W1O),e.YNc(3,Mx,1,3,"ng-template",null,2,e.W1O),e.YNc(5,Wx,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,Vn,jn],encapsulation:2}),s})(),Ox=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[$t],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"clinical-provider-specialty-select",component:Px,wrappers:["form-field"]},{name:"clinical-provider-specialty-grid",component:Ex}]})]}),s})(),Lx=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[Ox]}),s})();class Gt extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class $x extends Gt{constructor(o,t,i){super("ValidateClinicalProviderTagExcelDataAction"),this.valid=!1,this.excelData=o,this.clinicalProviders=t,this.tags=i}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name),this.validationContext.addRule(new f.mi(`clinicalProviderName_${i}_is_valid}`,"Clinical Provider Is Not Valid","clinicalProvider.name",t.clinicalProvider,this.clinicalProviders,!0)),this.validationContext.addRule(new f.mi(`tagName_${i}_is_valid}`,"Tag Is Not Valid","tag.name",t.tag,this.tags,!0))}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class Gx extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class Rx extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new Gx("name","The clinicalprovidertag name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class Qx extends Gt{constructor(o){super("CreateClinicalProviderTagAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new Rx("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateClinicalProviderTag({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class Vx extends Gt{constructor(o){super("UpdateClinicalProviderTagsAction"),this.clinicalProviderTags=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.clinicalProviderTags,!0))}performAction(){this.response=this.businessProvider.data.userUpdateClinicalProviderTags({input:{clinicalProviderTags:this.clinicalProviderTags}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class jx extends Gt{constructor(o,t){super("UpdateClinicalProviderTagAction"),this.clinicalProviderTag=o,this.clinicalProviderTagId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.clinicalProviderTag,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.clinicalProviderTagId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateClinicalProviderTag({clinicalProviderTagId:this.clinicalProviderTagId,input:this.clinicalProviderTag}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let Un=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.ClinicalProviderTagBusinessProviderService",t,a),this.data=i}createClinicalProviderTag(t){const i=new Qx(t);return i.Do(this),i.response}updateClinicalProviderTag(t,i){const a=new jx(t,i);return a.Do(this),a.response}importClinicalProviderTags(t){const i=new Vx(t);return i.Do(this),i.response}validateClinicalProviderTagExcelData(t,i,a){const l=new $x(t,i,a);return l.Do(this),l.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),Ux=(()=>{class s extends I.nH{constructor(t,i,a){super("ClinicalProviderTagService",a,t),this.businessProvider=i}createClinicalProviderTag(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createClinicalProviderTag(i)}updateClinicalProviderTag(t,i){return this.businessProvider.updateClinicalProviderTag(t,i)}importClinicalProviderTags(t){return this.businessProvider.importClinicalProviderTags(t)}validateClinicalProviderTagExcelData(t,i,a){return this.businessProvider.validateClinicalProviderTagExcelData(t,i,a)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(Un,8),e.LFG(Un),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),io=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){if(super({loading:!1,clinicalProviderTags:[],done:!1,searchQuery:"",formName:void 0,clinicalProviderId:void 0,tagId:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.clinicalProviderTagService=H,this.errors$=this.select(n=>n.errors),this.loading$=this.select(n=>n.loading),this.done$=this.select(n=>n.done),this.item$=this.select(n=>n.item),this.clinicalProviderTags$=this.select(n=>n.clinicalProviderTags),this.clinicalProviders$=this.select(n=>n.clinicalProviders||[]),this.tags$=this.select(n=>n.tags||[]),this.clinicalProviderId$=this.select(n=>n.clinicalProviderId),this.tagId$=this.select(n=>n.tagId),this.paging$=this.select(n=>n.paging),this.searchQuery$=this.select(n=>n.searchQuery),this.formName$=this.select(n=>n.formName),this.actionResult$=this.select(this.item$,this.done$,(n,r)=>({item:n,done:r}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.clinicalProviderTags$,this.clinicalProviders$,this.tags$,(n,r,m,p,_,w,J)=>({errors:n,loading:r,item:m,formName:p,clinicalProviderTags:_,clinicalProviders:w,tags:J}),{debounce:!0}),this.input$=this.select(this.paging$,this.clinicalProviderId$,this.tagId$,this.searchQuery$,(n,r,m,p)=>({limit:n.limit,skip:n.skip,name:p,clinicalProviderId:r,tagId:m,total:n.total})),this.setFormName=this.updater((n,r)=>Object.assign(Object.assign({},n),{formName:r})),this.setClinicalProviderId=this.updater((n,r)=>Object.assign(Object.assign({},n),{clinicalProviderId:r})),this.setTagId=this.updater((n,r)=>Object.assign(Object.assign({},n),{tagId:r})),this.filterClinicalProviders=n=>this.data.userSelectClinicalProviders({input:{name:n}}).pipe((0,g._b)(r=>{let m=r.data.items;return this.patchState({clinicalProviders:m}),m},r=>this.patchState({errors:r.graphQLErrors?r.graphQLErrors:r})),(0,he.U)(r=>r.data.items)),this.filterTags=n=>this.data.userSelectTags({input:{name:n}}).pipe((0,g._b)(r=>{let m=r.data.items;return this.patchState({tags:m}),m},r=>this.patchState({errors:r.graphQLErrors?r.graphQLErrors:r})),(0,he.U)(r=>r.data.items)),this.addClinicalProvider=this.updater((n,r)=>Object.assign(Object.assign({},n),{clinicalProviders:n.clinicalProviders.concat(r)})),this.addTag=this.updater((n,r)=>Object.assign(Object.assign({},n),{tags:n.tags.concat(r)})),this.setItem=this.updater((n,r)=>Object.assign(Object.assign({},n),{item:r})),this.addNewClinicalProviderTag=this.updater((n,r)=>Object.assign(Object.assign({},n),{clinicalProviderTags:[...n.clinicalProviderTags,r]})),this.updateClinicalProviderTag=this.updater((n,r)=>Object.assign(Object.assign({},n),{clinicalProviderTags:n.clinicalProviderTags.map(m=>m.id===r.id?r:m)})),this.addClinicalProviderTags=this.updater((n,r)=>Object.assign(Object.assign({},n),{clinicalProviderTags:n.clinicalProviderTags.concat(r)})),this.updateClinicalProviderTags=this.updater((n,r)=>Object.assign(Object.assign({},n),{clinicalProviderTags:n.clinicalProviderTags.map(m=>r.find(_=>_.id===m.id)||m)})),this.setSearchQuery=this.updater((n,r)=>Object.assign(Object.assign({},n),{searchQuery:r})),this.loadClinicalProviderTagEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(r=>this.data.userClinicalProviderTag({clinicalProviderTagId:r}).pipe((0,g._b)(m=>{this.patchState({item:m.data.item,errors:m.errors,loading:!1})},m=>this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})))))),this.loadClinicalProviderTagsEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([r,m])=>this.data.userClinicalProviderTags({input:m}).pipe((0,g._b)(p=>this.patchState({paging:{limit:m.limit,skip:m.skip,total:p.data.count.total},clinicalProviderTags:p.data.items,errors:p.errors,loading:!1}),p=>this.patchState({loading:!1,errors:p.graphQLErrors?p.graphQLErrors:p})))))),this.createClinicalProviderTagEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(r=>this.clinicalProviderTagService.createClinicalProviderTag(Object.assign({},r)).pipe((0,g._b)(m=>{this.addNewClinicalProviderTag(m),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:m,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},m=>{m.graphQLErrors?(this.toast.error(m.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})):(this.toast.error(m.Message),this.formService.setErrors(m.Data))}))))),this.updateClinicalProviderTagEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([r,m])=>this.clinicalProviderTagService.updateClinicalProviderTag(r,r.id).pipe((0,g._b)(p=>{this.updateClinicalProviderTag(p),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:p,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},p=>{p.graphQLErrors?(this.toast.error(p.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:p.graphQLErrors?p.graphQLErrors:p})):(this.toast.error(p.Message),this.formService.setErrors(p.Data))}))))),this.deleteClinicalProviderTagEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([r,m])=>this.data.userDeleteClinicalProviderTag({clinicalProviderTagId:m.id}).pipe((0,g._b)(p=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:p.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},p=>{p.graphQLErrors?(this.toast.error(p.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:p.graphQLErrors?p.graphQLErrors:p})):(this.toast.error(p.Message),this.formService.setErrors(p.Data))}))))),this.importExcelEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(r=>this.clinicalProviderTagService.importClinicalProviderTags(r).pipe((0,ce.K)(m=>{var p;return this.toast.error(null!==(p=m.Message)&&void 0!==p?p:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(m=>{const p=JSON.parse(m.created),_=JSON.parse(m.updated),w=JSON.parse(m.failed),J=p.length+_.length+w.length;this.addClinicalProviderTags(p),this.updateClinicalProviderTags(_),this.toast.success(`${p.length} created, ${_.length} updated, ${w.length} failed of total ${J}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("clinicalProviderTagId")?(this.route.snapshot.paramMap.get("clinicalProviderTagId"),this.setFormName("clinicalProviderTag_edit")):this.setFormName("clinicalProviderTag_create"),this.route.snapshot.paramMap.has("clinicalProviderId")){var c=this.route.snapshot.paramMap.get("clinicalProviderId");this.setClinicalProviderId(c)}if(this.route.snapshot.paramMap.has("tagId")){var d=this.route.snapshot.paramMap.get("tagId");this.setTagId(d)}}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.clinicalProviderTagService.validateClinicalProviderTagExcelData(t,i.clinicalProviders,i.tags)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(Ux))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function Jx(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.clinicalProviderTag)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let Jn=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"clinicalProviderTag_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.clinicalProviderTag=i.item})):t.formName&&t.formName.currentValue&&"clinicalProviderTag_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadClinicalProviderTagEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.clinicalProviderTag=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(io),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-clinical-provider-tag-form"]],inputs:{clinicalProviderTag:"clinicalProviderTag",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,Jx,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),zn=(()=>{class s{constructor(){this.autoHeight=!1,this.clinicalProviderTags=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[{field:"clinicalProvider.name",headerName:"Clinical Provider",filter:"agTextColumnFilter"},{field:"tag.name",headerName:"Tag",filter:"agTextColumnFilter"},{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{field:"clinicalProviderId",filter:"agTextColumnFilter",hide:!0},{field:"tagId",filter:"agTextColumnFilter",hide:!0}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-clinical-provider-tag-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",clinicalProviderTags:"clinicalProviderTags"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.clinicalProviderTags)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function zx(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-clinical-provider-tag-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","clinicalProviderTag_edit")("formControl",t.formControl)("clinicalProviderTag",t.clinicalProviderTag)}}const Hx=function(){return{}};function qx(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-clinical-provider-tag-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","clinicalProviderTag_create")("formControl",t.formControl)("clinicalProviderTag",e.DdM(3,Hx))}}function Kx(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-clinical-provider-tag-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("clinicalProviderTags",o.data.items)}let Zx=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadClinicalProviderTagsEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.clinicalProviderTags$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(io))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","clinicalProviderTag","send","close"],[1,"w-full","h-full","bg-white",3,"clinicalProviderTags","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,zx,2,3,"ng-template",null,1,e.W1O),e.YNc(3,qx,1,4,"ng-template",null,2,e.W1O),e.YNc(5,Kx,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,Jn,zn],encapsulation:2}),s})();function kx(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-clinical-provider-tag-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","clinicalProviderTag_edit")("clinicalProviderTag",t.value)}}const Bx=function(){return{}};function Yx(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-clinical-provider-tag-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","clinicalProviderTag_create")("clinicalProviderTag",e.DdM(2,Bx))}function Xx(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-clinical-provider-tag-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("clinicalProviderTags",t.items)}}let eN=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","clinicalProviderTag","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","clinicalProviderTags","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,kx,1,2,"ng-template",null,1,e.W1O),e.YNc(3,Yx,1,3,"ng-template",null,2,e.W1O),e.YNc(5,Xx,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,Jn,zn],encapsulation:2}),s})(),tN=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[io],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"clinical-provider-tag-select",component:Zx,wrappers:["form-field"]},{name:"clinical-provider-tag-grid",component:eN}]})]}),s})(),iN=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[tN]}),s})();class Rt extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class sN extends Rt{constructor(o,t){super("ValidateContactEmailExcelDataAction"),this.valid=!1,this.excelData=o,this.contacts=t}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name),this.validationContext.addRule(new f.mi(`contactName_${i}_is_valid}`,"Contact Is Not Valid","contact.name",t.contact,this.contacts,!0))}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class oN extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class aN extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new oN("name","The contactemail name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class rN extends Rt{constructor(o){super("CreateContactEmailAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new aN("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateContactEmail({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class nN extends Rt{constructor(o){super("UpdateContactEmailsAction"),this.contactEmails=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.contactEmails,!0))}performAction(){this.response=this.businessProvider.data.userUpdateContactEmails({input:{contactEmails:this.contactEmails}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class lN extends Rt{constructor(o,t){super("UpdateContactEmailAction"),this.contactEmail=o,this.contactEmailId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.contactEmail,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.contactEmailId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateContactEmail({contactEmailId:this.contactEmailId,input:this.contactEmail}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let Hn=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.ContactEmailBusinessProviderService",t,a),this.data=i}createContactEmail(t){const i=new rN(t);return i.Do(this),i.response}updateContactEmail(t,i){const a=new lN(t,i);return a.Do(this),a.response}importContactEmails(t){const i=new nN(t);return i.Do(this),i.response}validateContactEmailExcelData(t,i){const a=new sN(t,i);return a.Do(this),a.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),cN=(()=>{class s extends I.nH{constructor(t,i,a){super("ContactEmailService",a,t),this.businessProvider=i}createContactEmail(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createContactEmail(i)}updateContactEmail(t,i){return this.businessProvider.updateContactEmail(t,i)}importContactEmails(t){return this.businessProvider.importContactEmails(t)}validateContactEmailExcelData(t,i){return this.businessProvider.validateContactEmailExcelData(t,i)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(Hn,8),e.LFG(Hn),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),so=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){if(super({loading:!1,contactEmails:[],done:!1,searchQuery:"",formName:void 0,contactId:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.contactEmailService=H,this.errors$=this.select(d=>d.errors),this.loading$=this.select(d=>d.loading),this.done$=this.select(d=>d.done),this.item$=this.select(d=>d.item),this.contactEmails$=this.select(d=>d.contactEmails),this.contacts$=this.select(d=>d.contacts||[]),this.contactId$=this.select(d=>d.contactId),this.paging$=this.select(d=>d.paging),this.searchQuery$=this.select(d=>d.searchQuery),this.formName$=this.select(d=>d.formName),this.actionResult$=this.select(this.item$,this.done$,(d,n)=>({item:d,done:n}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.contactEmails$,this.contacts$,(d,n,r,m,p,_)=>({errors:d,loading:n,item:r,formName:m,contactEmails:p,contacts:_}),{debounce:!0}),this.input$=this.select(this.paging$,this.contactId$,this.searchQuery$,(d,n,r)=>({limit:d.limit,skip:d.skip,name:r,contactId:n,total:d.total})),this.setFormName=this.updater((d,n)=>Object.assign(Object.assign({},d),{formName:n})),this.setContactId=this.updater((d,n)=>Object.assign(Object.assign({},d),{contactId:n})),this.filterContacts=d=>this.data.userSelectContacts({input:{name:d}}).pipe((0,g._b)(n=>{let r=n.data.items;return this.patchState({contacts:r}),r},n=>this.patchState({errors:n.graphQLErrors?n.graphQLErrors:n})),(0,he.U)(n=>n.data.items)),this.addContact=this.updater((d,n)=>Object.assign(Object.assign({},d),{contacts:d.contacts.concat(n)})),this.setItem=this.updater((d,n)=>Object.assign(Object.assign({},d),{item:n})),this.addNewContactEmail=this.updater((d,n)=>Object.assign(Object.assign({},d),{contactEmails:[...d.contactEmails,n]})),this.updateContactEmail=this.updater((d,n)=>Object.assign(Object.assign({},d),{contactEmails:d.contactEmails.map(r=>r.id===n.id?n:r)})),this.addContactEmails=this.updater((d,n)=>Object.assign(Object.assign({},d),{contactEmails:d.contactEmails.concat(n)})),this.updateContactEmails=this.updater((d,n)=>Object.assign(Object.assign({},d),{contactEmails:d.contactEmails.map(r=>n.find(p=>p.id===r.id)||r)})),this.setSearchQuery=this.updater((d,n)=>Object.assign(Object.assign({},d),{searchQuery:n})),this.loadContactEmailEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(n=>this.data.userContactEmail({contactEmailId:n}).pipe((0,g._b)(r=>{this.patchState({item:r.data.item,errors:r.errors,loading:!1})},r=>this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})))))),this.loadContactEmailsEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([n,r])=>this.data.userContactEmails({input:r}).pipe((0,g._b)(m=>this.patchState({paging:{limit:r.limit,skip:r.skip,total:m.data.count.total},contactEmails:m.data.items,errors:m.errors,loading:!1}),m=>this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})))))),this.createContactEmailEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(n=>this.contactEmailService.createContactEmail(Object.assign({},n)).pipe((0,g._b)(r=>{this.addNewContactEmail(r),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:r,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.updateContactEmailEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([n,r])=>this.contactEmailService.updateContactEmail(n,n.id).pipe((0,g._b)(m=>{this.updateContactEmail(m),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:m,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},m=>{m.graphQLErrors?(this.toast.error(m.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})):(this.toast.error(m.Message),this.formService.setErrors(m.Data))}))))),this.deleteContactEmailEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([n,r])=>this.data.userDeleteContactEmail({contactEmailId:r.id}).pipe((0,g._b)(m=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:m.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},m=>{m.graphQLErrors?(this.toast.error(m.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})):(this.toast.error(m.Message),this.formService.setErrors(m.Data))}))))),this.importExcelEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(n=>this.contactEmailService.importContactEmails(n).pipe((0,ce.K)(r=>{var m;return this.toast.error(null!==(m=r.Message)&&void 0!==m?m:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(r=>{const m=JSON.parse(r.created),p=JSON.parse(r.updated),_=JSON.parse(r.failed),w=m.length+p.length+_.length;this.addContactEmails(m),this.updateContactEmails(p),this.toast.success(`${m.length} created, ${p.length} updated, ${_.length} failed of total ${w}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("contactEmailId")?(this.route.snapshot.paramMap.get("contactEmailId"),this.setFormName("contactEmail_edit")):this.setFormName("contactEmail_create"),this.route.snapshot.paramMap.has("contactId")){var c=this.route.snapshot.paramMap.get("contactId");this.setContactId(c)}}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.contactEmailService.validateContactEmailExcelData(t,i.contacts)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(cN))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function dN(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.contactEmail)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let qn=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"contactEmail_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.contactEmail=i.item})):t.formName&&t.formName.currentValue&&"contactEmail_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadContactEmailEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.contactEmail=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(so),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-contact-email-form"]],inputs:{contactEmail:"contactEmail",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,dN,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),Kn=(()=>{class s{constructor(){this.autoHeight=!1,this.contactEmails=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[{field:"contact.name",headerName:"Contact",filter:"agTextColumnFilter"},{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"email",filter:"agTextColumnFilter"},{field:"name",filter:"agTextColumnFilter"},{field:"contactId",filter:"agTextColumnFilter",hide:!0}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-contact-email-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",contactEmails:"contactEmails"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.contactEmails)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function uN(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-contact-email-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","contactEmail_edit")("formControl",t.formControl)("contactEmail",t.contactEmail)}}const mN=function(){return{}};function pN(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-contact-email-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","contactEmail_create")("formControl",t.formControl)("contactEmail",e.DdM(3,mN))}}function hN(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-contact-email-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("contactEmails",o.data.items)}let fN=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadContactEmailsEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.contactEmails$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(so))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","contactEmail","send","close"],[1,"w-full","h-full","bg-white",3,"contactEmails","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,uN,2,3,"ng-template",null,1,e.W1O),e.YNc(3,pN,1,4,"ng-template",null,2,e.W1O),e.YNc(5,hN,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,qn,Kn],encapsulation:2}),s})();function _N(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-contact-email-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","contactEmail_edit")("contactEmail",t.value)}}const gN=function(){return{}};function CN(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-contact-email-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","contactEmail_create")("contactEmail",e.DdM(2,gN))}function vN(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-contact-email-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("contactEmails",t.items)}}let SN=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","contactEmail","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","contactEmails","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,_N,1,2,"ng-template",null,1,e.W1O),e.YNc(3,CN,1,3,"ng-template",null,2,e.W1O),e.YNc(5,vN,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,qn,Kn],encapsulation:2}),s})(),bN=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[so],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"contact-email-select",component:fN,wrappers:["form-field"]},{name:"contact-email-grid",component:SN}]})]}),s})(),TN=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[bN]}),s})();class Qt extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class yN extends Qt{constructor(o){super("ValidateContactKindExcelDataAction"),this.valid=!1,this.excelData=o}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name)}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class wN extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class xN extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new wN("name","The contactkind name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class NN extends Qt{constructor(o){super("CreateContactKindAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new xN("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateContactKind({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class AN extends Qt{constructor(o){super("UpdateContactKindsAction"),this.contactKinds=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.contactKinds,!0))}performAction(){this.response=this.businessProvider.data.userUpdateContactKinds({input:{contactKinds:this.contactKinds}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class FN extends Qt{constructor(o,t){super("UpdateContactKindAction"),this.contactKind=o,this.contactKindId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.contactKind,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.contactKindId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateContactKind({contactKindId:this.contactKindId,input:this.contactKind}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let Zn=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.ContactKindBusinessProviderService",t,a),this.data=i}createContactKind(t){const i=new NN(t);return i.Do(this),i.response}updateContactKind(t,i){const a=new FN(t,i);return a.Do(this),a.response}importContactKinds(t){const i=new AN(t);return i.Do(this),i.response}validateContactKindExcelData(t){const i=new yN(t);return i.Do(this),i.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),PN=(()=>{class s extends I.nH{constructor(t,i,a){super("ContactKindService",a,t),this.businessProvider=i}createContactKind(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createContactKind(i)}updateContactKind(t,i){return this.businessProvider.updateContactKind(t,i)}importContactKinds(t){return this.businessProvider.importContactKinds(t)}validateContactKindExcelData(t){return this.businessProvider.validateContactKindExcelData(t)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(Zn,8),e.LFG(Zn),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),oo=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){super({loading:!1,contactKinds:[],done:!1,searchQuery:"",formName:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.contactKindService=H,this.errors$=this.select(c=>c.errors),this.loading$=this.select(c=>c.loading),this.done$=this.select(c=>c.done),this.item$=this.select(c=>c.item),this.contactKinds$=this.select(c=>c.contactKinds),this.paging$=this.select(c=>c.paging),this.searchQuery$=this.select(c=>c.searchQuery),this.formName$=this.select(c=>c.formName),this.actionResult$=this.select(this.item$,this.done$,(c,d)=>({item:c,done:d}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.contactKinds$,(c,d,n,r,m)=>({errors:c,loading:d,item:n,formName:r,contactKinds:m}),{debounce:!0}),this.input$=this.select(this.paging$,this.searchQuery$,(c,d)=>({limit:c.limit,skip:c.skip,name:d,total:c.total})),this.setFormName=this.updater((c,d)=>Object.assign(Object.assign({},c),{formName:d})),this.setItem=this.updater((c,d)=>Object.assign(Object.assign({},c),{item:d})),this.addNewContactKind=this.updater((c,d)=>Object.assign(Object.assign({},c),{contactKinds:[...c.contactKinds,d]})),this.updateContactKind=this.updater((c,d)=>Object.assign(Object.assign({},c),{contactKinds:c.contactKinds.map(n=>n.id===d.id?d:n)})),this.addContactKinds=this.updater((c,d)=>Object.assign(Object.assign({},c),{contactKinds:c.contactKinds.concat(d)})),this.updateContactKinds=this.updater((c,d)=>Object.assign(Object.assign({},c),{contactKinds:c.contactKinds.map(n=>d.find(m=>m.id===n.id)||n)})),this.setSearchQuery=this.updater((c,d)=>Object.assign(Object.assign({},c),{searchQuery:d})),this.loadContactKindEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.data.userContactKind({contactKindId:d}).pipe((0,g._b)(n=>{this.patchState({item:n.data.item,errors:n.errors,loading:!1})},n=>this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})))))),this.loadContactKindsEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([d,n])=>this.data.userContactKinds({input:n}).pipe((0,g._b)(r=>this.patchState({paging:{limit:n.limit,skip:n.skip,total:r.data.count.total},contactKinds:r.data.items,errors:r.errors,loading:!1}),r=>this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})))))),this.createContactKindEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.contactKindService.createContactKind(Object.assign({},d)).pipe((0,g._b)(n=>{this.addNewContactKind(n),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:n,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},n=>{n.graphQLErrors?(this.toast.error(n.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})):(this.toast.error(n.Message),this.formService.setErrors(n.Data))}))))),this.updateContactKindEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.contactKindService.updateContactKind(d,d.id).pipe((0,g._b)(r=>{this.updateContactKind(r),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:r,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.deleteContactKindEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.data.userDeleteContactKind({contactKindId:n.id}).pipe((0,g._b)(r=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:r.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.importExcelEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.contactKindService.importContactKinds(d).pipe((0,ce.K)(n=>{var r;return this.toast.error(null!==(r=n.Message)&&void 0!==r?r:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(n=>{const r=JSON.parse(n.created),m=JSON.parse(n.updated),p=JSON.parse(n.failed),_=r.length+m.length+p.length;this.addContactKinds(r),this.updateContactKinds(m),this.toast.success(`${r.length} created, ${m.length} updated, ${p.length} failed of total ${_}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("contactKindId")?(this.route.snapshot.paramMap.get("contactKindId"),this.setFormName("contactKind_edit")):this.setFormName("contactKind_create")}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.contactKindService.validateContactKindExcelData(t)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(PN))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function IN(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.contactKind)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let kn=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"contactKind_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.contactKind=i.item})):t.formName&&t.formName.currentValue&&"contactKind_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadContactKindEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.contactKind=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(oo),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-contact-kind-form"]],inputs:{contactKind:"contactKind",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,IN,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),Bn=(()=>{class s{constructor(){this.autoHeight=!1,this.contactKinds=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[,{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-contact-kind-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",contactKinds:"contactKinds"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.contactKinds)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function DN(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-contact-kind-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","contactKind_edit")("formControl",t.formControl)("contactKind",t.contactKind)}}const MN=function(){return{}};function WN(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-contact-kind-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","contactKind_create")("formControl",t.formControl)("contactKind",e.DdM(3,MN))}}function EN(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-contact-kind-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("contactKinds",o.data.items)}let ON=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadContactKindsEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.contactKinds$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(oo))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","contactKind","send","close"],[1,"w-full","h-full","bg-white",3,"contactKinds","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,DN,2,3,"ng-template",null,1,e.W1O),e.YNc(3,WN,1,4,"ng-template",null,2,e.W1O),e.YNc(5,EN,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,kn,Bn],encapsulation:2}),s})();function LN(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-contact-kind-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","contactKind_edit")("contactKind",t.value)}}const $N=function(){return{}};function GN(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-contact-kind-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","contactKind_create")("contactKind",e.DdM(2,$N))}function RN(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-contact-kind-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("contactKinds",t.items)}}let QN=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","contactKind","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","contactKinds","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,LN,1,2,"ng-template",null,1,e.W1O),e.YNc(3,GN,1,3,"ng-template",null,2,e.W1O),e.YNc(5,RN,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,kn,Bn],encapsulation:2}),s})(),VN=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[oo],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"contact-kind-select",component:ON,wrappers:["form-field"]},{name:"contact-kind-grid",component:QN}]})]}),s})(),jN=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[VN]}),s})();class Vt extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class UN extends Vt{constructor(o,t){super("ValidateContactExcelDataAction"),this.valid=!1,this.excelData=o,this.contactKinds=t}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name),this.validationContext.addRule(new f.mi(`contactKindName_${i}_is_valid}`,"Contact Kind Is Not Valid","contactKind.name",t.contactKind,this.contactKinds,!0))}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class JN extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class zN extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new JN("name","The contact name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class HN extends Vt{constructor(o){super("CreateContactAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new zN("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateContact({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class qN extends Vt{constructor(o){super("UpdateContactsAction"),this.contacts=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.contacts,!0))}performAction(){this.response=this.businessProvider.data.userUpdateContacts({input:{contacts:this.contacts}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class KN extends Vt{constructor(o,t){super("UpdateContactAction"),this.contact=o,this.contactId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.contact,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.contactId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateContact({contactId:this.contactId,input:this.contact}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let Yn=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.ContactBusinessProviderService",t,a),this.data=i}createContact(t){const i=new HN(t);return i.Do(this),i.response}updateContact(t,i){const a=new KN(t,i);return a.Do(this),a.response}importContacts(t){const i=new qN(t);return i.Do(this),i.response}validateContactExcelData(t,i){const a=new UN(t,i);return a.Do(this),a.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),ZN=(()=>{class s extends I.nH{constructor(t,i,a){super("ContactService",a,t),this.businessProvider=i}createContact(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createContact(i)}updateContact(t,i){return this.businessProvider.updateContact(t,i)}importContacts(t){return this.businessProvider.importContacts(t)}validateContactExcelData(t,i){return this.businessProvider.validateContactExcelData(t,i)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(Yn,8),e.LFG(Yn),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),ao=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){if(super({loading:!1,contacts:[],done:!1,searchQuery:"",formName:void 0,contactKindId:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.contactService=H,this.errors$=this.select(A=>A.errors),this.loading$=this.select(A=>A.loading),this.done$=this.select(A=>A.done),this.item$=this.select(A=>A.item),this.contacts$=this.select(A=>A.contacts),this.contactKinds$=this.select(A=>A.contactKinds||[]),this.contactKindId$=this.select(A=>A.contactKindId),this.paging$=this.select(A=>A.paging),this.searchQuery$=this.select(A=>A.searchQuery),this.formName$=this.select(A=>A.formName),this.actionResult$=this.select(this.item$,this.done$,(A,c)=>({item:A,done:c}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.contacts$,this.contactKinds$,(A,c,d,n,r,m)=>({errors:A,loading:c,item:d,formName:n,contacts:r,contactKinds:m}),{debounce:!0}),this.input$=this.select(this.paging$,this.contactKindId$,this.searchQuery$,(A,c,d)=>({limit:A.limit,skip:A.skip,name:d,contactKindId:c,total:A.total})),this.setFormName=this.updater((A,c)=>Object.assign(Object.assign({},A),{formName:c})),this.setContactKindId=this.updater((A,c)=>Object.assign(Object.assign({},A),{contactKindId:c})),this.filterContactKinds=A=>this.data.userSelectContactKinds({input:{name:A}}).pipe((0,g._b)(c=>{const d=c.data.items;return this.patchState({contactKinds:d}),d},c=>this.patchState({errors:c.graphQLErrors?c.graphQLErrors:c})),(0,he.U)(c=>c.data.items)),this.addContactKind=this.updater((A,c)=>Object.assign(Object.assign({},A),{contactKinds:A.contactKinds.concat(c)})),this.setItem=this.updater((A,c)=>Object.assign(Object.assign({},A),{item:c})),this.addNewContact=this.updater((A,c)=>Object.assign(Object.assign({},A),{contacts:[...A.contacts,c]})),this.updateContact=this.updater((A,c)=>Object.assign(Object.assign({},A),{contacts:A.contacts.map(d=>d.id===c.id?c:d)})),this.addContacts=this.updater((A,c)=>Object.assign(Object.assign({},A),{contacts:A.contacts.concat(c)})),this.updateContacts=this.updater((A,c)=>Object.assign(Object.assign({},A),{contacts:A.contacts.map(d=>c.find(r=>r.id===d.id)||d)})),this.setSearchQuery=this.updater((A,c)=>Object.assign(Object.assign({},A),{searchQuery:c})),this.loadContactEffect=this.effect(A=>A.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(c=>this.data.userContact({contactId:c}).pipe((0,g._b)(d=>{this.patchState({item:d.data.item,errors:d.errors,loading:!1})},d=>this.patchState({loading:!1,errors:d.graphQLErrors?d.graphQLErrors:d})))))),this.loadContactsEffect=this.effect(A=>A.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([c,d])=>this.data.userContacts({input:d}).pipe((0,g._b)(n=>this.patchState({paging:{limit:d.limit,skip:d.skip,total:n.data.count.total},contacts:n.data.items,errors:n.errors,loading:!1}),n=>this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})))))),this.createContactEffect=this.effect(A=>A.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(c=>this.contactService.createContact(Object.assign({},c)).pipe((0,g._b)(d=>{this.addNewContact(d),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:d,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},d=>{d.graphQLErrors?(this.toast.error(d.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:d.graphQLErrors?d.graphQLErrors:d})):(this.toast.error(d.Message),this.formService.setErrors(d.Data))}))))),this.updateContactEffect=this.effect(A=>A.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([c,d])=>this.contactService.updateContact(c,c.id).pipe((0,g._b)(n=>{this.updateContact(n),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:n,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},n=>{n.graphQLErrors?(this.toast.error(n.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})):(this.toast.error(n.Message),this.formService.setErrors(n.Data))}))))),this.deleteContactEffect=this.effect(A=>A.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([c,d])=>this.data.userDeleteContact({contactId:d.id}).pipe((0,g._b)(n=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:n.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},n=>{n.graphQLErrors?(this.toast.error(n.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})):(this.toast.error(n.Message),this.formService.setErrors(n.Data))}))))),this.importExcelEffect=this.effect(A=>A.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(c=>this.contactService.importContacts(c).pipe((0,ce.K)(d=>{var n;return this.toast.error(null!==(n=d.Message)&&void 0!==n?n:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(d=>{const n=JSON.parse(d.created),r=JSON.parse(d.updated),m=JSON.parse(d.failed),p=n.length+r.length+m.length;this.addContacts(n),this.updateContacts(r),this.toast.success(`${n.length} created, ${r.length} updated, ${m.length} failed of total ${p}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("contactId")?this.setFormName("contact_edit"):this.setFormName("contact_create"),this.route.snapshot.paramMap.has("contactKindId")){const A=this.route.snapshot.paramMap.get("contactKindId");this.setContactKindId(A)}}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.contactService.validateContactExcelData(t,i.contactKinds)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(ZN))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function kN(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.contact)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let Xn=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"contact_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.contact=i.item})):t.formName&&t.formName.currentValue&&"contact_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadContactEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.contact=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(ao),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-contact-form"]],inputs:{contact:"contact",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,kN,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),el=(()=>{class s{constructor(){this.autoHeight=!1,this.contacts=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[{field:"contactKind.name",headerName:"Contact Kind",filter:"agTextColumnFilter"},{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{field:"honorific",filter:"agTextColumnFilter"},{field:"firstName",filter:"agTextColumnFilter"},{field:"lastName",filter:"agTextColumnFilter"},{field:"suffix",filter:"agTextColumnFilter"},{field:"primaryPhoneNumber",filter:"agTextColumnFilter"},{field:"primaryEmailAddress",filter:"agTextColumnFilter"},{field:"primaryAddressLine1",filter:"agTextColumnFilter"},{field:"primaryAddressLine2",filter:"agTextColumnFilter"},{field:"primaryAddressCity",filter:"agTextColumnFilter"},{field:"primaryAddressStateOrProvince",filter:"agTextColumnFilter"},{field:"primaryAddressPostalCode",filter:"agTextColumnFilter"},{field:"notes",filter:"agTextColumnFilter"},{field:"discriminator",filter:"agTextColumnFilter"},{field:"contactKindId",filter:"agTextColumnFilter",hide:!0},{field:"dateOfBirth",filter:"agDateColumnFilter"},{headerName:"Latitude",field:"latitude",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.latitude,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{headerName:"Longitude",field:"longitude",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.longitude,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{field:"avatar",filter:"agTextColumnFilter"},{field:"background",filter:"agTextColumnFilter"},{field:"title",filter:"agTextColumnFilter"},{field:"company",filter:"agTextColumnFilter"},{field:"birthday",filter:"agTextColumnFilter"},{field:"address",filter:"agTextColumnFilter"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-contact-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",contacts:"contacts"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.contacts)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function BN(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-contact-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","contact_edit")("formControl",t.formControl)("contact",t.contact)}}const YN=function(){return{}};function XN(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-contact-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","contact_create")("formControl",t.formControl)("contact",e.DdM(3,YN))}}function eA(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-contact-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("contacts",o.data.items)}let tA=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadContactsEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.contacts$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(ao))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","contact","send","close"],[1,"w-full","h-full","bg-white",3,"contacts","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,BN,2,3,"ng-template",null,1,e.W1O),e.YNc(3,XN,1,4,"ng-template",null,2,e.W1O),e.YNc(5,eA,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,Xn,el],encapsulation:2}),s})();function iA(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-contact-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","contact_edit")("contact",t.value)}}const sA=function(){return{}};function oA(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-contact-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","contact_create")("contact",e.DdM(2,sA))}function aA(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-contact-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("contacts",t.items)}}let rA=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","contact","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","contacts","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,iA,1,2,"ng-template",null,1,e.W1O),e.YNc(3,oA,1,3,"ng-template",null,2,e.W1O),e.YNc(5,aA,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,Xn,el],encapsulation:2}),s})(),nA=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[ao],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"contact-select",component:tA,wrappers:["form-field"]},{name:"contact-grid",component:rA}]})]}),s})(),lA=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[nA]}),s})();class jt extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class cA extends jt{constructor(o,t,i){super("ValidateContactPhoneNumberExcelDataAction"),this.valid=!1,this.excelData=o,this.countries=t,this.contacts=i}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name),this.validationContext.addRule(new f.mi(`countryName_${i}_is_valid}`,"Country Is Not Valid","country.name",t.country,this.countries,!0)),this.validationContext.addRule(new f.mi(`contactName_${i}_is_valid}`,"Contact Is Not Valid","contact.name",t.contact,this.contacts,!0))}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class dA extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class uA extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new dA("name","The contactphonenumber name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class mA extends jt{constructor(o){super("CreateContactPhoneNumberAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new uA("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateContactPhoneNumber({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class pA extends jt{constructor(o){super("UpdateContactPhoneNumbersAction"),this.contactPhoneNumbers=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.contactPhoneNumbers,!0))}performAction(){this.response=this.businessProvider.data.userUpdateContactPhoneNumbers({input:{contactPhoneNumbers:this.contactPhoneNumbers}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class hA extends jt{constructor(o,t){super("UpdateContactPhoneNumberAction"),this.contactPhoneNumber=o,this.contactPhoneNumberId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.contactPhoneNumber,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.contactPhoneNumberId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateContactPhoneNumber({contactPhoneNumberId:this.contactPhoneNumberId,input:this.contactPhoneNumber}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let tl=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.ContactPhoneNumberBusinessProviderService",t,a),this.data=i}createContactPhoneNumber(t){const i=new mA(t);return i.Do(this),i.response}updateContactPhoneNumber(t,i){const a=new hA(t,i);return a.Do(this),a.response}importContactPhoneNumbers(t){const i=new pA(t);return i.Do(this),i.response}validateContactPhoneNumberExcelData(t,i,a){const l=new cA(t,i,a);return l.Do(this),l.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),fA=(()=>{class s extends I.nH{constructor(t,i,a){super("ContactPhoneNumberService",a,t),this.businessProvider=i}createContactPhoneNumber(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createContactPhoneNumber(i)}updateContactPhoneNumber(t,i){return this.businessProvider.updateContactPhoneNumber(t,i)}importContactPhoneNumbers(t){return this.businessProvider.importContactPhoneNumbers(t)}validateContactPhoneNumberExcelData(t,i,a){return this.businessProvider.validateContactPhoneNumberExcelData(t,i,a)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(tl,8),e.LFG(tl),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),ro=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){if(super({loading:!1,contactPhoneNumbers:[],done:!1,searchQuery:"",formName:void 0,countryId:void 0,contactId:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.contactPhoneNumberService=H,this.errors$=this.select(n=>n.errors),this.loading$=this.select(n=>n.loading),this.done$=this.select(n=>n.done),this.item$=this.select(n=>n.item),this.contactPhoneNumbers$=this.select(n=>n.contactPhoneNumbers),this.countries$=this.select(n=>n.countries||[]),this.contacts$=this.select(n=>n.contacts||[]),this.countryId$=this.select(n=>n.countryId),this.contactId$=this.select(n=>n.contactId),this.paging$=this.select(n=>n.paging),this.searchQuery$=this.select(n=>n.searchQuery),this.formName$=this.select(n=>n.formName),this.actionResult$=this.select(this.item$,this.done$,(n,r)=>({item:n,done:r}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.contactPhoneNumbers$,this.countries$,this.contacts$,(n,r,m,p,_,w,J)=>({errors:n,loading:r,item:m,formName:p,contactPhoneNumbers:_,countries:w,contacts:J}),{debounce:!0}),this.input$=this.select(this.paging$,this.countryId$,this.contactId$,this.searchQuery$,(n,r,m,p)=>({limit:n.limit,skip:n.skip,name:p,countryId:r,contactId:m,total:n.total})),this.setFormName=this.updater((n,r)=>Object.assign(Object.assign({},n),{formName:r})),this.setCountryId=this.updater((n,r)=>Object.assign(Object.assign({},n),{countryId:r})),this.setContactId=this.updater((n,r)=>Object.assign(Object.assign({},n),{contactId:r})),this.filterCountries=n=>this.data.userSelectCountries({input:{name:n}}).pipe((0,g._b)(r=>{let m=r.data.items;return this.patchState({countries:m}),m},r=>this.patchState({errors:r.graphQLErrors?r.graphQLErrors:r})),(0,he.U)(r=>r.data.items)),this.filterContacts=n=>this.data.userSelectContacts({input:{name:n}}).pipe((0,g._b)(r=>{let m=r.data.items;return this.patchState({contacts:m}),m},r=>this.patchState({errors:r.graphQLErrors?r.graphQLErrors:r})),(0,he.U)(r=>r.data.items)),this.addCountry=this.updater((n,r)=>Object.assign(Object.assign({},n),{countries:n.countries.concat(r)})),this.addContact=this.updater((n,r)=>Object.assign(Object.assign({},n),{contacts:n.contacts.concat(r)})),this.setItem=this.updater((n,r)=>Object.assign(Object.assign({},n),{item:r})),this.addNewContactPhoneNumber=this.updater((n,r)=>Object.assign(Object.assign({},n),{contactPhoneNumbers:[...n.contactPhoneNumbers,r]})),this.updateContactPhoneNumber=this.updater((n,r)=>Object.assign(Object.assign({},n),{contactPhoneNumbers:n.contactPhoneNumbers.map(m=>m.id===r.id?r:m)})),this.addContactPhoneNumbers=this.updater((n,r)=>Object.assign(Object.assign({},n),{contactPhoneNumbers:n.contactPhoneNumbers.concat(r)})),this.updateContactPhoneNumbers=this.updater((n,r)=>Object.assign(Object.assign({},n),{contactPhoneNumbers:n.contactPhoneNumbers.map(m=>r.find(_=>_.id===m.id)||m)})),this.setSearchQuery=this.updater((n,r)=>Object.assign(Object.assign({},n),{searchQuery:r})),this.loadContactPhoneNumberEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(r=>this.data.userContactPhoneNumber({contactPhoneNumberId:r}).pipe((0,g._b)(m=>{this.patchState({item:m.data.item,errors:m.errors,loading:!1})},m=>this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})))))),this.loadContactPhoneNumbersEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([r,m])=>this.data.userContactPhoneNumbers({input:m}).pipe((0,g._b)(p=>this.patchState({paging:{limit:m.limit,skip:m.skip,total:p.data.count.total},contactPhoneNumbers:p.data.items,errors:p.errors,loading:!1}),p=>this.patchState({loading:!1,errors:p.graphQLErrors?p.graphQLErrors:p})))))),this.createContactPhoneNumberEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(r=>this.contactPhoneNumberService.createContactPhoneNumber(Object.assign({},r)).pipe((0,g._b)(m=>{this.addNewContactPhoneNumber(m),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:m,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},m=>{m.graphQLErrors?(this.toast.error(m.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})):(this.toast.error(m.Message),this.formService.setErrors(m.Data))}))))),this.updateContactPhoneNumberEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([r,m])=>this.contactPhoneNumberService.updateContactPhoneNumber(r,r.id).pipe((0,g._b)(p=>{this.updateContactPhoneNumber(p),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:p,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},p=>{p.graphQLErrors?(this.toast.error(p.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:p.graphQLErrors?p.graphQLErrors:p})):(this.toast.error(p.Message),this.formService.setErrors(p.Data))}))))),this.deleteContactPhoneNumberEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([r,m])=>this.data.userDeleteContactPhoneNumber({contactPhoneNumberId:m.id}).pipe((0,g._b)(p=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:p.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},p=>{p.graphQLErrors?(this.toast.error(p.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:p.graphQLErrors?p.graphQLErrors:p})):(this.toast.error(p.Message),this.formService.setErrors(p.Data))}))))),this.importExcelEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(r=>this.contactPhoneNumberService.importContactPhoneNumbers(r).pipe((0,ce.K)(m=>{var p;return this.toast.error(null!==(p=m.Message)&&void 0!==p?p:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(m=>{const p=JSON.parse(m.created),_=JSON.parse(m.updated),w=JSON.parse(m.failed),J=p.length+_.length+w.length;this.addContactPhoneNumbers(p),this.updateContactPhoneNumbers(_),this.toast.success(`${p.length} created, ${_.length} updated, ${w.length} failed of total ${J}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("contactPhoneNumberId")?(this.route.snapshot.paramMap.get("contactPhoneNumberId"),this.setFormName("contactPhoneNumber_edit")):this.setFormName("contactPhoneNumber_create"),this.route.snapshot.paramMap.has("countryId")){var c=this.route.snapshot.paramMap.get("countryId");this.setCountryId(c)}if(this.route.snapshot.paramMap.has("contactId")){var d=this.route.snapshot.paramMap.get("contactId");this.setContactId(d)}}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.contactPhoneNumberService.validateContactPhoneNumberExcelData(t,i.countries,i.contacts)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(fA))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function _A(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.contactPhoneNumber)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let il=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"contactPhoneNumber_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.contactPhoneNumber=i.item})):t.formName&&t.formName.currentValue&&"contactPhoneNumber_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadContactPhoneNumberEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.contactPhoneNumber=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(ro),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-contact-phone-number-form"]],inputs:{contactPhoneNumber:"contactPhoneNumber",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,_A,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),sl=(()=>{class s{constructor(){this.autoHeight=!1,this.contactPhoneNumbers=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[{field:"country.name",headerName:"Country",filter:"agTextColumnFilter"},{field:"contact.name",headerName:"Contact",filter:"agTextColumnFilter"},{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{field:"countryId",filter:"agTextColumnFilter",hide:!0},{field:"phoneNumber",filter:"agTextColumnFilter"},{field:"label",filter:"agTextColumnFilter"},{field:"contactId",filter:"agTextColumnFilter",hide:!0}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-contact-phone-number-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",contactPhoneNumbers:"contactPhoneNumbers"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.contactPhoneNumbers)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function gA(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-contact-phone-number-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","contactPhoneNumber_edit")("formControl",t.formControl)("contactPhoneNumber",t.contactPhoneNumber)}}const CA=function(){return{}};function vA(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-contact-phone-number-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","contactPhoneNumber_create")("formControl",t.formControl)("contactPhoneNumber",e.DdM(3,CA))}}function SA(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-contact-phone-number-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("contactPhoneNumbers",o.data.items)}let bA=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadContactPhoneNumbersEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.contactPhoneNumbers$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(ro))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","contactPhoneNumber","send","close"],[1,"w-full","h-full","bg-white",3,"contactPhoneNumbers","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,gA,2,3,"ng-template",null,1,e.W1O),e.YNc(3,vA,1,4,"ng-template",null,2,e.W1O),e.YNc(5,SA,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,il,sl],encapsulation:2}),s})();function TA(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-contact-phone-number-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","contactPhoneNumber_edit")("contactPhoneNumber",t.value)}}const yA=function(){return{}};function wA(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-contact-phone-number-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","contactPhoneNumber_create")("contactPhoneNumber",e.DdM(2,yA))}function xA(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-contact-phone-number-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("contactPhoneNumbers",t.items)}}let NA=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","contactPhoneNumber","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","contactPhoneNumbers","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,TA,1,2,"ng-template",null,1,e.W1O),e.YNc(3,wA,1,3,"ng-template",null,2,e.W1O),e.YNc(5,xA,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,il,sl],encapsulation:2}),s})(),AA=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[ro],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"contact-phone-number-select",component:bA,wrappers:["form-field"]},{name:"contact-phone-number-grid",component:NA}]})]}),s})(),FA=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[AA]}),s})();class Ut extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class PA extends Ut{constructor(o,t,i){super("ValidateContactSettingExcelDataAction"),this.valid=!1,this.excelData=o,this.contacts=t,this.integrations=i}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name),this.validationContext.addRule(new f.mi(`contactName_${i}_is_valid}`,"Contact Is Not Valid","contact.name",t.contact,this.contacts,!0)),this.validationContext.addRule(new f.mi(`integrationName_${i}_is_valid}`,"Integration Is Not Valid","integration.name",t.integration,this.integrations,!0))}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class IA extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class DA extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new IA("name","The contactsetting name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class MA extends Ut{constructor(o){super("CreateContactSettingAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new DA("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateContactSetting({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class WA extends Ut{constructor(o){super("UpdateContactSettingsAction"),this.contactSettings=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.contactSettings,!0))}performAction(){this.response=this.businessProvider.data.userUpdateContactSettings({input:{contactSettings:this.contactSettings}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class EA extends Ut{constructor(o,t){super("UpdateContactSettingAction"),this.contactSetting=o,this.contactSettingId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.contactSetting,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.contactSettingId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateContactSetting({contactSettingId:this.contactSettingId,input:this.contactSetting}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let ol=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.ContactSettingBusinessProviderService",t,a),this.data=i}createContactSetting(t){const i=new MA(t);return i.Do(this),i.response}updateContactSetting(t,i){const a=new EA(t,i);return a.Do(this),a.response}importContactSettings(t){const i=new WA(t);return i.Do(this),i.response}validateContactSettingExcelData(t,i,a){const l=new PA(t,i,a);return l.Do(this),l.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),OA=(()=>{class s extends I.nH{constructor(t,i,a){super("ContactSettingService",a,t),this.businessProvider=i}createContactSetting(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createContactSetting(i)}updateContactSetting(t,i){return this.businessProvider.updateContactSetting(t,i)}importContactSettings(t){return this.businessProvider.importContactSettings(t)}validateContactSettingExcelData(t,i,a){return this.businessProvider.validateContactSettingExcelData(t,i,a)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(ol,8),e.LFG(ol),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),no=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){if(super({loading:!1,contactSettings:[],done:!1,searchQuery:"",formName:void 0,contactId:void 0,integrationId:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.contactSettingService=H,this.errors$=this.select(n=>n.errors),this.loading$=this.select(n=>n.loading),this.done$=this.select(n=>n.done),this.item$=this.select(n=>n.item),this.contactSettings$=this.select(n=>n.contactSettings),this.contacts$=this.select(n=>n.contacts||[]),this.integrations$=this.select(n=>n.integrations||[]),this.contactId$=this.select(n=>n.contactId),this.integrationId$=this.select(n=>n.integrationId),this.paging$=this.select(n=>n.paging),this.searchQuery$=this.select(n=>n.searchQuery),this.formName$=this.select(n=>n.formName),this.actionResult$=this.select(this.item$,this.done$,(n,r)=>({item:n,done:r}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.contactSettings$,this.contacts$,this.integrations$,(n,r,m,p,_,w,J)=>({errors:n,loading:r,item:m,formName:p,contactSettings:_,contacts:w,integrations:J}),{debounce:!0}),this.input$=this.select(this.paging$,this.contactId$,this.integrationId$,this.searchQuery$,(n,r,m,p)=>({limit:n.limit,skip:n.skip,name:p,contactId:r,integrationId:m,total:n.total})),this.setFormName=this.updater((n,r)=>Object.assign(Object.assign({},n),{formName:r})),this.setContactId=this.updater((n,r)=>Object.assign(Object.assign({},n),{contactId:r})),this.setIntegrationId=this.updater((n,r)=>Object.assign(Object.assign({},n),{integrationId:r})),this.filterContacts=n=>this.data.userSelectContacts({input:{name:n}}).pipe((0,g._b)(r=>{let m=r.data.items;return this.patchState({contacts:m}),m},r=>this.patchState({errors:r.graphQLErrors?r.graphQLErrors:r})),(0,he.U)(r=>r.data.items)),this.filterIntegrations=n=>this.data.userSelectIntegrations({input:{name:n}}).pipe((0,g._b)(r=>{let m=r.data.items;return this.patchState({integrations:m}),m},r=>this.patchState({errors:r.graphQLErrors?r.graphQLErrors:r})),(0,he.U)(r=>r.data.items)),this.addContact=this.updater((n,r)=>Object.assign(Object.assign({},n),{contacts:n.contacts.concat(r)})),this.addIntegration=this.updater((n,r)=>Object.assign(Object.assign({},n),{integrations:n.integrations.concat(r)})),this.setItem=this.updater((n,r)=>Object.assign(Object.assign({},n),{item:r})),this.addNewContactSetting=this.updater((n,r)=>Object.assign(Object.assign({},n),{contactSettings:[...n.contactSettings,r]})),this.updateContactSetting=this.updater((n,r)=>Object.assign(Object.assign({},n),{contactSettings:n.contactSettings.map(m=>m.id===r.id?r:m)})),this.addContactSettings=this.updater((n,r)=>Object.assign(Object.assign({},n),{contactSettings:n.contactSettings.concat(r)})),this.updateContactSettings=this.updater((n,r)=>Object.assign(Object.assign({},n),{contactSettings:n.contactSettings.map(m=>r.find(_=>_.id===m.id)||m)})),this.setSearchQuery=this.updater((n,r)=>Object.assign(Object.assign({},n),{searchQuery:r})),this.loadContactSettingEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(r=>this.data.userContactSetting({contactSettingId:r}).pipe((0,g._b)(m=>{this.patchState({item:m.data.item,errors:m.errors,loading:!1})},m=>this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})))))),this.loadContactSettingsEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([r,m])=>this.data.userContactSettings({input:m}).pipe((0,g._b)(p=>this.patchState({paging:{limit:m.limit,skip:m.skip,total:p.data.count.total},contactSettings:p.data.items,errors:p.errors,loading:!1}),p=>this.patchState({loading:!1,errors:p.graphQLErrors?p.graphQLErrors:p})))))),this.createContactSettingEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(r=>this.contactSettingService.createContactSetting(Object.assign({},r)).pipe((0,g._b)(m=>{this.addNewContactSetting(m),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:m,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},m=>{m.graphQLErrors?(this.toast.error(m.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})):(this.toast.error(m.Message),this.formService.setErrors(m.Data))}))))),this.updateContactSettingEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([r,m])=>this.contactSettingService.updateContactSetting(r,r.id).pipe((0,g._b)(p=>{this.updateContactSetting(p),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:p,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},p=>{p.graphQLErrors?(this.toast.error(p.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:p.graphQLErrors?p.graphQLErrors:p})):(this.toast.error(p.Message),this.formService.setErrors(p.Data))}))))),this.deleteContactSettingEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([r,m])=>this.data.userDeleteContactSetting({contactSettingId:m.id}).pipe((0,g._b)(p=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:p.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},p=>{p.graphQLErrors?(this.toast.error(p.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:p.graphQLErrors?p.graphQLErrors:p})):(this.toast.error(p.Message),this.formService.setErrors(p.Data))}))))),this.importExcelEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(r=>this.contactSettingService.importContactSettings(r).pipe((0,ce.K)(m=>{var p;return this.toast.error(null!==(p=m.Message)&&void 0!==p?p:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(m=>{const p=JSON.parse(m.created),_=JSON.parse(m.updated),w=JSON.parse(m.failed),J=p.length+_.length+w.length;this.addContactSettings(p),this.updateContactSettings(_),this.toast.success(`${p.length} created, ${_.length} updated, ${w.length} failed of total ${J}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("contactSettingId")?(this.route.snapshot.paramMap.get("contactSettingId"),this.setFormName("contactSetting_edit")):this.setFormName("contactSetting_create"),this.route.snapshot.paramMap.has("contactId")){var c=this.route.snapshot.paramMap.get("contactId");this.setContactId(c)}if(this.route.snapshot.paramMap.has("integrationId")){var d=this.route.snapshot.paramMap.get("integrationId");this.setIntegrationId(d)}}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.contactSettingService.validateContactSettingExcelData(t,i.contacts,i.integrations)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(OA))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function LA(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.contactSetting)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let al=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"contactSetting_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.contactSetting=i.item})):t.formName&&t.formName.currentValue&&"contactSetting_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadContactSettingEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.contactSetting=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(no),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-contact-setting-form"]],inputs:{contactSetting:"contactSetting",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,LA,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),rl=(()=>{class s{constructor(){this.autoHeight=!1,this.contactSettings=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[{field:"contact.name",headerName:"Contact",filter:"agTextColumnFilter"},{field:"integration.name",headerName:"Integration",filter:"agTextColumnFilter"},{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{field:"value",filter:"agTextColumnFilter"},{field:"iconUrl",filter:"agTextColumnFilter"},{field:"properties",filter:"agTextColumnFilter"},{field:"contactId",filter:"agTextColumnFilter",hide:!0},{field:"integrationId",filter:"agTextColumnFilter",hide:!0}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-contact-setting-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",contactSettings:"contactSettings"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.contactSettings)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function $A(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-contact-setting-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","contactSetting_edit")("formControl",t.formControl)("contactSetting",t.contactSetting)}}const GA=function(){return{}};function RA(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-contact-setting-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","contactSetting_create")("formControl",t.formControl)("contactSetting",e.DdM(3,GA))}}function QA(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-contact-setting-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("contactSettings",o.data.items)}let VA=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadContactSettingsEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.contactSettings$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(no))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","contactSetting","send","close"],[1,"w-full","h-full","bg-white",3,"contactSettings","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,$A,2,3,"ng-template",null,1,e.W1O),e.YNc(3,RA,1,4,"ng-template",null,2,e.W1O),e.YNc(5,QA,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,al,rl],encapsulation:2}),s})();function jA(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-contact-setting-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","contactSetting_edit")("contactSetting",t.value)}}const UA=function(){return{}};function JA(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-contact-setting-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","contactSetting_create")("contactSetting",e.DdM(2,UA))}function zA(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-contact-setting-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("contactSettings",t.items)}}let HA=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","contactSetting","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","contactSettings","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,jA,1,2,"ng-template",null,1,e.W1O),e.YNc(3,JA,1,3,"ng-template",null,2,e.W1O),e.YNc(5,zA,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,al,rl],encapsulation:2}),s})(),qA=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[no],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"contact-setting-select",component:VA,wrappers:["form-field"]},{name:"contact-setting-grid",component:HA}]})]}),s})(),KA=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[qA]}),s})();class Jt extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class ZA extends Jt{constructor(o,t){super("ValidateContactTagExcelDataAction"),this.valid=!1,this.excelData=o,this.contacts=t}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name),this.validationContext.addRule(new f.mi(`contactName_${i}_is_valid}`,"Contact Is Not Valid","contact.name",t.contact,this.contacts,!0))}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class kA extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class BA extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new kA("name","The contacttag name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class YA extends Jt{constructor(o){super("CreateContactTagAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new BA("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateContactTag({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class XA extends Jt{constructor(o){super("UpdateContactTagsAction"),this.contactTags=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.contactTags,!0))}performAction(){this.response=this.businessProvider.data.userUpdateContactTags({input:{contactTags:this.contactTags}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class eF extends Jt{constructor(o,t){super("UpdateContactTagAction"),this.contactTag=o,this.contactTagId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.contactTag,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.contactTagId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateContactTag({contactTagId:this.contactTagId,input:this.contactTag}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let nl=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.ContactTagBusinessProviderService",t,a),this.data=i}createContactTag(t){const i=new YA(t);return i.Do(this),i.response}updateContactTag(t,i){const a=new eF(t,i);return a.Do(this),a.response}importContactTags(t){const i=new XA(t);return i.Do(this),i.response}validateContactTagExcelData(t,i){const a=new ZA(t,i);return a.Do(this),a.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),tF=(()=>{class s extends I.nH{constructor(t,i,a){super("ContactTagService",a,t),this.businessProvider=i}createContactTag(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createContactTag(i)}updateContactTag(t,i){return this.businessProvider.updateContactTag(t,i)}importContactTags(t){return this.businessProvider.importContactTags(t)}validateContactTagExcelData(t,i){return this.businessProvider.validateContactTagExcelData(t,i)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(nl,8),e.LFG(nl),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),lo=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){if(super({loading:!1,contactTags:[],done:!1,searchQuery:"",formName:void 0,contactId:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.contactTagService=H,this.errors$=this.select(d=>d.errors),this.loading$=this.select(d=>d.loading),this.done$=this.select(d=>d.done),this.item$=this.select(d=>d.item),this.contactTags$=this.select(d=>d.contactTags),this.contacts$=this.select(d=>d.contacts||[]),this.contactId$=this.select(d=>d.contactId),this.paging$=this.select(d=>d.paging),this.searchQuery$=this.select(d=>d.searchQuery),this.formName$=this.select(d=>d.formName),this.actionResult$=this.select(this.item$,this.done$,(d,n)=>({item:d,done:n}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.contactTags$,this.contacts$,(d,n,r,m,p,_)=>({errors:d,loading:n,item:r,formName:m,contactTags:p,contacts:_}),{debounce:!0}),this.input$=this.select(this.paging$,this.contactId$,this.searchQuery$,(d,n,r)=>({limit:d.limit,skip:d.skip,name:r,contactId:n,total:d.total})),this.setFormName=this.updater((d,n)=>Object.assign(Object.assign({},d),{formName:n})),this.setContactId=this.updater((d,n)=>Object.assign(Object.assign({},d),{contactId:n})),this.filterContacts=d=>this.data.userSelectContacts({input:{name:d}}).pipe((0,g._b)(n=>{let r=n.data.items;return this.patchState({contacts:r}),r},n=>this.patchState({errors:n.graphQLErrors?n.graphQLErrors:n})),(0,he.U)(n=>n.data.items)),this.addContact=this.updater((d,n)=>Object.assign(Object.assign({},d),{contacts:d.contacts.concat(n)})),this.setItem=this.updater((d,n)=>Object.assign(Object.assign({},d),{item:n})),this.addNewContactTag=this.updater((d,n)=>Object.assign(Object.assign({},d),{contactTags:[...d.contactTags,n]})),this.updateContactTag=this.updater((d,n)=>Object.assign(Object.assign({},d),{contactTags:d.contactTags.map(r=>r.id===n.id?n:r)})),this.addContactTags=this.updater((d,n)=>Object.assign(Object.assign({},d),{contactTags:d.contactTags.concat(n)})),this.updateContactTags=this.updater((d,n)=>Object.assign(Object.assign({},d),{contactTags:d.contactTags.map(r=>n.find(p=>p.id===r.id)||r)})),this.setSearchQuery=this.updater((d,n)=>Object.assign(Object.assign({},d),{searchQuery:n})),this.loadContactTagEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(n=>this.data.userContactTag({contactTagId:n}).pipe((0,g._b)(r=>{this.patchState({item:r.data.item,errors:r.errors,loading:!1})},r=>this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})))))),this.loadContactTagsEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([n,r])=>this.data.userContactTags({input:r}).pipe((0,g._b)(m=>this.patchState({paging:{limit:r.limit,skip:r.skip,total:m.data.count.total},contactTags:m.data.items,errors:m.errors,loading:!1}),m=>this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})))))),this.createContactTagEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(n=>this.contactTagService.createContactTag(Object.assign({},n)).pipe((0,g._b)(r=>{this.addNewContactTag(r),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:r,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.updateContactTagEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([n,r])=>this.contactTagService.updateContactTag(n,n.id).pipe((0,g._b)(m=>{this.updateContactTag(m),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:m,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},m=>{m.graphQLErrors?(this.toast.error(m.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})):(this.toast.error(m.Message),this.formService.setErrors(m.Data))}))))),this.deleteContactTagEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([n,r])=>this.data.userDeleteContactTag({contactTagId:r.id}).pipe((0,g._b)(m=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:m.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},m=>{m.graphQLErrors?(this.toast.error(m.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})):(this.toast.error(m.Message),this.formService.setErrors(m.Data))}))))),this.importExcelEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(n=>this.contactTagService.importContactTags(n).pipe((0,ce.K)(r=>{var m;return this.toast.error(null!==(m=r.Message)&&void 0!==m?m:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(r=>{const m=JSON.parse(r.created),p=JSON.parse(r.updated),_=JSON.parse(r.failed),w=m.length+p.length+_.length;this.addContactTags(m),this.updateContactTags(p),this.toast.success(`${m.length} created, ${p.length} updated, ${_.length} failed of total ${w}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("contactTagId")?(this.route.snapshot.paramMap.get("contactTagId"),this.setFormName("contactTag_edit")):this.setFormName("contactTag_create"),this.route.snapshot.paramMap.has("contactId")){var c=this.route.snapshot.paramMap.get("contactId");this.setContactId(c)}}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.contactTagService.validateContactTagExcelData(t,i.contacts)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(tF))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function iF(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.contactTag)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let ll=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"contactTag_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.contactTag=i.item})):t.formName&&t.formName.currentValue&&"contactTag_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadContactTagEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.contactTag=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(lo),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-contact-tag-form"]],inputs:{contactTag:"contactTag",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,iF,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),cl=(()=>{class s{constructor(){this.autoHeight=!1,this.contactTags=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[{field:"contact.name",headerName:"Contact",filter:"agTextColumnFilter"},{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{field:"contactId",filter:"agTextColumnFilter",hide:!0}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-contact-tag-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",contactTags:"contactTags"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.contactTags)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function sF(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-contact-tag-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","contactTag_edit")("formControl",t.formControl)("contactTag",t.contactTag)}}const oF=function(){return{}};function aF(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-contact-tag-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","contactTag_create")("formControl",t.formControl)("contactTag",e.DdM(3,oF))}}function rF(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-contact-tag-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("contactTags",o.data.items)}let nF=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadContactTagsEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.contactTags$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(lo))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","contactTag","send","close"],[1,"w-full","h-full","bg-white",3,"contactTags","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,sF,2,3,"ng-template",null,1,e.W1O),e.YNc(3,aF,1,4,"ng-template",null,2,e.W1O),e.YNc(5,rF,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,ll,cl],encapsulation:2}),s})();function lF(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-contact-tag-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","contactTag_edit")("contactTag",t.value)}}const cF=function(){return{}};function dF(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-contact-tag-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","contactTag_create")("contactTag",e.DdM(2,cF))}function uF(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-contact-tag-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("contactTags",t.items)}}let mF=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","contactTag","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","contactTags","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,lF,1,2,"ng-template",null,1,e.W1O),e.YNc(3,dF,1,3,"ng-template",null,2,e.W1O),e.YNc(5,uF,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,ll,cl],encapsulation:2}),s})(),pF=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[lo],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"contact-tag-select",component:nF,wrappers:["form-field"]},{name:"contact-tag-grid",component:mF}]})]}),s})(),hF=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[pF]}),s})();class zt extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class fF extends zt{constructor(o){super("ValidateContractedRateKindExcelDataAction"),this.valid=!1,this.excelData=o}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name)}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class _F extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class gF extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new _F("name","The contractedratekind name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class CF extends zt{constructor(o){super("CreateContractedRateKindAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new gF("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateContractedRateKind({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class vF extends zt{constructor(o){super("UpdateContractedRateKindsAction"),this.contractedRateKinds=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.contractedRateKinds,!0))}performAction(){this.response=this.businessProvider.data.userUpdateContractedRateKinds({input:{contractedRateKinds:this.contractedRateKinds}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class SF extends zt{constructor(o,t){super("UpdateContractedRateKindAction"),this.contractedRateKind=o,this.contractedRateKindId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.contractedRateKind,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.contractedRateKindId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateContractedRateKind({contractedRateKindId:this.contractedRateKindId,input:this.contractedRateKind}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let dl=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.ContractedRateKindBusinessProviderService",t,a),this.data=i}createContractedRateKind(t){const i=new CF(t);return i.Do(this),i.response}updateContractedRateKind(t,i){const a=new SF(t,i);return a.Do(this),a.response}importContractedRateKinds(t){const i=new vF(t);return i.Do(this),i.response}validateContractedRateKindExcelData(t){const i=new fF(t);return i.Do(this),i.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),bF=(()=>{class s extends I.nH{constructor(t,i,a){super("ContractedRateKindService",a,t),this.businessProvider=i}createContractedRateKind(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createContractedRateKind(i)}updateContractedRateKind(t,i){return this.businessProvider.updateContractedRateKind(t,i)}importContractedRateKinds(t){return this.businessProvider.importContractedRateKinds(t)}validateContractedRateKindExcelData(t){return this.businessProvider.validateContractedRateKindExcelData(t)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(dl,8),e.LFG(dl),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),co=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){super({loading:!1,contractedRateKinds:[],done:!1,searchQuery:"",formName:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.contractedRateKindService=H,this.errors$=this.select(c=>c.errors),this.loading$=this.select(c=>c.loading),this.done$=this.select(c=>c.done),this.item$=this.select(c=>c.item),this.contractedRateKinds$=this.select(c=>c.contractedRateKinds),this.paging$=this.select(c=>c.paging),this.searchQuery$=this.select(c=>c.searchQuery),this.formName$=this.select(c=>c.formName),this.actionResult$=this.select(this.item$,this.done$,(c,d)=>({item:c,done:d}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.contractedRateKinds$,(c,d,n,r,m)=>({errors:c,loading:d,item:n,formName:r,contractedRateKinds:m}),{debounce:!0}),this.input$=this.select(this.paging$,this.searchQuery$,(c,d)=>({limit:c.limit,skip:c.skip,name:d,total:c.total})),this.setFormName=this.updater((c,d)=>Object.assign(Object.assign({},c),{formName:d})),this.setItem=this.updater((c,d)=>Object.assign(Object.assign({},c),{item:d})),this.addNewContractedRateKind=this.updater((c,d)=>Object.assign(Object.assign({},c),{contractedRateKinds:[...c.contractedRateKinds,d]})),this.updateContractedRateKind=this.updater((c,d)=>Object.assign(Object.assign({},c),{contractedRateKinds:c.contractedRateKinds.map(n=>n.id===d.id?d:n)})),this.addContractedRateKinds=this.updater((c,d)=>Object.assign(Object.assign({},c),{contractedRateKinds:c.contractedRateKinds.concat(d)})),this.updateContractedRateKinds=this.updater((c,d)=>Object.assign(Object.assign({},c),{contractedRateKinds:c.contractedRateKinds.map(n=>d.find(m=>m.id===n.id)||n)})),this.setSearchQuery=this.updater((c,d)=>Object.assign(Object.assign({},c),{searchQuery:d})),this.loadContractedRateKindEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.data.userContractedRateKind({contractedRateKindId:d}).pipe((0,g._b)(n=>{this.patchState({item:n.data.item,errors:n.errors,loading:!1})},n=>this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})))))),this.loadContractedRateKindsEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([d,n])=>this.data.userContractedRateKinds({input:n}).pipe((0,g._b)(r=>this.patchState({paging:{limit:n.limit,skip:n.skip,total:r.data.count.total},contractedRateKinds:r.data.items,errors:r.errors,loading:!1}),r=>this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})))))),this.createContractedRateKindEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.contractedRateKindService.createContractedRateKind(Object.assign({},d)).pipe((0,g._b)(n=>{this.addNewContractedRateKind(n),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:n,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},n=>{n.graphQLErrors?(this.toast.error(n.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})):(this.toast.error(n.Message),this.formService.setErrors(n.Data))}))))),this.updateContractedRateKindEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.contractedRateKindService.updateContractedRateKind(d,d.id).pipe((0,g._b)(r=>{this.updateContractedRateKind(r),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:r,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.deleteContractedRateKindEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.data.userDeleteContractedRateKind({contractedRateKindId:n.id}).pipe((0,g._b)(r=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:r.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.importExcelEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.contractedRateKindService.importContractedRateKinds(d).pipe((0,ce.K)(n=>{var r;return this.toast.error(null!==(r=n.Message)&&void 0!==r?r:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(n=>{const r=JSON.parse(n.created),m=JSON.parse(n.updated),p=JSON.parse(n.failed),_=r.length+m.length+p.length;this.addContractedRateKinds(r),this.updateContractedRateKinds(m),this.toast.success(`${r.length} created, ${m.length} updated, ${p.length} failed of total ${_}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("contractedRateKindId")?(this.route.snapshot.paramMap.get("contractedRateKindId"),this.setFormName("contractedRateKind_edit")):this.setFormName("contractedRateKind_create")}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.contractedRateKindService.validateContractedRateKindExcelData(t)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(bF))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function TF(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.contractedRateKind)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let ul=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"contractedRateKind_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.contractedRateKind=i.item})):t.formName&&t.formName.currentValue&&"contractedRateKind_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadContractedRateKindEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.contractedRateKind=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(co),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-contracted-rate-kind-form"]],inputs:{contractedRateKind:"contractedRateKind",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,TF,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),ml=(()=>{class s{constructor(){this.autoHeight=!1,this.contractedRateKinds=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[,{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{field:"code",filter:"agTextColumnFilter"},{headerName:"Value",field:"value",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.value,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-contracted-rate-kind-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",contractedRateKinds:"contractedRateKinds"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.contractedRateKinds)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function yF(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-contracted-rate-kind-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","contractedRateKind_edit")("formControl",t.formControl)("contractedRateKind",t.contractedRateKind)}}const wF=function(){return{}};function xF(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-contracted-rate-kind-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","contractedRateKind_create")("formControl",t.formControl)("contractedRateKind",e.DdM(3,wF))}}function NF(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-contracted-rate-kind-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("contractedRateKinds",o.data.items)}let AF=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadContractedRateKindsEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.contractedRateKinds$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(co))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","contractedRateKind","send","close"],[1,"w-full","h-full","bg-white",3,"contractedRateKinds","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,yF,2,3,"ng-template",null,1,e.W1O),e.YNc(3,xF,1,4,"ng-template",null,2,e.W1O),e.YNc(5,NF,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,ul,ml],encapsulation:2}),s})();function FF(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-contracted-rate-kind-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","contractedRateKind_edit")("contractedRateKind",t.value)}}const PF=function(){return{}};function IF(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-contracted-rate-kind-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","contractedRateKind_create")("contractedRateKind",e.DdM(2,PF))}function DF(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-contracted-rate-kind-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("contractedRateKinds",t.items)}}let MF=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","contractedRateKind","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","contractedRateKinds","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,FF,1,2,"ng-template",null,1,e.W1O),e.YNc(3,IF,1,3,"ng-template",null,2,e.W1O),e.YNc(5,DF,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,ul,ml],encapsulation:2}),s})(),WF=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[co],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"contracted-rate-kind-select",component:AF,wrappers:["form-field"]},{name:"contracted-rate-kind-grid",component:MF}]})]}),s})(),EF=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[WF]}),s})();class Ht extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class OF extends Ht{constructor(o,t,i,a,l,u,H){super("ValidateContractedRateExcelDataAction"),this.valid=!1,this.excelData=o,this.contracts=t,this.contractedRateKinds=i,this.contractKinds=a,this.visitKinds=l,this.clinicalProviders=u,this.specialties=H}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name),this.validationContext.addRule(new f.mi(`contractName_${i}_is_valid}`,"Contract Is Not Valid","contract.name",t.contract,this.contracts,!0)),this.validationContext.addRule(new f.mi(`contractedRateKindName_${i}_is_valid}`,"Contracted Rate Kind Is Not Valid","contractedRateKind.name",t.contractedRateKind,this.contractedRateKinds,!0)),this.validationContext.addRule(new f.mi(`contractKindName_${i}_is_valid}`,"Contract Kind Is Not Valid","contractKind.name",t.contractKind,this.contractKinds,!0)),this.validationContext.addRule(new f.mi(`visitKindName_${i}_is_valid}`,"Visit Kind Is Not Valid","visitKind.name",t.visitKind,this.visitKinds,!0)),this.validationContext.addRule(new f.mi(`clinicalProviderName_${i}_is_valid}`,"Clinical Provider Is Not Valid","clinicalProvider.name",t.clinicalProvider,this.clinicalProviders,!0)),this.validationContext.addRule(new f.mi(`specialtyName_${i}_is_valid}`,"Specialty Is Not Valid","specialty.name",t.specialty,this.specialties,!0))}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class LF extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class $F extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new LF("name","The contractedrate name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class GF extends Ht{constructor(o){super("CreateContractedRateAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new $F("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateContractedRate({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class RF extends Ht{constructor(o){super("UpdateContractedRatesAction"),this.contractedRates=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.contractedRates,!0))}performAction(){this.response=this.businessProvider.data.userUpdateContractedRates({input:{contractedRates:this.contractedRates}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class QF extends Ht{constructor(o,t){super("UpdateContractedRateAction"),this.contractedRate=o,this.contractedRateId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.contractedRate,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.contractedRateId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateContractedRate({contractedRateId:this.contractedRateId,input:this.contractedRate}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let pl=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.ContractedRateBusinessProviderService",t,a),this.data=i}createContractedRate(t){const i=new GF(t);return i.Do(this),i.response}updateContractedRate(t,i){const a=new QF(t,i);return a.Do(this),a.response}importContractedRates(t){const i=new RF(t);return i.Do(this),i.response}validateContractedRateExcelData(t,i,a,l,u,H,A){const c=new OF(t,i,a,l,u,H,A);return c.Do(this),c.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),VF=(()=>{class s extends I.nH{constructor(t,i,a){super("ContractedRateService",a,t),this.businessProvider=i}createContractedRate(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createContractedRate(i)}updateContractedRate(t,i){return this.businessProvider.updateContractedRate(t,i)}importContractedRates(t){return this.businessProvider.importContractedRates(t)}validateContractedRateExcelData(t,i,a,l,u,H,A){return this.businessProvider.validateContractedRateExcelData(t,i,a,l,u,H,A)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(pl,8),e.LFG(pl),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),uo=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){if(super({loading:!1,contractedRates:[],done:!1,searchQuery:"",formName:void 0,contractId:void 0,contractedRateKindId:void 0,contractKindId:void 0,visitKindId:void 0,clinicalProviderId:void 0,specialtyId:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.contractedRateService=H,this.errors$=this.select(_=>_.errors),this.loading$=this.select(_=>_.loading),this.done$=this.select(_=>_.done),this.item$=this.select(_=>_.item),this.contractedRates$=this.select(_=>_.contractedRates),this.contracts$=this.select(_=>_.contracts||[]),this.contractedRateKinds$=this.select(_=>_.contractedRateKinds||[]),this.contractKinds$=this.select(_=>_.contractKinds||[]),this.visitKinds$=this.select(_=>_.visitKinds||[]),this.clinicalProviders$=this.select(_=>_.clinicalProviders||[]),this.specialties$=this.select(_=>_.specialties||[]),this.contractId$=this.select(_=>_.contractId),this.contractedRateKindId$=this.select(_=>_.contractedRateKindId),this.contractKindId$=this.select(_=>_.contractKindId),this.visitKindId$=this.select(_=>_.visitKindId),this.clinicalProviderId$=this.select(_=>_.clinicalProviderId),this.specialtyId$=this.select(_=>_.specialtyId),this.paging$=this.select(_=>_.paging),this.searchQuery$=this.select(_=>_.searchQuery),this.formName$=this.select(_=>_.formName),this.actionResult$=this.select(this.item$,this.done$,(_,w)=>({item:_,done:w}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.contractedRates$,this.contracts$,this.contractedRateKinds$,this.contractKinds$,this.visitKinds$,this.clinicalProviders$,this.specialties$,(_,w,J,_e,ve,ae,le,Y,oe,ge,Se)=>({errors:_,loading:w,item:J,formName:_e,contractedRates:ve,contracts:ae,contractedRateKinds:le,contractKinds:Y,visitKinds:oe,clinicalProviders:ge,specialties:Se}),{debounce:!0}),this.input$=this.select(this.paging$,this.contractId$,this.contractedRateKindId$,this.contractKindId$,this.visitKindId$,this.clinicalProviderId$,this.specialtyId$,this.searchQuery$,(_,w,J,_e,ve,ae,le,Y)=>({limit:_.limit,skip:_.skip,name:Y,contractId:w,contractedRateKindId:J,contractKindId:_e,visitKindId:ve,clinicalProviderId:ae,specialtyId:le,total:_.total})),this.setFormName=this.updater((_,w)=>Object.assign(Object.assign({},_),{formName:w})),this.setContractId=this.updater((_,w)=>Object.assign(Object.assign({},_),{contractId:w})),this.setContractedRateKindId=this.updater((_,w)=>Object.assign(Object.assign({},_),{contractedRateKindId:w})),this.setContractKindId=this.updater((_,w)=>Object.assign(Object.assign({},_),{contractKindId:w})),this.setVisitKindId=this.updater((_,w)=>Object.assign(Object.assign({},_),{visitKindId:w})),this.setClinicalProviderId=this.updater((_,w)=>Object.assign(Object.assign({},_),{clinicalProviderId:w})),this.setSpecialtyId=this.updater((_,w)=>Object.assign(Object.assign({},_),{specialtyId:w})),this.filterContracts=_=>this.data.userSelectContracts({input:{name:_}}).pipe((0,g._b)(w=>{let J=w.data.items;return this.patchState({contracts:J}),J},w=>this.patchState({errors:w.graphQLErrors?w.graphQLErrors:w})),(0,he.U)(w=>w.data.items)),this.filterContractedRateKinds=_=>this.data.userSelectContractedRateKinds({input:{name:_}}).pipe((0,g._b)(w=>{let J=w.data.items;return this.patchState({contractedRateKinds:J}),J},w=>this.patchState({errors:w.graphQLErrors?w.graphQLErrors:w})),(0,he.U)(w=>w.data.items)),this.filterContractKinds=_=>this.data.userSelectContractKinds({input:{name:_}}).pipe((0,g._b)(w=>{let J=w.data.items;return this.patchState({contractKinds:J}),J},w=>this.patchState({errors:w.graphQLErrors?w.graphQLErrors:w})),(0,he.U)(w=>w.data.items)),this.filterVisitKinds=_=>this.data.userSelectVisitKinds({input:{name:_}}).pipe((0,g._b)(w=>{let J=w.data.items;return this.patchState({visitKinds:J}),J},w=>this.patchState({errors:w.graphQLErrors?w.graphQLErrors:w})),(0,he.U)(w=>w.data.items)),this.filterClinicalProviders=_=>this.data.userSelectClinicalProviders({input:{name:_}}).pipe((0,g._b)(w=>{let J=w.data.items;return this.patchState({clinicalProviders:J}),J},w=>this.patchState({errors:w.graphQLErrors?w.graphQLErrors:w})),(0,he.U)(w=>w.data.items)),this.filterSpecialties=_=>this.data.userSelectSpecialties({input:{name:_}}).pipe((0,g._b)(w=>{let J=w.data.items;return this.patchState({specialties:J}),J},w=>this.patchState({errors:w.graphQLErrors?w.graphQLErrors:w})),(0,he.U)(w=>w.data.items)),this.addContract=this.updater((_,w)=>Object.assign(Object.assign({},_),{contracts:_.contracts.concat(w)})),this.addContractedRateKind=this.updater((_,w)=>Object.assign(Object.assign({},_),{contractedRateKinds:_.contractedRateKinds.concat(w)})),this.addContractKind=this.updater((_,w)=>Object.assign(Object.assign({},_),{contractKinds:_.contractKinds.concat(w)})),this.addVisitKind=this.updater((_,w)=>Object.assign(Object.assign({},_),{visitKinds:_.visitKinds.concat(w)})),this.addClinicalProvider=this.updater((_,w)=>Object.assign(Object.assign({},_),{clinicalProviders:_.clinicalProviders.concat(w)})),this.addSpecialty=this.updater((_,w)=>Object.assign(Object.assign({},_),{specialties:_.specialties.concat(w)})),this.setItem=this.updater((_,w)=>Object.assign(Object.assign({},_),{item:w})),this.addNewContractedRate=this.updater((_,w)=>Object.assign(Object.assign({},_),{contractedRates:[..._.contractedRates,w]})),this.updateContractedRate=this.updater((_,w)=>Object.assign(Object.assign({},_),{contractedRates:_.contractedRates.map(J=>J.id===w.id?w:J)})),this.addContractedRates=this.updater((_,w)=>Object.assign(Object.assign({},_),{contractedRates:_.contractedRates.concat(w)})),this.updateContractedRates=this.updater((_,w)=>Object.assign(Object.assign({},_),{contractedRates:_.contractedRates.map(J=>w.find(ve=>ve.id===J.id)||J)})),this.setSearchQuery=this.updater((_,w)=>Object.assign(Object.assign({},_),{searchQuery:w})),this.loadContractedRateEffect=this.effect(_=>_.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(w=>this.data.userContractedRate({contractedRateId:w}).pipe((0,g._b)(J=>{this.patchState({item:J.data.item,errors:J.errors,loading:!1})},J=>this.patchState({loading:!1,errors:J.graphQLErrors?J.graphQLErrors:J})))))),this.loadContractedRatesEffect=this.effect(_=>_.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([w,J])=>this.data.userContractedRates({input:J}).pipe((0,g._b)(_e=>this.patchState({paging:{limit:J.limit,skip:J.skip,total:_e.data.count.total},contractedRates:_e.data.items,errors:_e.errors,loading:!1}),_e=>this.patchState({loading:!1,errors:_e.graphQLErrors?_e.graphQLErrors:_e})))))),this.createContractedRateEffect=this.effect(_=>_.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(w=>this.contractedRateService.createContractedRate(Object.assign({},w)).pipe((0,g._b)(J=>{this.addNewContractedRate(J),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:J,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},J=>{J.graphQLErrors?(this.toast.error(J.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:J.graphQLErrors?J.graphQLErrors:J})):(this.toast.error(J.Message),this.formService.setErrors(J.Data))}))))),this.updateContractedRateEffect=this.effect(_=>_.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([w,J])=>this.contractedRateService.updateContractedRate(w,w.id).pipe((0,g._b)(_e=>{this.updateContractedRate(_e),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:_e,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},_e=>{_e.graphQLErrors?(this.toast.error(_e.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:_e.graphQLErrors?_e.graphQLErrors:_e})):(this.toast.error(_e.Message),this.formService.setErrors(_e.Data))}))))),this.deleteContractedRateEffect=this.effect(_=>_.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([w,J])=>this.data.userDeleteContractedRate({contractedRateId:J.id}).pipe((0,g._b)(_e=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:_e.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},_e=>{_e.graphQLErrors?(this.toast.error(_e.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:_e.graphQLErrors?_e.graphQLErrors:_e})):(this.toast.error(_e.Message),this.formService.setErrors(_e.Data))}))))),this.importExcelEffect=this.effect(_=>_.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(w=>this.contractedRateService.importContractedRates(w).pipe((0,ce.K)(J=>{var _e;return this.toast.error(null!==(_e=J.Message)&&void 0!==_e?_e:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(J=>{const _e=JSON.parse(J.created),ve=JSON.parse(J.updated),ae=JSON.parse(J.failed),le=_e.length+ve.length+ae.length;this.addContractedRates(_e),this.updateContractedRates(ve),this.toast.success(`${_e.length} created, ${ve.length} updated, ${ae.length} failed of total ${le}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("contractedRateId")?(this.route.snapshot.paramMap.get("contractedRateId"),this.setFormName("contractedRate_edit")):this.setFormName("contractedRate_create"),this.route.snapshot.paramMap.has("contractId")){var c=this.route.snapshot.paramMap.get("contractId");this.setContractId(c)}if(this.route.snapshot.paramMap.has("contractedRateKindId")){var d=this.route.snapshot.paramMap.get("contractedRateKindId");this.setContractedRateKindId(d)}if(this.route.snapshot.paramMap.has("contractKindId")){var n=this.route.snapshot.paramMap.get("contractKindId");this.setContractKindId(n)}if(this.route.snapshot.paramMap.has("visitKindId")){var r=this.route.snapshot.paramMap.get("visitKindId");this.setVisitKindId(r)}if(this.route.snapshot.paramMap.has("clinicalProviderId")){var m=this.route.snapshot.paramMap.get("clinicalProviderId");this.setClinicalProviderId(m)}if(this.route.snapshot.paramMap.has("specialtyId")){var p=this.route.snapshot.paramMap.get("specialtyId");this.setSpecialtyId(p)}}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.contractedRateService.validateContractedRateExcelData(t,i.contracts,i.contractedRateKinds,i.contractKinds,i.visitKinds,i.clinicalProviders,i.specialties)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(VF))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function jF(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.contractedRate)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let hl=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"contractedRate_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({id:null,name:""}),this.store.vm$.subscribe(i=>{this.contractedRate=i.item})):t.formName&&t.formName.currentValue&&"contractedRate_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadContractedRateEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.contractedRate=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(uo),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-contracted-rate-form"]],inputs:{contractedRate:"contractedRate",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,jF,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),fl=(()=>{class s{constructor(){this.autoHeight=!1,this.contractedRates=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[{field:"contract.name",headerName:"Contract",filter:"agTextColumnFilter"},{field:"contractedRateKind.name",headerName:"Contracted Rate Kind",filter:"agTextColumnFilter"},{field:"contractKind.name",headerName:"Contract Kind",filter:"agTextColumnFilter"},{field:"visitKind.name",headerName:"Visit Kind",filter:"agTextColumnFilter"},{field:"clinicalProvider.name",headerName:"Clinical Provider",filter:"agTextColumnFilter"},{field:"specialty.name",headerName:"Specialty",filter:"agTextColumnFilter"},{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{headerName:"Amount",field:"amount",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.amount,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{headerName:"Percentage",field:"percentage",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.percentage,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{headerName:"Reimbursed Rate",field:"reimbursedRate",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.reimbursedRate,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{headerName:"Bill on Behalf",field:"billOnBehalf",filter:"agSetColumnFilter",cellRenderer:"checkboxRenderer"},{field:"contractId",filter:"agTextColumnFilter",hide:!0},{field:"contractedRateKindId",filter:"agTextColumnFilter",hide:!0},{field:"contractKindId",filter:"agTextColumnFilter",hide:!0},{field:"visitKindId",filter:"agTextColumnFilter",hide:!0},{field:"clinicalProviderId",filter:"agTextColumnFilter",hide:!0},{field:"specialtyId",filter:"agTextColumnFilter",hide:!0}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-contracted-rate-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",contractedRates:"contractedRates"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.contractedRates)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function UF(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-contracted-rate-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","contractedRate_edit")("formControl",t.formControl)("contractedRate",t.contractedRate)}}const JF=function(){return{}};function zF(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-contracted-rate-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","contractedRate_create")("formControl",t.formControl)("contractedRate",e.DdM(3,JF))}}function HF(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-contracted-rate-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("contractedRates",o.data.items)}let qF=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadContractedRatesEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.contractedRates$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(uo))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","contractedRate","send","close"],[1,"w-full","h-full","bg-white",3,"contractedRates","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,UF,2,3,"ng-template",null,1,e.W1O),e.YNc(3,zF,1,4,"ng-template",null,2,e.W1O),e.YNc(5,HF,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,hl,fl],encapsulation:2}),s})();function KF(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-contracted-rate-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","contractedRate_edit")("contractedRate",t.value)}}const ZF=function(){return{}};function kF(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-contracted-rate-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","contractedRate_create")("contractedRate",e.DdM(2,ZF))}function BF(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-contracted-rate-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("contractedRates",t.items)}}let YF=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:6,consts:[[3,"data","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","contractedRate","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","contractedRates","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,KF,1,2,"ng-template",null,1,e.W1O),e.YNc(3,kF,1,3,"ng-template",null,2,e.W1O),e.YNc(5,BF,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,hl,fl],encapsulation:2}),s})(),XF=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[uo],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"contracted-rate-select",component:qF,wrappers:["form-field"]},{name:"contracted-rate-grid",component:YF}]})]}),s})(),eP=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[XF]}),s})();class qt extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class tP extends qt{constructor(o){super("ValidateContractKindExcelDataAction"),this.valid=!1,this.excelData=o}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name)}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class iP extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class sP extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new iP("name","The contractkind name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class oP extends qt{constructor(o){super("CreateContractKindAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new sP("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateContractKind({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class aP extends qt{constructor(o){super("UpdateContractKindsAction"),this.contractKinds=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.contractKinds,!0))}performAction(){this.response=this.businessProvider.data.userUpdateContractKinds({input:{contractKinds:this.contractKinds}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class rP extends qt{constructor(o,t){super("UpdateContractKindAction"),this.contractKind=o,this.contractKindId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.contractKind,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.contractKindId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateContractKind({contractKindId:this.contractKindId,input:this.contractKind}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let _l=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.ContractKindBusinessProviderService",t,a),this.data=i}createContractKind(t){const i=new oP(t);return i.Do(this),i.response}updateContractKind(t,i){const a=new rP(t,i);return a.Do(this),a.response}importContractKinds(t){const i=new aP(t);return i.Do(this),i.response}validateContractKindExcelData(t){const i=new tP(t);return i.Do(this),i.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),nP=(()=>{class s extends I.nH{constructor(t,i,a){super("ContractKindService",a,t),this.businessProvider=i}createContractKind(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createContractKind(i)}updateContractKind(t,i){return this.businessProvider.updateContractKind(t,i)}importContractKinds(t){return this.businessProvider.importContractKinds(t)}validateContractKindExcelData(t){return this.businessProvider.validateContractKindExcelData(t)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(_l,8),e.LFG(_l),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),mo=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){super({loading:!1,contractKinds:[],done:!1,searchQuery:"",formName:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.contractKindService=H,this.errors$=this.select(c=>c.errors),this.loading$=this.select(c=>c.loading),this.done$=this.select(c=>c.done),this.item$=this.select(c=>c.item),this.contractKinds$=this.select(c=>c.contractKinds),this.paging$=this.select(c=>c.paging),this.searchQuery$=this.select(c=>c.searchQuery),this.formName$=this.select(c=>c.formName),this.actionResult$=this.select(this.item$,this.done$,(c,d)=>({item:c,done:d}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.contractKinds$,(c,d,n,r,m)=>({errors:c,loading:d,item:n,formName:r,contractKinds:m}),{debounce:!0}),this.input$=this.select(this.paging$,this.searchQuery$,(c,d)=>({limit:c.limit,skip:c.skip,name:d,total:c.total})),this.setFormName=this.updater((c,d)=>Object.assign(Object.assign({},c),{formName:d})),this.setItem=this.updater((c,d)=>Object.assign(Object.assign({},c),{item:d})),this.addNewContractKind=this.updater((c,d)=>Object.assign(Object.assign({},c),{contractKinds:[...c.contractKinds,d]})),this.updateContractKind=this.updater((c,d)=>Object.assign(Object.assign({},c),{contractKinds:c.contractKinds.map(n=>n.id===d.id?d:n)})),this.addContractKinds=this.updater((c,d)=>Object.assign(Object.assign({},c),{contractKinds:c.contractKinds.concat(d)})),this.updateContractKinds=this.updater((c,d)=>Object.assign(Object.assign({},c),{contractKinds:c.contractKinds.map(n=>d.find(m=>m.id===n.id)||n)})),this.setSearchQuery=this.updater((c,d)=>Object.assign(Object.assign({},c),{searchQuery:d})),this.loadContractKindEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.data.userContractKind({contractKindId:d}).pipe((0,g._b)(n=>{this.patchState({item:n.data.item,errors:n.errors,loading:!1})},n=>this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})))))),this.loadContractKindsEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([d,n])=>this.data.userContractKinds({input:n}).pipe((0,g._b)(r=>this.patchState({paging:{limit:n.limit,skip:n.skip,total:r.data.count.total},contractKinds:r.data.items,errors:r.errors,loading:!1}),r=>this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})))))),this.createContractKindEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.contractKindService.createContractKind(Object.assign({},d)).pipe((0,g._b)(n=>{this.addNewContractKind(n),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:n,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},n=>{n.graphQLErrors?(this.toast.error(n.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})):(this.toast.error(n.Message),this.formService.setErrors(n.Data))}))))),this.updateContractKindEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.contractKindService.updateContractKind(d,d.id).pipe((0,g._b)(r=>{this.updateContractKind(r),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:r,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.deleteContractKindEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.data.userDeleteContractKind({contractKindId:n.id}).pipe((0,g._b)(r=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:r.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.importExcelEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.contractKindService.importContractKinds(d).pipe((0,ce.K)(n=>{var r;return this.toast.error(null!==(r=n.Message)&&void 0!==r?r:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(n=>{const r=JSON.parse(n.created),m=JSON.parse(n.updated),p=JSON.parse(n.failed),_=r.length+m.length+p.length;this.addContractKinds(r),this.updateContractKinds(m),this.toast.success(`${r.length} created, ${m.length} updated, ${p.length} failed of total ${_}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("contractKindId")?(this.route.snapshot.paramMap.get("contractKindId"),this.setFormName("contractKind_edit")):this.setFormName("contractKind_create")}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.contractKindService.validateContractKindExcelData(t)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(nP))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function lP(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.contractKind)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let gl=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"contractKind_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.contractKind=i.item})):t.formName&&t.formName.currentValue&&"contractKind_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadContractKindEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.contractKind=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(mo),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-contract-kind-form"]],inputs:{contractKind:"contractKind",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,lP,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),Cl=(()=>{class s{constructor(){this.autoHeight=!1,this.contractKinds=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[,{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-contract-kind-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",contractKinds:"contractKinds"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.contractKinds)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function cP(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-contract-kind-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","contractKind_edit")("formControl",t.formControl)("contractKind",t.contractKind)}}const dP=function(){return{}};function uP(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-contract-kind-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","contractKind_create")("formControl",t.formControl)("contractKind",e.DdM(3,dP))}}function mP(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-contract-kind-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("contractKinds",o.data.items)}let pP=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadContractKindsEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.contractKinds$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(mo))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","contractKind","send","close"],[1,"w-full","h-full","bg-white",3,"contractKinds","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,cP,2,3,"ng-template",null,1,e.W1O),e.YNc(3,uP,1,4,"ng-template",null,2,e.W1O),e.YNc(5,mP,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,gl,Cl],encapsulation:2}),s})();function hP(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-contract-kind-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","contractKind_edit")("contractKind",t.value)}}const fP=function(){return{}};function _P(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-contract-kind-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","contractKind_create")("contractKind",e.DdM(2,fP))}function gP(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-contract-kind-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("contractKinds",t.items)}}let CP=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","contractKind","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","contractKinds","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,hP,1,2,"ng-template",null,1,e.W1O),e.YNc(3,_P,1,3,"ng-template",null,2,e.W1O),e.YNc(5,gP,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,gl,Cl],encapsulation:2}),s})(),vP=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[mo],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"contract-kind-select",component:pP,wrappers:["form-field"]},{name:"contract-kind-grid",component:CP}]})]}),s})(),SP=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[vP]}),s})();class Ze extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class bP extends Ze{constructor(o,t,i,a,l,u,H,A){super("ValidateContractExcelDataAction"),this.valid=!1,this.excelData=o,this.organizations=t,this.billingOrganizations=i,this.templates=a,this.vendors=l,this.reconciliationPeriodTypes=u,this.calculationBasisTypes=H,this.processes=A}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name),this.validationContext.addRule(new f.mi(`organizationName_${i}_is_valid}`,"Organization Is Not Valid","organization.name",t.organization,this.organizations,!0)),this.validationContext.addRule(new f.mi(`billingOrganizationName_${i}_is_valid}`,"Billing Organization Is Not Valid","billingOrganization.name",t.billingOrganization,this.billingOrganizations,!0)),this.validationContext.addRule(new f.mi(`templateName_${i}_is_valid}`,"Template Is Not Valid","template.name",t.template,this.templates,!0)),this.validationContext.addRule(new f.mi(`vendorName_${i}_is_valid}`,"Vendor Is Not Valid","vendor.name",t.vendor,this.vendors,!0)),this.validationContext.addRule(new f.mi(`reconciliationPeriodTypeName_${i}_is_valid}`,"Reconciliation Period Type Is Not Valid","reconciliationPeriodType.name",t.reconciliationPeriodType,this.reconciliationPeriodTypes,!0)),this.validationContext.addRule(new f.mi(`calculationBasisTypeName_${i}_is_valid}`,"Calculation Basis Type Is Not Valid","calculationBasisType.name",t.calculationBasisType,this.calculationBasisTypes,!0)),this.validationContext.addRule(new f.mi(`processName_${i}_is_valid}`,"Process Is Not Valid","process.name",t.process,this.processes,!0))}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class TP extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class yP extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new TP("name","The contract name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class wP extends Ze{constructor(o){super("CreateContractAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new yP("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateContract({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class xP extends Ze{constructor(o){super("UpdateContractsAction"),this.contracts=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.contracts,!0))}performAction(){this.response=this.businessProvider.data.userUpdateContracts({input:{contracts:this.contracts}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class NP extends Ze{constructor(o,t){super("UpdateContractAction"),this.contract=o,this.contractId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.contract,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.contractId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateContract({contractId:this.contractId,input:this.contract}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}const vl=["name","organization","vendor","billingOrganization","reconciliationPeriodType","calculationBasisType","process"];class AP extends Ze{constructor(o){super("CheckRequiredFieldsAction"),this.excelData=o,console.log(o)}preValidateAction(){this.excelData.map((o,t)=>{this.validationContext.addRule(new f.r7(`row_${t}_is_valid`,`Row ${t} is not valid`,o,vl,!0))})}finish(){super.finish();let o=[];const t=[];this.validationContext.hasRuleViolations()?this.validationContext.rules.map(i=>{i instanceof f.r7&&(i.isValid?o.push(i.target):t.push(i.target))}):o=this.excelData,this.response=(0,F.of)({data:o,badData:t,requiredFields:vl})}}let Sl=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.ContractBusinessProviderService",t,a),this.data=i}createContract(t){const i=new wP(t);return i.Do(this),i.response}updateContract(t,i){const a=new NP(t,i);return a.Do(this),a.response}importContracts(t){const i=new xP(t);return i.Do(this),i.response}validateRequredFields(t){const i=new AP(t);return i.Do(this),i.response}validateContractExcelData(t,i,a,l,u,H,A,c){const d=new bP(t,i,a,l,u,H,A,c);return d.Do(this),d.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),FP=(()=>{class s extends I.nH{constructor(t,i,a){super("ContractService",a,t),this.businessProvider=i}createContract(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createContract(i)}updateContract(t,i){return this.businessProvider.updateContract(t,i)}importContracts(t){return this.businessProvider.importContracts(t)}checkRequiredFields(t){return this.businessProvider.validateRequredFields(t)}validateContractExcelData(t,i,a,l,u,H,A,c){return this.businessProvider.validateContractExcelData(t,i,a,l,u,H,A,c)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(Sl,8),e.LFG(Sl),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),po=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){if(super({loading:!1,contracts:[],done:!1,searchQuery:"",formName:void 0,organizationId:void 0,billingOrganizationId:void 0,templateId:void 0,vendorId:void 0,reconciliationPeriodTypeId:void 0,calculationBasisTypeId:void 0,processId:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.contractService=H,this.errors$=this.select(A=>A.errors),this.loading$=this.select(A=>A.loading),this.done$=this.select(A=>A.done),this.item$=this.select(A=>A.item),this.contracts$=this.select(A=>A.contracts),this.organizations$=this.select(A=>A.organizations||[]),this.templates$=this.select(A=>A.templates||[]),this.vendors$=this.select(A=>A.vendors||[]),this.reconciliationPeriodTypes$=this.select(A=>A.reconciliationPeriodTypes||[]),this.calculationBasisTypes$=this.select(A=>A.calculationBasisTypes||[]),this.processes$=this.select(A=>A.processes||[]),this.organizationId$=this.select(A=>A.organizationId),this.billingOrganizationId$=this.select(A=>A.billingOrganizationId),this.templateId$=this.select(A=>A.templateId),this.vendorId$=this.select(A=>A.vendorId),this.reconciliationPeriodTypeId$=this.select(A=>A.reconciliationPeriodTypeId),this.calculationBasisTypeId$=this.select(A=>A.calculationBasisTypeId),this.processId$=this.select(A=>A.processId),this.paging$=this.select(A=>A.paging),this.searchQuery$=this.select(A=>A.searchQuery),this.formName$=this.select(A=>A.formName),this.actionResult$=this.select(this.item$,this.done$,(A,c)=>({item:A,done:c}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.contracts$,this.organizations$,this.templates$,this.vendors$,this.reconciliationPeriodTypes$,this.calculationBasisTypes$,this.processes$,(A,c,d,n,r,m,p,_,w,J,_e)=>({errors:A,loading:c,item:d,formName:n,contracts:r,organizations:m,templates:p,vendors:_,reconciliationPeriodTypes:w,calculationBasisTypes:J,processes:_e}),{debounce:!0}),this.input$=this.select(this.paging$,this.organizationId$,this.billingOrganizationId$,this.templateId$,this.vendorId$,this.reconciliationPeriodTypeId$,this.calculationBasisTypeId$,this.processId$,this.searchQuery$,(A,c,d,n,r,m,p,_,w)=>({limit:A.limit,skip:A.skip,name:w,organizationId:c,billingOrganizationId:d,templateId:n,vendorId:r,reconciliationPeriodTypeId:m,calculationBasisTypeId:p,processId:_,total:A.total})),this.setFormName=this.updater((A,c)=>Object.assign(Object.assign({},A),{formName:c})),this.setOrganizationId=this.updater((A,c)=>Object.assign(Object.assign({},A),{organizationId:c})),this.setBillingOrganizationId=this.updater((A,c)=>Object.assign(Object.assign({},A),{billingOrganizationId:c})),this.setTemplateId=this.updater((A,c)=>Object.assign(Object.assign({},A),{templateId:c})),this.setVendorId=this.updater((A,c)=>Object.assign(Object.assign({},A),{vendorId:c})),this.setReconciliationPeriodTypeId=this.updater((A,c)=>Object.assign(Object.assign({},A),{reconciliationPeriodTypeId:c})),this.setCalculationBasisTypeId=this.updater((A,c)=>Object.assign(Object.assign({},A),{calculationBasisTypeId:c})),this.setProcessId=this.updater((A,c)=>Object.assign(Object.assign({},A),{processId:c})),this.filterOrganizations=A=>this.data.userSelectOrganizations({input:{name:A,limit:1e3}}).pipe((0,g._b)(c=>{const d=c.data.items;return this.patchState({organizations:d}),d},c=>this.patchState({errors:c.graphQLErrors?c.graphQLErrors:c})),(0,he.U)(c=>c.data.items)),this.filterTemplates=A=>this.data.userSelectTemplates({input:{name:A}}).pipe((0,g._b)(c=>{const d=c.data.items;return this.patchState({templates:d}),d},c=>this.patchState({errors:c.graphQLErrors?c.graphQLErrors:c})),(0,he.U)(c=>c.data.items)),this.filterVendors=A=>this.data.userSelectVendors({input:{name:A}}).pipe((0,g._b)(c=>{const d=c.data.items;return this.patchState({vendors:d}),d},c=>this.patchState({errors:c.graphQLErrors?c.graphQLErrors:c})),(0,he.U)(c=>c.data.items)),this.filterReconciliationPeriodTypes=A=>this.data.userSelectReconciliationPeriodTypes({input:{name:A}}).pipe((0,g._b)(c=>{const d=c.data.items;return this.patchState({reconciliationPeriodTypes:d}),d},c=>this.patchState({errors:c.graphQLErrors?c.graphQLErrors:c})),(0,he.U)(c=>c.data.items)),this.filterCalculationBasisTypes=A=>this.data.userSelectCalculationBasisTypes({input:{name:A}}).pipe((0,g._b)(c=>{const d=c.data.items;return this.patchState({calculationBasisTypes:d}),d},c=>this.patchState({errors:c.graphQLErrors?c.graphQLErrors:c})),(0,he.U)(c=>c.data.items)),this.filterProcesses=A=>this.data.userSelectProcesses({input:{name:A}}).pipe((0,g._b)(c=>{const d=c.data.items;return this.patchState({processes:d}),d},c=>this.patchState({errors:c.graphQLErrors?c.graphQLErrors:c})),(0,he.U)(c=>c.data.items)),this.addOrganization=this.updater((A,c)=>Object.assign(Object.assign({},A),{organizations:A.organizations.concat(c)})),this.addTemplate=this.updater((A,c)=>Object.assign(Object.assign({},A),{templates:A.templates.concat(c)})),this.addVendor=this.updater((A,c)=>Object.assign(Object.assign({},A),{vendors:A.vendors.concat(c)})),this.addReconciliationPeriodType=this.updater((A,c)=>Object.assign(Object.assign({},A),{reconciliationPeriodTypes:A.reconciliationPeriodTypes.concat(c)})),this.addCalculationBasisType=this.updater((A,c)=>Object.assign(Object.assign({},A),{calculationBasisTypes:A.calculationBasisTypes.concat(c)})),this.addProcess=this.updater((A,c)=>Object.assign(Object.assign({},A),{processes:A.processes.concat(c)})),this.setItem=this.updater((A,c)=>Object.assign(Object.assign({},A),{item:c})),this.addNewContract=this.updater((A,c)=>Object.assign(Object.assign({},A),{contracts:[...A.contracts,c]})),this.updateContract=this.updater((A,c)=>Object.assign(Object.assign({},A),{contracts:A.contracts.map(d=>d.id===c.id?c:d)})),this.addContracts=this.updater((A,c)=>Object.assign(Object.assign({},A),{contracts:A.contracts.concat(c)})),this.updateContracts=this.updater((A,c)=>Object.assign(Object.assign({},A),{contracts:A.contracts.map(d=>c.find(r=>r.id===d.id)||d)})),this.setSearchQuery=this.updater((A,c)=>Object.assign(Object.assign({},A),{searchQuery:c})),this.loadContractEffect=this.effect(A=>A.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(c=>this.data.userContract({contractId:c}).pipe((0,g._b)(d=>{this.patchState({item:d.data.item,errors:d.errors,loading:!1})},d=>this.patchState({loading:!1,errors:d.graphQLErrors?d.graphQLErrors:d})))))),this.loadContractsEffect=this.effect(A=>A.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([c,d])=>this.data.userContracts({input:d}).pipe((0,g._b)(n=>this.patchState({paging:{limit:d.limit,skip:d.skip,total:n.data.count.total},contracts:n.data.items,errors:n.errors,loading:!1}),n=>this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})))))),this.createContractEffect=this.effect(A=>A.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(c=>this.contractService.createContract(Object.assign({},c)).pipe((0,g._b)(d=>{this.addNewContract(d),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:d,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},d=>{d.graphQLErrors?(this.toast.error(d.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:d.graphQLErrors?d.graphQLErrors:d})):(this.toast.error(d.Message),this.formService.setErrors(d.Data))}))))),this.updateContractEffect=this.effect(A=>A.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([c,d])=>this.contractService.updateContract(c,c.id).pipe((0,g._b)(n=>{this.updateContract(n),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:n,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},n=>{n.graphQLErrors?(this.toast.error(n.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})):(this.toast.error(n.Message),this.formService.setErrors(n.Data))}))))),this.deleteContractEffect=this.effect(A=>A.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([c,d])=>this.data.userDeleteContract({contractId:d.id}).pipe((0,g._b)(n=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:n.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},n=>{n.graphQLErrors?(this.toast.error(n.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})):(this.toast.error(n.Message),this.formService.setErrors(n.Data))}))))),this.importExcelEffect=this.effect(A=>A.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(c=>this.contractService.importContracts(c).pipe((0,ce.K)(d=>{var n;return this.toast.error(null!==(n=d.Message)&&void 0!==n?n:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(d=>{const n=JSON.parse(d.created),r=JSON.parse(d.updated),m=JSON.parse(d.failed),p=n.length+r.length+m.length;this.addContracts(n),this.updateContracts(r),this.toast.success(`${n.length} created, ${r.length} updated, ${m.length} failed of total ${p}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("contractId")?(this.route.snapshot.paramMap.get("contractId"),this.setFormName("contract_edit")):this.setFormName("contract_create"),this.route.snapshot.paramMap.has("organizationId")){const A=this.route.snapshot.paramMap.get("organizationId");this.setOrganizationId(A)}if(this.route.snapshot.paramMap.has("billingOrganizationId")){const A=this.route.snapshot.paramMap.get("billingOrganizationId");this.setBillingOrganizationId(A)}if(this.route.snapshot.paramMap.has("templateId")){const A=this.route.snapshot.paramMap.get("templateId");this.setTemplateId(A)}if(this.route.snapshot.paramMap.has("vendorId")){const A=this.route.snapshot.paramMap.get("vendorId");this.setVendorId(A)}if(this.route.snapshot.paramMap.has("reconciliationPeriodTypeId")){const A=this.route.snapshot.paramMap.get("reconciliationPeriodTypeId");this.setReconciliationPeriodTypeId(A)}if(this.route.snapshot.paramMap.has("calculationBasisTypeId")){const A=this.route.snapshot.paramMap.get("calculationBasisTypeId");this.setCalculationBasisTypeId(A)}if(this.route.snapshot.paramMap.has("processId")){const A=this.route.snapshot.paramMap.get("processId");this.setProcessId(A)}}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.contractService.checkRequiredFields(t).pipe((0,h.w)(({data:a,badData:l,requiredFields:u})=>(l?.length>0&&this.toast.error(`${l.length} rows do not have all required fields. All rows should contain ${u.join(", ")}`,{duration:3e3}),this.contractService.validateContractExcelData(a,i.organizations,i.organizations,i.templates,i.vendors,i.reconciliationPeriodTypes,i.calculationBasisTypes,i.processes))))))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(FP))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function PP(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.contract)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let bl=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"contract_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.contract=i.item})):t.formName&&t.formName.currentValue&&"contract_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadContractEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.contract=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(po),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-contract-form"]],inputs:{contract:"contract",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,PP,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),Tl=(()=>{class s{constructor(){this.autoHeight=!1,this.contracts=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[{field:"organization.name",headerName:"Organization",filter:"agTextColumnFilter"},{field:"billingOrganization.name",headerName:"Billing Organization",filter:"agTextColumnFilter"},{field:"template.name",headerName:"Template",filter:"agTextColumnFilter"},{field:"vendor.name",headerName:"Vendor",filter:"agTextColumnFilter"},{field:"reconciliationPeriodType.name",headerName:"Reconciliation Period Type",filter:"agTextColumnFilter"},{field:"calculationBasisType.name",headerName:"Calculation Basis Type",filter:"agTextColumnFilter"},{field:"process.name",headerName:"Process",filter:"agTextColumnFilter"},{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{field:"organizationId",filter:"agTextColumnFilter",hide:!0},{field:"billingOrganizationId",filter:"agTextColumnFilter",hide:!0},{field:"templateId",filter:"agTextColumnFilter",hide:!0},{headerName:"Bill on Behalf",field:"billOnBehalf",filter:"agSetColumnFilter",cellRenderer:"checkboxRenderer"},{field:"billRate",filter:"agTextColumnFilter"},{field:"vendorId",filter:"agTextColumnFilter",hide:!0},{field:"contractDate",filter:"agDateColumnFilter"},{field:"maturityDate",filter:"agDateColumnFilter"},{headerName:"Requires Tpa Medical Necessity",field:"requiresTpaMedicalNecessity",filter:"agSetColumnFilter",cellRenderer:"checkboxRenderer"},{headerName:"Requires Tpa Medicare Allowable",field:"requiresTpaMedicareAllowable",filter:"agSetColumnFilter",cellRenderer:"checkboxRenderer"},{field:"reconciliationPeriodTypeId",filter:"agTextColumnFilter",hide:!0},{field:"calculationBasisTypeId",filter:"agTextColumnFilter",hide:!0},{headerName:"Signed",field:"signed",filter:"agSetColumnFilter",cellRenderer:"checkboxRenderer"},{field:"processId",filter:"agTextColumnFilter",hide:!0}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-contract-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",contracts:"contracts"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.contracts)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function IP(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-contract-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","contract_edit")("formControl",t.formControl)("contract",t.contract)}}const DP=function(){return{}};function MP(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-contract-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","contract_create")("formControl",t.formControl)("contract",e.DdM(3,DP))}}function WP(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-contract-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("contracts",o.data.items)}let EP=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadContractsEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.contracts$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(po))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","contract","send","close"],[1,"w-full","h-full","bg-white",3,"contracts","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,IP,2,3,"ng-template",null,1,e.W1O),e.YNc(3,MP,1,4,"ng-template",null,2,e.W1O),e.YNc(5,WP,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,bl,Tl],encapsulation:2}),s})();function OP(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-contract-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","contract_edit")("contract",t.value)}}const LP=function(){return{}};function $P(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-contract-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","contract_create")("contract",e.DdM(2,LP))}function GP(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-contract-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("contracts",t.items)}}let RP=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","contract","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","contracts","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,OP,1,2,"ng-template",null,1,e.W1O),e.YNc(3,$P,1,3,"ng-template",null,2,e.W1O),e.YNc(5,GP,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,bl,Tl],encapsulation:2}),s})(),QP=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[po],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"contract-select",component:EP,wrappers:["form-field"]},{name:"contract-grid",component:RP}]})]}),s})(),VP=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[QP]}),s})();class Kt extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class jP extends Kt{constructor(o,t){super("ValidateContractTermExcelDataAction"),this.valid=!1,this.excelData=o,this.contracts=t}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name),this.validationContext.addRule(new f.mi(`contractName_${i}_is_valid}`,"Contract Is Not Valid","contract.name",t.contract,this.contracts,!0))}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class UP extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class JP extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new UP("name","The contractterm name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class zP extends Kt{constructor(o){super("CreateContractTermAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new JP("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateContractTerm({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class HP extends Kt{constructor(o){super("UpdateContractTermsAction"),this.contractTerms=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.contractTerms,!0))}performAction(){this.response=this.businessProvider.data.userUpdateContractTerms({input:{contractTerms:this.contractTerms}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class qP extends Kt{constructor(o,t){super("UpdateContractTermAction"),this.contractTerm=o,this.contractTermId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.contractTerm,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.contractTermId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateContractTerm({contractTermId:this.contractTermId,input:this.contractTerm}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let yl=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.ContractTermBusinessProviderService",t,a),this.data=i}createContractTerm(t){const i=new zP(t);return i.Do(this),i.response}updateContractTerm(t,i){const a=new qP(t,i);return a.Do(this),a.response}importContractTerms(t){const i=new HP(t);return i.Do(this),i.response}validateContractTermExcelData(t,i){const a=new jP(t,i);return a.Do(this),a.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),KP=(()=>{class s extends I.nH{constructor(t,i,a){super("ContractTermService",a,t),this.businessProvider=i}createContractTerm(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createContractTerm(i)}updateContractTerm(t,i){return this.businessProvider.updateContractTerm(t,i)}importContractTerms(t){return this.businessProvider.importContractTerms(t)}validateContractTermExcelData(t,i){return this.businessProvider.validateContractTermExcelData(t,i)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(yl,8),e.LFG(yl),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),ho=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){if(super({loading:!1,contractTerms:[],done:!1,searchQuery:"",formName:void 0,contractTermId:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.contractTermService=H,this.errors$=this.select(c=>c.errors),this.loading$=this.select(c=>c.loading),this.done$=this.select(c=>c.done),this.item$=this.select(c=>c.item),this.contractTerms$=this.select(c=>c.contractTerms),this.contracts$=this.select(c=>c.contracts||[]),this.contractTermId$=this.select(c=>c.contractTermId),this.paging$=this.select(c=>c.paging),this.searchQuery$=this.select(c=>c.searchQuery),this.formName$=this.select(c=>c.formName),this.actionResult$=this.select(this.item$,this.done$,(c,d)=>({item:c,done:d}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.contractTerms$,this.contracts$,(c,d,n,r,m,p)=>({errors:c,loading:d,item:n,formName:r,contractTerms:m,contracts:p}),{debounce:!0}),this.input$=this.select(this.paging$,this.contractTermId$,this.searchQuery$,(c,d,n)=>({limit:c.limit,skip:c.skip,name:n,contractTermId:d,total:c.total})),this.setFormName=this.updater((c,d)=>Object.assign(Object.assign({},c),{formName:d})),this.setContractTermId=this.updater((c,d)=>Object.assign(Object.assign({},c),{contractTermId:d})),this.filterContracts=c=>this.data.userSelectContracts({input:{name:c}}).pipe((0,g._b)(d=>{let n=d.data.items;return this.patchState({contracts:n}),n},d=>this.patchState({errors:d.graphQLErrors?d.graphQLErrors:d})),(0,he.U)(d=>d.data.items)),this.addContract=this.updater((c,d)=>Object.assign(Object.assign({},c),{contracts:c.contracts.concat(d)})),this.setItem=this.updater((c,d)=>Object.assign(Object.assign({},c),{item:d})),this.addNewContractTerm=this.updater((c,d)=>Object.assign(Object.assign({},c),{contractTerms:[...c.contractTerms,d]})),this.updateContractTerm=this.updater((c,d)=>Object.assign(Object.assign({},c),{contractTerms:c.contractTerms.map(n=>n.id===d.id?d:n)})),this.addContractTerms=this.updater((c,d)=>Object.assign(Object.assign({},c),{contractTerms:c.contractTerms.concat(d)})),this.updateContractTerms=this.updater((c,d)=>Object.assign(Object.assign({},c),{contractTerms:c.contractTerms.map(n=>d.find(m=>m.id===n.id)||n)})),this.setSearchQuery=this.updater((c,d)=>Object.assign(Object.assign({},c),{searchQuery:d})),this.loadContractTermEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.data.userContractTerm({contractTermId:d}).pipe((0,g._b)(n=>{this.patchState({item:n.data.item,errors:n.errors,loading:!1})},n=>this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})))))),this.loadContractTermsEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([d,n])=>this.data.userContractTerms({input:n}).pipe((0,g._b)(r=>this.patchState({paging:{limit:n.limit,skip:n.skip,total:r.data.count.total},contractTerms:r.data.items,errors:r.errors,loading:!1}),r=>this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})))))),this.createContractTermEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.contractTermService.createContractTerm(Object.assign({},d)).pipe((0,g._b)(n=>{this.addNewContractTerm(n),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:n,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},n=>{n.graphQLErrors?(this.toast.error(n.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})):(this.toast.error(n.Message),this.formService.setErrors(n.Data))}))))),this.updateContractTermEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.contractTermService.updateContractTerm(d,d.id).pipe((0,g._b)(r=>{this.updateContractTerm(r),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:r,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.deleteContractTermEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.data.userDeleteContractTerm({contractTermId:n.id}).pipe((0,g._b)(r=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:r.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.importExcelEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.contractTermService.importContractTerms(d).pipe((0,ce.K)(n=>{var r;return this.toast.error(null!==(r=n.Message)&&void 0!==r?r:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(n=>{const r=JSON.parse(n.created),m=JSON.parse(n.updated),p=JSON.parse(n.failed),_=r.length+m.length+p.length;this.addContractTerms(r),this.updateContractTerms(m),this.toast.success(`${r.length} created, ${m.length} updated, ${p.length} failed of total ${_}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("contractTermId")){var A=this.route.snapshot.paramMap.get("contractTermId");this.setFormName("contractTerm_edit")}else this.setFormName("contractTerm_create");this.route.snapshot.paramMap.has("contractTermId")&&(A=this.route.snapshot.paramMap.get("contractTermId"),this.setContractTermId(A))}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.contractTermService.validateContractTermExcelData(t,i.contracts)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(KP))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function ZP(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.contractTerm)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let wl=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"contractTerm_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.contractTerm=i.item})):t.formName&&t.formName.currentValue&&"contractTerm_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadContractTermEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.contractTerm=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(ho),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-contract-term-form"]],inputs:{contractTerm:"contractTerm",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,ZP,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),xl=(()=>{class s{constructor(){this.autoHeight=!1,this.contractTerms=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[{field:"contract.name",headerName:"Contract",filter:"agTextColumnFilter"},{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{headerName:"Max Approved",field:"maxApproved",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.maxApproved,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{headerName:"Number Included",field:"numberIncluded",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.numberIncluded,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{headerName:"Factor",field:"factor",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.factor,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{field:"contractTermId",filter:"agTextColumnFilter",hide:!0}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-contract-term-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",contractTerms:"contractTerms"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.contractTerms)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function kP(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-contract-term-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","contractTerm_edit")("formControl",t.formControl)("contractTerm",t.contractTerm)}}const BP=function(){return{}};function YP(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-contract-term-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","contractTerm_create")("formControl",t.formControl)("contractTerm",e.DdM(3,BP))}}function XP(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-contract-term-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("contractTerms",o.data.items)}let eI=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadContractTermsEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.contractTerms$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(ho))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","contractTerm","send","close"],[1,"w-full","h-full","bg-white",3,"contractTerms","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,kP,2,3,"ng-template",null,1,e.W1O),e.YNc(3,YP,1,4,"ng-template",null,2,e.W1O),e.YNc(5,XP,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,wl,xl],encapsulation:2}),s})();function tI(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-contract-term-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","contractTerm_edit")("contractTerm",t.value)}}const iI=function(){return{}};function sI(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-contract-term-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","contractTerm_create")("contractTerm",e.DdM(2,iI))}function oI(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-contract-term-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("contractTerms",t.items)}}let aI=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","contractTerm","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","contractTerms","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,tI,1,2,"ng-template",null,1,e.W1O),e.YNc(3,sI,1,3,"ng-template",null,2,e.W1O),e.YNc(5,oI,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,wl,xl],encapsulation:2}),s})(),rI=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[ho],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"contract-term-select",component:eI,wrappers:["form-field"]},{name:"contract-term-grid",component:aI}]})]}),s})(),nI=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[rI]}),s})();class Zt extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class lI extends Zt{constructor(o){super("ValidateCostCategoryExcelDataAction"),this.valid=!1,this.excelData=o}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name)}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class cI extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class dI extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new cI("name","The costcategory name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class uI extends Zt{constructor(o){super("CreateCostCategoryAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new dI("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateCostCategory({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class mI extends Zt{constructor(o){super("UpdateCostCategoriesAction"),this.costCategories=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.costCategories,!0))}performAction(){this.response=this.businessProvider.data.userUpdateCostCategories({input:{costCategories:this.costCategories}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class pI extends Zt{constructor(o,t){super("UpdateCostCategoryAction"),this.costCategory=o,this.costCategoryId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.costCategory,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.costCategoryId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateCostCategory({costCategoryId:this.costCategoryId,input:this.costCategory}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let Nl=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.CostCategoryBusinessProviderService",t,a),this.data=i}createCostCategory(t){const i=new uI(t);return i.Do(this),i.response}updateCostCategory(t,i){const a=new pI(t,i);return a.Do(this),a.response}importCostCategories(t){const i=new mI(t);return i.Do(this),i.response}validateCostCategoryExcelData(t){const i=new lI(t);return i.Do(this),i.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),hI=(()=>{class s extends I.nH{constructor(t,i,a){super("CostCategoryService",a,t),this.businessProvider=i}createCostCategory(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createCostCategory(i)}updateCostCategory(t,i){return this.businessProvider.updateCostCategory(t,i)}importCostCategories(t){return this.businessProvider.importCostCategories(t)}validateCostCategoryExcelData(t){return this.businessProvider.validateCostCategoryExcelData(t)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(Nl,8),e.LFG(Nl),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),fo=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){super({loading:!1,costCategories:[],done:!1,searchQuery:"",formName:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.costCategoryService=H,this.errors$=this.select(c=>c.errors),this.loading$=this.select(c=>c.loading),this.done$=this.select(c=>c.done),this.item$=this.select(c=>c.item),this.costCategories$=this.select(c=>c.costCategories),this.paging$=this.select(c=>c.paging),this.searchQuery$=this.select(c=>c.searchQuery),this.formName$=this.select(c=>c.formName),this.actionResult$=this.select(this.item$,this.done$,(c,d)=>({item:c,done:d}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.costCategories$,(c,d,n,r,m)=>({errors:c,loading:d,item:n,formName:r,costCategories:m}),{debounce:!0}),this.input$=this.select(this.paging$,this.searchQuery$,(c,d)=>({limit:c.limit,skip:c.skip,name:d,total:c.total})),this.setFormName=this.updater((c,d)=>Object.assign(Object.assign({},c),{formName:d})),this.setItem=this.updater((c,d)=>Object.assign(Object.assign({},c),{item:d})),this.addNewCostCategory=this.updater((c,d)=>Object.assign(Object.assign({},c),{costCategories:[...c.costCategories,d]})),this.updateCostCategory=this.updater((c,d)=>Object.assign(Object.assign({},c),{costCategories:c.costCategories.map(n=>n.id===d.id?d:n)})),this.addCostCategories=this.updater((c,d)=>Object.assign(Object.assign({},c),{costCategories:c.costCategories.concat(d)})),this.updateCostCategories=this.updater((c,d)=>Object.assign(Object.assign({},c),{costCategories:c.costCategories.map(n=>d.find(m=>m.id===n.id)||n)})),this.setSearchQuery=this.updater((c,d)=>Object.assign(Object.assign({},c),{searchQuery:d})),this.loadCostCategoryEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.data.userCostCategory({costCategoryId:d}).pipe((0,g._b)(n=>{this.patchState({item:n.data.item,errors:n.errors,loading:!1})},n=>this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})))))),this.loadCostCategoriesEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([d,n])=>this.data.userCostCategories({input:n}).pipe((0,g._b)(r=>this.patchState({paging:{limit:n.limit,skip:n.skip,total:r.data.count.total},costCategories:r.data.items,errors:r.errors,loading:!1}),r=>this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})))))),this.createCostCategoryEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.costCategoryService.createCostCategory(Object.assign({},d)).pipe((0,g._b)(n=>{this.addNewCostCategory(n),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:n,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},n=>{n.graphQLErrors?(this.toast.error(n.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})):(this.toast.error(n.Message),this.formService.setErrors(n.Data))}))))),this.updateCostCategoryEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.costCategoryService.updateCostCategory(d,d.id).pipe((0,g._b)(r=>{this.updateCostCategory(r),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:r,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.deleteCostCategoryEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.data.userDeleteCostCategory({costCategoryId:n.id}).pipe((0,g._b)(r=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:r.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.importExcelEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.costCategoryService.importCostCategories(d).pipe((0,ce.K)(n=>{var r;return this.toast.error(null!==(r=n.Message)&&void 0!==r?r:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(n=>{const r=JSON.parse(n.created),m=JSON.parse(n.updated),p=JSON.parse(n.failed),_=r.length+m.length+p.length;this.addCostCategories(r),this.updateCostCategories(m),this.toast.success(`${r.length} created, ${m.length} updated, ${p.length} failed of total ${_}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("costCategoryId")?(this.route.snapshot.paramMap.get("costCategoryId"),this.setFormName("costCategory_edit")):this.setFormName("costCategory_create")}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.costCategoryService.validateCostCategoryExcelData(t)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(hI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function fI(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.costCategory)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let Al=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"costCategory_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.costCategory=i.item})):t.formName&&t.formName.currentValue&&"costCategory_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadCostCategoryEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.costCategory=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(fo),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-cost-category-form"]],inputs:{costCategory:"costCategory",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,fI,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),Fl=(()=>{class s{constructor(){this.autoHeight=!1,this.costCategories=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[,{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-cost-category-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",costCategories:"costCategories"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.costCategories)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function _I(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-cost-category-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","costCategory_edit")("formControl",t.formControl)("costCategory",t.costCategory)}}const gI=function(){return{}};function CI(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-cost-category-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","costCategory_create")("formControl",t.formControl)("costCategory",e.DdM(3,gI))}}function vI(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-cost-category-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("costCategories",o.data.items)}let SI=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadCostCategoriesEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.costCategories$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(fo))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","costCategory","send","close"],[1,"w-full","h-full","bg-white",3,"costCategories","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,_I,2,3,"ng-template",null,1,e.W1O),e.YNc(3,CI,1,4,"ng-template",null,2,e.W1O),e.YNc(5,vI,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,Al,Fl],encapsulation:2}),s})();function bI(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-cost-category-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","costCategory_edit")("costCategory",t.value)}}const TI=function(){return{}};function yI(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-cost-category-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","costCategory_create")("costCategory",e.DdM(2,TI))}function wI(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-cost-category-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("costCategories",t.items)}}let xI=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","costCategory","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","costCategories","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,bI,1,2,"ng-template",null,1,e.W1O),e.YNc(3,yI,1,3,"ng-template",null,2,e.W1O),e.YNc(5,wI,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,Al,Fl],encapsulation:2}),s})(),NI=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[fo],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"cost-category-select",component:SI,wrappers:["form-field"]},{name:"cost-category-grid",component:xI}]})]}),s})(),AI=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[NI]}),s})();var kt=Q(59443);function FI(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.diagnosisCode)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let Pl=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"diagnosisCode_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({id:null,name:""}),this.store.vm$.subscribe(i=>{this.diagnosisCode=i.item})):t.formName&&t.formName.currentValue&&"diagnosisCode_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadDiagnosisCodeEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.diagnosisCode=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(kt.r),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-diagnosis-code-form"]],inputs:{diagnosisCode:"diagnosisCode",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,FI,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),Il=(()=>{class s{constructor(){this.autoHeight=!1,this.diagnosisCodes=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[,{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-diagnosis-code-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",diagnosisCodes:"diagnosisCodes"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:6,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.diagnosisCodes)("showSidebar",!1)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function PI(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-diagnosis-code-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","diagnosisCode_edit")("formControl",t.formControl)("diagnosisCode",t.diagnosisCode)}}const II=function(){return{}};function DI(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-diagnosis-code-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","diagnosisCode_create")("formControl",t.formControl)("diagnosisCode",e.DdM(3,II))}}function MI(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-diagnosis-code-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("diagnosisCodes",o.data.items)}let WI=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadDiagnosisCodesEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.diagnosisCodes$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(kt.r))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e._Bn([kt.r]),e.qOj],decls:7,vars:5,consts:[[3,"to","control","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","diagnosisCode","send","close"],[1,"w-full","h-full","bg-white",3,"diagnosisCodes","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"ui-select-form",0),e.YNc(1,PI,2,3,"ng-template",null,1,e.W1O),e.YNc(3,DI,1,4,"ng-template",null,2,e.W1O),e.YNc(5,MI,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[W.JJ,W.oH,Z.$,Pl,Il],encapsulation:2}),s})();function EI(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-diagnosis-code-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","diagnosisCode_edit")("diagnosisCode",t.value)}}const OI=function(){return{}};function LI(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-diagnosis-code-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","diagnosisCode_create")("diagnosisCode",e.DdM(2,OI))}function $I(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-diagnosis-code-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("diagnosisCodes",t.items)}}let GI=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:6,consts:[[3,"data","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","diagnosisCode","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","diagnosisCodes","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,EI,1,2,"ng-template",null,1,e.W1O),e.YNc(3,LI,1,3,"ng-template",null,2,e.W1O),e.YNc(5,$I,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,Pl,Il],encapsulation:2}),s})(),RI=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[kt.r],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"diagnosis-code-select",component:WI,wrappers:["form-field"]},{name:"diagnosis-code-grid",component:GI}]})]}),s})(),QI=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[RI]}),s})(),Dl=(()=>{class s extends g.m1{constructor(t){super({loading:!1,documents:[]}),this.data=t,this.errors$=this.select(i=>i.errors),this.loading$=this.select(i=>i.loading),this.documents$=this.select(i=>i.documents),this.vm$=this.select(this.errors$,this.loading$,this.documents$,(i,a,l)=>({errors:i,loading:a,documents:l}),{debounce:!0}),this.addNewDocument=this.updater((i,a)=>({documents:[...i.documents,a]})),this.updateDocument=this.updater((i,a)=>Object.assign(Object.assign({},i),{documents:i.documents.map(l=>l.id===a.id?a:l)})),this.createDocumentEffect=this.effect(i=>i.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(a=>this.data.userCreateDocument({input:a.input}).pipe((0,g._b)(l=>{this.addNewDocument(l.data.created),this.patchState({errors:l.errors,loading:!1}),a.resultEmitter.emit(l.data.created)},l=>this.patchState({loading:!1,errors:l.graphQLErrors?l.graphQLErrors:l})))))),this.updateDocumentEffect=this.effect(i=>i.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(a=>this.data.userUpdateDocument({documentId:a.input.id,input:a.input}).pipe((0,g._b)(l=>{this.updateDocument(l.data.updated),this.patchState({errors:l.errors,loading:!1}),a.resultEmitter.emit(l.data.updated)},l=>this.patchState({loading:!1,errors:l.graphQLErrors?l.graphQLErrors:l})))))),this.loadDocumentsEffect=this.effect(i=>i.pipe((0,S.b)(()=>{this.patchState({loading:!0})}),(0,h.w)(()=>this.data.userDocuments({input:{}}).pipe((0,g._b)(a=>{this.patchState({loading:!1,documents:a.data.items})},a=>{this.patchState({loading:!1})})))))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();var Ml=Q(56794);function VI(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.document)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let Wl=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"document_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.document=i.item})):t.formName&&t.formName.currentValue&&"document_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadDocumentEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.document=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Ml.F),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-document-form"]],inputs:{document:"document",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,VI,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})();const jI=function(){return{}};function UI(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-document-form",3),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("document",o.data.value||e.DdM(1,jI))}function JI(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-document-table-view",4),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("documents",o.data.items)}let zI=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadDocumentsEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.documents$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Dl))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:5,vars:4,consts:[[3,"to","control","listTemplate","editTemplate"],["editTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"document","send","close"],[1,"w-full","h-full","bg-white",3,"documents","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"ui-select-form",0),e.YNc(1,UI,1,2,"ng-template",null,1,e.W1O),e.YNc(3,JI,1,1,"ng-template",null,2,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4);e.Q6J("to",i.to)("control",i.formControl)("listTemplate",l)("editTemplate",a)}},dependencies:[Z.$,Wl],encapsulation:2}),s})(),HI=(()=>{class s{constructor(){this.documents=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.autoHeight=!1,this.columnDefs=[{field:"contract.name",headerName:"Contract",filter:"agTextColumnFilter"},{field:"patient.name",headerName:"Patient",filter:"agTextColumnFilter"},{field:"prescription.name",headerName:"Prescription",filter:"agTextColumnFilter"},{field:"provider.name",headerName:"Provider",filter:"agTextColumnFilter"},{field:"patientStudies.name",headerName:"Patient Studies",filter:"agTextColumnFilter"},{field:"procedureVendor.name",headerName:"Procedure Vendor",filter:"agTextColumnFilter"},{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{field:"attachment",filter:"agTextColumnFilter"},{field:"encoding",filter:"agTextColumnFilter"},{field:"extension",filter:"agTextColumnFilter"},{field:"contractId",filter:"agTextColumnFilter",hide:!0},{field:"patientId",filter:"agTextColumnFilter",hide:!0},{field:"prescriptionId",filter:"agTextColumnFilter",hide:!0},{field:"providerId",filter:"agTextColumnFilter",hide:!0},{field:"patientStudyId",filter:"agTextColumnFilter",hide:!0},{field:"procedureVendorId",filter:"agTextColumnFilter",hide:!0}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-document-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{documents:"documents",autoHeight:"autoHeight"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:4,consts:[[1,"w-full","h-full",3,"autoHeight","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("data",i.documents)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function qI(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-document-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","document_edit")("document",t.value)}}const KI=function(){return{}};function ZI(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-document-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","document_create")("document",e.DdM(2,KI))}function kI(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-document-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("documents",t.items)}}let BI=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","document","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","documents","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,qI,1,2,"ng-template",null,1,e.W1O),e.YNc(3,ZI,1,3,"ng-template",null,2,e.W1O),e.YNc(5,kI,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,Wl,HI],encapsulation:2}),s})(),YI=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[Dl,Ml.F],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,q.h,k.G,me,R.X0.forChild({types:[{name:"document-select",component:zI,wrappers:["form-field"]},{name:"document-grid",component:BI,wrappers:["form-field"]}]})]}),s})(),XI=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[YI]}),s})();class Bt extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class eD extends Bt{constructor(o){super("ValidateDocumentTypeExcelDataAction"),this.valid=!1,this.excelData=o}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name)}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class tD extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class iD extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new tD("name","The documenttype name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class sD extends Bt{constructor(o){super("CreateDocumentTypeAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new iD("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateDocumentType({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class oD extends Bt{constructor(o){super("UpdateDocumentTypesAction"),this.documentTypes=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.documentTypes,!0))}performAction(){this.response=this.businessProvider.data.userUpdateDocumentTypes({input:{documentTypes:this.documentTypes}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class aD extends Bt{constructor(o,t){super("UpdateDocumentTypeAction"),this.documentType=o,this.documentTypeId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.documentType,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.documentTypeId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateDocumentType({documentTypeId:this.documentTypeId,input:this.documentType}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let El=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.DocumentTypeBusinessProviderService",t,a),this.data=i}createDocumentType(t){const i=new sD(t);return i.Do(this),i.response}updateDocumentType(t,i){const a=new aD(t,i);return a.Do(this),a.response}importDocumentTypes(t){const i=new oD(t);return i.Do(this),i.response}validateDocumentTypeExcelData(t){const i=new eD(t);return i.Do(this),i.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),rD=(()=>{class s extends I.nH{constructor(t,i,a){super("DocumentTypeService",a,t),this.businessProvider=i}createDocumentType(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createDocumentType(i)}updateDocumentType(t,i){return this.businessProvider.updateDocumentType(t,i)}importDocumentTypes(t){return this.businessProvider.importDocumentTypes(t)}validateDocumentTypeExcelData(t){return this.businessProvider.validateDocumentTypeExcelData(t)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(El,8),e.LFG(El),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),_o=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){super({loading:!1,documentTypes:[],done:!1,searchQuery:"",formName:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.documentTypeService=H,this.errors$=this.select(c=>c.errors),this.loading$=this.select(c=>c.loading),this.done$=this.select(c=>c.done),this.item$=this.select(c=>c.item),this.documentTypes$=this.select(c=>c.documentTypes),this.paging$=this.select(c=>c.paging),this.searchQuery$=this.select(c=>c.searchQuery),this.formName$=this.select(c=>c.formName),this.actionResult$=this.select(this.item$,this.done$,(c,d)=>({item:c,done:d}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.documentTypes$,(c,d,n,r,m)=>({errors:c,loading:d,item:n,formName:r,documentTypes:m}),{debounce:!0}),this.input$=this.select(this.paging$,this.searchQuery$,(c,d)=>({limit:c.limit,skip:c.skip,name:d,total:c.total})),this.setFormName=this.updater((c,d)=>Object.assign(Object.assign({},c),{formName:d})),this.setItem=this.updater((c,d)=>Object.assign(Object.assign({},c),{item:d})),this.addNewDocumentType=this.updater((c,d)=>Object.assign(Object.assign({},c),{documentTypes:[...c.documentTypes,d]})),this.updateDocumentType=this.updater((c,d)=>Object.assign(Object.assign({},c),{documentTypes:c.documentTypes.map(n=>n.id===d.id?d:n)})),this.addDocumentTypes=this.updater((c,d)=>Object.assign(Object.assign({},c),{documentTypes:c.documentTypes.concat(d)})),this.updateDocumentTypes=this.updater((c,d)=>Object.assign(Object.assign({},c),{documentTypes:c.documentTypes.map(n=>d.find(m=>m.id===n.id)||n)})),this.setSearchQuery=this.updater((c,d)=>Object.assign(Object.assign({},c),{searchQuery:d})),this.loadDocumentTypeEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.data.userDocumentType({documentTypeId:d}).pipe((0,g._b)(n=>{this.patchState({item:n.data.item,errors:n.errors,loading:!1})},n=>this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})))))),this.loadDocumentTypesEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([d,n])=>this.data.userDocumentTypes({input:n}).pipe((0,g._b)(r=>this.patchState({paging:{limit:n.limit,skip:n.skip,total:r.data.count.total},documentTypes:r.data.items,errors:r.errors,loading:!1}),r=>this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})))))),this.createDocumentTypeEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.documentTypeService.createDocumentType(Object.assign({},d)).pipe((0,g._b)(n=>{this.addNewDocumentType(n),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:n,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},n=>{n.graphQLErrors?(this.toast.error(n.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})):(this.toast.error(n.Message),this.formService.setErrors(n.Data))}))))),this.updateDocumentTypeEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.documentTypeService.updateDocumentType(d,d.id).pipe((0,g._b)(r=>{this.updateDocumentType(r),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:r,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.deleteDocumentTypeEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.data.userDeleteDocumentType({documentTypeId:n.id}).pipe((0,g._b)(r=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:r.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.importExcelEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.documentTypeService.importDocumentTypes(d).pipe((0,ce.K)(n=>{var r;return this.toast.error(null!==(r=n.Message)&&void 0!==r?r:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(n=>{const r=JSON.parse(n.created),m=JSON.parse(n.updated),p=JSON.parse(n.failed),_=r.length+m.length+p.length;this.addDocumentTypes(r),this.updateDocumentTypes(m),this.toast.success(`${r.length} created, ${m.length} updated, ${p.length} failed of total ${_}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("documentTypeId")?(this.route.snapshot.paramMap.get("documentTypeId"),this.setFormName("documentType_edit")):this.setFormName("documentType_create")}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.documentTypeService.validateDocumentTypeExcelData(t)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(rD))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function nD(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.documentType)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let Ol=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"documentType_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.documentType=i.item})):t.formName&&t.formName.currentValue&&"documentType_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadDocumentTypeEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.documentType=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(_o),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-document-type-form"]],inputs:{documentType:"documentType",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,nD,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),Ll=(()=>{class s{constructor(){this.autoHeight=!1,this.documentTypes=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-document-type-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",documentTypes:"documentTypes"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.documentTypes)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function lD(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-document-type-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","documentType_edit")("formControl",t.formControl)("documentType",t.documentType)}}const cD=function(){return{}};function dD(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-document-type-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","documentType_create")("formControl",t.formControl)("documentType",e.DdM(3,cD))}}function uD(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-document-type-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("documentTypes",o.data.items)}let mD=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadDocumentTypesEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.documentTypes$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(_o))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","documentType","send","close"],[1,"w-full","h-full","bg-white",3,"documentTypes","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,lD,2,3,"ng-template",null,1,e.W1O),e.YNc(3,dD,1,4,"ng-template",null,2,e.W1O),e.YNc(5,uD,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,Ol,Ll],encapsulation:2}),s})();function pD(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-document-type-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","documentType_edit")("documentType",t.value)}}const hD=function(){return{}};function fD(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-document-type-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","documentType_create")("documentType",e.DdM(2,hD))}function _D(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-document-type-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("documentTypes",t.items)}}let gD=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","documentType","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","documentTypes","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,pD,1,2,"ng-template",null,1,e.W1O),e.YNc(3,fD,1,3,"ng-template",null,2,e.W1O),e.YNc(5,_D,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,Ol,Ll],encapsulation:2}),s})(),CD=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[_o],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"document-type-select",component:mD,wrappers:["form-field"]},{name:"document-type-grid",component:gD}]})]}),s})(),vD=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[CD]}),s})();class Yt extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class SD extends Yt{constructor(o,t){super("ValidateDurableMedicalEquipmentExcelDataAction"),this.valid=!1,this.excelData=o,this.vendors=t}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name),this.validationContext.addRule(new f.mi(`vendorName_${i}_is_valid}`,"Vendor Is Not Valid","vendor.name",t.vendor,this.vendors,!0))}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class bD extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class TD extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new bD("name","The durablemedicalequipment name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class yD extends Yt{constructor(o){super("CreateDurableMedicalEquipmentAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new TD("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateDurableMedicalEquipment({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class wD extends Yt{constructor(o){super("UpdateDurableMedicalEquipmentsAction"),this.durableMedicalEquipments=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.durableMedicalEquipments,!0))}performAction(){this.response=this.businessProvider.data.userUpdateDurableMedicalEquipments({input:{durableMedicalEquipments:this.durableMedicalEquipments}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class xD extends Yt{constructor(o,t){super("UpdateDurableMedicalEquipmentAction"),this.durableMedicalEquipment=o,this.durableMedicalEquipmentId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.durableMedicalEquipment,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.durableMedicalEquipmentId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateDurableMedicalEquipment({durableMedicalEquipmentId:this.durableMedicalEquipmentId,input:this.durableMedicalEquipment}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let $l=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.DurableMedicalEquipmentBusinessProviderService",t,a),this.data=i}createDurableMedicalEquipment(t){const i=new yD(t);return i.Do(this),i.response}updateDurableMedicalEquipment(t,i){const a=new xD(t,i);return a.Do(this),a.response}importDurableMedicalEquipments(t){const i=new wD(t);return i.Do(this),i.response}validateDurableMedicalEquipmentExcelData(t,i){const a=new SD(t,i);return a.Do(this),a.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),ND=(()=>{class s extends I.nH{constructor(t,i,a){super("DurableMedicalEquipmentService",a,t),this.businessProvider=i}createDurableMedicalEquipment(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createDurableMedicalEquipment(i)}updateDurableMedicalEquipment(t,i){return this.businessProvider.updateDurableMedicalEquipment(t,i)}importDurableMedicalEquipments(t){return this.businessProvider.importDurableMedicalEquipments(t)}validateDurableMedicalEquipmentExcelData(t,i){return this.businessProvider.validateDurableMedicalEquipmentExcelData(t,i)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG($l,8),e.LFG($l),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),go=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){if(super({loading:!1,durableMedicalEquipments:[],done:!1,searchQuery:"",formName:void 0,vendorId:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.durableMedicalEquipmentService=H,this.errors$=this.select(d=>d.errors),this.loading$=this.select(d=>d.loading),this.done$=this.select(d=>d.done),this.item$=this.select(d=>d.item),this.durableMedicalEquipments$=this.select(d=>d.durableMedicalEquipments),this.vendors$=this.select(d=>d.vendors||[]),this.vendorId$=this.select(d=>d.vendorId),this.paging$=this.select(d=>d.paging),this.searchQuery$=this.select(d=>d.searchQuery),this.formName$=this.select(d=>d.formName),this.actionResult$=this.select(this.item$,this.done$,(d,n)=>({item:d,done:n}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.durableMedicalEquipments$,this.vendors$,(d,n,r,m,p,_)=>({errors:d,loading:n,item:r,formName:m,durableMedicalEquipments:p,vendors:_}),{debounce:!0}),this.input$=this.select(this.paging$,this.vendorId$,this.searchQuery$,(d,n,r)=>({limit:d.limit,skip:d.skip,name:r,vendorId:n,total:d.total})),this.setFormName=this.updater((d,n)=>Object.assign(Object.assign({},d),{formName:n})),this.setVendorId=this.updater((d,n)=>Object.assign(Object.assign({},d),{vendorId:n})),this.filterVendors=d=>this.data.userSelectVendors({input:{name:d}}).pipe((0,g._b)(n=>{let r=n.data.items;return this.patchState({vendors:r}),r},n=>this.patchState({errors:n.graphQLErrors?n.graphQLErrors:n})),(0,he.U)(n=>n.data.items)),this.addVendor=this.updater((d,n)=>Object.assign(Object.assign({},d),{vendors:d.vendors.concat(n)})),this.setItem=this.updater((d,n)=>Object.assign(Object.assign({},d),{item:n})),this.addNewDurableMedicalEquipment=this.updater((d,n)=>Object.assign(Object.assign({},d),{durableMedicalEquipments:[...d.durableMedicalEquipments,n]})),this.updateDurableMedicalEquipment=this.updater((d,n)=>Object.assign(Object.assign({},d),{durableMedicalEquipments:d.durableMedicalEquipments.map(r=>r.id===n.id?n:r)})),this.addDurableMedicalEquipments=this.updater((d,n)=>Object.assign(Object.assign({},d),{durableMedicalEquipments:d.durableMedicalEquipments.concat(n)})),this.updateDurableMedicalEquipments=this.updater((d,n)=>Object.assign(Object.assign({},d),{durableMedicalEquipments:d.durableMedicalEquipments.map(r=>n.find(p=>p.id===r.id)||r)})),this.setSearchQuery=this.updater((d,n)=>Object.assign(Object.assign({},d),{searchQuery:n})),this.loadDurableMedicalEquipmentEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(n=>this.data.userDurableMedicalEquipment({durableMedicalEquipmentId:n}).pipe((0,g._b)(r=>{this.patchState({item:r.data.item,errors:r.errors,loading:!1})},r=>this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})))))),this.loadDurableMedicalEquipmentsEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([n,r])=>this.data.userDurableMedicalEquipments({input:r}).pipe((0,g._b)(m=>this.patchState({paging:{limit:r.limit,skip:r.skip,total:m.data.count.total},durableMedicalEquipments:m.data.items,errors:m.errors,loading:!1}),m=>this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})))))),this.createDurableMedicalEquipmentEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(n=>this.durableMedicalEquipmentService.createDurableMedicalEquipment(Object.assign({},n)).pipe((0,g._b)(r=>{this.addNewDurableMedicalEquipment(r),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:r,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.updateDurableMedicalEquipmentEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([n,r])=>this.durableMedicalEquipmentService.updateDurableMedicalEquipment(n,n.id).pipe((0,g._b)(m=>{this.updateDurableMedicalEquipment(m),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:m,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},m=>{m.graphQLErrors?(this.toast.error(m.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})):(this.toast.error(m.Message),this.formService.setErrors(m.Data))}))))),this.deleteDurableMedicalEquipmentEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([n,r])=>this.data.userDeleteDurableMedicalEquipment({durableMedicalEquipmentId:r.id}).pipe((0,g._b)(m=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:m.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},m=>{m.graphQLErrors?(this.toast.error(m.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})):(this.toast.error(m.Message),this.formService.setErrors(m.Data))}))))),this.importExcelEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(n=>this.durableMedicalEquipmentService.importDurableMedicalEquipments(n).pipe((0,ce.K)(r=>{var m;return this.toast.error(null!==(m=r.Message)&&void 0!==m?m:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(r=>{const m=JSON.parse(r.created),p=JSON.parse(r.updated),_=JSON.parse(r.failed),w=m.length+p.length+_.length;this.addDurableMedicalEquipments(m),this.updateDurableMedicalEquipments(p),this.toast.success(`${m.length} created, ${p.length} updated, ${_.length} failed of total ${w}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("durableMedicalEquipmentId")?(this.route.snapshot.paramMap.get("durableMedicalEquipmentId"),this.setFormName("durableMedicalEquipment_edit")):this.setFormName("durableMedicalEquipment_create"),this.route.snapshot.paramMap.has("vendorId")){var c=this.route.snapshot.paramMap.get("vendorId");this.setVendorId(c)}}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.durableMedicalEquipmentService.validateDurableMedicalEquipmentExcelData(t,i.vendors)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(ND))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function AD(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.durableMedicalEquipment)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let Gl=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"durableMedicalEquipment_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.durableMedicalEquipment=i.item})):t.formName&&t.formName.currentValue&&"durableMedicalEquipment_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadDurableMedicalEquipmentEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.durableMedicalEquipment=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(go),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-durable-medical-equipment-form"]],inputs:{durableMedicalEquipment:"durableMedicalEquipment",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,AD,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),Rl=(()=>{class s{constructor(){this.autoHeight=!1,this.durableMedicalEquipments=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[{field:"vendor.name",headerName:"Vendor",filter:"agTextColumnFilter"},{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{field:"itemCode",filter:"agTextColumnFilter"},{field:"vendorId",filter:"agTextColumnFilter",hide:!0},{field:"size",filter:"agTextColumnFilter"},{field:"brand",filter:"agTextColumnFilter"},{field:"itemURL",filter:"agTextColumnFilter"},{field:"estimatedCost",filter:"agTextColumnFilter"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-durable-medical-equipment-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",durableMedicalEquipments:"durableMedicalEquipments"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.durableMedicalEquipments)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function FD(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-durable-medical-equipment-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","durableMedicalEquipment_edit")("formControl",t.formControl)("durableMedicalEquipment",t.durableMedicalEquipment)}}const PD=function(){return{}};function ID(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-durable-medical-equipment-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","durableMedicalEquipment_create")("formControl",t.formControl)("durableMedicalEquipment",e.DdM(3,PD))}}function DD(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-durable-medical-equipment-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("durableMedicalEquipments",o.data.items)}let MD=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadDurableMedicalEquipmentsEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.durableMedicalEquipments$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(go))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","durableMedicalEquipment","send","close"],[1,"w-full","h-full","bg-white",3,"durableMedicalEquipments","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,FD,2,3,"ng-template",null,1,e.W1O),e.YNc(3,ID,1,4,"ng-template",null,2,e.W1O),e.YNc(5,DD,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,Gl,Rl],encapsulation:2}),s})();function WD(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-durable-medical-equipment-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","durableMedicalEquipment_edit")("durableMedicalEquipment",t.value)}}const ED=function(){return{}};function OD(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-durable-medical-equipment-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","durableMedicalEquipment_create")("durableMedicalEquipment",e.DdM(2,ED))}function LD(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-durable-medical-equipment-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("durableMedicalEquipments",t.items)}}let $D=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","durableMedicalEquipment","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","durableMedicalEquipments","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,WD,1,2,"ng-template",null,1,e.W1O),e.YNc(3,OD,1,3,"ng-template",null,2,e.W1O),e.YNc(5,LD,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,Gl,Rl],encapsulation:2}),s})(),GD=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[go],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"durable-medical-equipment-select",component:MD,wrappers:["form-field"]},{name:"durable-medical-equipment-grid",component:$D}]})]}),s})(),RD=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[GD]}),s})();class Xt extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class QD extends Xt{constructor(o){super("ValidateEquipmentExcelDataAction"),this.valid=!1,this.excelData=o}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name)}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class VD extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class jD extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new VD("name","The equipment name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class UD extends Xt{constructor(o){super("CreateEquipmentAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new jD("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateEquipment({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class JD extends Xt{constructor(o){super("UpdateEquipmentsAction"),this.equipments=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.equipments,!0))}performAction(){this.response=this.businessProvider.data.userUpdateEquipments({input:{equipments:this.equipments}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class zD extends Xt{constructor(o,t){super("UpdateEquipmentAction"),this.equipment=o,this.equipmentId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.equipment,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.equipmentId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateEquipment({equipmentId:this.equipmentId,input:this.equipment}).pipe((0,h.w)(()=>(0,F.of)(!0)))}}let Ql=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.EquipmentBusinessProviderService",t,a),this.data=i}createEquipment(t){const i=new UD(t);return i.Do(this),i.response}updateEquipment(t,i){const a=new zD(t,i);return a.Do(this),a.response}importEquipments(t){const i=new JD(t);return i.Do(this),i.response}validateEquipmentExcelData(t){const i=new QD(t);return i.Do(this),i.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),HD=(()=>{class s extends I.nH{constructor(t,i,a){super("EquipmentService",a,t),this.businessProvider=i}createEquipment(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createEquipment(i)}updateEquipment(t,i){return this.businessProvider.updateEquipment(t,i)}importEquipments(t){return this.businessProvider.importEquipments(t)}validateEquipmentExcelData(t){return this.businessProvider.validateEquipmentExcelData(t)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(Ql,8),e.LFG(Ql),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),Co=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){super({loading:!1,equipments:[],done:!1,searchQuery:"",formName:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.equipmentService=H,this.errors$=this.select(c=>c.errors),this.loading$=this.select(c=>c.loading),this.done$=this.select(c=>c.done),this.item$=this.select(c=>c.item),this.equipments$=this.select(c=>c.equipments),this.paging$=this.select(c=>c.paging),this.searchQuery$=this.select(c=>c.searchQuery),this.formName$=this.select(c=>c.formName),this.actionResult$=this.select(this.item$,this.done$,(c,d)=>({item:c,done:d}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.equipments$,(c,d,n,r,m)=>({errors:c,loading:d,item:n,formName:r,equipments:m}),{debounce:!0}),this.input$=this.select(this.paging$,this.searchQuery$,(c,d)=>({limit:c.limit,skip:c.skip,name:d,total:c.total})),this.setFormName=this.updater((c,d)=>Object.assign(Object.assign({},c),{formName:d})),this.setItem=this.updater((c,d)=>Object.assign(Object.assign({},c),{item:d})),this.addNewEquipment=this.updater((c,d)=>Object.assign(Object.assign({},c),{equipments:[...c.equipments,d]})),this.updateEquipment=this.updater((c,d)=>Object.assign(Object.assign({},c),{equipments:c.equipments.map(n=>n.id===d.id?d:n)})),this.addEquipments=this.updater((c,d)=>Object.assign(Object.assign({},c),{equipments:c.equipments.concat(d)})),this.updateEquipments=this.updater((c,d)=>Object.assign(Object.assign({},c),{equipments:c.equipments.map(n=>d.find(m=>m.id===n.id)||n)})),this.setSearchQuery=this.updater((c,d)=>Object.assign(Object.assign({},c),{searchQuery:d})),this.loadEquipmentEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.data.userEquipment({equipmentId:d}).pipe((0,g._b)(n=>{this.patchState({item:n.data.item,errors:n.errors,loading:!1})},n=>this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})))))),this.loadEquipmentsEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([d,n])=>this.data.userEquipments({input:n}).pipe((0,g._b)(r=>this.patchState({paging:{limit:n.limit,skip:n.skip,total:r.data.count.total},equipments:r.data.items,errors:r.errors,loading:!1}),r=>this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})))))),this.createEquipmentEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.equipmentService.createEquipment(Object.assign({},d)).pipe((0,g._b)(n=>{this.addNewEquipment(n),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:n,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},n=>{n.graphQLErrors?(this.toast.error(n.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})):(this.toast.error(n.Message),this.formService.setErrors(n.Data))}))))),this.updateEquipmentEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.equipmentService.updateEquipment(d,d.id).pipe((0,g._b)(r=>{this.updateEquipment(r),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:r,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.deleteEquipmentEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.data.userDeleteEquipment({equipmentId:n.id}).pipe((0,g._b)(r=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:r.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.importExcelEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.equipmentService.importEquipments(d).pipe((0,ce.K)(n=>{var r;return this.toast.error(null!==(r=n.Message)&&void 0!==r?r:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(n=>{const r=JSON.parse(n.created),m=JSON.parse(n.updated),p=JSON.parse(n.failed),_=r.length+m.length+p.length;this.addEquipments(r),this.updateEquipments(m),this.toast.success(`${r.length} created, ${m.length} updated, ${p.length} failed of total ${_}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("equipmentId")?(this.route.snapshot.paramMap.get("equipmentId"),this.setFormName("equipment_edit")):this.setFormName("equipment_create")}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.equipmentService.validateEquipmentExcelData(t)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(HD))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function qD(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.equipment)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let Vl=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"equipment_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.equipment=i.item})):t.formName&&t.formName.currentValue&&"equipment_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadEquipmentEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.equipment=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Co),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-equipment-form"]],inputs:{equipment:"equipment",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,qD,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),jl=(()=>{class s{constructor(){this.autoHeight=!1,this.equipments=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[,{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-equipment-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",equipments:"equipments"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.equipments)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function KD(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-equipment-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","equipment_edit")("formControl",t.formControl)("equipment",t.equipment)}}const ZD=function(){return{}};function kD(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-equipment-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","equipment_create")("formControl",t.formControl)("equipment",e.DdM(3,ZD))}}function BD(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-equipment-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("equipments",o.data.items)}let YD=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadEquipmentsEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.equipments$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Co))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","equipment","send","close"],[1,"w-full","h-full","bg-white",3,"equipments","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,KD,2,3,"ng-template",null,1,e.W1O),e.YNc(3,kD,1,4,"ng-template",null,2,e.W1O),e.YNc(5,BD,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,Vl,jl],encapsulation:2}),s})();function XD(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-equipment-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","equipment_edit")("equipment",t.value)}}const e1=function(){return{}};function t1(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-equipment-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","equipment_create")("equipment",e.DdM(2,e1))}function i1(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-equipment-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("equipments",t.items)}}let s1=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","equipment","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","equipments","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,XD,1,2,"ng-template",null,1,e.W1O),e.YNc(3,t1,1,3,"ng-template",null,2,e.W1O),e.YNc(5,i1,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,Vl,jl],encapsulation:2}),s})(),o1=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[Co],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"equipment-select",component:YD,wrappers:["form-field"]},{name:"equipment-grid",component:s1}]})]}),s})(),a1=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[o1]}),s})();class ei extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class r1 extends ei{constructor(o){super("ValidateEthnicityExcelDataAction"),this.valid=!1,this.excelData=o}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name)}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class n1 extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class l1 extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new n1("name","The ethnicity name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class c1 extends ei{constructor(o){super("CreateEthnicityAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new l1("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateEthnicity({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class d1 extends ei{constructor(o){super("UpdateEthnicitiesAction"),this.ethnicities=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.ethnicities,!0))}performAction(){this.response=this.businessProvider.data.userUpdateEthnicities({input:{ethnicities:this.ethnicities}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class u1 extends ei{constructor(o,t){super("UpdateEthnicityAction"),this.ethnicity=o,this.ethnicityId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.ethnicity,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.ethnicityId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateEthnicity({ethnicityId:this.ethnicityId,input:this.ethnicity}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let Ul=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.EthnicityBusinessProviderService",t,a),this.data=i}createEthnicity(t){const i=new c1(t);return i.Do(this),i.response}updateEthnicity(t,i){const a=new u1(t,i);return a.Do(this),a.response}importEthnicities(t){const i=new d1(t);return i.Do(this),i.response}validateEthnicityExcelData(t){const i=new r1(t);return i.Do(this),i.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),m1=(()=>{class s extends I.nH{constructor(t,i,a){super("EthnicityService",a,t),this.businessProvider=i}createEthnicity(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createEthnicity(i)}updateEthnicity(t,i){return this.businessProvider.updateEthnicity(t,i)}importEthnicities(t){return this.businessProvider.importEthnicities(t)}validateEthnicityExcelData(t){return this.businessProvider.validateEthnicityExcelData(t)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(Ul,8),e.LFG(Ul),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),vo=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){super({loading:!1,ethnicities:[],done:!1,searchQuery:"",formName:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.ethnicityService=H,this.errors$=this.select(c=>c.errors),this.loading$=this.select(c=>c.loading),this.done$=this.select(c=>c.done),this.item$=this.select(c=>c.item),this.ethnicities$=this.select(c=>c.ethnicities),this.paging$=this.select(c=>c.paging),this.searchQuery$=this.select(c=>c.searchQuery),this.formName$=this.select(c=>c.formName),this.actionResult$=this.select(this.item$,this.done$,(c,d)=>({item:c,done:d}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.ethnicities$,(c,d,n,r,m)=>({errors:c,loading:d,item:n,formName:r,ethnicities:m}),{debounce:!0}),this.input$=this.select(this.paging$,this.searchQuery$,(c,d)=>({limit:c.limit,skip:c.skip,name:d,total:c.total})),this.setFormName=this.updater((c,d)=>Object.assign(Object.assign({},c),{formName:d})),this.setItem=this.updater((c,d)=>Object.assign(Object.assign({},c),{item:d})),this.addNewEthnicity=this.updater((c,d)=>Object.assign(Object.assign({},c),{ethnicities:[...c.ethnicities,d]})),this.updateEthnicity=this.updater((c,d)=>Object.assign(Object.assign({},c),{ethnicities:c.ethnicities.map(n=>n.id===d.id?d:n)})),this.addEthnicities=this.updater((c,d)=>Object.assign(Object.assign({},c),{ethnicities:c.ethnicities.concat(d)})),this.updateEthnicities=this.updater((c,d)=>Object.assign(Object.assign({},c),{ethnicities:c.ethnicities.map(n=>d.find(m=>m.id===n.id)||n)})),this.setSearchQuery=this.updater((c,d)=>Object.assign(Object.assign({},c),{searchQuery:d})),this.loadEthnicityEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.data.userEthnicity({ethnicityId:d}).pipe((0,g._b)(n=>{this.patchState({item:n.data.item,errors:n.errors,loading:!1})},n=>this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})))))),this.loadEthnicitiesEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([d,n])=>this.data.userEthnicities({input:n}).pipe((0,g._b)(r=>this.patchState({paging:{limit:n.limit,skip:n.skip,total:r.data.count.total},ethnicities:r.data.items,errors:r.errors,loading:!1}),r=>this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})))))),this.createEthnicityEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.ethnicityService.createEthnicity(Object.assign({},d)).pipe((0,g._b)(n=>{this.addNewEthnicity(n),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:n,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},n=>{n.graphQLErrors?(this.toast.error(n.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})):(this.toast.error(n.Message),this.formService.setErrors(n.Data))}))))),this.updateEthnicityEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.ethnicityService.updateEthnicity(d,d.id).pipe((0,g._b)(r=>{this.updateEthnicity(r),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:r,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.deleteEthnicityEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.data.userDeleteEthnicity({ethnicityId:n.id}).pipe((0,g._b)(r=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:r.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.importExcelEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.ethnicityService.importEthnicities(d).pipe((0,ce.K)(n=>{var r;return this.toast.error(null!==(r=n.Message)&&void 0!==r?r:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(n=>{const r=JSON.parse(n.created),m=JSON.parse(n.updated),p=JSON.parse(n.failed),_=r.length+m.length+p.length;this.addEthnicities(r),this.updateEthnicities(m),this.toast.success(`${r.length} created, ${m.length} updated, ${p.length} failed of total ${_}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("ethnicityId")?(this.route.snapshot.paramMap.get("ethnicityId"),this.setFormName("ethnicity_edit")):this.setFormName("ethnicity_create")}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.ethnicityService.validateEthnicityExcelData(t)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(m1))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function p1(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.ethnicity)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let Jl=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"ethnicity_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.ethnicity=i.item})):t.formName&&t.formName.currentValue&&"ethnicity_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadEthnicityEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.ethnicity=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(vo),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-ethnicity-form"]],inputs:{ethnicity:"ethnicity",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,p1,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),zl=(()=>{class s{constructor(){this.autoHeight=!1,this.ethnicities=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[,{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-ethnicity-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",ethnicities:"ethnicities"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.ethnicities)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function h1(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-ethnicity-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","ethnicity_edit")("formControl",t.formControl)("ethnicity",t.ethnicity)}}const f1=function(){return{}};function _1(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-ethnicity-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","ethnicity_create")("formControl",t.formControl)("ethnicity",e.DdM(3,f1))}}function g1(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-ethnicity-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("ethnicities",o.data.items)}let C1=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadEthnicitiesEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.ethnicities$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(vo))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","ethnicity","send","close"],[1,"w-full","h-full","bg-white",3,"ethnicities","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,h1,2,3,"ng-template",null,1,e.W1O),e.YNc(3,_1,1,4,"ng-template",null,2,e.W1O),e.YNc(5,g1,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,Jl,zl],encapsulation:2}),s})();function v1(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-ethnicity-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","ethnicity_edit")("ethnicity",t.value)}}const S1=function(){return{}};function b1(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-ethnicity-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","ethnicity_create")("ethnicity",e.DdM(2,S1))}function T1(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-ethnicity-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("ethnicities",t.items)}}let y1=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","ethnicity","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","ethnicities","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,v1,1,2,"ng-template",null,1,e.W1O),e.YNc(3,b1,1,3,"ng-template",null,2,e.W1O),e.YNc(5,T1,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,Jl,zl],encapsulation:2}),s})(),w1=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[vo],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"ethnicity-select",component:C1,wrappers:["form-field"]},{name:"ethnicity-grid",component:y1}]})]}),s})(),x1=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[w1]}),s})();class ti extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class N1 extends ti{constructor(o,t,i){super("ValidateFacilityFeeScheduleExcelDataAction"),this.valid=!1,this.excelData=o,this.organizations=t,this.specialties=i}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name),this.validationContext.addRule(new f.mi(`organizationName_${i}_is_valid}`,"Organization Is Not Valid","organization.name",t.organization,this.organizations,!0)),this.validationContext.addRule(new f.mi(`specialtyName_${i}_is_valid}`,"Specialty Is Not Valid","specialty.name",t.specialty,this.specialties,!0))}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class A1 extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class F1 extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new A1("name","The facilityfeeschedule name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class P1 extends ti{constructor(o){super("CreateFacilityFeeScheduleAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new F1("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateFacilityFeeSchedule({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class I1 extends ti{constructor(o){super("UpdateFacilityFeeSchedulesAction"),this.facilityFeeSchedules=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.facilityFeeSchedules,!0))}performAction(){this.response=this.businessProvider.data.userUpdateFacilityFeeSchedules({input:{facilityFeeSchedules:this.facilityFeeSchedules}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class D1 extends ti{constructor(o,t){super("UpdateFacilityFeeScheduleAction"),this.facilityFeeSchedule=o,this.facilityFeeScheduleId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.facilityFeeSchedule,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.facilityFeeScheduleId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateFacilityFeeSchedule({facilityFeeScheduleId:this.facilityFeeScheduleId,input:this.facilityFeeSchedule}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let Hl=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.FacilityFeeScheduleBusinessProviderService",t,a),this.data=i}createFacilityFeeSchedule(t){const i=new P1(t);return i.Do(this),i.response}updateFacilityFeeSchedule(t,i){const a=new D1(t,i);return a.Do(this),a.response}importFacilityFeeSchedules(t){const i=new I1(t);return i.Do(this),i.response}validateFacilityFeeScheduleExcelData(t,i,a){const l=new N1(t,i,a);return l.Do(this),l.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),M1=(()=>{class s extends I.nH{constructor(t,i,a){super("FacilityFeeScheduleService",a,t),this.businessProvider=i}createFacilityFeeSchedule(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createFacilityFeeSchedule(i)}updateFacilityFeeSchedule(t,i){return this.businessProvider.updateFacilityFeeSchedule(t,i)}importFacilityFeeSchedules(t){return this.businessProvider.importFacilityFeeSchedules(t)}validateFacilityFeeScheduleExcelData(t,i,a){return this.businessProvider.validateFacilityFeeScheduleExcelData(t,i,a)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(Hl,8),e.LFG(Hl),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),So=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){if(super({loading:!1,facilityFeeSchedules:[],done:!1,searchQuery:"",formName:void 0,organizationId:void 0,specialtyId:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.facilityFeeScheduleService=H,this.errors$=this.select(n=>n.errors),this.loading$=this.select(n=>n.loading),this.done$=this.select(n=>n.done),this.item$=this.select(n=>n.item),this.facilityFeeSchedules$=this.select(n=>n.facilityFeeSchedules),this.organizations$=this.select(n=>n.organizations||[]),this.specialties$=this.select(n=>n.specialties||[]),this.organizationId$=this.select(n=>n.organizationId),this.specialtyId$=this.select(n=>n.specialtyId),this.paging$=this.select(n=>n.paging),this.searchQuery$=this.select(n=>n.searchQuery),this.formName$=this.select(n=>n.formName),this.actionResult$=this.select(this.item$,this.done$,(n,r)=>({item:n,done:r}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.facilityFeeSchedules$,this.organizations$,this.specialties$,(n,r,m,p,_,w,J)=>({errors:n,loading:r,item:m,formName:p,facilityFeeSchedules:_,organizations:w,specialties:J}),{debounce:!0}),this.input$=this.select(this.paging$,this.organizationId$,this.specialtyId$,this.searchQuery$,(n,r,m,p)=>({limit:n.limit,skip:n.skip,name:p,organizationId:r,specialtyId:m,total:n.total})),this.setFormName=this.updater((n,r)=>Object.assign(Object.assign({},n),{formName:r})),this.setOrganizationId=this.updater((n,r)=>Object.assign(Object.assign({},n),{organizationId:r})),this.setSpecialtyId=this.updater((n,r)=>Object.assign(Object.assign({},n),{specialtyId:r})),this.filterOrganizations=n=>this.data.userSelectOrganizations({input:{name:n}}).pipe((0,g._b)(r=>{let m=r.data.items;return this.patchState({organizations:m}),m},r=>this.patchState({errors:r.graphQLErrors?r.graphQLErrors:r})),(0,he.U)(r=>r.data.items)),this.filterSpecialties=n=>this.data.userSelectSpecialties({input:{name:n}}).pipe((0,g._b)(r=>{let m=r.data.items;return this.patchState({specialties:m}),m},r=>this.patchState({errors:r.graphQLErrors?r.graphQLErrors:r})),(0,he.U)(r=>r.data.items)),this.addOrganization=this.updater((n,r)=>Object.assign(Object.assign({},n),{organizations:n.organizations.concat(r)})),this.addSpecialty=this.updater((n,r)=>Object.assign(Object.assign({},n),{specialties:n.specialties.concat(r)})),this.setItem=this.updater((n,r)=>Object.assign(Object.assign({},n),{item:r})),this.addNewFacilityFeeSchedule=this.updater((n,r)=>Object.assign(Object.assign({},n),{facilityFeeSchedules:[...n.facilityFeeSchedules,r]})),this.updateFacilityFeeSchedule=this.updater((n,r)=>Object.assign(Object.assign({},n),{facilityFeeSchedules:n.facilityFeeSchedules.map(m=>m.id===r.id?r:m)})),this.addFacilityFeeSchedules=this.updater((n,r)=>Object.assign(Object.assign({},n),{facilityFeeSchedules:n.facilityFeeSchedules.concat(r)})),this.updateFacilityFeeSchedules=this.updater((n,r)=>Object.assign(Object.assign({},n),{facilityFeeSchedules:n.facilityFeeSchedules.map(m=>r.find(_=>_.id===m.id)||m)})),this.setSearchQuery=this.updater((n,r)=>Object.assign(Object.assign({},n),{searchQuery:r})),this.loadFacilityFeeScheduleEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(r=>this.data.userFacilityFeeSchedule({facilityFeeScheduleId:r}).pipe((0,g._b)(m=>{this.patchState({item:m.data.item,errors:m.errors,loading:!1})},m=>this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})))))),this.loadFacilityFeeSchedulesEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([r,m])=>this.data.userFacilityFeeSchedules({input:m}).pipe((0,g._b)(p=>this.patchState({paging:{limit:m.limit,skip:m.skip,total:p.data.count.total},facilityFeeSchedules:p.data.items,errors:p.errors,loading:!1}),p=>this.patchState({loading:!1,errors:p.graphQLErrors?p.graphQLErrors:p})))))),this.createFacilityFeeScheduleEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(r=>this.facilityFeeScheduleService.createFacilityFeeSchedule(Object.assign({},r)).pipe((0,g._b)(m=>{this.addNewFacilityFeeSchedule(m),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:m,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},m=>{m.graphQLErrors?(this.toast.error(m.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})):(this.toast.error(m.Message),this.formService.setErrors(m.Data))}))))),this.updateFacilityFeeScheduleEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([r,m])=>this.facilityFeeScheduleService.updateFacilityFeeSchedule(r,r.id).pipe((0,g._b)(p=>{this.updateFacilityFeeSchedule(p),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:p,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},p=>{p.graphQLErrors?(this.toast.error(p.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:p.graphQLErrors?p.graphQLErrors:p})):(this.toast.error(p.Message),this.formService.setErrors(p.Data))}))))),this.deleteFacilityFeeScheduleEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([r,m])=>this.data.userDeleteFacilityFeeSchedule({facilityFeeScheduleId:m.id}).pipe((0,g._b)(p=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:p.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},p=>{p.graphQLErrors?(this.toast.error(p.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:p.graphQLErrors?p.graphQLErrors:p})):(this.toast.error(p.Message),this.formService.setErrors(p.Data))}))))),this.importExcelEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(r=>this.facilityFeeScheduleService.importFacilityFeeSchedules(r).pipe((0,ce.K)(m=>{var p;return this.toast.error(null!==(p=m.Message)&&void 0!==p?p:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(m=>{const p=JSON.parse(m.created),_=JSON.parse(m.updated),w=JSON.parse(m.failed),J=p.length+_.length+w.length;this.addFacilityFeeSchedules(p),this.updateFacilityFeeSchedules(_),this.toast.success(`${p.length} created, ${_.length} updated, ${w.length} failed of total ${J}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("facilityFeeScheduleId")?(this.route.snapshot.paramMap.get("facilityFeeScheduleId"),this.setFormName("facilityFeeSchedule_edit")):this.setFormName("facilityFeeSchedule_create"),this.route.snapshot.paramMap.has("organizationId")){var c=this.route.snapshot.paramMap.get("organizationId");this.setOrganizationId(c)}if(this.route.snapshot.paramMap.has("specialtyId")){var d=this.route.snapshot.paramMap.get("specialtyId");this.setSpecialtyId(d)}}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.facilityFeeScheduleService.validateFacilityFeeScheduleExcelData(t,i.organizations,i.specialties)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(M1))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function W1(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.facilityFeeSchedule)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let ql=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"facilityFeeSchedule_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.facilityFeeSchedule=i.item})):t.formName&&t.formName.currentValue&&"facilityFeeSchedule_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadFacilityFeeScheduleEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.facilityFeeSchedule=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(So),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-facility-fee-schedule-form"]],inputs:{facilityFeeSchedule:"facilityFeeSchedule",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,W1,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),Kl=(()=>{class s{constructor(){this.autoHeight=!1,this.facilityFeeSchedules=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[{field:"organization.name",headerName:"Organization",filter:"agTextColumnFilter"},{field:"specialty.name",headerName:"Specialty",filter:"agTextColumnFilter"},{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{field:"organizationId",filter:"agTextColumnFilter",hide:!0},{field:"specialtyId",filter:"agTextColumnFilter",hide:!0},{field:"code",filter:"agTextColumnFilter"},{field:"modifier",filter:"agTextColumnFilter"},{field:"description",filter:"agTextColumnFilter"},{headerName:"Medicare Facility Rate",field:"medicareFacilityRate",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.medicareFacilityRate,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{headerName:"Facility Fee",field:"facilityFee",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.facilityFee,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{headerName:"Base Unit",field:"baseUnit",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.baseUnit,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{headerName:"Prof Cf",field:"profCf",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.profCf,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-facility-fee-schedule-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",facilityFeeSchedules:"facilityFeeSchedules"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.facilityFeeSchedules)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function E1(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-facility-fee-schedule-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","facilityFeeSchedule_edit")("formControl",t.formControl)("facilityFeeSchedule",t.facilityFeeSchedule)}}const O1=function(){return{}};function L1(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-facility-fee-schedule-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","facilityFeeSchedule_create")("formControl",t.formControl)("facilityFeeSchedule",e.DdM(3,O1))}}function $1(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-facility-fee-schedule-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("facilityFeeSchedules",o.data.items)}let G1=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadFacilityFeeSchedulesEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.facilityFeeSchedules$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(So))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","facilityFeeSchedule","send","close"],[1,"w-full","h-full","bg-white",3,"facilityFeeSchedules","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,E1,2,3,"ng-template",null,1,e.W1O),e.YNc(3,L1,1,4,"ng-template",null,2,e.W1O),e.YNc(5,$1,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,ql,Kl],encapsulation:2}),s})();function R1(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-facility-fee-schedule-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","facilityFeeSchedule_edit")("facilityFeeSchedule",t.value)}}const Q1=function(){return{}};function V1(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-facility-fee-schedule-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","facilityFeeSchedule_create")("facilityFeeSchedule",e.DdM(2,Q1))}function j1(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-facility-fee-schedule-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("facilityFeeSchedules",t.items)}}let U1=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","facilityFeeSchedule","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","facilityFeeSchedules","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,R1,1,2,"ng-template",null,1,e.W1O),e.YNc(3,V1,1,3,"ng-template",null,2,e.W1O),e.YNc(5,j1,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,ql,Kl],encapsulation:2}),s})(),J1=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[So],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"facility-fee-schedule-select",component:G1,wrappers:["form-field"]},{name:"facility-fee-schedule-grid",component:U1}]})]}),s})(),z1=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[J1]}),s})();var bo=Q(32944);function H1(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.favoriteProvider)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let Zl=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"favoriteProvider_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.favoriteProvider=i.item})):t.formName&&t.formName.currentValue&&"favoriteProvider_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadFavoriteProviderEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.favoriteProvider=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(bo.m),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-favorite-provider-form"]],inputs:{favoriteProvider:"favoriteProvider",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,H1,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),kl=(()=>{class s{constructor(){this.autoHeight=!1,this.favoriteProviders=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[{field:"clinicalProvider.name",headerName:"Clinical Provider",filter:"agTextColumnFilter"},{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{field:"clinicalProviderId",filter:"agTextColumnFilter",hide:!0},{field:"userId",filter:"agTextColumnFilter",hide:!0},{field:"specialtyId",filter:"agTextColumnFilter",hide:!0}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-favorite-provider-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",favoriteProviders:"favoriteProviders"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.favoriteProviders)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function q1(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-favorite-provider-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","favoriteProvider_edit")("formControl",t.formControl)("favoriteProvider",t.favoriteProvider)}}const K1=function(){return{}};function Z1(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-favorite-provider-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","favoriteProvider_create")("formControl",t.formControl)("favoriteProvider",e.DdM(3,K1))}}function k1(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-favorite-provider-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("favoriteProviders",o.data.items)}let B1=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadFavoriteProvidersEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.favoriteProviders$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(bo.m))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","favoriteProvider","send","close"],[1,"w-full","h-full","bg-white",3,"favoriteProviders","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,q1,2,3,"ng-template",null,1,e.W1O),e.YNc(3,Z1,1,4,"ng-template",null,2,e.W1O),e.YNc(5,k1,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,Zl,kl],encapsulation:2}),s})();function Y1(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-favorite-provider-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","favoriteProvider_edit")("favoriteProvider",t.value)}}const X1=function(){return{}};function eM(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-favorite-provider-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","favoriteProvider_create")("favoriteProvider",e.DdM(2,X1))}function tM(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-favorite-provider-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("favoriteProviders",t.items)}}let iM=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","favoriteProvider","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","favoriteProviders","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,Y1,1,2,"ng-template",null,1,e.W1O),e.YNc(3,eM,1,3,"ng-template",null,2,e.W1O),e.YNc(5,tM,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,Zl,kl],encapsulation:2}),s})(),sM=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[bo.m],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"favorite-provider-select",component:B1,wrappers:["form-field"]},{name:"favorite-provider-grid",component:iM}]})]}),s})(),oM=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[sM]}),s})();class ii extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class aM extends ii{constructor(o,t,i){super("ValidateFeeScheduleExcelDataAction"),this.valid=!1,this.excelData=o,this.organizations=t,this.specialties=i}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name),this.validationContext.addRule(new f.mi(`organizationName_${i}_is_valid}`,"Organization Is Not Valid","organization.name",t.organization,this.organizations,!0)),this.validationContext.addRule(new f.mi(`specialtyName_${i}_is_valid}`,"Specialty Is Not Valid","specialty.name",t.specialty,this.specialties,!0))}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class rM extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class nM extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new rM("name","The feeschedule name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class lM extends ii{constructor(o){super("CreateFeeScheduleAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new nM("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateFeeSchedule({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class cM extends ii{constructor(o){super("UpdateFeeSchedulesAction"),this.feeSchedules=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.feeSchedules,!0))}performAction(){this.response=this.businessProvider.data.userUpdateFeeSchedules({input:{feeSchedules:this.feeSchedules}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class dM extends ii{constructor(o,t){super("UpdateFeeScheduleAction"),this.feeSchedule=o,this.feeScheduleId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.feeSchedule,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.feeScheduleId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateFeeSchedule({feeScheduleId:this.feeScheduleId,input:this.feeSchedule}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let Bl=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.FeeScheduleBusinessProviderService",t,a),this.data=i}createFeeSchedule(t){const i=new lM(t);return i.Do(this),i.response}updateFeeSchedule(t,i){const a=new dM(t,i);return a.Do(this),a.response}importFeeSchedules(t){const i=new cM(t);return i.Do(this),i.response}validateFeeScheduleExcelData(t,i,a){const l=new aM(t,i,a);return l.Do(this),l.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),uM=(()=>{class s extends I.nH{constructor(t,i,a){super("FeeScheduleService",a,t),this.businessProvider=i}createFeeSchedule(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createFeeSchedule(i)}updateFeeSchedule(t,i){return this.businessProvider.updateFeeSchedule(t,i)}importFeeSchedules(t){return this.businessProvider.importFeeSchedules(t)}validateFeeScheduleExcelData(t,i,a){return this.businessProvider.validateFeeScheduleExcelData(t,i,a)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(Bl,8),e.LFG(Bl),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),To=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){if(super({loading:!1,feeSchedules:[],done:!1,searchQuery:"",formName:void 0,organizationId:void 0,specialtyId:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.feeScheduleService=H,this.errors$=this.select(n=>n.errors),this.loading$=this.select(n=>n.loading),this.done$=this.select(n=>n.done),this.item$=this.select(n=>n.item),this.feeSchedules$=this.select(n=>n.feeSchedules),this.organizations$=this.select(n=>n.organizations||[]),this.specialties$=this.select(n=>n.specialties||[]),this.organizationId$=this.select(n=>n.organizationId),this.specialtyId$=this.select(n=>n.specialtyId),this.paging$=this.select(n=>n.paging),this.searchQuery$=this.select(n=>n.searchQuery),this.formName$=this.select(n=>n.formName),this.actionResult$=this.select(this.item$,this.done$,(n,r)=>({item:n,done:r}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.feeSchedules$,this.organizations$,this.specialties$,(n,r,m,p,_,w,J)=>({errors:n,loading:r,item:m,formName:p,feeSchedules:_,organizations:w,specialties:J}),{debounce:!0}),this.input$=this.select(this.paging$,this.organizationId$,this.specialtyId$,this.searchQuery$,(n,r,m,p)=>({limit:n.limit,skip:n.skip,name:p,organizationId:r,specialtyId:m,total:n.total})),this.setFormName=this.updater((n,r)=>Object.assign(Object.assign({},n),{formName:r})),this.setOrganizationId=this.updater((n,r)=>Object.assign(Object.assign({},n),{organizationId:r})),this.setSpecialtyId=this.updater((n,r)=>Object.assign(Object.assign({},n),{specialtyId:r})),this.filterOrganizations=n=>this.data.userSelectOrganizations({input:{name:n}}).pipe((0,g._b)(r=>{let m=r.data.items;return this.patchState({organizations:m}),m},r=>this.patchState({errors:r.graphQLErrors?r.graphQLErrors:r})),(0,he.U)(r=>r.data.items)),this.filterSpecialties=n=>this.data.userSelectSpecialties({input:{name:n}}).pipe((0,g._b)(r=>{let m=r.data.items;return this.patchState({specialties:m}),m},r=>this.patchState({errors:r.graphQLErrors?r.graphQLErrors:r})),(0,he.U)(r=>r.data.items)),this.addOrganization=this.updater((n,r)=>Object.assign(Object.assign({},n),{organizations:n.organizations.concat(r)})),this.addSpecialty=this.updater((n,r)=>Object.assign(Object.assign({},n),{specialties:n.specialties.concat(r)})),this.setItem=this.updater((n,r)=>Object.assign(Object.assign({},n),{item:r})),this.addNewFeeSchedule=this.updater((n,r)=>Object.assign(Object.assign({},n),{feeSchedules:[...n.feeSchedules,r]})),this.updateFeeSchedule=this.updater((n,r)=>Object.assign(Object.assign({},n),{feeSchedules:n.feeSchedules.map(m=>m.id===r.id?r:m)})),this.addFeeSchedules=this.updater((n,r)=>Object.assign(Object.assign({},n),{feeSchedules:n.feeSchedules.concat(r)})),this.updateFeeSchedules=this.updater((n,r)=>Object.assign(Object.assign({},n),{feeSchedules:n.feeSchedules.map(m=>r.find(_=>_.id===m.id)||m)})),this.setSearchQuery=this.updater((n,r)=>Object.assign(Object.assign({},n),{searchQuery:r})),this.loadFeeScheduleEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(r=>this.data.userFeeSchedule({feeScheduleId:r}).pipe((0,g._b)(m=>{this.patchState({item:m.data.item,errors:m.errors,loading:!1})},m=>this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})))))),this.loadFeeSchedulesEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([r,m])=>this.data.userFeeSchedules({input:m}).pipe((0,g._b)(p=>this.patchState({paging:{limit:m.limit,skip:m.skip,total:p.data.count.total},feeSchedules:p.data.items,errors:p.errors,loading:!1}),p=>this.patchState({loading:!1,errors:p.graphQLErrors?p.graphQLErrors:p})))))),this.createFeeScheduleEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(r=>this.feeScheduleService.createFeeSchedule(Object.assign({},r)).pipe((0,g._b)(m=>{this.addNewFeeSchedule(m),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:m,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},m=>{m.graphQLErrors?(this.toast.error(m.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})):(this.toast.error(m.Message),this.formService.setErrors(m.Data))}))))),this.updateFeeScheduleEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([r,m])=>this.feeScheduleService.updateFeeSchedule(r,r.id).pipe((0,g._b)(p=>{this.updateFeeSchedule(p),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:p,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},p=>{p.graphQLErrors?(this.toast.error(p.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:p.graphQLErrors?p.graphQLErrors:p})):(this.toast.error(p.Message),this.formService.setErrors(p.Data))}))))),this.deleteFeeScheduleEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([r,m])=>this.data.userDeleteFeeSchedule({feeScheduleId:m.id}).pipe((0,g._b)(p=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:p.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},p=>{p.graphQLErrors?(this.toast.error(p.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:p.graphQLErrors?p.graphQLErrors:p})):(this.toast.error(p.Message),this.formService.setErrors(p.Data))}))))),this.importExcelEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(r=>this.feeScheduleService.importFeeSchedules(r).pipe((0,ce.K)(m=>{var p;return this.toast.error(null!==(p=m.Message)&&void 0!==p?p:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(m=>{const p=JSON.parse(m.created),_=JSON.parse(m.updated),w=JSON.parse(m.failed),J=p.length+_.length+w.length;this.addFeeSchedules(p),this.updateFeeSchedules(_),this.toast.success(`${p.length} created, ${_.length} updated, ${w.length} failed of total ${J}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("feeScheduleId")?(this.route.snapshot.paramMap.get("feeScheduleId"),this.setFormName("feeSchedule_edit")):this.setFormName("feeSchedule_create"),this.route.snapshot.paramMap.has("organizationId")){var c=this.route.snapshot.paramMap.get("organizationId");this.setOrganizationId(c)}if(this.route.snapshot.paramMap.has("specialtyId")){var d=this.route.snapshot.paramMap.get("specialtyId");this.setSpecialtyId(d)}}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.feeScheduleService.validateFeeScheduleExcelData(t,i.organizations,i.specialties)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(uM))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function mM(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.feeSchedule)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let Yl=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"feeSchedule_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.feeSchedule=i.item})):t.formName&&t.formName.currentValue&&"feeSchedule_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadFeeScheduleEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.feeSchedule=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(To),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-fee-schedule-form"]],inputs:{feeSchedule:"feeSchedule",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,mM,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),Xl=(()=>{class s{constructor(){this.autoHeight=!1,this.feeSchedules=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[{field:"organization.name",headerName:"Organization",filter:"agTextColumnFilter"},{field:"specialty.name",headerName:"Specialty",filter:"agTextColumnFilter"},{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{field:"organizationId",filter:"agTextColumnFilter",hide:!0},{field:"specialtyId",filter:"agTextColumnFilter",hide:!0},{field:"code",filter:"agTextColumnFilter"},{field:"modifier",filter:"agTextColumnFilter"},{field:"description",filter:"agTextColumnFilter"},{headerName:"Medicare Physician Non Facility Rate",field:"medicarePhysicianNonFacilityRate",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.medicarePhysicianNonFacilityRate,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{headerName:"Physician Non Facility Fee",field:"physicianNonFacilityFee",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.physicianNonFacilityFee,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{headerName:"Medicare Physician Facility Rate",field:"medicarePhysicianFacilityRate",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.medicarePhysicianFacilityRate,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{headerName:"Physician Facility Fee",field:"physicianFacilityFee",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.physicianFacilityFee,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{field:"baseUnit",filter:"agTextColumnFilter"},{field:"profCf",filter:"agTextColumnFilter"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-fee-schedule-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",feeSchedules:"feeSchedules"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.feeSchedules)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function pM(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-fee-schedule-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","feeSchedule_edit")("formControl",t.formControl)("feeSchedule",t.feeSchedule)}}const hM=function(){return{}};function fM(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-fee-schedule-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","feeSchedule_create")("formControl",t.formControl)("feeSchedule",e.DdM(3,hM))}}function _M(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-fee-schedule-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("feeSchedules",o.data.items)}let gM=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadFeeSchedulesEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.feeSchedules$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(To))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","feeSchedule","send","close"],[1,"w-full","h-full","bg-white",3,"feeSchedules","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,pM,2,3,"ng-template",null,1,e.W1O),e.YNc(3,fM,1,4,"ng-template",null,2,e.W1O),e.YNc(5,_M,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,Yl,Xl],encapsulation:2}),s})();function CM(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-fee-schedule-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","feeSchedule_edit")("feeSchedule",t.value)}}const vM=function(){return{}};function SM(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-fee-schedule-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","feeSchedule_create")("feeSchedule",e.DdM(2,vM))}function bM(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-fee-schedule-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("feeSchedules",t.items)}}let TM=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","feeSchedule","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","feeSchedules","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,CM,1,2,"ng-template",null,1,e.W1O),e.YNc(3,SM,1,3,"ng-template",null,2,e.W1O),e.YNc(5,bM,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,Yl,Xl],encapsulation:2}),s})(),yM=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[To],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"fee-schedule-select",component:gM,wrappers:["form-field"]},{name:"fee-schedule-grid",component:TM}]})]}),s})(),wM=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[yM]}),s})();class si extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class xM extends si{constructor(o,t,i){super("ValidateFirmExcelDataAction"),this.valid=!1,this.excelData=o,this.firmStatuses=t,this.eulas=i}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name),this.validationContext.addRule(new f.mi(`firmStatusName_${i}_is_valid}`,"Firm Status Is Not Valid","firmStatus.name",t.firmStatus,this.firmStatuses,!0)),this.validationContext.addRule(new f.mi(`eulaName_${i}_is_valid}`,"Eula Is Not Valid","eula.name",t.eula,this.eulas,!0))}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class NM extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class AM extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new NM("name","The firm name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class FM extends si{constructor(o){super("CreateFirmAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new AM("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateFirm({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class PM extends si{constructor(o){super("UpdateFirmsAction"),this.firms=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.firms,!0))}performAction(){this.response=this.businessProvider.data.userUpdateFirms({input:{firms:this.firms}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class IM extends si{constructor(o,t){super("UpdateFirmAction"),this.firm=o,this.firmId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.firm,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.firmId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateFirm({firmId:this.firmId,input:this.firm}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let ec=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.FirmBusinessProviderService",t,a),this.data=i}createFirm(t){const i=new FM(t);return i.Do(this),i.response}updateFirm(t,i){const a=new IM(t,i);return a.Do(this),a.response}importFirms(t){const i=new PM(t);return i.Do(this),i.response}validateFirmExcelData(t,i,a){const l=new xM(t,i,a);return l.Do(this),l.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),DM=(()=>{class s extends I.nH{constructor(t,i,a){super("FirmService",a,t),this.businessProvider=i}createFirm(t){var i,a,l,u,H,A;t.firmStatusNote=(null===(i=t.firmStatusNote)||void 0===i?void 0:i.length)>1e3?null===(a=t.firmStatusNote)||void 0===a?void 0:a.substring(0,999):t.firmStatusNote,t.reductionNotes=(null===(l=t.reductionNotes)||void 0===l?void 0:l.length)>1e3?null===(u=t.reductionNotes)||void 0===u?void 0:u.substring(0,999):t.reductionNotes,t.notes=(null===(H=t.notes)||void 0===H?void 0:H.length)>1e3?null===(A=t.notes)||void 0===A?void 0:A.substring(0,999):t.notes;const c=Object.fromEntries(Object.entries(t).filter(([d,n])=>null!==n));return this.businessProvider.createFirm(c)}updateFirm(t,i){var a,l,u,H,A,c;return t.firmStatusNote=(null===(a=t.firmStatusNote)||void 0===a?void 0:a.length)>1e3?null===(l=t.firmStatusNote)||void 0===l?void 0:l.substring(0,999):t.firmStatusNote,t.reductionNotes=(null===(u=t.reductionNotes)||void 0===u?void 0:u.length)>1e3?null===(H=t.reductionNotes)||void 0===H?void 0:H.substring(0,999):t.reductionNotes,t.notes=(null===(A=t.notes)||void 0===A?void 0:A.length)>1e3?null===(c=t.notes)||void 0===c?void 0:c.substring(0,999):t.notes,this.businessProvider.updateFirm(t,i)}importFirms(t){return this.businessProvider.importFirms(t)}validateFirmExcelData(t,i,a){return this.businessProvider.validateFirmExcelData(t,i,a)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(ec,8),e.LFG(ec),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),yo=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){if(super({loading:!1,firms:[],done:!1,searchQuery:"",formName:void 0,firmStatusId:void 0,eulaId:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.firmService=H,this.errors$=this.select(n=>n.errors),this.loading$=this.select(n=>n.loading),this.done$=this.select(n=>n.done),this.item$=this.select(n=>n.item),this.firms$=this.select(n=>n.firms),this.firmStatuses$=this.select(n=>n.firmStatuses||[]),this.documents$=this.select(n=>n.documents||[]),this.firmStatusId$=this.select(n=>n.firmStatusId),this.eulaId$=this.select(n=>n.eulaId),this.paging$=this.select(n=>n.paging),this.searchQuery$=this.select(n=>n.searchQuery),this.formName$=this.select(n=>n.formName),this.actionResult$=this.select(this.item$,this.done$,(n,r)=>({item:n,done:r}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.firms$,this.firmStatuses$,this.documents$,(n,r,m,p,_,w,J)=>({errors:n,loading:r,item:m,formName:p,firms:_,firmStatuses:w,documents:J}),{debounce:!0}),this.input$=this.select(this.paging$,this.firmStatusId$,this.eulaId$,this.searchQuery$,(n,r,m,p)=>({limit:n.limit,skip:n.skip,name:p,firmStatusId:r,eulaId:m,total:n.total})),this.setFormName=this.updater((n,r)=>Object.assign(Object.assign({},n),{formName:r})),this.setFirmStatusId=this.updater((n,r)=>Object.assign(Object.assign({},n),{firmStatusId:r})),this.setEulaId=this.updater((n,r)=>Object.assign(Object.assign({},n),{eulaId:r})),this.filterFirmStatuses=n=>this.data.userSelectFirmStatuses({input:{name:n}}).pipe((0,g._b)(r=>{let m=r.data.items;return this.patchState({firmStatuses:m}),m},r=>this.patchState({errors:r.graphQLErrors?r.graphQLErrors:r})),(0,he.U)(r=>r.data.items)),this.filterDocuments=n=>this.data.userSelectDocuments({input:{name:n}}).pipe((0,g._b)(r=>{let m=r.data.items;return this.patchState({documents:m}),m},r=>this.patchState({errors:r.graphQLErrors?r.graphQLErrors:r})),(0,he.U)(r=>r.data.items)),this.addFirmStatus=this.updater((n,r)=>Object.assign(Object.assign({},n),{firmStatuses:n.firmStatuses.concat(r)})),this.addDocument=this.updater((n,r)=>Object.assign(Object.assign({},n),{documents:n.documents.concat(r)})),this.setItem=this.updater((n,r)=>Object.assign(Object.assign({},n),{item:r})),this.addNewFirm=this.updater((n,r)=>Object.assign(Object.assign({},n),{firms:[...n.firms,r]})),this.updateFirm=this.updater((n,r)=>Object.assign(Object.assign({},n),{firms:n.firms.map(m=>m.id===r.id?r:m)})),this.addFirms=this.updater((n,r)=>Object.assign(Object.assign({},n),{firms:n.firms.concat(r)})),this.updateFirms=this.updater((n,r)=>Object.assign(Object.assign({},n),{firms:n.firms.map(m=>r.find(_=>_.id===m.id)||m)})),this.setSearchQuery=this.updater((n,r)=>Object.assign(Object.assign({},n),{searchQuery:r})),this.loadFirmEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(r=>this.data.userFirm({firmId:r}).pipe((0,g._b)(m=>{this.patchState({item:m.data.item,errors:m.errors,loading:!1})},m=>this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})))))),this.loadFirmsEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([r,m])=>this.data.userFirms({input:m}).pipe((0,g._b)(p=>this.patchState({paging:{limit:m.limit,skip:m.skip,total:p.data.count.total},firms:p.data.items,errors:p.errors,loading:!1}),p=>this.patchState({loading:!1,errors:p.graphQLErrors?p.graphQLErrors:p})))))),this.createFirmEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(r=>this.firmService.createFirm(Object.assign({},r)).pipe((0,g._b)(m=>{this.addNewFirm(m),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:m,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},m=>{m.graphQLErrors?(this.toast.error(m.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})):(this.toast.error(m.Message),this.formService.setErrors(m.Data))}))))),this.updateFirmEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([r,m])=>this.firmService.updateFirm(r,r.id).pipe((0,g._b)(p=>{this.updateFirm(p),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:p,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},p=>{p.graphQLErrors?(this.toast.error(p.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:p.graphQLErrors?p.graphQLErrors:p})):(this.toast.error(p.Message),this.formService.setErrors(p.Data))}))))),this.deleteFirmEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([r,m])=>this.data.userDeleteFirm({firmId:m.id}).pipe((0,g._b)(p=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:p.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},p=>{p.graphQLErrors?(this.toast.error(p.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:p.graphQLErrors?p.graphQLErrors:p})):(this.toast.error(p.Message),this.formService.setErrors(p.Data))}))))),this.importExcelEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(r=>this.firmService.importFirms(r).pipe((0,ce.K)(m=>{var p;return this.toast.error(null!==(p=m.Message)&&void 0!==p?p:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(m=>{const p=JSON.parse(m.created),_=JSON.parse(m.updated),w=JSON.parse(m.failed),J=p.length+_.length+w.length;this.addFirms(p),this.updateFirms(_),this.toast.success(`${p.length} created, ${_.length} updated, ${w.length} failed of total ${J}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("firmId")?(this.route.snapshot.paramMap.get("firmId"),this.setFormName("firm_edit")):this.setFormName("firm_create"),this.route.snapshot.paramMap.has("firmStatusId")){var c=this.route.snapshot.paramMap.get("firmStatusId");this.setFirmStatusId(c)}if(this.route.snapshot.paramMap.has("eulaId")){var d=this.route.snapshot.paramMap.get("eulaId");this.setEulaId(d)}}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.firmService.validateFirmExcelData(t,i.firmStatuses,i.documents)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(DM))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function MM(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.firm)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let tc=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"firm_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.firm=i.item})):t.formName&&t.formName.currentValue&&"firm_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadFirmEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.firm=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(yo),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-firm-form"]],inputs:{firm:"firm",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,MM,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),ic=(()=>{class s{constructor(){this.autoHeight=!1,this.firms=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[{field:"firmStatus.name",headerName:"Firm Status",filter:"agTextColumnFilter"},{field:"eula.name",headerName:"Eula",filter:"agTextColumnFilter"},{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{field:"firmStatusNote",filter:"agTextColumnFilter"},{field:"firmStatusId",filter:"agTextColumnFilter",hide:!0},{field:"firmName",filter:"agTextColumnFilter"},{field:"address",filter:"agTextColumnFilter"},{field:"address2",filter:"agTextColumnFilter"},{field:"city",filter:"agTextColumnFilter"},{field:"state",filter:"agTextColumnFilter"},{field:"zip",filter:"agTextColumnFilter"},{field:"country",filter:"agTextColumnFilter"},{field:"office",filter:"agTextColumnFilter"},{field:"fax",filter:"agTextColumnFilter"},{field:"webAddress",filter:"agTextColumnFilter"},{field:"email",filter:"agTextColumnFilter"},{headerName:"Rating",field:"rating",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.rating,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{field:"notes",filter:"agTextColumnFilter"},{headerName:"Do Not Disturb",field:"doNotDisturb",filter:"agSetColumnFilter",cellRenderer:"checkboxRenderer"},{headerName:"Invoice Only",field:"invoiceOnly",filter:"agSetColumnFilter",cellRenderer:"checkboxRenderer"},{field:"reductionNotes",filter:"agTextColumnFilter"},{headerName:"Deceased",field:"deceased",filter:"agSetColumnFilter",cellRenderer:"checkboxRenderer"},{field:"createdBy",filter:"agTextColumnFilter"},{field:"dateCreated",filter:"agDateColumnFilter"},{field:"eulaId",filter:"agTextColumnFilter",hide:!0}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-firm-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",firms:"firms"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.firms)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function WM(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-firm-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","firm_edit")("formControl",t.formControl)("firm",t.firm)}}const EM=function(){return{}};function OM(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-firm-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","firm_create")("formControl",t.formControl)("firm",e.DdM(3,EM))}}function LM(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-firm-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("firms",o.data.items)}let $M=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadFirmsEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.firms$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(yo))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","firm","send","close"],[1,"w-full","h-full","bg-white",3,"firms","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,WM,2,3,"ng-template",null,1,e.W1O),e.YNc(3,OM,1,4,"ng-template",null,2,e.W1O),e.YNc(5,LM,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,tc,ic],encapsulation:2}),s})();function GM(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-firm-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","firm_edit")("firm",t.value)}}const RM=function(){return{}};function QM(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-firm-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","firm_create")("firm",e.DdM(2,RM))}function VM(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-firm-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("firms",t.items)}}let jM=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","firm","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","firms","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,GM,1,2,"ng-template",null,1,e.W1O),e.YNc(3,QM,1,3,"ng-template",null,2,e.W1O),e.YNc(5,VM,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,tc,ic],encapsulation:2}),s})(),UM=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[yo],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"firm-select",component:$M,wrappers:["form-field"]},{name:"firm-grid",component:jM}]})]}),s})(),JM=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[UM]}),s})();class oi extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class zM extends oi{constructor(o){super("ValidateFirmStatusExcelDataAction"),this.valid=!1,this.excelData=o}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name)}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class HM extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class qM extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new HM("name","The firmstatus name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class KM extends oi{constructor(o){super("CreateFirmStatusAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new qM("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateFirmStatus({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class ZM extends oi{constructor(o){super("UpdateFirmStatusesAction"),this.firmStatuses=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.firmStatuses,!0))}performAction(){this.response=this.businessProvider.data.userUpdateFirmStatuses({input:{firmStatuses:this.firmStatuses}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class kM extends oi{constructor(o,t){super("UpdateFirmStatusAction"),this.firmStatus=o,this.firmStatusId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.firmStatus,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.firmStatusId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateFirmStatus({firmStatusId:this.firmStatusId,input:this.firmStatus}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let sc=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.FirmStatusBusinessProviderService",t,a),this.data=i}createFirmStatus(t){const i=new KM(t);return i.Do(this),i.response}updateFirmStatus(t,i){const a=new kM(t,i);return a.Do(this),a.response}importFirmStatuses(t){const i=new ZM(t);return i.Do(this),i.response}validateFirmStatusExcelData(t){const i=new zM(t);return i.Do(this),i.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),BM=(()=>{class s extends I.nH{constructor(t,i,a){super("FirmStatusService",a,t),this.businessProvider=i}createFirmStatus(t){var i,a;t.name=(null===(i=t.name)||void 0===i?void 0:i.length)>256?null===(a=t.name)||void 0===a?void 0:a.substring(0,255):t.name;const l=Object.fromEntries(Object.entries(t).filter(([u,H])=>null!==H));return this.businessProvider.createFirmStatus(l)}updateFirmStatus(t,i){var a,l;return t.name=(null===(a=t.name)||void 0===a?void 0:a.length)>256?null===(l=t.name)||void 0===l?void 0:l.substring(0,255):t.name,this.businessProvider.updateFirmStatus(t,i)}importFirmStatuses(t){return this.businessProvider.importFirmStatuses(t)}validateFirmStatusExcelData(t){return this.businessProvider.validateFirmStatusExcelData(t)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(sc,8),e.LFG(sc),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),wo=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){super({loading:!1,firmStatuses:[],done:!1,searchQuery:"",formName:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.firmStatusService=H,this.errors$=this.select(c=>c.errors),this.loading$=this.select(c=>c.loading),this.done$=this.select(c=>c.done),this.item$=this.select(c=>c.item),this.firmStatuses$=this.select(c=>c.firmStatuses),this.paging$=this.select(c=>c.paging),this.searchQuery$=this.select(c=>c.searchQuery),this.formName$=this.select(c=>c.formName),this.actionResult$=this.select(this.item$,this.done$,(c,d)=>({item:c,done:d}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.firmStatuses$,(c,d,n,r,m)=>({errors:c,loading:d,item:n,formName:r,firmStatuses:m}),{debounce:!0}),this.input$=this.select(this.paging$,this.searchQuery$,(c,d)=>({limit:c.limit,skip:c.skip,name:d,total:c.total})),this.setFormName=this.updater((c,d)=>Object.assign(Object.assign({},c),{formName:d})),this.setItem=this.updater((c,d)=>Object.assign(Object.assign({},c),{item:d})),this.addNewFirmStatus=this.updater((c,d)=>Object.assign(Object.assign({},c),{firmStatuses:[...c.firmStatuses,d]})),this.updateFirmStatus=this.updater((c,d)=>Object.assign(Object.assign({},c),{firmStatuses:c.firmStatuses.map(n=>n.id===d.id?d:n)})),this.addFirmStatuses=this.updater((c,d)=>Object.assign(Object.assign({},c),{firmStatuses:c.firmStatuses.concat(d)})),this.updateFirmStatuses=this.updater((c,d)=>Object.assign(Object.assign({},c),{firmStatuses:c.firmStatuses.map(n=>d.find(m=>m.id===n.id)||n)})),this.setSearchQuery=this.updater((c,d)=>Object.assign(Object.assign({},c),{searchQuery:d})),this.loadFirmStatusEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.data.userFirmStatus({firmStatusId:d}).pipe((0,g._b)(n=>{this.patchState({item:n.data.item,errors:n.errors,loading:!1})},n=>this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})))))),this.loadFirmStatusesEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([d,n])=>this.data.userFirmStatuses({input:n}).pipe((0,g._b)(r=>this.patchState({paging:{limit:n.limit,skip:n.skip,total:r.data.count.total},firmStatuses:r.data.items,errors:r.errors,loading:!1}),r=>this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})))))),this.createFirmStatusEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.firmStatusService.createFirmStatus(Object.assign({},d)).pipe((0,g._b)(n=>{this.addNewFirmStatus(n),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:n,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},n=>{n.graphQLErrors?(this.toast.error(n.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})):(this.toast.error(n.Message),this.formService.setErrors(n.Data))}))))),this.updateFirmStatusEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.firmStatusService.updateFirmStatus(d,d.id).pipe((0,g._b)(r=>{this.updateFirmStatus(r),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:r,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.deleteFirmStatusEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.data.userDeleteFirmStatus({firmStatusId:n.id}).pipe((0,g._b)(r=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:r.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.importExcelEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.firmStatusService.importFirmStatuses(d).pipe((0,ce.K)(n=>{var r;return this.toast.error(null!==(r=n.Message)&&void 0!==r?r:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(n=>{const r=JSON.parse(n.created),m=JSON.parse(n.updated),p=JSON.parse(n.failed),_=r.length+m.length+p.length;this.addFirmStatuses(r),this.updateFirmStatuses(m),this.toast.success(`${r.length} created, ${m.length} updated, ${p.length} failed of total ${_}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("firmStatusId")?(this.route.snapshot.paramMap.get("firmStatusId"),this.setFormName("firmStatus_edit")):this.setFormName("firmStatus_create")}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.firmStatusService.validateFirmStatusExcelData(t)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(BM))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function YM(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.firmStatus)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let oc=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"firmStatus_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.firmStatus=i.item})):t.formName&&t.formName.currentValue&&"firmStatus_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadFirmStatusEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.firmStatus=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(wo),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-firm-status-form"]],inputs:{firmStatus:"firmStatus",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,YM,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),ac=(()=>{class s{constructor(){this.autoHeight=!1,this.firmStatuses=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[,{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{headerName:"Black Listed",field:"blackListed",filter:"agSetColumnFilter",cellRenderer:"checkboxRenderer"},{headerName:"Active",field:"active",filter:"agSetColumnFilter",cellRenderer:"checkboxRenderer"},{field:"statusColor",filter:"agTextColumnFilter"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-firm-status-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",firmStatuses:"firmStatuses"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.firmStatuses)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function XM(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-firm-status-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","firmStatus_edit")("formControl",t.formControl)("firmStatus",t.firmStatus)}}const eW=function(){return{}};function tW(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-firm-status-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","firmStatus_create")("formControl",t.formControl)("firmStatus",e.DdM(3,eW))}}function iW(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-firm-status-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("firmStatuses",o.data.items)}let sW=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadFirmStatusesEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.firmStatuses$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(wo))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","firmStatus","send","close"],[1,"w-full","h-full","bg-white",3,"firmStatuses","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,XM,2,3,"ng-template",null,1,e.W1O),e.YNc(3,tW,1,4,"ng-template",null,2,e.W1O),e.YNc(5,iW,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,oc,ac],encapsulation:2}),s})();function oW(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-firm-status-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","firmStatus_edit")("firmStatus",t.value)}}const aW=function(){return{}};function rW(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-firm-status-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","firmStatus_create")("firmStatus",e.DdM(2,aW))}function nW(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-firm-status-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("firmStatuses",t.items)}}let lW=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","firmStatus","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","firmStatuses","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,oW,1,2,"ng-template",null,1,e.W1O),e.YNc(3,rW,1,3,"ng-template",null,2,e.W1O),e.YNc(5,nW,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,oc,ac],encapsulation:2}),s})(),cW=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[wo],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"firm-status-select",component:sW,wrappers:["form-field"]},{name:"firm-status-grid",component:lW}]})]}),s})(),dW=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[cW]}),s})();var xo=Q(28816);function uW(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.gender)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let rc=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"gender_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.gender=i.item})):t.formName&&t.formName.currentValue&&"gender_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadGenderEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.gender=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(xo._),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-gender-form"]],inputs:{gender:"gender",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,uW,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),nc=(()=>{class s{constructor(){this.autoHeight=!1,this.genders=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[,{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{field:"code",filter:"agTextColumnFilter"},{headerName:"Value",field:"value",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.value,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-gender-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",genders:"genders"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.genders)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function mW(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-gender-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","gender_edit")("formControl",t.formControl)("gender",t.gender)}}const pW=function(){return{}};function hW(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-gender-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","gender_create")("formControl",t.formControl)("gender",e.DdM(3,pW))}}function fW(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-gender-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("genders",o.data.items)}let _W=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadGendersEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.genders$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(xo._))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","gender","send","close"],[1,"w-full","h-full","bg-white",3,"genders","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,mW,2,3,"ng-template",null,1,e.W1O),e.YNc(3,hW,1,4,"ng-template",null,2,e.W1O),e.YNc(5,fW,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,rc,nc],encapsulation:2}),s})();function gW(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-gender-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","gender_edit")("gender",t.value)}}const CW=function(){return{}};function vW(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-gender-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","gender_create")("gender",e.DdM(2,CW))}function SW(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-gender-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("genders",t.items)}}let bW=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","gender","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","genders","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,gW,1,2,"ng-template",null,1,e.W1O),e.YNc(3,vW,1,3,"ng-template",null,2,e.W1O),e.YNc(5,SW,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,rc,nc],encapsulation:2}),s})(),TW=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[xo._],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"gender-select",component:_W,wrappers:["form-field"]},{name:"gender-grid",component:bW}]})]}),s})(),yW=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[TW]}),s})();class ai extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class wW extends ai{constructor(o){super("ValidateGuidelineExcelDataAction"),this.valid=!1,this.excelData=o}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name)}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class xW extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class NW extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new xW("name","The guideline name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class AW extends ai{constructor(o){super("CreateGuidelineAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new NW("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateGuideline({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class FW extends ai{constructor(o){super("UpdateGuidelinesAction"),this.guidelines=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.guidelines,!0))}performAction(){this.response=this.businessProvider.data.userUpdateGuidelines({input:{guidelines:this.guidelines}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class PW extends ai{constructor(o,t){super("UpdateGuidelineAction"),this.guideline=o,this.guidelineId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.guideline,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.guidelineId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateGuideline({guidelineId:this.guidelineId,input:this.guideline}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let lc=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.GuidelineBusinessProviderService",t,a),this.data=i}createGuideline(t){const i=new AW(t);return i.Do(this),i.response}updateGuideline(t,i){const a=new PW(t,i);return a.Do(this),a.response}importGuidelines(t){const i=new FW(t);return i.Do(this),i.response}validateGuidelineExcelData(t){const i=new wW(t);return i.Do(this),i.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),IW=(()=>{class s extends I.nH{constructor(t,i,a){super("GuidelineService",a,t),this.businessProvider=i}createGuideline(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createGuideline(i)}updateGuideline(t,i){return this.businessProvider.updateGuideline(t,i)}importGuidelines(t){return this.businessProvider.importGuidelines(t)}validateGuidelineExcelData(t){return this.businessProvider.validateGuidelineExcelData(t)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(lc,8),e.LFG(lc),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),No=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){super({loading:!1,guidelines:[],done:!1,searchQuery:"",formName:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.guidelineService=H,this.errors$=this.select(c=>c.errors),this.loading$=this.select(c=>c.loading),this.done$=this.select(c=>c.done),this.item$=this.select(c=>c.item),this.guidelines$=this.select(c=>c.guidelines),this.paging$=this.select(c=>c.paging),this.searchQuery$=this.select(c=>c.searchQuery),this.formName$=this.select(c=>c.formName),this.actionResult$=this.select(this.item$,this.done$,(c,d)=>({item:c,done:d}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.guidelines$,(c,d,n,r,m)=>({errors:c,loading:d,item:n,formName:r,guidelines:m}),{debounce:!0}),this.input$=this.select(this.paging$,this.searchQuery$,(c,d)=>({limit:c.limit,skip:c.skip,name:d,total:c.total})),this.setFormName=this.updater((c,d)=>Object.assign(Object.assign({},c),{formName:d})),this.setItem=this.updater((c,d)=>Object.assign(Object.assign({},c),{item:d})),this.addNewGuideline=this.updater((c,d)=>Object.assign(Object.assign({},c),{guidelines:[...c.guidelines,d]})),this.updateGuideline=this.updater((c,d)=>Object.assign(Object.assign({},c),{guidelines:c.guidelines.map(n=>n.id===d.id?d:n)})),this.addGuidelines=this.updater((c,d)=>Object.assign(Object.assign({},c),{guidelines:c.guidelines.concat(d)})),this.updateGuidelines=this.updater((c,d)=>Object.assign(Object.assign({},c),{guidelines:c.guidelines.map(n=>d.find(m=>m.id===n.id)||n)})),this.setSearchQuery=this.updater((c,d)=>Object.assign(Object.assign({},c),{searchQuery:d})),this.loadGuidelineEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.data.userGuideline({guidelineId:d}).pipe((0,g._b)(n=>{this.patchState({item:n.data.item,errors:n.errors,loading:!1})},n=>this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})))))),this.loadGuidelinesEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([d,n])=>this.data.userGuidelines({input:n}).pipe((0,g._b)(r=>this.patchState({paging:{limit:n.limit,skip:n.skip,total:r.data.count.total},guidelines:r.data.items,errors:r.errors,loading:!1}),r=>this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})))))),this.createGuidelineEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.guidelineService.createGuideline(Object.assign({},d)).pipe((0,g._b)(n=>{this.addNewGuideline(n),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:n,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},n=>{n.graphQLErrors?(this.toast.error(n.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})):(this.toast.error(n.Message),this.formService.setErrors(n.Data))}))))),this.updateGuidelineEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.guidelineService.updateGuideline(d,d.id).pipe((0,g._b)(r=>{this.updateGuideline(r),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:r,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.deleteGuidelineEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.data.userDeleteGuideline({guidelineId:n.id}).pipe((0,g._b)(r=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:r.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.importExcelEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.guidelineService.importGuidelines(d).pipe((0,ce.K)(n=>{var r;return this.toast.error(null!==(r=n.Message)&&void 0!==r?r:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(n=>{const r=JSON.parse(n.created),m=JSON.parse(n.updated),p=JSON.parse(n.failed),_=r.length+m.length+p.length;this.addGuidelines(r),this.updateGuidelines(m),this.toast.success(`${r.length} created, ${m.length} updated, ${p.length} failed of total ${_}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("guidelineId")?(this.route.snapshot.paramMap.get("guidelineId"),this.setFormName("guideline_edit")):this.setFormName("guideline_create")}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.guidelineService.validateGuidelineExcelData(t)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(IW))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function DW(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.guideline)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let cc=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"guideline_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.guideline=i.item})):t.formName&&t.formName.currentValue&&"guideline_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadGuidelineEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.guideline=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(No),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-guideline-form"]],inputs:{guideline:"guideline",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,DW,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),dc=(()=>{class s{constructor(){this.autoHeight=!1,this.guidelines=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[,{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-guideline-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",guidelines:"guidelines"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.guidelines)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function MW(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-guideline-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","guideline_edit")("formControl",t.formControl)("guideline",t.guideline)}}const WW=function(){return{}};function EW(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-guideline-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","guideline_create")("formControl",t.formControl)("guideline",e.DdM(3,WW))}}function OW(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-guideline-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("guidelines",o.data.items)}let LW=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadGuidelinesEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.guidelines$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(No))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","guideline","send","close"],[1,"w-full","h-full","bg-white",3,"guidelines","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,MW,2,3,"ng-template",null,1,e.W1O),e.YNc(3,EW,1,4,"ng-template",null,2,e.W1O),e.YNc(5,OW,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,cc,dc],encapsulation:2}),s})();function $W(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-guideline-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","guideline_edit")("guideline",t.value)}}const GW=function(){return{}};function RW(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-guideline-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","guideline_create")("guideline",e.DdM(2,GW))}function QW(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-guideline-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("guidelines",t.items)}}let VW=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","guideline","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","guidelines","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,$W,1,2,"ng-template",null,1,e.W1O),e.YNc(3,RW,1,3,"ng-template",null,2,e.W1O),e.YNc(5,QW,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,cc,dc],encapsulation:2}),s})(),jW=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[No],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"guideline-select",component:LW,wrappers:["form-field"]},{name:"guideline-grid",component:VW}]})]}),s})(),UW=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[jW]}),s})();class ri extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class JW extends ri{constructor(o){super("ValidateGuidelineUsedExcelDataAction"),this.valid=!1,this.excelData=o}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name)}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class zW extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class HW extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new zW("name","The guidelineused name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class qW extends ri{constructor(o){super("CreateGuidelineUsedAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new HW("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateGuidelineUsed({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class KW extends ri{constructor(o){super("UpdateGuidelineUsedsAction"),this.guidelineUseds=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.guidelineUseds,!0))}performAction(){this.response=this.businessProvider.data.userUpdateGuidelineUseds({input:{guidelineUseds:this.guidelineUseds}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class ZW extends ri{constructor(o,t){super("UpdateGuidelineUsedAction"),this.guidelineUsed=o,this.guidelineUsedId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.guidelineUsed,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.guidelineUsedId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateGuidelineUsed({guidelineUsedId:this.guidelineUsedId,input:this.guidelineUsed}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let uc=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.GuidelineUsedBusinessProviderService",t,a),this.data=i}createGuidelineUsed(t){const i=new qW(t);return i.Do(this),i.response}updateGuidelineUsed(t,i){const a=new ZW(t,i);return a.Do(this),a.response}importGuidelineUseds(t){const i=new KW(t);return i.Do(this),i.response}validateGuidelineUsedExcelData(t){const i=new JW(t);return i.Do(this),i.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),kW=(()=>{class s extends I.nH{constructor(t,i,a){super("GuidelineUsedService",a,t),this.businessProvider=i}createGuidelineUsed(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createGuidelineUsed(i)}updateGuidelineUsed(t,i){return this.businessProvider.updateGuidelineUsed(t,i)}importGuidelineUseds(t){return this.businessProvider.importGuidelineUseds(t)}validateGuidelineUsedExcelData(t){return this.businessProvider.validateGuidelineUsedExcelData(t)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(uc,8),e.LFG(uc),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),Ao=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){super({loading:!1,guidelineUseds:[],done:!1,searchQuery:"",formName:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.guidelineUsedService=H,this.errors$=this.select(c=>c.errors),this.loading$=this.select(c=>c.loading),this.done$=this.select(c=>c.done),this.item$=this.select(c=>c.item),this.guidelineUseds$=this.select(c=>c.guidelineUseds),this.paging$=this.select(c=>c.paging),this.searchQuery$=this.select(c=>c.searchQuery),this.formName$=this.select(c=>c.formName),this.actionResult$=this.select(this.item$,this.done$,(c,d)=>({item:c,done:d}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.guidelineUseds$,(c,d,n,r,m)=>({errors:c,loading:d,item:n,formName:r,guidelineUseds:m}),{debounce:!0}),this.input$=this.select(this.paging$,this.searchQuery$,(c,d)=>({limit:c.limit,skip:c.skip,name:d,total:c.total})),this.setFormName=this.updater((c,d)=>Object.assign(Object.assign({},c),{formName:d})),this.setItem=this.updater((c,d)=>Object.assign(Object.assign({},c),{item:d})),this.addNewGuidelineUsed=this.updater((c,d)=>Object.assign(Object.assign({},c),{guidelineUseds:[...c.guidelineUseds,d]})),this.updateGuidelineUsed=this.updater((c,d)=>Object.assign(Object.assign({},c),{guidelineUseds:c.guidelineUseds.map(n=>n.id===d.id?d:n)})),this.addGuidelineUseds=this.updater((c,d)=>Object.assign(Object.assign({},c),{guidelineUseds:c.guidelineUseds.concat(d)})),this.updateGuidelineUseds=this.updater((c,d)=>Object.assign(Object.assign({},c),{guidelineUseds:c.guidelineUseds.map(n=>d.find(m=>m.id===n.id)||n)})),this.setSearchQuery=this.updater((c,d)=>Object.assign(Object.assign({},c),{searchQuery:d})),this.loadGuidelineUsedEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.data.userGuidelineUsed({guidelineUsedId:d}).pipe((0,g._b)(n=>{this.patchState({item:n.data.item,errors:n.errors,loading:!1})},n=>this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})))))),this.loadGuidelineUsedsEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([d,n])=>this.data.userGuidelineUseds({input:n}).pipe((0,g._b)(r=>this.patchState({paging:{limit:n.limit,skip:n.skip,total:r.data.count.total},guidelineUseds:r.data.items,errors:r.errors,loading:!1}),r=>this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})))))),this.createGuidelineUsedEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.guidelineUsedService.createGuidelineUsed(Object.assign({},d)).pipe((0,g._b)(n=>{this.addNewGuidelineUsed(n),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:n,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},n=>{n.graphQLErrors?(this.toast.error(n.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})):(this.toast.error(n.Message),this.formService.setErrors(n.Data))}))))),this.updateGuidelineUsedEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.guidelineUsedService.updateGuidelineUsed(d,d.id).pipe((0,g._b)(r=>{this.updateGuidelineUsed(r),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:r,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.deleteGuidelineUsedEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.data.userDeleteGuidelineUsed({guidelineUsedId:n.id}).pipe((0,g._b)(r=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:r.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.importExcelEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.guidelineUsedService.importGuidelineUseds(d).pipe((0,ce.K)(n=>{var r;return this.toast.error(null!==(r=n.Message)&&void 0!==r?r:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(n=>{const r=JSON.parse(n.created),m=JSON.parse(n.updated),p=JSON.parse(n.failed),_=r.length+m.length+p.length;this.addGuidelineUseds(r),this.updateGuidelineUseds(m),this.toast.success(`${r.length} created, ${m.length} updated, ${p.length} failed of total ${_}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("guidelineUsedId")?(this.route.snapshot.paramMap.get("guidelineUsedId"),this.setFormName("guidelineUsed_edit")):this.setFormName("guidelineUsed_create")}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.guidelineUsedService.validateGuidelineUsedExcelData(t)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(kW))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function BW(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.guidelineUsed)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let mc=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"guidelineUsed_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.guidelineUsed=i.item})):t.formName&&t.formName.currentValue&&"guidelineUsed_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadGuidelineUsedEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.guidelineUsed=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Ao),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-guideline-used-form"]],inputs:{guidelineUsed:"guidelineUsed",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,BW,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),pc=(()=>{class s{constructor(){this.autoHeight=!1,this.guidelineUseds=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[,{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-guideline-used-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",guidelineUseds:"guidelineUseds"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.guidelineUseds)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function YW(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-guideline-used-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","guidelineUsed_edit")("formControl",t.formControl)("guidelineUsed",t.guidelineUsed)}}const XW=function(){return{}};function eE(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-guideline-used-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","guidelineUsed_create")("formControl",t.formControl)("guidelineUsed",e.DdM(3,XW))}}function tE(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-guideline-used-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("guidelineUseds",o.data.items)}let iE=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadGuidelineUsedsEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.guidelineUseds$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Ao))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","guidelineUsed","send","close"],[1,"w-full","h-full","bg-white",3,"guidelineUseds","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,YW,2,3,"ng-template",null,1,e.W1O),e.YNc(3,eE,1,4,"ng-template",null,2,e.W1O),e.YNc(5,tE,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,mc,pc],encapsulation:2}),s})();function sE(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-guideline-used-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","guidelineUsed_edit")("guidelineUsed",t.value)}}const oE=function(){return{}};function aE(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-guideline-used-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","guidelineUsed_create")("guidelineUsed",e.DdM(2,oE))}function rE(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-guideline-used-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("guidelineUseds",t.items)}}let nE=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","guidelineUsed","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","guidelineUseds","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,sE,1,2,"ng-template",null,1,e.W1O),e.YNc(3,aE,1,3,"ng-template",null,2,e.W1O),e.YNc(5,rE,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,mc,pc],encapsulation:2}),s})(),lE=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[Ao],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"guideline-used-select",component:iE,wrappers:["form-field"]},{name:"guideline-used-grid",component:nE}]})]}),s})(),cE=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[lE]}),s})();class ni extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class dE extends ni{constructor(o){super("ValidateHealthInsuranceExcelDataAction"),this.valid=!1,this.excelData=o}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name)}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class uE extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class mE extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new uE("name","The healthinsurance name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class pE extends ni{constructor(o){super("CreateHealthInsuranceAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new mE("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateHealthInsurance({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class hE extends ni{constructor(o){super("UpdateHealthInsurancesAction"),this.healthInsurances=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.healthInsurances,!0))}performAction(){this.response=this.businessProvider.data.userUpdateHealthInsurances({input:{healthInsurances:this.healthInsurances}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class fE extends ni{constructor(o,t){super("UpdateHealthInsuranceAction"),this.healthInsurance=o,this.healthInsuranceId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.healthInsurance,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.healthInsuranceId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateHealthInsurance({healthInsuranceId:this.healthInsuranceId,input:this.healthInsurance}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let hc=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.HealthInsuranceBusinessProviderService",t,a),this.data=i}createHealthInsurance(t){const i=new pE(t);return i.Do(this),i.response}updateHealthInsurance(t,i){const a=new fE(t,i);return a.Do(this),a.response}importHealthInsurances(t){const i=new hE(t);return i.Do(this),i.response}validateHealthInsuranceExcelData(t){const i=new dE(t);return i.Do(this),i.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),_E=(()=>{class s extends I.nH{constructor(t,i,a){super("HealthInsuranceService",a,t),this.businessProvider=i}createHealthInsurance(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createHealthInsurance(i)}updateHealthInsurance(t,i){return this.businessProvider.updateHealthInsurance(t,i)}importHealthInsurances(t){return this.businessProvider.importHealthInsurances(t)}validateHealthInsuranceExcelData(t){return this.businessProvider.validateHealthInsuranceExcelData(t)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(hc,8),e.LFG(hc),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),Fo=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){super({loading:!1,healthInsurances:[],done:!1,searchQuery:"",formName:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.healthInsuranceService=H,this.errors$=this.select(c=>c.errors),this.loading$=this.select(c=>c.loading),this.done$=this.select(c=>c.done),this.item$=this.select(c=>c.item),this.healthInsurances$=this.select(c=>c.healthInsurances),this.paging$=this.select(c=>c.paging),this.searchQuery$=this.select(c=>c.searchQuery),this.formName$=this.select(c=>c.formName),this.actionResult$=this.select(this.item$,this.done$,(c,d)=>({item:c,done:d}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.healthInsurances$,(c,d,n,r,m)=>({errors:c,loading:d,item:n,formName:r,healthInsurances:m}),{debounce:!0}),this.input$=this.select(this.paging$,this.searchQuery$,(c,d)=>({limit:c.limit,skip:c.skip,name:d,total:c.total})),this.setFormName=this.updater((c,d)=>Object.assign(Object.assign({},c),{formName:d})),this.setItem=this.updater((c,d)=>Object.assign(Object.assign({},c),{item:d})),this.addNewHealthInsurance=this.updater((c,d)=>Object.assign(Object.assign({},c),{healthInsurances:[...c.healthInsurances,d]})),this.updateHealthInsurance=this.updater((c,d)=>Object.assign(Object.assign({},c),{healthInsurances:c.healthInsurances.map(n=>n.id===d.id?d:n)})),this.addHealthInsurances=this.updater((c,d)=>Object.assign(Object.assign({},c),{healthInsurances:c.healthInsurances.concat(d)})),this.updateHealthInsurances=this.updater((c,d)=>Object.assign(Object.assign({},c),{healthInsurances:c.healthInsurances.map(n=>d.find(m=>m.id===n.id)||n)})),this.setSearchQuery=this.updater((c,d)=>Object.assign(Object.assign({},c),{searchQuery:d})),this.loadHealthInsuranceEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.data.userHealthInsurance({healthInsuranceId:d}).pipe((0,g._b)(n=>{this.patchState({item:n.data.item,errors:n.errors,loading:!1})},n=>this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})))))),this.loadHealthInsurancesEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([d,n])=>this.data.userHealthInsurances({input:n}).pipe((0,g._b)(r=>this.patchState({paging:{limit:n.limit,skip:n.skip,total:r.data.count.total},healthInsurances:r.data.items,errors:r.errors,loading:!1}),r=>this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})))))),this.createHealthInsuranceEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.healthInsuranceService.createHealthInsurance(Object.assign({},d)).pipe((0,g._b)(n=>{this.addNewHealthInsurance(n),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:n,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},n=>{n.graphQLErrors?(this.toast.error(n.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})):(this.toast.error(n.Message),this.formService.setErrors(n.Data))}))))),this.updateHealthInsuranceEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.healthInsuranceService.updateHealthInsurance(d,d.id).pipe((0,g._b)(r=>{this.updateHealthInsurance(r),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:r,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.deleteHealthInsuranceEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.data.userDeleteHealthInsurance({healthInsuranceId:n.id}).pipe((0,g._b)(r=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:r.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.importExcelEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.healthInsuranceService.importHealthInsurances(d).pipe((0,ce.K)(n=>{var r;return this.toast.error(null!==(r=n.Message)&&void 0!==r?r:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(n=>{const r=JSON.parse(n.created),m=JSON.parse(n.updated),p=JSON.parse(n.failed),_=r.length+m.length+p.length;this.addHealthInsurances(r),this.updateHealthInsurances(m),this.toast.success(`${r.length} created, ${m.length} updated, ${p.length} failed of total ${_}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("healthInsuranceId")?(this.route.snapshot.paramMap.get("healthInsuranceId"),this.setFormName("healthInsurance_edit")):this.setFormName("healthInsurance_create")}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.healthInsuranceService.validateHealthInsuranceExcelData(t)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(_E))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function gE(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.healthInsurance)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let fc=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"healthInsurance_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.healthInsurance=i.item})):t.formName&&t.formName.currentValue&&"healthInsurance_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadHealthInsuranceEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.healthInsurance=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Fo),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-health-insurance-form"]],inputs:{healthInsurance:"healthInsurance",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,gE,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),_c=(()=>{class s{constructor(){this.autoHeight=!1,this.healthInsurances=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[,{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{field:"healthInsuranceKind",filter:"agTextColumnFilter"},{field:"identificationGroupNumber",filter:"agTextColumnFilter"},{field:"mediCalNumber",filter:"agTextColumnFilter"},{field:"medicareNumber",filter:"agTextColumnFilter"},{field:"policyNumber",filter:"agTextColumnFilter"},{field:"legalCaseId",filter:"agTextColumnFilter",hide:!0}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-health-insurance-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",healthInsurances:"healthInsurances"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.healthInsurances)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function CE(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-health-insurance-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","healthInsurance_edit")("formControl",t.formControl)("healthInsurance",t.healthInsurance)}}const vE=function(){return{}};function SE(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-health-insurance-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","healthInsurance_create")("formControl",t.formControl)("healthInsurance",e.DdM(3,vE))}}function bE(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-health-insurance-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("healthInsurances",o.data.items)}let TE=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadHealthInsurancesEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.healthInsurances$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Fo))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","healthInsurance","send","close"],[1,"w-full","h-full","bg-white",3,"healthInsurances","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,CE,2,3,"ng-template",null,1,e.W1O),e.YNc(3,SE,1,4,"ng-template",null,2,e.W1O),e.YNc(5,bE,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,fc,_c],encapsulation:2}),s})();function yE(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-health-insurance-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","healthInsurance_edit")("healthInsurance",t.value)}}const wE=function(){return{}};function xE(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-health-insurance-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","healthInsurance_create")("healthInsurance",e.DdM(2,wE))}function NE(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-health-insurance-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("healthInsurances",t.items)}}let AE=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","healthInsurance","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","healthInsurances","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,yE,1,2,"ng-template",null,1,e.W1O),e.YNc(3,xE,1,3,"ng-template",null,2,e.W1O),e.YNc(5,NE,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,fc,_c],encapsulation:2}),s})(),FE=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[Fo],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"health-insurance-select",component:TE,wrappers:["form-field"]},{name:"health-insurance-grid",component:AE}]})]}),s})(),PE=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[FE]}),s})();class li extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class IE extends li{constructor(o){super("ValidateImplantCategoryExcelDataAction"),this.valid=!1,this.excelData=o}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name)}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class DE extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class ME extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new DE("name","The implantcategory name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class WE extends li{constructor(o){super("CreateImplantCategoryAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new ME("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateImplantCategory({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class EE extends li{constructor(o){super("UpdateImplantCategoriesAction"),this.implantCategories=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.implantCategories,!0))}performAction(){this.response=this.businessProvider.data.userUpdateImplantCategories({input:{implantCategories:this.implantCategories}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class OE extends li{constructor(o,t){super("UpdateImplantCategoryAction"),this.implantCategory=o,this.implantCategoryId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.implantCategory,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.implantCategoryId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateImplantCategory({implantCategoryId:this.implantCategoryId,input:this.implantCategory}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let gc=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.ImplantCategoryBusinessProviderService",t,a),this.data=i}createImplantCategory(t){const i=new WE(t);return i.Do(this),i.response}updateImplantCategory(t,i){const a=new OE(t,i);return a.Do(this),a.response}importImplantCategories(t){const i=new EE(t);return i.Do(this),i.response}validateImplantCategoryExcelData(t){const i=new IE(t);return i.Do(this),i.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),LE=(()=>{class s extends I.nH{constructor(t,i,a){super("ImplantCategoryService",a,t),this.businessProvider=i}createImplantCategory(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createImplantCategory(i)}updateImplantCategory(t,i){return this.businessProvider.updateImplantCategory(t,i)}importImplantCategories(t){return this.businessProvider.importImplantCategories(t)}validateImplantCategoryExcelData(t){return this.businessProvider.validateImplantCategoryExcelData(t)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(gc,8),e.LFG(gc),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),Po=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){super({loading:!1,implantCategories:[],done:!1,searchQuery:"",formName:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.implantCategoryService=H,this.errors$=this.select(c=>c.errors),this.loading$=this.select(c=>c.loading),this.done$=this.select(c=>c.done),this.item$=this.select(c=>c.item),this.implantCategories$=this.select(c=>c.implantCategories),this.paging$=this.select(c=>c.paging),this.searchQuery$=this.select(c=>c.searchQuery),this.formName$=this.select(c=>c.formName),this.actionResult$=this.select(this.item$,this.done$,(c,d)=>({item:c,done:d}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.implantCategories$,(c,d,n,r,m)=>({errors:c,loading:d,item:n,formName:r,implantCategories:m}),{debounce:!0}),this.input$=this.select(this.paging$,this.searchQuery$,(c,d)=>({limit:c.limit,skip:c.skip,name:d,total:c.total})),this.setFormName=this.updater((c,d)=>Object.assign(Object.assign({},c),{formName:d})),this.setItem=this.updater((c,d)=>Object.assign(Object.assign({},c),{item:d})),this.addNewImplantCategory=this.updater((c,d)=>Object.assign(Object.assign({},c),{implantCategories:[...c.implantCategories,d]})),this.updateImplantCategory=this.updater((c,d)=>Object.assign(Object.assign({},c),{implantCategories:c.implantCategories.map(n=>n.id===d.id?d:n)})),this.addImplantCategories=this.updater((c,d)=>Object.assign(Object.assign({},c),{implantCategories:c.implantCategories.concat(d)})),this.updateImplantCategories=this.updater((c,d)=>Object.assign(Object.assign({},c),{implantCategories:c.implantCategories.map(n=>d.find(m=>m.id===n.id)||n)})),this.setSearchQuery=this.updater((c,d)=>Object.assign(Object.assign({},c),{searchQuery:d})),this.loadImplantCategoryEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.data.userImplantCategory({implantCategoryId:d}).pipe((0,g._b)(n=>{this.patchState({item:n.data.item,errors:n.errors,loading:!1})},n=>this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})))))),this.loadImplantCategoriesEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([d,n])=>this.data.userImplantCategories({input:n}).pipe((0,g._b)(r=>this.patchState({paging:{limit:n.limit,skip:n.skip,total:r.data.count.total},implantCategories:r.data.items,errors:r.errors,loading:!1}),r=>this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})))))),this.createImplantCategoryEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.implantCategoryService.createImplantCategory(Object.assign({},d)).pipe((0,g._b)(n=>{this.addNewImplantCategory(n),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:n,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},n=>{n.graphQLErrors?(this.toast.error(n.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})):(this.toast.error(n.Message),this.formService.setErrors(n.Data))}))))),this.updateImplantCategoryEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.implantCategoryService.updateImplantCategory(d,d.id).pipe((0,g._b)(r=>{this.updateImplantCategory(r),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:r,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.deleteImplantCategoryEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.data.userDeleteImplantCategory({implantCategoryId:n.id}).pipe((0,g._b)(r=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:r.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.importExcelEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.implantCategoryService.importImplantCategories(d).pipe((0,ce.K)(n=>{var r;return this.toast.error(null!==(r=n.Message)&&void 0!==r?r:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(n=>{const r=JSON.parse(n.created),m=JSON.parse(n.updated),p=JSON.parse(n.failed),_=r.length+m.length+p.length;this.addImplantCategories(r),this.updateImplantCategories(m),this.toast.success(`${r.length} created, ${m.length} updated, ${p.length} failed of total ${_}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("implantCategoryId")?(this.route.snapshot.paramMap.get("implantCategoryId"),this.setFormName("implantCategory_edit")):this.setFormName("implantCategory_create")}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.implantCategoryService.validateImplantCategoryExcelData(t)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(LE))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function $E(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.implantCategory)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let Cc=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"implantCategory_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.implantCategory=i.item})):t.formName&&t.formName.currentValue&&"implantCategory_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadImplantCategoryEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.implantCategory=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Po),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-implant-category-form"]],inputs:{implantCategory:"implantCategory",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,$E,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),vc=(()=>{class s{constructor(){this.autoHeight=!1,this.implantCategories=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[,{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-implant-category-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",implantCategories:"implantCategories"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.implantCategories)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function GE(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-implant-category-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","implantCategory_edit")("formControl",t.formControl)("implantCategory",t.implantCategory)}}const RE=function(){return{}};function QE(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-implant-category-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","implantCategory_create")("formControl",t.formControl)("implantCategory",e.DdM(3,RE))}}function VE(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-implant-category-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("implantCategories",o.data.items)}let jE=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadImplantCategoriesEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.implantCategories$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Po))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","implantCategory","send","close"],[1,"w-full","h-full","bg-white",3,"implantCategories","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,GE,2,3,"ng-template",null,1,e.W1O),e.YNc(3,QE,1,4,"ng-template",null,2,e.W1O),e.YNc(5,VE,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,Cc,vc],encapsulation:2}),s})();function UE(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-implant-category-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","implantCategory_edit")("implantCategory",t.value)}}const JE=function(){return{}};function zE(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-implant-category-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","implantCategory_create")("implantCategory",e.DdM(2,JE))}function HE(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-implant-category-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("implantCategories",t.items)}}let qE=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","implantCategory","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","implantCategories","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,UE,1,2,"ng-template",null,1,e.W1O),e.YNc(3,zE,1,3,"ng-template",null,2,e.W1O),e.YNc(5,HE,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,Cc,vc],encapsulation:2}),s})(),KE=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[Po],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"implant-category-select",component:jE,wrappers:["form-field"]},{name:"implant-category-grid",component:qE}]})]}),s})(),ZE=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[KE]}),s})();class ci extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class kE extends ci{constructor(o,t,i,a){super("ValidateImplantExcelDataAction"),this.valid=!1,this.excelData=o,this.implantCategories=t,this.salesRepresentatives=i,this.manufacturers=a}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name),this.validationContext.addRule(new f.mi(`implantCategoryName_${i}_is_valid}`,"Implant Category Is Not Valid","implantCategory.name",t.implantCategory,this.implantCategories,!0)),this.validationContext.addRule(new f.mi(`salesRepresentativeName_${i}_is_valid}`,"Sales Representative Is Not Valid","salesRepresentative.name",t.salesRepresentative,this.salesRepresentatives,!0)),this.validationContext.addRule(new f.mi(`manufacturerName_${i}_is_valid}`,"Manufacturer Is Not Valid","manufacturer.name",t.manufacturer,this.manufacturers,!0))}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class BE extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class YE extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new BE("name","The implant name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class XE extends ci{constructor(o){super("CreateImplantAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new YE("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateImplant({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class eO extends ci{constructor(o){super("UpdateImplantsAction"),this.implants=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.implants,!0))}performAction(){this.response=this.businessProvider.data.userUpdateImplants({input:{implants:this.implants}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class tO extends ci{constructor(o,t){super("UpdateImplantAction"),this.implant=o,this.implantId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.implant,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.implantId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateImplant({implantId:this.implantId,input:this.implant}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let Sc=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.ImplantBusinessProviderService",t,a),this.data=i}createImplant(t){const i=new XE(t);return i.Do(this),i.response}updateImplant(t,i){const a=new tO(t,i);return a.Do(this),a.response}importImplants(t){const i=new eO(t);return i.Do(this),i.response}validateImplantExcelData(t,i,a,l){const u=new kE(t,i,a,l);return u.Do(this),u.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),iO=(()=>{class s extends I.nH{constructor(t,i,a){super("ImplantService",a,t),this.businessProvider=i}createImplant(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createImplant(i)}updateImplant(t,i){return this.businessProvider.updateImplant(t,i)}importImplants(t){return this.businessProvider.importImplants(t)}validateImplantExcelData(t,i,a,l){return this.businessProvider.validateImplantExcelData(t,i,a,l)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(Sc,8),e.LFG(Sc),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),Io=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){if(super({loading:!1,implants:[],done:!1,searchQuery:"",formName:void 0,implantCategoryId:void 0,salesRepresentativeId:void 0,manufacturerId:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.implantService=H,this.errors$=this.select(r=>r.errors),this.loading$=this.select(r=>r.loading),this.done$=this.select(r=>r.done),this.item$=this.select(r=>r.item),this.implants$=this.select(r=>r.implants),this.implantCategories$=this.select(r=>r.implantCategories||[]),this.contacts$=this.select(r=>r.contacts||[]),this.manufacturers$=this.select(r=>r.manufacturers||[]),this.implantCategoryId$=this.select(r=>r.implantCategoryId),this.salesRepresentativeId$=this.select(r=>r.salesRepresentativeId),this.manufacturerId$=this.select(r=>r.manufacturerId),this.paging$=this.select(r=>r.paging),this.searchQuery$=this.select(r=>r.searchQuery),this.formName$=this.select(r=>r.formName),this.actionResult$=this.select(this.item$,this.done$,(r,m)=>({item:r,done:m}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.implants$,this.implantCategories$,this.contacts$,this.manufacturers$,(r,m,p,_,w,J,_e,ve)=>({errors:r,loading:m,item:p,formName:_,implants:w,implantCategories:J,contacts:_e,manufacturers:ve}),{debounce:!0}),this.input$=this.select(this.paging$,this.implantCategoryId$,this.salesRepresentativeId$,this.manufacturerId$,this.searchQuery$,(r,m,p,_,w)=>({limit:r.limit,skip:r.skip,name:w,implantCategoryId:m,salesRepresentativeId:p,manufacturerId:_,total:r.total})),this.setFormName=this.updater((r,m)=>Object.assign(Object.assign({},r),{formName:m})),this.setImplantCategoryId=this.updater((r,m)=>Object.assign(Object.assign({},r),{implantCategoryId:m})),this.setSalesRepresentativeId=this.updater((r,m)=>Object.assign(Object.assign({},r),{salesRepresentativeId:m})),this.setManufacturerId=this.updater((r,m)=>Object.assign(Object.assign({},r),{manufacturerId:m})),this.filterImplantCategories=r=>this.data.userSelectImplantCategories({input:{name:r}}).pipe((0,g._b)(m=>{let p=m.data.items;return this.patchState({implantCategories:p}),p},m=>this.patchState({errors:m.graphQLErrors?m.graphQLErrors:m})),(0,he.U)(m=>m.data.items)),this.filterContacts=r=>this.data.userSelectContacts({input:{name:r}}).pipe((0,g._b)(m=>{let p=m.data.items;return this.patchState({contacts:p}),p},m=>this.patchState({errors:m.graphQLErrors?m.graphQLErrors:m})),(0,he.U)(m=>m.data.items)),this.filterManufacturers=r=>this.data.userSelectManufacturers({input:{name:r}}).pipe((0,g._b)(m=>{let p=m.data.items;return this.patchState({manufacturers:p}),p},m=>this.patchState({errors:m.graphQLErrors?m.graphQLErrors:m})),(0,he.U)(m=>m.data.items)),this.addImplantCategory=this.updater((r,m)=>Object.assign(Object.assign({},r),{implantCategories:r.implantCategories.concat(m)})),this.addContact=this.updater((r,m)=>Object.assign(Object.assign({},r),{contacts:r.contacts.concat(m)})),this.addManufacturer=this.updater((r,m)=>Object.assign(Object.assign({},r),{manufacturers:r.manufacturers.concat(m)})),this.setItem=this.updater((r,m)=>Object.assign(Object.assign({},r),{item:m})),this.addNewImplant=this.updater((r,m)=>Object.assign(Object.assign({},r),{implants:[...r.implants,m]})),this.updateImplant=this.updater((r,m)=>Object.assign(Object.assign({},r),{implants:r.implants.map(p=>p.id===m.id?m:p)})),this.addImplants=this.updater((r,m)=>Object.assign(Object.assign({},r),{implants:r.implants.concat(m)})),this.updateImplants=this.updater((r,m)=>Object.assign(Object.assign({},r),{implants:r.implants.map(p=>m.find(w=>w.id===p.id)||p)})),this.setSearchQuery=this.updater((r,m)=>Object.assign(Object.assign({},r),{searchQuery:m})),this.loadImplantEffect=this.effect(r=>r.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(m=>this.data.userImplant({implantId:m}).pipe((0,g._b)(p=>{this.patchState({item:p.data.item,errors:p.errors,loading:!1})},p=>this.patchState({loading:!1,errors:p.graphQLErrors?p.graphQLErrors:p})))))),this.loadImplantsEffect=this.effect(r=>r.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([m,p])=>this.data.userImplants({input:p}).pipe((0,g._b)(_=>this.patchState({paging:{limit:p.limit,skip:p.skip,total:_.data.count.total},implants:_.data.items,errors:_.errors,loading:!1}),_=>this.patchState({loading:!1,errors:_.graphQLErrors?_.graphQLErrors:_})))))),this.createImplantEffect=this.effect(r=>r.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(m=>this.implantService.createImplant(Object.assign({},m)).pipe((0,g._b)(p=>{this.addNewImplant(p),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:p,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},p=>{p.graphQLErrors?(this.toast.error(p.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:p.graphQLErrors?p.graphQLErrors:p})):(this.toast.error(p.Message),this.formService.setErrors(p.Data))}))))),this.updateImplantEffect=this.effect(r=>r.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([m,p])=>this.implantService.updateImplant(m,m.id).pipe((0,g._b)(_=>{this.updateImplant(_),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:_,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},_=>{_.graphQLErrors?(this.toast.error(_.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:_.graphQLErrors?_.graphQLErrors:_})):(this.toast.error(_.Message),this.formService.setErrors(_.Data))}))))),this.deleteImplantEffect=this.effect(r=>r.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([m,p])=>this.data.userDeleteImplant({implantId:p.id}).pipe((0,g._b)(_=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:_.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},_=>{_.graphQLErrors?(this.toast.error(_.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:_.graphQLErrors?_.graphQLErrors:_})):(this.toast.error(_.Message),this.formService.setErrors(_.Data))}))))),this.importExcelEffect=this.effect(r=>r.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(m=>this.implantService.importImplants(m).pipe((0,ce.K)(p=>{var _;return this.toast.error(null!==(_=p.Message)&&void 0!==_?_:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(p=>{const _=JSON.parse(p.created),w=JSON.parse(p.updated),J=JSON.parse(p.failed),_e=_.length+w.length+J.length;this.addImplants(_),this.updateImplants(w),this.toast.success(`${_.length} created, ${w.length} updated, ${J.length} failed of total ${_e}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("implantId")?(this.route.snapshot.paramMap.get("implantId"),this.setFormName("implant_edit")):this.setFormName("implant_create"),this.route.snapshot.paramMap.has("implantCategoryId")){var c=this.route.snapshot.paramMap.get("implantCategoryId");this.setImplantCategoryId(c)}if(this.route.snapshot.paramMap.has("salesRepresentativeId")){var d=this.route.snapshot.paramMap.get("salesRepresentativeId");this.setSalesRepresentativeId(d)}if(this.route.snapshot.paramMap.has("manufacturerId")){var n=this.route.snapshot.paramMap.get("manufacturerId");this.setManufacturerId(n)}}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.implantService.validateImplantExcelData(t,i.implantCategories,i.contacts,i.manufacturers)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(iO))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function sO(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.implant)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let bc=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"implant_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.implant=i.item})):t.formName&&t.formName.currentValue&&"implant_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadImplantEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.implant=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Io),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-implant-form"]],inputs:{implant:"implant",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,sO,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),Tc=(()=>{class s{constructor(){this.autoHeight=!1,this.implants=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[{field:"implantCategory.name",headerName:"Implant Category",filter:"agTextColumnFilter"},{field:"salesRepresentative.name",headerName:"Sales Representative",filter:"agTextColumnFilter"},{field:"manufacturer.name",headerName:"Manufacturer",filter:"agTextColumnFilter"},{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{headerName:"Estimated Cost",field:"estimatedCost",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.estimatedCost,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{field:"implantCategoryId",filter:"agTextColumnFilter",hide:!0},{field:"manufacturerId",filter:"agTextColumnFilter",hide:!0},{field:"photoUrl",filter:"agTextColumnFilter"},{field:"salesRepresentativeId",filter:"agTextColumnFilter",hide:!0},{field:"sku",filter:"agTextColumnFilter"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-implant-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",implants:"implants"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.implants)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function oO(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-implant-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","implant_edit")("formControl",t.formControl)("implant",t.implant)}}const aO=function(){return{}};function rO(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-implant-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","implant_create")("formControl",t.formControl)("implant",e.DdM(3,aO))}}function nO(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-implant-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("implants",o.data.items)}let lO=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadImplantsEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.implants$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Io))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","implant","send","close"],[1,"w-full","h-full","bg-white",3,"implants","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,oO,2,3,"ng-template",null,1,e.W1O),e.YNc(3,rO,1,4,"ng-template",null,2,e.W1O),e.YNc(5,nO,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,bc,Tc],encapsulation:2}),s})();function cO(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-implant-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","implant_edit")("implant",t.value)}}const dO=function(){return{}};function uO(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-implant-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","implant_create")("implant",e.DdM(2,dO))}function mO(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-implant-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("implants",t.items)}}let pO=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","implant","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","implants","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,cO,1,2,"ng-template",null,1,e.W1O),e.YNc(3,uO,1,3,"ng-template",null,2,e.W1O),e.YNc(5,mO,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,bc,Tc],encapsulation:2}),s})(),hO=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[Io],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"implant-select",component:lO,wrappers:["form-field"]},{name:"implant-grid",component:pO}]})]}),s})(),fO=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[hO]}),s})();class di extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class _O extends di{constructor(o,t,i,a,l){super("ValidateInsuranceExcelDataAction"),this.valid=!1,this.excelData=o,this.legalCases=t,this.insuranceTypes=i,this.insuranceSectors=a,this.leads=l}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name),this.validationContext.addRule(new f.mi(`legalCaseName_${i}_is_valid}`,"Legal Case Is Not Valid","legalCase.name",t.legalCase,this.legalCases,!0)),this.validationContext.addRule(new f.mi(`insuranceTypeName_${i}_is_valid}`,"Insurance Type Is Not Valid","insuranceType.name",t.insuranceType,this.insuranceTypes,!0)),this.validationContext.addRule(new f.mi(`insuranceSectorName_${i}_is_valid}`,"Insurance Sector Is Not Valid","insuranceSector.name",t.insuranceSector,this.insuranceSectors,!0)),this.validationContext.addRule(new f.mi(`leadName_${i}_is_valid}`,"Lead Is Not Valid","lead.name",t.lead,this.leads,!0))}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class gO extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class CO extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new gO("name","The insurance name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class vO extends di{constructor(o){super("CreateInsuranceAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new CO("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateInsurance({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class SO extends di{constructor(o){super("UpdateInsurancesAction"),this.insurances=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.insurances,!0))}performAction(){this.response=this.businessProvider.data.userUpdateInsurances({input:{insurances:this.insurances}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class bO extends di{constructor(o,t){super("UpdateInsuranceAction"),this.insurance=o,this.insuranceId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.insurance,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.insuranceId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateInsurance({insuranceId:this.insuranceId,input:this.insurance}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let yc=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.InsuranceBusinessProviderService",t,a),this.data=i}createInsurance(t){const i=new vO(t);return i.Do(this),i.response}updateInsurance(t,i){const a=new bO(t,i);return a.Do(this),a.response}importInsurances(t){const i=new SO(t);return i.Do(this),i.response}validateInsuranceExcelData(t,i,a,l,u){const H=new _O(t,i,a,l,u);return H.Do(this),H.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),TO=(()=>{class s extends I.nH{constructor(t,i,a){super("InsuranceService",a,t),this.businessProvider=i}createInsurance(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createInsurance(i)}updateInsurance(t,i){return this.businessProvider.updateInsurance(t,i)}importInsurances(t){return this.businessProvider.importInsurances(t)}validateInsuranceExcelData(t,i,a,l,u){return this.businessProvider.validateInsuranceExcelData(t,i,a,l,u)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(yc,8),e.LFG(yc),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),Do=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){if(super({loading:!1,insurances:[],done:!1,searchQuery:"",formName:void 0,legalCaseId:void 0,insuranceTypeId:void 0,insuranceSectorId:void 0,leadId:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.insuranceService=H,this.errors$=this.select(m=>m.errors),this.loading$=this.select(m=>m.loading),this.done$=this.select(m=>m.done),this.item$=this.select(m=>m.item),this.insurances$=this.select(m=>m.insurances),this.legalCases$=this.select(m=>m.legalCases||[]),this.insuranceTypes$=this.select(m=>m.insuranceTypes||[]),this.insuranceSectors$=this.select(m=>m.insuranceSectors||[]),this.leads$=this.select(m=>m.leads||[]),this.legalCaseId$=this.select(m=>m.legalCaseId),this.insuranceTypeId$=this.select(m=>m.insuranceTypeId),this.insuranceSectorId$=this.select(m=>m.insuranceSectorId),this.leadId$=this.select(m=>m.leadId),this.paging$=this.select(m=>m.paging),this.searchQuery$=this.select(m=>m.searchQuery),this.formName$=this.select(m=>m.formName),this.actionResult$=this.select(this.item$,this.done$,(m,p)=>({item:m,done:p}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.insurances$,this.legalCases$,this.insuranceTypes$,this.insuranceSectors$,this.leads$,(m,p,_,w,J,_e,ve,ae,le)=>({errors:m,loading:p,item:_,formName:w,insurances:J,legalCases:_e,insuranceTypes:ve,insuranceSectors:ae,leads:le}),{debounce:!0}),this.input$=this.select(this.paging$,this.legalCaseId$,this.insuranceTypeId$,this.insuranceSectorId$,this.leadId$,this.searchQuery$,(m,p,_,w,J,_e)=>({limit:m.limit,skip:m.skip,name:_e,legalCaseId:p,insuranceTypeId:_,insuranceSectorId:w,leadId:J,total:m.total})),this.setFormName=this.updater((m,p)=>Object.assign(Object.assign({},m),{formName:p})),this.setLegalCaseId=this.updater((m,p)=>Object.assign(Object.assign({},m),{legalCaseId:p})),this.setInsuranceTypeId=this.updater((m,p)=>Object.assign(Object.assign({},m),{insuranceTypeId:p})),this.setInsuranceSectorId=this.updater((m,p)=>Object.assign(Object.assign({},m),{insuranceSectorId:p})),this.setLeadId=this.updater((m,p)=>Object.assign(Object.assign({},m),{leadId:p})),this.filterLegalCases=m=>this.data.userSelectLegalCases({input:{name:m}}).pipe((0,g._b)(p=>{let _=p.data.items;return this.patchState({legalCases:_}),_},p=>this.patchState({errors:p.graphQLErrors?p.graphQLErrors:p})),(0,he.U)(p=>p.data.items)),this.filterInsuranceTypes=m=>this.data.userSelectInsuranceTypes({input:{name:m}}).pipe((0,g._b)(p=>{let _=p.data.items;return this.patchState({insuranceTypes:_}),_},p=>this.patchState({errors:p.graphQLErrors?p.graphQLErrors:p})),(0,he.U)(p=>p.data.items)),this.filterInsuranceSectors=m=>this.data.userSelectInsuranceSectors({input:{name:m}}).pipe((0,g._b)(p=>{let _=p.data.items;return this.patchState({insuranceSectors:_}),_},p=>this.patchState({errors:p.graphQLErrors?p.graphQLErrors:p})),(0,he.U)(p=>p.data.items)),this.filterLeads=m=>this.data.userSelectLeads({input:{name:m}}).pipe((0,g._b)(p=>{let _=p.data.items;return this.patchState({leads:_}),_},p=>this.patchState({errors:p.graphQLErrors?p.graphQLErrors:p})),(0,he.U)(p=>p.data.items)),this.addLegalCase=this.updater((m,p)=>Object.assign(Object.assign({},m),{legalCases:m.legalCases.concat(p)})),this.addInsuranceType=this.updater((m,p)=>Object.assign(Object.assign({},m),{insuranceTypes:m.insuranceTypes.concat(p)})),this.addInsuranceSector=this.updater((m,p)=>Object.assign(Object.assign({},m),{insuranceSectors:m.insuranceSectors.concat(p)})),this.addLead=this.updater((m,p)=>Object.assign(Object.assign({},m),{leads:m.leads.concat(p)})),this.setItem=this.updater((m,p)=>Object.assign(Object.assign({},m),{item:p})),this.addNewInsurance=this.updater((m,p)=>Object.assign(Object.assign({},m),{insurances:[...m.insurances,p]})),this.updateInsurance=this.updater((m,p)=>Object.assign(Object.assign({},m),{insurances:m.insurances.map(_=>_.id===p.id?p:_)})),this.addInsurances=this.updater((m,p)=>Object.assign(Object.assign({},m),{insurances:m.insurances.concat(p)})),this.updateInsurances=this.updater((m,p)=>Object.assign(Object.assign({},m),{insurances:m.insurances.map(_=>p.find(J=>J.id===_.id)||_)})),this.setSearchQuery=this.updater((m,p)=>Object.assign(Object.assign({},m),{searchQuery:p})),this.loadInsuranceEffect=this.effect(m=>m.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(p=>this.data.userInsurance({insuranceId:p}).pipe((0,g._b)(_=>{this.patchState({item:_.data.item,errors:_.errors,loading:!1})},_=>this.patchState({loading:!1,errors:_.graphQLErrors?_.graphQLErrors:_})))))),this.loadInsurancesEffect=this.effect(m=>m.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([p,_])=>this.data.userInsurances({input:_}).pipe((0,g._b)(w=>this.patchState({paging:{limit:_.limit,skip:_.skip,total:w.data.count.total},insurances:w.data.items,errors:w.errors,loading:!1}),w=>this.patchState({loading:!1,errors:w.graphQLErrors?w.graphQLErrors:w})))))),this.createInsuranceEffect=this.effect(m=>m.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(p=>this.insuranceService.createInsurance(Object.assign({},p)).pipe((0,g._b)(_=>{this.addNewInsurance(_),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:_,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},_=>{_.graphQLErrors?(this.toast.error(_.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:_.graphQLErrors?_.graphQLErrors:_})):(this.toast.error(_.Message),this.formService.setErrors(_.Data))}))))),this.updateInsuranceEffect=this.effect(m=>m.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([p,_])=>this.insuranceService.updateInsurance(p,p.id).pipe((0,g._b)(w=>{this.updateInsurance(w),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:w,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},w=>{w.graphQLErrors?(this.toast.error(w.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:w.graphQLErrors?w.graphQLErrors:w})):(this.toast.error(w.Message),this.formService.setErrors(w.Data))}))))),this.deleteInsuranceEffect=this.effect(m=>m.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([p,_])=>this.data.userDeleteInsurance({insuranceId:_.id}).pipe((0,g._b)(w=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:w.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},w=>{w.graphQLErrors?(this.toast.error(w.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:w.graphQLErrors?w.graphQLErrors:w})):(this.toast.error(w.Message),this.formService.setErrors(w.Data))}))))),this.importExcelEffect=this.effect(m=>m.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(p=>this.insuranceService.importInsurances(p).pipe((0,ce.K)(_=>{var w;return this.toast.error(null!==(w=_.Message)&&void 0!==w?w:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(_=>{const w=JSON.parse(_.created),J=JSON.parse(_.updated),_e=JSON.parse(_.failed),ve=w.length+J.length+_e.length;this.addInsurances(w),this.updateInsurances(J),this.toast.success(`${w.length} created, ${J.length} updated, ${_e.length} failed of total ${ve}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("insuranceId")?(this.route.snapshot.paramMap.get("insuranceId"),this.setFormName("insurance_edit")):this.setFormName("insurance_create"),this.route.snapshot.paramMap.has("legalCaseId")){var c=this.route.snapshot.paramMap.get("legalCaseId");this.setLegalCaseId(c)}if(this.route.snapshot.paramMap.has("insuranceTypeId")){var d=this.route.snapshot.paramMap.get("insuranceTypeId");this.setInsuranceTypeId(d)}if(this.route.snapshot.paramMap.has("insuranceSectorId")){var n=this.route.snapshot.paramMap.get("insuranceSectorId");this.setInsuranceSectorId(n)}if(this.route.snapshot.paramMap.has("leadId")){var r=this.route.snapshot.paramMap.get("leadId");this.setLeadId(r)}}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.insuranceService.validateInsuranceExcelData(t,i.legalCases,i.insuranceTypes,i.insuranceSectors,i.leads)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(TO))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function yO(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.insurance)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let wc=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"insurance_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({id:null,name:""}),this.store.vm$.subscribe(i=>{this.insurance=i.item})):t.formName&&t.formName.currentValue&&"insurance_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadInsuranceEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.insurance=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Do),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-insurance-form"]],inputs:{insurance:"insurance",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,yO,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),xc=(()=>{class s{constructor(){this.autoHeight=!1,this.insurances=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[{field:"legalCase.name",headerName:"Legal Case",filter:"agTextColumnFilter"},{field:"insuranceType.name",headerName:"Insurance Type",filter:"agTextColumnFilter"},{field:"insuranceSector.name",headerName:"Insurance Sector",filter:"agTextColumnFilter"},{field:"lead.name",headerName:"Lead",filter:"agTextColumnFilter"},{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{field:"legalCaseId",filter:"agTextColumnFilter",hide:!0},{field:"insuranceTypeId",filter:"agTextColumnFilter",hide:!0},{field:"insuranceSectorId",filter:"agTextColumnFilter",hide:!0},{field:"policyNumber",filter:"agTextColumnFilter"},{field:"insuranceCompany",filter:"agTextColumnFilter"},{headerName:"Minimum Coverage Amount",field:"minimumCoverageAmount",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.minimumCoverageAmount,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{headerName:"Maximum Coverage Amount",field:"maximumCoverageAmount",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.maximumCoverageAmount,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{headerName:"Is Stackable",field:"isStackable",filter:"agSetColumnFilter",cellRenderer:"checkboxRenderer"},{field:"adjuster",filter:"agTextColumnFilter"},{field:"leadId",filter:"agTextColumnFilter",hide:!0}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-insurance-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",insurances:"insurances"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.insurances)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function wO(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-insurance-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","insurance_edit")("formControl",t.formControl)("insurance",t.insurance)}}const xO=function(){return{}};function NO(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-insurance-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","insurance_create")("formControl",t.formControl)("insurance",e.DdM(3,xO))}}function AO(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-insurance-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("insurances",o.data.items)}let FO=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadInsurancesEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.insurances$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Do))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","insurance","send","close"],[1,"w-full","h-full","bg-white",3,"insurances","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,wO,2,3,"ng-template",null,1,e.W1O),e.YNc(3,NO,1,4,"ng-template",null,2,e.W1O),e.YNc(5,AO,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,wc,xc],encapsulation:2}),s})();function PO(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-insurance-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","insurance_edit")("insurance",t.value)}}const IO=function(){return{}};function DO(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-insurance-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","insurance_create")("insurance",e.DdM(2,IO))}function MO(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-insurance-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("insurances",t.items)}}let WO=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:6,consts:[[3,"data","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","insurance","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","insurances","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,PO,1,2,"ng-template",null,1,e.W1O),e.YNc(3,DO,1,3,"ng-template",null,2,e.W1O),e.YNc(5,MO,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,wc,xc],encapsulation:2}),s})(),EO=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[Do],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"insurance-select",component:FO,wrappers:["form-field"]},{name:"insurance-grid",component:WO}]})]}),s})(),OO=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[EO]}),s})();class ui extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class LO extends ui{constructor(o){super("ValidateInsuranceSectorExcelDataAction"),this.valid=!1,this.excelData=o}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name)}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class $O extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class GO extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new $O("name","The insurancesector name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class RO extends ui{constructor(o){super("CreateInsuranceSectorAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new GO("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateInsuranceSector({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class QO extends ui{constructor(o){super("UpdateInsuranceSectorsAction"),this.insuranceSectors=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.insuranceSectors,!0))}performAction(){this.response=this.businessProvider.data.userUpdateInsuranceSectors({input:{insuranceSectors:this.insuranceSectors}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class VO extends ui{constructor(o,t){super("UpdateInsuranceSectorAction"),this.insuranceSector=o,this.insuranceSectorId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.insuranceSector,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.insuranceSectorId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateInsuranceSector({insuranceSectorId:this.insuranceSectorId,input:this.insuranceSector}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let Nc=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.InsuranceSectorBusinessProviderService",t,a),this.data=i}createInsuranceSector(t){const i=new RO(t);return i.Do(this),i.response}updateInsuranceSector(t,i){const a=new VO(t,i);return a.Do(this),a.response}importInsuranceSectors(t){const i=new QO(t);return i.Do(this),i.response}validateInsuranceSectorExcelData(t){const i=new LO(t);return i.Do(this),i.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),jO=(()=>{class s extends I.nH{constructor(t,i,a){super("InsuranceSectorService",a,t),this.businessProvider=i}createInsuranceSector(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createInsuranceSector(i)}updateInsuranceSector(t,i){return this.businessProvider.updateInsuranceSector(t,i)}importInsuranceSectors(t){return this.businessProvider.importInsuranceSectors(t)}validateInsuranceSectorExcelData(t){return this.businessProvider.validateInsuranceSectorExcelData(t)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(Nc,8),e.LFG(Nc),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),Mo=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){super({loading:!1,insuranceSectors:[],done:!1,searchQuery:"",formName:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.insuranceSectorService=H,this.errors$=this.select(c=>c.errors),this.loading$=this.select(c=>c.loading),this.done$=this.select(c=>c.done),this.item$=this.select(c=>c.item),this.insuranceSectors$=this.select(c=>c.insuranceSectors),this.paging$=this.select(c=>c.paging),this.searchQuery$=this.select(c=>c.searchQuery),this.formName$=this.select(c=>c.formName),this.actionResult$=this.select(this.item$,this.done$,(c,d)=>({item:c,done:d}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.insuranceSectors$,(c,d,n,r,m)=>({errors:c,loading:d,item:n,formName:r,insuranceSectors:m}),{debounce:!0}),this.input$=this.select(this.paging$,this.searchQuery$,(c,d)=>({limit:c.limit,skip:c.skip,name:d,total:c.total})),this.setFormName=this.updater((c,d)=>Object.assign(Object.assign({},c),{formName:d})),this.setItem=this.updater((c,d)=>Object.assign(Object.assign({},c),{item:d})),this.addNewInsuranceSector=this.updater((c,d)=>Object.assign(Object.assign({},c),{insuranceSectors:[...c.insuranceSectors,d]})),this.updateInsuranceSector=this.updater((c,d)=>Object.assign(Object.assign({},c),{insuranceSectors:c.insuranceSectors.map(n=>n.id===d.id?d:n)})),this.addInsuranceSectors=this.updater((c,d)=>Object.assign(Object.assign({},c),{insuranceSectors:c.insuranceSectors.concat(d)})),this.updateInsuranceSectors=this.updater((c,d)=>Object.assign(Object.assign({},c),{insuranceSectors:c.insuranceSectors.map(n=>d.find(m=>m.id===n.id)||n)})),this.setSearchQuery=this.updater((c,d)=>Object.assign(Object.assign({},c),{searchQuery:d})),this.loadInsuranceSectorEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.data.userInsuranceSector({insuranceSectorId:d}).pipe((0,g._b)(n=>{this.patchState({item:n.data.item,errors:n.errors,loading:!1})},n=>this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})))))),this.loadInsuranceSectorsEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([d,n])=>this.data.userInsuranceSectors({input:n}).pipe((0,g._b)(r=>this.patchState({paging:{limit:n.limit,skip:n.skip,total:r.data.count.total},insuranceSectors:r.data.items,errors:r.errors,loading:!1}),r=>this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})))))),this.createInsuranceSectorEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.insuranceSectorService.createInsuranceSector(Object.assign({},d)).pipe((0,g._b)(n=>{this.addNewInsuranceSector(n),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:n,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},n=>{n.graphQLErrors?(this.toast.error(n.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})):(this.toast.error(n.Message),this.formService.setErrors(n.Data))}))))),this.updateInsuranceSectorEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.insuranceSectorService.updateInsuranceSector(d,d.id).pipe((0,g._b)(r=>{this.updateInsuranceSector(r),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:r,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.deleteInsuranceSectorEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.data.userDeleteInsuranceSector({insuranceSectorId:n.id}).pipe((0,g._b)(r=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:r.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.importExcelEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.insuranceSectorService.importInsuranceSectors(d).pipe((0,ce.K)(n=>{var r;return this.toast.error(null!==(r=n.Message)&&void 0!==r?r:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(n=>{const r=JSON.parse(n.created),m=JSON.parse(n.updated),p=JSON.parse(n.failed),_=r.length+m.length+p.length;this.addInsuranceSectors(r),this.updateInsuranceSectors(m),this.toast.success(`${r.length} created, ${m.length} updated, ${p.length} failed of total ${_}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("insuranceSectorId")?(this.route.snapshot.paramMap.get("insuranceSectorId"),this.setFormName("insuranceSector_edit")):this.setFormName("insuranceSector_create")}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.insuranceSectorService.validateInsuranceSectorExcelData(t)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(jO))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function UO(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.insuranceSector)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let Ac=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"insuranceSector_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.insuranceSector=i.item})):t.formName&&t.formName.currentValue&&"insuranceSector_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadInsuranceSectorEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.insuranceSector=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Mo),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-insurance-sector-form"]],inputs:{insuranceSector:"insuranceSector",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,UO,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),Fc=(()=>{class s{constructor(){this.autoHeight=!1,this.insuranceSectors=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[,{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-insurance-sector-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",insuranceSectors:"insuranceSectors"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.insuranceSectors)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function JO(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-insurance-sector-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","insuranceSector_edit")("formControl",t.formControl)("insuranceSector",t.insuranceSector)}}const zO=function(){return{}};function HO(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-insurance-sector-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","insuranceSector_create")("formControl",t.formControl)("insuranceSector",e.DdM(3,zO))}}function qO(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-insurance-sector-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("insuranceSectors",o.data.items)}let KO=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadInsuranceSectorsEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.insuranceSectors$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Mo))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","insuranceSector","send","close"],[1,"w-full","h-full","bg-white",3,"insuranceSectors","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,JO,2,3,"ng-template",null,1,e.W1O),e.YNc(3,HO,1,4,"ng-template",null,2,e.W1O),e.YNc(5,qO,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,Ac,Fc],encapsulation:2}),s})();function ZO(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-insurance-sector-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","insuranceSector_edit")("insuranceSector",t.value)}}const kO=function(){return{}};function BO(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-insurance-sector-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","insuranceSector_create")("insuranceSector",e.DdM(2,kO))}function YO(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-insurance-sector-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("insuranceSectors",t.items)}}let XO=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","insuranceSector","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","insuranceSectors","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,ZO,1,2,"ng-template",null,1,e.W1O),e.YNc(3,BO,1,3,"ng-template",null,2,e.W1O),e.YNc(5,YO,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,Ac,Fc],encapsulation:2}),s})(),eL=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[Mo],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"insurance-sector-select",component:KO,wrappers:["form-field"]},{name:"insurance-sector-grid",component:XO}]})]}),s})(),tL=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[eL]}),s})();class mi extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class iL extends mi{constructor(o){super("ValidateInsuranceTypeExcelDataAction"),this.valid=!1,this.excelData=o}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name)}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class sL extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class oL extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new sL("name","The insurancetype name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class aL extends mi{constructor(o){super("CreateInsuranceTypeAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new oL("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateInsuranceType({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class rL extends mi{constructor(o){super("UpdateInsuranceTypesAction"),this.insuranceTypes=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.insuranceTypes,!0))}performAction(){this.response=this.businessProvider.data.userUpdateInsuranceTypes({input:{insuranceTypes:this.insuranceTypes}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class nL extends mi{constructor(o,t){super("UpdateInsuranceTypeAction"),this.insuranceType=o,this.insuranceTypeId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.insuranceType,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.insuranceTypeId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateInsuranceType({insuranceTypeId:this.insuranceTypeId,input:this.insuranceType}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let Pc=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.InsuranceTypeBusinessProviderService",t,a),this.data=i}createInsuranceType(t){const i=new aL(t);return i.Do(this),i.response}updateInsuranceType(t,i){const a=new nL(t,i);return a.Do(this),a.response}importInsuranceTypes(t){const i=new rL(t);return i.Do(this),i.response}validateInsuranceTypeExcelData(t){const i=new iL(t);return i.Do(this),i.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),lL=(()=>{class s extends I.nH{constructor(t,i,a){super("InsuranceTypeService",a,t),this.businessProvider=i}createInsuranceType(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createInsuranceType(i)}updateInsuranceType(t,i){return this.businessProvider.updateInsuranceType(t,i)}importInsuranceTypes(t){return this.businessProvider.importInsuranceTypes(t)}validateInsuranceTypeExcelData(t){return this.businessProvider.validateInsuranceTypeExcelData(t)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(Pc,8),e.LFG(Pc),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),Wo=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){super({loading:!1,insuranceTypes:[],done:!1,searchQuery:"",formName:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.insuranceTypeService=H,this.errors$=this.select(c=>c.errors),this.loading$=this.select(c=>c.loading),this.done$=this.select(c=>c.done),this.item$=this.select(c=>c.item),this.insuranceTypes$=this.select(c=>c.insuranceTypes),this.paging$=this.select(c=>c.paging),this.searchQuery$=this.select(c=>c.searchQuery),this.formName$=this.select(c=>c.formName),this.actionResult$=this.select(this.item$,this.done$,(c,d)=>({item:c,done:d}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.insuranceTypes$,(c,d,n,r,m)=>({errors:c,loading:d,item:n,formName:r,insuranceTypes:m}),{debounce:!0}),this.input$=this.select(this.paging$,this.searchQuery$,(c,d)=>({limit:c.limit,skip:c.skip,name:d,total:c.total})),this.setFormName=this.updater((c,d)=>Object.assign(Object.assign({},c),{formName:d})),this.setItem=this.updater((c,d)=>Object.assign(Object.assign({},c),{item:d})),this.addNewInsuranceType=this.updater((c,d)=>Object.assign(Object.assign({},c),{insuranceTypes:[...c.insuranceTypes,d]})),this.updateInsuranceType=this.updater((c,d)=>Object.assign(Object.assign({},c),{insuranceTypes:c.insuranceTypes.map(n=>n.id===d.id?d:n)})),this.addInsuranceTypes=this.updater((c,d)=>Object.assign(Object.assign({},c),{insuranceTypes:c.insuranceTypes.concat(d)})),this.updateInsuranceTypes=this.updater((c,d)=>Object.assign(Object.assign({},c),{insuranceTypes:c.insuranceTypes.map(n=>d.find(m=>m.id===n.id)||n)})),this.setSearchQuery=this.updater((c,d)=>Object.assign(Object.assign({},c),{searchQuery:d})),this.loadInsuranceTypeEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.data.userInsuranceType({insuranceTypeId:d}).pipe((0,g._b)(n=>{this.patchState({item:n.data.item,errors:n.errors,loading:!1})},n=>this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})))))),this.loadInsuranceTypesEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([d,n])=>this.data.userInsuranceTypes({input:n}).pipe((0,g._b)(r=>this.patchState({paging:{limit:n.limit,skip:n.skip,total:r.data.count.total},insuranceTypes:r.data.items,errors:r.errors,loading:!1}),r=>this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})))))),this.createInsuranceTypeEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.insuranceTypeService.createInsuranceType(Object.assign({},d)).pipe((0,g._b)(n=>{this.addNewInsuranceType(n),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:n,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},n=>{n.graphQLErrors?(this.toast.error(n.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})):(this.toast.error(n.Message),this.formService.setErrors(n.Data))}))))),this.updateInsuranceTypeEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.insuranceTypeService.updateInsuranceType(d,d.id).pipe((0,g._b)(r=>{this.updateInsuranceType(r),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:r,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.deleteInsuranceTypeEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.data.userDeleteInsuranceType({insuranceTypeId:n.id}).pipe((0,g._b)(r=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:r.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.importExcelEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.insuranceTypeService.importInsuranceTypes(d).pipe((0,ce.K)(n=>{var r;return this.toast.error(null!==(r=n.Message)&&void 0!==r?r:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(n=>{const r=JSON.parse(n.created),m=JSON.parse(n.updated),p=JSON.parse(n.failed),_=r.length+m.length+p.length;this.addInsuranceTypes(r),this.updateInsuranceTypes(m),this.toast.success(`${r.length} created, ${m.length} updated, ${p.length} failed of total ${_}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("insuranceTypeId")?(this.route.snapshot.paramMap.get("insuranceTypeId"),this.setFormName("insuranceType_edit")):this.setFormName("insuranceType_create")}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.insuranceTypeService.validateInsuranceTypeExcelData(t)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(lL))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function cL(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.insuranceType)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let Ic=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"insuranceType_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.insuranceType=i.item})):t.formName&&t.formName.currentValue&&"insuranceType_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadInsuranceTypeEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.insuranceType=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Wo),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-insurance-type-form"]],inputs:{insuranceType:"insuranceType",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,cL,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),Dc=(()=>{class s{constructor(){this.autoHeight=!1,this.insuranceTypes=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[,{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-insurance-type-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",insuranceTypes:"insuranceTypes"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.insuranceTypes)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function dL(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-insurance-type-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","insuranceType_edit")("formControl",t.formControl)("insuranceType",t.insuranceType)}}const uL=function(){return{}};function mL(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-insurance-type-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","insuranceType_create")("formControl",t.formControl)("insuranceType",e.DdM(3,uL))}}function pL(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-insurance-type-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("insuranceTypes",o.data.items)}let hL=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadInsuranceTypesEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.insuranceTypes$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Wo))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","insuranceType","send","close"],[1,"w-full","h-full","bg-white",3,"insuranceTypes","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,dL,2,3,"ng-template",null,1,e.W1O),e.YNc(3,mL,1,4,"ng-template",null,2,e.W1O),e.YNc(5,pL,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,Ic,Dc],encapsulation:2}),s})();function fL(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-insurance-type-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","insuranceType_edit")("insuranceType",t.value)}}const _L=function(){return{}};function gL(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-insurance-type-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","insuranceType_create")("insuranceType",e.DdM(2,_L))}function CL(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-insurance-type-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("insuranceTypes",t.items)}}let vL=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","insuranceType","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","insuranceTypes","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,fL,1,2,"ng-template",null,1,e.W1O),e.YNc(3,gL,1,3,"ng-template",null,2,e.W1O),e.YNc(5,CL,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,Ic,Dc],encapsulation:2}),s})(),SL=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[Wo],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"insurance-type-select",component:hL,wrappers:["form-field"]},{name:"insurance-type-grid",component:vL}]})]}),s})(),bL=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[SL]}),s})();class pi extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class TL extends pi{constructor(o){super("ValidateIntegrationExcelDataAction"),this.valid=!1,this.excelData=o}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name)}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class yL extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class wL extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new yL("name","The integration name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class xL extends pi{constructor(o){super("CreateIntegrationAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new wL("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateIntegration({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class NL extends pi{constructor(o){super("UpdateIntegrationsAction"),this.integrations=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.integrations,!0))}performAction(){this.response=this.businessProvider.data.userUpdateIntegrations({input:{integrations:this.integrations}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class AL extends pi{constructor(o,t){super("UpdateIntegrationAction"),this.integration=o,this.integrationId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.integration,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.integrationId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateIntegration({integrationId:this.integrationId,input:this.integration}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let Mc=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.IntegrationBusinessProviderService",t,a),this.data=i}createIntegration(t){const i=new xL(t);return i.Do(this),i.response}updateIntegration(t,i){const a=new AL(t,i);return a.Do(this),a.response}importIntegrations(t){const i=new NL(t);return i.Do(this),i.response}validateIntegrationExcelData(t){const i=new TL(t);return i.Do(this),i.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),FL=(()=>{class s extends I.nH{constructor(t,i,a){super("IntegrationService",a,t),this.businessProvider=i}createIntegration(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createIntegration(i)}updateIntegration(t,i){return this.businessProvider.updateIntegration(t,i)}importIntegrations(t){return this.businessProvider.importIntegrations(t)}validateIntegrationExcelData(t){return this.businessProvider.validateIntegrationExcelData(t)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(Mc,8),e.LFG(Mc),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),Eo=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){super({loading:!1,integrations:[],done:!1,searchQuery:"",formName:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.integrationService=H,this.errors$=this.select(c=>c.errors),this.loading$=this.select(c=>c.loading),this.done$=this.select(c=>c.done),this.item$=this.select(c=>c.item),this.integrations$=this.select(c=>c.integrations),this.paging$=this.select(c=>c.paging),this.searchQuery$=this.select(c=>c.searchQuery),this.formName$=this.select(c=>c.formName),this.actionResult$=this.select(this.item$,this.done$,(c,d)=>({item:c,done:d}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.integrations$,(c,d,n,r,m)=>({errors:c,loading:d,item:n,formName:r,integrations:m}),{debounce:!0}),this.input$=this.select(this.paging$,this.searchQuery$,(c,d)=>({limit:c.limit,skip:c.skip,name:d,total:c.total})),this.setFormName=this.updater((c,d)=>Object.assign(Object.assign({},c),{formName:d})),this.setItem=this.updater((c,d)=>Object.assign(Object.assign({},c),{item:d})),this.addNewIntegration=this.updater((c,d)=>Object.assign(Object.assign({},c),{integrations:[...c.integrations,d]})),this.updateIntegration=this.updater((c,d)=>Object.assign(Object.assign({},c),{integrations:c.integrations.map(n=>n.id===d.id?d:n)})),this.addIntegrations=this.updater((c,d)=>Object.assign(Object.assign({},c),{integrations:c.integrations.concat(d)})),this.updateIntegrations=this.updater((c,d)=>Object.assign(Object.assign({},c),{integrations:c.integrations.map(n=>d.find(m=>m.id===n.id)||n)})),this.setSearchQuery=this.updater((c,d)=>Object.assign(Object.assign({},c),{searchQuery:d})),this.loadIntegrationEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.data.userIntegration({integrationId:d}).pipe((0,g._b)(n=>{this.patchState({item:n.data.item,errors:n.errors,loading:!1})},n=>this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})))))),this.loadIntegrationsEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([d,n])=>this.data.userIntegrations({input:n}).pipe((0,g._b)(r=>this.patchState({paging:{limit:n.limit,skip:n.skip,total:r.data.count.total},integrations:r.data.items,errors:r.errors,loading:!1}),r=>this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})))))),this.createIntegrationEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.integrationService.createIntegration(Object.assign({},d)).pipe((0,g._b)(n=>{this.addNewIntegration(n),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:n,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},n=>{n.graphQLErrors?(this.toast.error(n.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})):(this.toast.error(n.Message),this.formService.setErrors(n.Data))}))))),this.updateIntegrationEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.integrationService.updateIntegration(d,d.id).pipe((0,g._b)(r=>{this.updateIntegration(r),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:r,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.deleteIntegrationEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.data.userDeleteIntegration({integrationId:n.id}).pipe((0,g._b)(r=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:r.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.importExcelEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.integrationService.importIntegrations(d).pipe((0,ce.K)(n=>{var r;return this.toast.error(null!==(r=n.Message)&&void 0!==r?r:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(n=>{const r=JSON.parse(n.created),m=JSON.parse(n.updated),p=JSON.parse(n.failed),_=r.length+m.length+p.length;this.addIntegrations(r),this.updateIntegrations(m),this.toast.success(`${r.length} created, ${m.length} updated, ${p.length} failed of total ${_}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("integrationId")?(this.route.snapshot.paramMap.get("integrationId"),this.setFormName("integration_edit")):this.setFormName("integration_create")}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.integrationService.validateIntegrationExcelData(t)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(FL))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function PL(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.integration)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let Wc=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"integration_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.integration=i.item})):t.formName&&t.formName.currentValue&&"integration_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadIntegrationEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.integration=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Eo),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-integration-form"]],inputs:{integration:"integration",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,PL,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),Ec=(()=>{class s{constructor(){this.autoHeight=!1,this.integrations=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[,{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-integration-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",integrations:"integrations"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.integrations)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function IL(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-integration-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","integration_edit")("formControl",t.formControl)("integration",t.integration)}}const DL=function(){return{}};function ML(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-integration-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","integration_create")("formControl",t.formControl)("integration",e.DdM(3,DL))}}function WL(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-integration-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("integrations",o.data.items)}let EL=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadIntegrationsEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.integrations$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Eo))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","integration","send","close"],[1,"w-full","h-full","bg-white",3,"integrations","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,IL,2,3,"ng-template",null,1,e.W1O),e.YNc(3,ML,1,4,"ng-template",null,2,e.W1O),e.YNc(5,WL,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,Wc,Ec],encapsulation:2}),s})();function OL(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-integration-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","integration_edit")("integration",t.value)}}const LL=function(){return{}};function $L(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-integration-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","integration_create")("integration",e.DdM(2,LL))}function GL(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-integration-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("integrations",t.items)}}let RL=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","integration","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","integrations","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,OL,1,2,"ng-template",null,1,e.W1O),e.YNc(3,$L,1,3,"ng-template",null,2,e.W1O),e.YNc(5,GL,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,Wc,Ec],encapsulation:2}),s})(),QL=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[Eo],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"integration-select",component:EL,wrappers:["form-field"]},{name:"integration-grid",component:RL}]})]}),s})(),VL=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[QL]}),s})();class hi extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class jL extends hi{constructor(o,t){super("ValidateInvoiceDetailExcelDataAction"),this.valid=!1,this.excelData=o,this.invoices=t}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name),this.validationContext.addRule(new f.mi(`invoiceName_${i}_is_valid}`,"Invoice Is Not Valid","invoice.name",t.invoice,this.invoices,!0))}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class UL extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class JL extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new UL("name","The invoicedetail name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class zL extends hi{constructor(o){super("CreateInvoiceDetailAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new JL("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateInvoiceDetail({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class HL extends hi{constructor(o){super("UpdateInvoiceDetailsAction"),this.invoiceDetails=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.invoiceDetails,!0))}performAction(){this.response=this.businessProvider.data.userUpdateInvoiceDetails({input:{invoiceDetails:this.invoiceDetails}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class qL extends hi{constructor(o,t){super("UpdateInvoiceDetailAction"),this.invoiceDetail=o,this.invoiceDetailId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.invoiceDetail,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.invoiceDetailId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateInvoiceDetail({invoiceDetailId:this.invoiceDetailId,input:this.invoiceDetail}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let Oc=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.InvoiceDetailBusinessProviderService",t,a),this.data=i}createInvoiceDetail(t){const i=new zL(t);return i.Do(this),i.response}updateInvoiceDetail(t,i){const a=new qL(t,i);return a.Do(this),a.response}importInvoiceDetails(t){const i=new HL(t);return i.Do(this),i.response}validateInvoiceDetailExcelData(t,i){const a=new jL(t,i);return a.Do(this),a.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),KL=(()=>{class s extends I.nH{constructor(t,i,a){super("InvoiceDetailService",a,t),this.businessProvider=i}createInvoiceDetail(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createInvoiceDetail(i)}updateInvoiceDetail(t,i){return this.businessProvider.updateInvoiceDetail(t,i)}importInvoiceDetails(t){return this.businessProvider.importInvoiceDetails(t)}validateInvoiceDetailExcelData(t,i){return this.businessProvider.validateInvoiceDetailExcelData(t,i)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(Oc,8),e.LFG(Oc),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),Oo=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){if(super({loading:!1,invoiceDetails:[],done:!1,searchQuery:"",formName:void 0,invoiceId:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.invoiceDetailService=H,this.errors$=this.select(d=>d.errors),this.loading$=this.select(d=>d.loading),this.done$=this.select(d=>d.done),this.item$=this.select(d=>d.item),this.invoiceDetails$=this.select(d=>d.invoiceDetails),this.invoices$=this.select(d=>d.invoices||[]),this.invoiceId$=this.select(d=>d.invoiceId),this.paging$=this.select(d=>d.paging),this.searchQuery$=this.select(d=>d.searchQuery),this.formName$=this.select(d=>d.formName),this.actionResult$=this.select(this.item$,this.done$,(d,n)=>({item:d,done:n}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.invoiceDetails$,this.invoices$,(d,n,r,m,p,_)=>({errors:d,loading:n,item:r,formName:m,invoiceDetails:p,invoices:_}),{debounce:!0}),this.input$=this.select(this.paging$,this.invoiceId$,this.searchQuery$,(d,n,r)=>({limit:d.limit,skip:d.skip,name:r,invoiceId:n,total:d.total})),this.setFormName=this.updater((d,n)=>Object.assign(Object.assign({},d),{formName:n})),this.setInvoiceId=this.updater((d,n)=>Object.assign(Object.assign({},d),{invoiceId:n})),this.filterInvoices=d=>this.data.userSelectInvoices({input:{name:d}}).pipe((0,g._b)(n=>{let r=n.data.items;return this.patchState({invoices:r}),r},n=>this.patchState({errors:n.graphQLErrors?n.graphQLErrors:n})),(0,he.U)(n=>n.data.items)),this.addInvoice=this.updater((d,n)=>Object.assign(Object.assign({},d),{invoices:d.invoices.concat(n)})),this.setItem=this.updater((d,n)=>Object.assign(Object.assign({},d),{item:n})),this.addNewInvoiceDetail=this.updater((d,n)=>Object.assign(Object.assign({},d),{invoiceDetails:[...d.invoiceDetails,n]})),this.updateInvoiceDetail=this.updater((d,n)=>Object.assign(Object.assign({},d),{invoiceDetails:d.invoiceDetails.map(r=>r.id===n.id?n:r)})),this.addInvoiceDetails=this.updater((d,n)=>Object.assign(Object.assign({},d),{invoiceDetails:d.invoiceDetails.concat(n)})),this.updateInvoiceDetails=this.updater((d,n)=>Object.assign(Object.assign({},d),{invoiceDetails:d.invoiceDetails.map(r=>n.find(p=>p.id===r.id)||r)})),this.setSearchQuery=this.updater((d,n)=>Object.assign(Object.assign({},d),{searchQuery:n})),this.loadInvoiceDetailEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(n=>this.data.userInvoiceDetail({invoiceDetailId:n}).pipe((0,g._b)(r=>{this.patchState({item:r.data.item,errors:r.errors,loading:!1})},r=>this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})))))),this.loadInvoiceDetailsEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([n,r])=>this.data.userInvoiceDetails({input:r}).pipe((0,g._b)(m=>this.patchState({paging:{limit:r.limit,skip:r.skip,total:m.data.count.total},invoiceDetails:m.data.items,errors:m.errors,loading:!1}),m=>this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})))))),this.createInvoiceDetailEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(n=>this.invoiceDetailService.createInvoiceDetail(Object.assign({},n)).pipe((0,g._b)(r=>{this.addNewInvoiceDetail(r),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:r,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.updateInvoiceDetailEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([n,r])=>this.invoiceDetailService.updateInvoiceDetail(n,n.id).pipe((0,g._b)(m=>{this.updateInvoiceDetail(m),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:m,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},m=>{m.graphQLErrors?(this.toast.error(m.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})):(this.toast.error(m.Message),this.formService.setErrors(m.Data))}))))),this.deleteInvoiceDetailEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([n,r])=>this.data.userDeleteInvoiceDetail({invoiceDetailId:r.id}).pipe((0,g._b)(m=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:m.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},m=>{m.graphQLErrors?(this.toast.error(m.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})):(this.toast.error(m.Message),this.formService.setErrors(m.Data))}))))),this.importExcelEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(n=>this.invoiceDetailService.importInvoiceDetails(n).pipe((0,ce.K)(r=>{var m;return this.toast.error(null!==(m=r.Message)&&void 0!==m?m:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(r=>{const m=JSON.parse(r.created),p=JSON.parse(r.updated),_=JSON.parse(r.failed),w=m.length+p.length+_.length;this.addInvoiceDetails(m),this.updateInvoiceDetails(p),this.toast.success(`${m.length} created, ${p.length} updated, ${_.length} failed of total ${w}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("invoiceDetailId")?(this.route.snapshot.paramMap.get("invoiceDetailId"),this.setFormName("invoiceDetail_edit")):this.setFormName("invoiceDetail_create"),this.route.snapshot.paramMap.has("invoiceId")){var c=this.route.snapshot.paramMap.get("invoiceId");this.setInvoiceId(c)}}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.invoiceDetailService.validateInvoiceDetailExcelData(t,i.invoices)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(KL))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function ZL(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.invoiceDetail)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let Lc=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"invoiceDetail_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({id:null,name:""}),this.store.vm$.subscribe(i=>{this.invoiceDetail=i.item})):t.formName&&t.formName.currentValue&&"invoiceDetail_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadInvoiceDetailEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.invoiceDetail=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Oo),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-invoice-detail-form"]],inputs:{invoiceDetail:"invoiceDetail",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,ZL,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),$c=(()=>{class s{constructor(){this.autoHeight=!1,this.invoiceDetails=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[{field:"invoice.name",headerName:"Invoice",filter:"agTextColumnFilter"},{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{field:"invoiceId",filter:"agTextColumnFilter",hide:!0},{field:"dateOfService",filter:"agDateColumnFilter"},{field:"providerName",filter:"agTextColumnFilter"},{field:"procedureDescription",filter:"agTextColumnFilter"},{headerName:"Quantity",field:"quantity",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.quantity,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{headerName:"Charges",field:"charges",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.charges,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{headerName:"Line Total",field:"lineTotal",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.lineTotal,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-invoice-detail-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",invoiceDetails:"invoiceDetails"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:6,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.invoiceDetails)("showSidebar",!1)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function kL(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-invoice-detail-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","invoiceDetail_edit")("formControl",t.formControl)("invoiceDetail",t.invoiceDetail)}}const BL=function(){return{}};function YL(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-invoice-detail-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","invoiceDetail_create")("formControl",t.formControl)("invoiceDetail",e.DdM(3,BL))}}function XL(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-invoice-detail-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("invoiceDetails",o.data.items)}let e$=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadInvoiceDetailsEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.invoiceDetails$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Oo))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:5,consts:[[3,"to","control","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","invoiceDetail","send","close"],[1,"w-full","h-full","bg-white",3,"invoiceDetails","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"ui-select-form",0),e.YNc(1,kL,2,3,"ng-template",null,1,e.W1O),e.YNc(3,YL,1,4,"ng-template",null,2,e.W1O),e.YNc(5,XL,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[W.JJ,W.oH,Z.$,Lc,$c],encapsulation:2}),s})();function t$(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-invoice-detail-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","invoiceDetail_edit")("invoiceDetail",t.value)}}const i$=function(){return{}};function s$(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-invoice-detail-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","invoiceDetail_create")("invoiceDetail",e.DdM(2,i$))}function o$(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-invoice-detail-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("invoiceDetails",t.items)}}let a$=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:6,consts:[[3,"data","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","invoiceDetail","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","invoiceDetails","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,t$,1,2,"ng-template",null,1,e.W1O),e.YNc(3,s$,1,3,"ng-template",null,2,e.W1O),e.YNc(5,o$,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,Lc,$c],encapsulation:2}),s})(),r$=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[Oo],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"invoice-detail-select",component:e$,wrappers:["form-field"]},{name:"invoice-detail-grid",component:a$}]})]}),s})(),n$=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[r$]}),s})();var Lo=Q(11913);function l$(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.invoice)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let Gc=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"invoice_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({id:null,name:""}),this.store.vm$.subscribe(i=>{this.invoice=i.item})):t.formName&&t.formName.currentValue&&"invoice_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadInvoiceEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.invoice=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Lo.I),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-invoice-form"]],inputs:{invoice:"invoice",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,l$,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),Rc=(()=>{class s{constructor(){this.autoHeight=!1,this.invoices=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[{field:"billingOrganization.name",headerName:"Billing Organization",filter:"agTextColumnFilter"},{field:"clinicalProvider.name",headerName:"Clinical Provider",filter:"agTextColumnFilter"},{field:"legalCase.name",headerName:"Legal Case",filter:"agTextColumnFilter"},{field:"invoice.name",headerName:"Invoice",filter:"agTextColumnFilter"},{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{field:"invoiceNumber",filter:"agTextColumnFilter"},{headerName:"Amount",field:"amount",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.amount,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{headerName:"Paid",field:"paid",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.paid,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{headerName:"Due",field:"due",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.due,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{field:"organizationId",filter:"agTextColumnFilter",hide:!0},{field:"legalCaseId",filter:"agTextColumnFilter",hide:!0},{field:"invoiceId",filter:"agTextColumnFilter",hide:!0}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-invoice-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",invoices:"invoices"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.invoices)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function c$(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-invoice-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","invoice_edit")("formControl",t.formControl)("invoice",t.invoice)}}const d$=function(){return{}};function u$(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-invoice-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","invoice_create")("formControl",t.formControl)("invoice",e.DdM(3,d$))}}function m$(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-invoice-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("invoices",o.data.items)}let p$=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadInvoicesEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.invoices$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Lo.I))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:5,consts:[[3,"to","control","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","invoice","send","close"],[1,"w-full","h-full","bg-white",3,"invoices","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"ui-select-form",0),e.YNc(1,c$,2,3,"ng-template",null,1,e.W1O),e.YNc(3,u$,1,4,"ng-template",null,2,e.W1O),e.YNc(5,m$,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[W.JJ,W.oH,Z.$,Gc,Rc],encapsulation:2}),s})();function h$(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-invoice-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","invoice_edit")("invoice",t.value)}}const f$=function(){return{}};function _$(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-invoice-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","invoice_create")("invoice",e.DdM(2,f$))}function g$(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-invoice-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("invoices",t.items)}}let C$=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:6,consts:[[3,"data","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","invoice","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","invoices","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,h$,1,2,"ng-template",null,1,e.W1O),e.YNc(3,_$,1,3,"ng-template",null,2,e.W1O),e.YNc(5,g$,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,Gc,Rc],encapsulation:2}),s})(),v$=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[Lo.I],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"invoice-select",component:p$,wrappers:["form-field"]},{name:"invoice-grid",component:C$}]})]}),s})(),S$=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[v$]}),s})();class fi extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class b$ extends fi{constructor(o,t){super("ValidateJournalEntryExcelDataAction"),this.valid=!1,this.excelData=o,this.caseAccounts=t}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name),this.validationContext.addRule(new f.mi(`caseAccountName_${i}_is_valid}`,"Case Account Is Not Valid","caseAccount.name",t.caseAccount,this.caseAccounts,!0))}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class T$ extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class y$ extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new T$("name","The journalentry name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class w$ extends fi{constructor(o){super("CreateJournalEntryAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new y$("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateJournalEntry({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class x$ extends fi{constructor(o){super("UpdateJournalEntriesAction"),this.journalEntries=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.journalEntries,!0))}performAction(){this.response=this.businessProvider.data.userUpdateJournalEntries({input:{journalEntries:this.journalEntries}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class N$ extends fi{constructor(o,t){super("UpdateJournalEntryAction"),this.journalEntry=o,this.journalEntryId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.journalEntry,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.journalEntryId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateJournalEntry({journalEntryId:this.journalEntryId,input:this.journalEntry}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let Qc=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.JournalEntryBusinessProviderService",t,a),this.data=i}createJournalEntry(t){const i=new w$(t);return i.Do(this),i.response}updateJournalEntry(t,i){const a=new N$(t,i);return a.Do(this),a.response}importJournalEntries(t){const i=new x$(t);return i.Do(this),i.response}validateJournalEntryExcelData(t,i){const a=new b$(t,i);return a.Do(this),a.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),A$=(()=>{class s extends I.nH{constructor(t,i,a){super("JournalEntryService",a,t),this.businessProvider=i}createJournalEntry(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createJournalEntry(i)}updateJournalEntry(t,i){return this.businessProvider.updateJournalEntry(t,i)}importJournalEntries(t){return this.businessProvider.importJournalEntries(t)}validateJournalEntryExcelData(t,i){return this.businessProvider.validateJournalEntryExcelData(t,i)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(Qc,8),e.LFG(Qc),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),$o=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){if(super({loading:!1,journalEntries:[],done:!1,searchQuery:"",formName:void 0,caseAccountId:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.journalEntryService=H,this.errors$=this.select(d=>d.errors),this.loading$=this.select(d=>d.loading),this.done$=this.select(d=>d.done),this.item$=this.select(d=>d.item),this.journalEntries$=this.select(d=>d.journalEntries),this.caseAccounts$=this.select(d=>d.caseAccounts||[]),this.caseAccountId$=this.select(d=>d.caseAccountId),this.paging$=this.select(d=>d.paging),this.searchQuery$=this.select(d=>d.searchQuery),this.formName$=this.select(d=>d.formName),this.actionResult$=this.select(this.item$,this.done$,(d,n)=>({item:d,done:n}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.journalEntries$,this.caseAccounts$,(d,n,r,m,p,_)=>({errors:d,loading:n,item:r,formName:m,journalEntries:p,caseAccounts:_}),{debounce:!0}),this.input$=this.select(this.paging$,this.caseAccountId$,this.searchQuery$,(d,n,r)=>({limit:d.limit,skip:d.skip,name:r,caseAccountId:n,total:d.total})),this.setFormName=this.updater((d,n)=>Object.assign(Object.assign({},d),{formName:n})),this.setCaseAccountId=this.updater((d,n)=>Object.assign(Object.assign({},d),{caseAccountId:n})),this.filterCaseAccounts=d=>this.data.userSelectCaseAccounts({input:{name:d}}).pipe((0,g._b)(n=>{let r=n.data.items;return this.patchState({caseAccounts:r}),r},n=>this.patchState({errors:n.graphQLErrors?n.graphQLErrors:n})),(0,he.U)(n=>n.data.items)),this.addCaseAccount=this.updater((d,n)=>Object.assign(Object.assign({},d),{caseAccounts:d.caseAccounts.concat(n)})),this.setItem=this.updater((d,n)=>Object.assign(Object.assign({},d),{item:n})),this.addNewJournalEntry=this.updater((d,n)=>Object.assign(Object.assign({},d),{journalEntries:[...d.journalEntries,n]})),this.updateJournalEntry=this.updater((d,n)=>Object.assign(Object.assign({},d),{journalEntries:d.journalEntries.map(r=>r.id===n.id?n:r)})),this.addJournalEntries=this.updater((d,n)=>Object.assign(Object.assign({},d),{journalEntries:d.journalEntries.concat(n)})),this.updateJournalEntries=this.updater((d,n)=>Object.assign(Object.assign({},d),{journalEntries:d.journalEntries.map(r=>n.find(p=>p.id===r.id)||r)})),this.setSearchQuery=this.updater((d,n)=>Object.assign(Object.assign({},d),{searchQuery:n})),this.loadJournalEntryEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(n=>this.data.userJournalEntry({journalEntryId:n}).pipe((0,g._b)(r=>{this.patchState({item:r.data.item,errors:r.errors,loading:!1})},r=>this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})))))),this.loadJournalEntriesEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([n,r])=>this.data.userJournalEntries({input:r}).pipe((0,g._b)(m=>this.patchState({paging:{limit:r.limit,skip:r.skip,total:m.data.count.total},journalEntries:m.data.items,errors:m.errors,loading:!1}),m=>this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})))))),this.createJournalEntryEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(n=>this.journalEntryService.createJournalEntry(Object.assign({},n)).pipe((0,g._b)(r=>{this.addNewJournalEntry(r),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:r,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.updateJournalEntryEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([n,r])=>this.journalEntryService.updateJournalEntry(n,n.id).pipe((0,g._b)(m=>{this.updateJournalEntry(m),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:m,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},m=>{m.graphQLErrors?(this.toast.error(m.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})):(this.toast.error(m.Message),this.formService.setErrors(m.Data))}))))),this.deleteJournalEntryEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([n,r])=>this.data.userDeleteJournalEntry({journalEntryId:r.id}).pipe((0,g._b)(m=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:m.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},m=>{m.graphQLErrors?(this.toast.error(m.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})):(this.toast.error(m.Message),this.formService.setErrors(m.Data))}))))),this.importExcelEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(n=>this.journalEntryService.importJournalEntries(n).pipe((0,ce.K)(r=>{var m;return this.toast.error(null!==(m=r.Message)&&void 0!==m?m:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(r=>{const m=JSON.parse(r.created),p=JSON.parse(r.updated),_=JSON.parse(r.failed),w=m.length+p.length+_.length;this.addJournalEntries(m),this.updateJournalEntries(p),this.toast.success(`${m.length} created, ${p.length} updated, ${_.length} failed of total ${w}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("journalEntryId")?(this.route.snapshot.paramMap.get("journalEntryId"),this.setFormName("journalEntry_edit")):this.setFormName("journalEntry_create"),this.route.snapshot.paramMap.has("caseAccountId")){var c=this.route.snapshot.paramMap.get("caseAccountId");this.setCaseAccountId(c)}}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.journalEntryService.validateJournalEntryExcelData(t,i.caseAccounts)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(A$))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function F$(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.journalEntry)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let Vc=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"journalEntry_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({id:null,name:""}),this.store.vm$.subscribe(i=>{this.journalEntry=i.item})):t.formName&&t.formName.currentValue&&"journalEntry_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadJournalEntryEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.journalEntry=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36($o),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-journal-entry-form"]],inputs:{journalEntry:"journalEntry",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,F$,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),jc=(()=>{class s{constructor(){this.autoHeight=!1,this.journalEntries=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[{field:"caseAccount.name",headerName:"Case Account",filter:"agTextColumnFilter"},{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{field:"locationName",filter:"agTextColumnFilter"},{field:"fromTo",filter:"agTextColumnFilter"},{field:"frequency",filter:"agTextColumnFilter"},{field:"autoOrManual",filter:"agTextColumnFilter"},{field:"process",filter:"agTextColumnFilter"},{field:"perAccountOrAggregateJE",filter:"agTextColumnFilter"},{headerName:"Cost Rate",field:"costRate",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.costRate,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{field:"postingDate",filter:"agDateColumnFilter"},{field:"documentDate",filter:"agDateColumnFilter"},{field:"dueDate",filter:"agDateColumnFilter"},{headerName:"Amount",field:"amount",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.amount,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{field:"accountType",filter:"agTextColumnFilter"},{field:"accountNumber",filter:"agTextColumnFilter"},{field:"costCenter",filter:"agTextColumnFilter"},{field:"appliesToDocumentNumber",filter:"agTextColumnFilter"},{field:"caseAccountId",filter:"agTextColumnFilter",hide:!0}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-journal-entry-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",journalEntries:"journalEntries"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.journalEntries)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function P$(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-journal-entry-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","journalEntry_edit")("formControl",t.formControl)("journalEntry",t.journalEntry)}}const I$=function(){return{}};function D$(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-journal-entry-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","journalEntry_create")("formControl",t.formControl)("journalEntry",e.DdM(3,I$))}}function M$(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-journal-entry-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("journalEntries",o.data.items)}let W$=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadJournalEntriesEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.journalEntries$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36($o))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","journalEntry","send","close"],[1,"w-full","h-full","bg-white",3,"journalEntries","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,P$,2,3,"ng-template",null,1,e.W1O),e.YNc(3,D$,1,4,"ng-template",null,2,e.W1O),e.YNc(5,M$,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,Vc,jc],encapsulation:2}),s})();function E$(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-journal-entry-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","journalEntry_edit")("journalEntry",t.value)}}const O$=function(){return{}};function L$(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-journal-entry-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","journalEntry_create")("journalEntry",e.DdM(2,O$))}function $$(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-journal-entry-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("journalEntries",t.items)}}let G$=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:6,consts:[[3,"data","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","journalEntry","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","journalEntries","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,E$,1,2,"ng-template",null,1,e.W1O),e.YNc(3,L$,1,3,"ng-template",null,2,e.W1O),e.YNc(5,$$,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,Vc,jc],encapsulation:2}),s})(),R$=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[$o],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"journal-entry-select",component:W$,wrappers:["form-field"]},{name:"journal-entry-grid",component:G$}]})]}),s})(),Q$=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[R$]}),s})();class _i extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class V$ extends _i{constructor(o){super("ValidateLanguageExcelDataAction"),this.valid=!1,this.excelData=o}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name)}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class j$ extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class U$ extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new j$("name","The language name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class J$ extends _i{constructor(o){super("CreateLanguageAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new U$("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateLanguage({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class z$ extends _i{constructor(o){super("UpdateLanguagesAction"),this.languages=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.languages,!0))}performAction(){this.response=this.businessProvider.data.userUpdateLanguages({input:{languages:this.languages}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class H$ extends _i{constructor(o,t){super("UpdateLanguageAction"),this.language=o,this.languageId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.language,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.languageId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateLanguage({languageId:this.languageId,input:this.language}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let Uc=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.LanguageBusinessProviderService",t,a),this.data=i}createLanguage(t){const i=new J$(t);return i.Do(this),i.response}updateLanguage(t,i){const a=new H$(t,i);return a.Do(this),a.response}importLanguages(t){const i=new z$(t);return i.Do(this),i.response}validateLanguageExcelData(t){const i=new V$(t);return i.Do(this),i.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),q$=(()=>{class s extends I.nH{constructor(t,i,a){super("LanguageService",a,t),this.businessProvider=i}createLanguage(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createLanguage(i)}updateLanguage(t,i){return this.businessProvider.updateLanguage(t,i)}importLanguages(t){return this.businessProvider.importLanguages(t)}validateLanguageExcelData(t){return this.businessProvider.validateLanguageExcelData(t)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(Uc,8),e.LFG(Uc),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),Go=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){super({loading:!1,languages:[],done:!1,searchQuery:"",formName:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.languageService=H,this.errors$=this.select(c=>c.errors),this.loading$=this.select(c=>c.loading),this.done$=this.select(c=>c.done),this.item$=this.select(c=>c.item),this.languages$=this.select(c=>c.languages),this.paging$=this.select(c=>c.paging),this.searchQuery$=this.select(c=>c.searchQuery),this.formName$=this.select(c=>c.formName),this.actionResult$=this.select(this.item$,this.done$,(c,d)=>({item:c,done:d}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.languages$,(c,d,n,r,m)=>({errors:c,loading:d,item:n,formName:r,languages:m}),{debounce:!0}),this.input$=this.select(this.paging$,this.searchQuery$,(c,d)=>({limit:c.limit,skip:c.skip,name:d,total:c.total})),this.setFormName=this.updater((c,d)=>Object.assign(Object.assign({},c),{formName:d})),this.setItem=this.updater((c,d)=>Object.assign(Object.assign({},c),{item:d})),this.addNewLanguage=this.updater((c,d)=>Object.assign(Object.assign({},c),{languages:[...c.languages,d]})),this.updateLanguage=this.updater((c,d)=>Object.assign(Object.assign({},c),{languages:c.languages.map(n=>n.id===d.id?d:n)})),this.addLanguages=this.updater((c,d)=>Object.assign(Object.assign({},c),{languages:c.languages.concat(d)})),this.updateLanguages=this.updater((c,d)=>Object.assign(Object.assign({},c),{languages:c.languages.map(n=>d.find(m=>m.id===n.id)||n)})),this.setSearchQuery=this.updater((c,d)=>Object.assign(Object.assign({},c),{searchQuery:d})),this.loadLanguageEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.data.userLanguage({languageId:d}).pipe((0,g._b)(n=>{this.patchState({item:n.data.item,errors:n.errors,loading:!1})},n=>this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})))))),this.loadLanguagesEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([d,n])=>this.data.userLanguages({input:n}).pipe((0,g._b)(r=>this.patchState({paging:{limit:n.limit,skip:n.skip,total:r.data.count.total},languages:r.data.items,errors:r.errors,loading:!1}),r=>this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})))))),this.createLanguageEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.languageService.createLanguage(Object.assign({},d)).pipe((0,g._b)(n=>{this.addNewLanguage(n),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:n,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},n=>{n.graphQLErrors?(this.toast.error(n.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})):(this.toast.error(n.Message),this.formService.setErrors(n.Data))}))))),this.updateLanguageEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.languageService.updateLanguage(d,d.id).pipe((0,g._b)(r=>{this.updateLanguage(r),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:r,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.deleteLanguageEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.data.userDeleteLanguage({languageId:n.id}).pipe((0,g._b)(r=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:r.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.importExcelEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.languageService.importLanguages(d).pipe((0,ce.K)(n=>{var r;return this.toast.error(null!==(r=n.Message)&&void 0!==r?r:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(n=>{const r=JSON.parse(n.created),m=JSON.parse(n.updated),p=JSON.parse(n.failed),_=r.length+m.length+p.length;this.addLanguages(r),this.updateLanguages(m),this.toast.success(`${r.length} created, ${m.length} updated, ${p.length} failed of total ${_}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("languageId")?(this.route.snapshot.paramMap.get("languageId"),this.setFormName("language_edit")):this.setFormName("language_create")}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.languageService.validateLanguageExcelData(t)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(q$))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function K$(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.language)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let Jc=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"language_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.language=i.item})):t.formName&&t.formName.currentValue&&"language_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadLanguageEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.language=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Go),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-language-form"]],inputs:{language:"language",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,K$,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),zc=(()=>{class s{constructor(){this.autoHeight=!1,this.languages=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[,{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}ngOnInit(){}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-language-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",languages:"languages"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.languages)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function Z$(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-language-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","language_edit")("formControl",t.formControl)("language",t.language)}}const k$=function(){return{}};function B$(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-language-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","language_create")("formControl",t.formControl)("language",e.DdM(3,k$))}}function Y$(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-language-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("languages",o.data.items)}let X$=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadLanguagesEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.languages$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Go))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","language","send","close"],[1,"w-full","h-full","bg-white",3,"languages","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,Z$,2,3,"ng-template",null,1,e.W1O),e.YNc(3,B$,1,4,"ng-template",null,2,e.W1O),e.YNc(5,Y$,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,Jc,zc],encapsulation:2}),s})();function eG(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-language-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","language_edit")("language",t.value)}}const tG=function(){return{}};function iG(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-language-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","language_create")("language",e.DdM(2,tG))}function sG(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-language-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("languages",t.items)}}let oG=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","language","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","languages","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,eG,1,2,"ng-template",null,1,e.W1O),e.YNc(3,iG,1,3,"ng-template",null,2,e.W1O),e.YNc(5,sG,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,Jc,zc],encapsulation:2}),s})(),aG=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[Go],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"language-select",component:X$,wrappers:["form-field"]},{name:"language-grid",component:oG}]})]}),s})(),rG=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[aG]}),s})();class gi extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class nG extends gi{constructor(o,t){super("ValidateLeadActionExcelDataAction"),this.valid=!1,this.excelData=o,this.leads=t}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name),this.validationContext.addRule(new f.mi(`leadName_${i}_is_valid}`,"Lead Is Not Valid","lead.name",t.lead,this.leads,!0))}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class lG extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class cG extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new lG("name","The leadaction name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class dG extends gi{constructor(o){super("CreateLeadActionAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new cG("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateLeadAction({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class uG extends gi{constructor(o){super("UpdateLeadActionsAction"),this.leadActions=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.leadActions,!0))}performAction(){this.response=this.businessProvider.data.userUpdateLeadActions({input:{leadActions:this.leadActions}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class mG extends gi{constructor(o,t){super("UpdateLeadActionAction"),this.leadAction=o,this.leadActionId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.leadAction,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.leadActionId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateLeadAction({leadActionId:this.leadActionId,input:this.leadAction}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let Hc=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.LeadActionBusinessProviderService",t,a),this.data=i}createLeadAction(t){const i=new dG(t);return i.Do(this),i.response}updateLeadAction(t,i){const a=new mG(t,i);return a.Do(this),a.response}importLeadActions(t){const i=new uG(t);return i.Do(this),i.response}validateLeadActionExcelData(t,i){const a=new nG(t,i);return a.Do(this),a.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),pG=(()=>{class s extends I.nH{constructor(t,i,a){super("LeadActionService",a,t),this.businessProvider=i}createLeadAction(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createLeadAction(i)}updateLeadAction(t,i){return this.businessProvider.updateLeadAction(t,i)}importLeadActions(t){return this.businessProvider.importLeadActions(t)}validateLeadActionExcelData(t,i){return this.businessProvider.validateLeadActionExcelData(t,i)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(Hc,8),e.LFG(Hc),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),Ro=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){if(super({loading:!1,leadActions:[],done:!1,searchQuery:"",formName:void 0,leadId:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.leadActionService=H,this.errors$=this.select(d=>d.errors),this.loading$=this.select(d=>d.loading),this.done$=this.select(d=>d.done),this.item$=this.select(d=>d.item),this.leadActions$=this.select(d=>d.leadActions),this.leads$=this.select(d=>d.leads||[]),this.leadId$=this.select(d=>d.leadId),this.paging$=this.select(d=>d.paging),this.searchQuery$=this.select(d=>d.searchQuery),this.formName$=this.select(d=>d.formName),this.actionResult$=this.select(this.item$,this.done$,(d,n)=>({item:d,done:n}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.leadActions$,this.leads$,(d,n,r,m,p,_)=>({errors:d,loading:n,item:r,formName:m,leadActions:p,leads:_}),{debounce:!0}),this.input$=this.select(this.paging$,this.leadId$,this.searchQuery$,(d,n,r)=>({limit:d.limit,skip:d.skip,name:r,leadId:n,total:d.total})),this.setFormName=this.updater((d,n)=>Object.assign(Object.assign({},d),{formName:n})),this.setLeadId=this.updater((d,n)=>Object.assign(Object.assign({},d),{leadId:n})),this.filterLeads=d=>this.data.userSelectLeads({input:{name:d}}).pipe((0,g._b)(n=>{let r=n.data.items;return this.patchState({leads:r}),r},n=>this.patchState({errors:n.graphQLErrors?n.graphQLErrors:n})),(0,he.U)(n=>n.data.items)),this.addLead=this.updater((d,n)=>Object.assign(Object.assign({},d),{leads:d.leads.concat(n)})),this.setItem=this.updater((d,n)=>Object.assign(Object.assign({},d),{item:n})),this.addNewLeadAction=this.updater((d,n)=>Object.assign(Object.assign({},d),{leadActions:[...d.leadActions,n]})),this.updateLeadAction=this.updater((d,n)=>Object.assign(Object.assign({},d),{leadActions:d.leadActions.map(r=>r.id===n.id?n:r)})),this.addLeadActions=this.updater((d,n)=>Object.assign(Object.assign({},d),{leadActions:d.leadActions.concat(n)})),this.updateLeadActions=this.updater((d,n)=>Object.assign(Object.assign({},d),{leadActions:d.leadActions.map(r=>n.find(p=>p.id===r.id)||r)})),this.setSearchQuery=this.updater((d,n)=>Object.assign(Object.assign({},d),{searchQuery:n})),this.loadLeadActionEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(n=>this.data.userLeadAction({leadActionId:n}).pipe((0,g._b)(r=>{this.patchState({item:r.data.item,errors:r.errors,loading:!1})},r=>this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})))))),this.loadLeadActionsEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([n,r])=>this.data.userLeadActions({input:r}).pipe((0,g._b)(m=>this.patchState({paging:{limit:r.limit,skip:r.skip,total:m.data.count.total},leadActions:m.data.items,errors:m.errors,loading:!1}),m=>this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})))))),this.createLeadActionEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(n=>this.leadActionService.createLeadAction(Object.assign({},n)).pipe((0,g._b)(r=>{this.addNewLeadAction(r),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:r,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.updateLeadActionEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([n,r])=>this.leadActionService.updateLeadAction(n,n.id).pipe((0,g._b)(m=>{this.updateLeadAction(m),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:m,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},m=>{m.graphQLErrors?(this.toast.error(m.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})):(this.toast.error(m.Message),this.formService.setErrors(m.Data))}))))),this.deleteLeadActionEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([n,r])=>this.data.userDeleteLeadAction({leadActionId:r.id}).pipe((0,g._b)(m=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:m.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},m=>{m.graphQLErrors?(this.toast.error(m.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})):(this.toast.error(m.Message),this.formService.setErrors(m.Data))}))))),this.importExcelEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(n=>this.leadActionService.importLeadActions(n).pipe((0,ce.K)(r=>{var m;return this.toast.error(null!==(m=r.Message)&&void 0!==m?m:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(r=>{const m=JSON.parse(r.created),p=JSON.parse(r.updated),_=JSON.parse(r.failed),w=m.length+p.length+_.length;this.addLeadActions(m),this.updateLeadActions(p),this.toast.success(`${m.length} created, ${p.length} updated, ${_.length} failed of total ${w}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("leadActionId")?(this.route.snapshot.paramMap.get("leadActionId"),this.setFormName("leadAction_edit")):this.setFormName("leadAction_create"),this.route.snapshot.paramMap.has("leadId")){var c=this.route.snapshot.paramMap.get("leadId");this.setLeadId(c)}}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.leadActionService.validateLeadActionExcelData(t,i.leads)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(pG))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function hG(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.leadAction)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let qc=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"leadAction_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({id:null,name:""}),this.store.vm$.subscribe(i=>{this.leadAction=i.item})):t.formName&&t.formName.currentValue&&"leadAction_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadLeadActionEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.leadAction=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Ro),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-lead-action-form"]],inputs:{leadAction:"leadAction",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,hG,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),Kc=(()=>{class s{constructor(){this.autoHeight=!1,this.leadActions=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[{field:"lead.name",headerName:"Lead",filter:"agTextColumnFilter"},{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{field:"leadId",filter:"agTextColumnFilter",hide:!0}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-lead-action-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",leadActions:"leadActions"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.leadActions)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function fG(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-lead-action-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","leadAction_edit")("formControl",t.formControl)("leadAction",t.leadAction)}}const _G=function(){return{}};function gG(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-lead-action-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","leadAction_create")("formControl",t.formControl)("leadAction",e.DdM(3,_G))}}function CG(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-lead-action-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("leadActions",o.data.items)}let vG=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadLeadActionsEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.leadActions$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Ro))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","leadAction","send","close"],[1,"w-full","h-full","bg-white",3,"leadActions","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,fG,2,3,"ng-template",null,1,e.W1O),e.YNc(3,gG,1,4,"ng-template",null,2,e.W1O),e.YNc(5,CG,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,qc,Kc],encapsulation:2}),s})();function SG(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-lead-action-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","leadAction_edit")("leadAction",t.value)}}const bG=function(){return{}};function TG(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-lead-action-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","leadAction_create")("leadAction",e.DdM(2,bG))}function yG(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-lead-action-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("leadActions",t.items)}}let wG=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:6,consts:[[3,"data","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","leadAction","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","leadActions","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,SG,1,2,"ng-template",null,1,e.W1O),e.YNc(3,TG,1,3,"ng-template",null,2,e.W1O),e.YNc(5,yG,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,qc,Kc],encapsulation:2}),s})(),xG=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[Ro],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"lead-action-select",component:vG,wrappers:["form-field"]},{name:"lead-action-grid",component:wG}]})]}),s})(),NG=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[xG]}),s})();var Ci=Q(6489);function AG(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.lead)("formName",t.formName)("showSubmitButton",!0)("formData",t.formData)("componentStore",t.store)}}let Qo=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$,this.formData={accidentTypes:this.store.filterAccidentTypes(""),documents:this.store.filterDocuments(""),leadStatuses:this.store.filterLeadStatuses(""),leadSources:this.store.filterLeadSources(""),users:this.store.filterUsers(""),bodyParts:this.store.filterBodyParts("")}}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"lead_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.lead=i.item})):t.formName&&t.formName.currentValue&&"lead_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadLeadEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.lead=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Ci.O),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-lead-form"]],inputs:{lead:"lead",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","formData","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,AG,4,5,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),Zc=(()=>{class s{constructor(){this.autoHeight=!1,this.leads=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[{field:"accidentType.name",headerName:"Accident Type",filter:"agTextColumnFilter"},{field:"driversLicense.name",headerName:"Drivers License",filter:"agTextColumnFilter"},{field:"policeReportAttachment.name",headerName:"Police Report Attachment",filter:"agTextColumnFilter"},{field:"phoneRecording.name",headerName:"Phone Recording",filter:"agTextColumnFilter"},{field:"status.name",headerName:"Status",filter:"agTextColumnFilter"},{field:"sourceOfLead.name",headerName:"Source of Lead",filter:"agTextColumnFilter"},{field:"submittedBy.name",headerName:"Submitted by",filter:"agTextColumnFilter"},{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{field:"firstName",filter:"agTextColumnFilter"},{field:"middleName",filter:"agTextColumnFilter"},{field:"lastName",filter:"agTextColumnFilter"},{field:"address",filter:"agTextColumnFilter"},{field:"city",filter:"agTextColumnFilter"},{field:"state",filter:"agTextColumnFilter"},{field:"postalCode",filter:"agTextColumnFilter"},{field:"dateOfBirth",filter:"agDateColumnFilter"},{field:"dateOfLoss",filter:"agDateColumnFilter"},{field:"dateOfRetention",filter:"agDateColumnFilter"},{field:"phoneNumber",filter:"agTextColumnFilter"},{field:"emailAddress",filter:"agTextColumnFilter"},{field:"priorRepresentation",filter:"agTextColumnFilter"},{field:"accidentTypeId",filter:"agTextColumnFilter",hide:!0},{field:"driversLicenseId",filter:"agTextColumnFilter",hide:!0},{field:"driversLicenseNumber",filter:"agTextColumnFilter"},{field:"driversLicenseState",filter:"agTextColumnFilter"},{headerName:"Severe Injury",field:"severeInjury",filter:"agSetColumnFilter",cellRenderer:"checkboxRenderer"},{field:"emergencyContactId",filter:"agTextColumnFilter"},{headerName:"Allowed to Contact Emergency Contact",field:"allowedToContactEmergencyContact",filter:"agSetColumnFilter",cellRenderer:"checkboxRenderer"},{headerName:"Police Report",field:"policeReport",filter:"agSetColumnFilter",cellRenderer:"checkboxRenderer"},{field:"policeReportAttachmentId",filter:"agTextColumnFilter",hide:!0},{field:"phoneRecordingId",filter:"agTextColumnFilter",hide:!0},{field:"leadStatusId",filter:"agTextColumnFilter",hide:!0},{field:"leadSpecialistId",filter:"agTextColumnFilter"},{field:"leadSourceId",filter:"agTextColumnFilter",hide:!0},{field:"submittedById",filter:"agTextColumnFilter",hide:!0},{field:"legalCaseId",filter:"agTextColumnFilter"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-lead-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",leads:"leads"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","data","showSidebar","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("data",i.leads)("showSidebar",!1)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function FG(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-lead-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","lead_edit")("formControl",t.formControl)("lead",t.lead)}}const PG=function(){return{}};function IG(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-lead-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","lead_create")("formControl",t.formControl)("lead",e.DdM(3,PG))}}function DG(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-lead-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("leads",o.data.items)}let MG=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadLeadsEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.leads$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Ci.O))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e._Bn([Ci.O]),e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","lead","send","close"],[1,"w-full","h-full","bg-white",3,"leads","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,FG,2,3,"ng-template",null,1,e.W1O),e.YNc(3,IG,1,4,"ng-template",null,2,e.W1O),e.YNc(5,DG,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,Qo,Zc],encapsulation:2}),s})();function WG(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-lead-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","lead_edit")("lead",t.value)}}const EG=function(){return{}};function OG(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-lead-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","lead_create")("lead",e.DdM(2,EG))}function LG(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-lead-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("leads",t.items)}}let $G=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:6,consts:[[3,"data","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","lead","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","leads","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,WG,1,2,"ng-template",null,1,e.W1O),e.YNc(3,OG,1,3,"ng-template",null,2,e.W1O),e.YNc(5,LG,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,Qo,Zc],encapsulation:2}),s})();const GG=function(){return{}};let RG=(()=>{class s extends R.fS{save(t){this.to.save&&this.to.save instanceof Function&&this.to.save(t)}cancel(){this.to.cancel&&this.to.cancel instanceof Function&&this.to.cancel()}}return s.\u0275fac=function(){let o;return function(i){return(o||(o=e.n5z(s)))(i||s)}}(),s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-web-lead-form"]],features:[e.qOj],decls:1,vars:4,consts:[[1,"flex-grow","flex","flex-col",3,"formName","formControl","lead","send","close"]],template:function(t,i){1&t&&(e.TgZ(0,"ui-lead-form",0),e.NdJ("send",function(l){return i.save(l)})("close",function(){return i.cancel()}),e.qZA()),2&t&&e.Q6J("formName","lead_create")("formControl",i.formControl)("lead",e.DdM(3,GG))},dependencies:[W.JJ,W.oH,Qo],encapsulation:2}),s})(),QG=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[Ci.O],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"lead-select",component:MG,wrappers:["form-field"]},{name:"lead-grid",component:$G},{name:"lead-form",component:RG}]})]}),s})(),VG=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[QG]}),s})();class vi extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class jG extends vi{constructor(o){super("ValidateLeadSourceExcelDataAction"),this.valid=!1,this.excelData=o}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name)}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class UG extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class JG extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new UG("name","The leadsource name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class zG extends vi{constructor(o){super("CreateLeadSourceAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new JG("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateLeadSource({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class HG extends vi{constructor(o){super("UpdateLeadSourcesAction"),this.leadSources=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.leadSources,!0))}performAction(){this.response=this.businessProvider.data.userUpdateLeadSources({input:{leadSources:this.leadSources}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class qG extends vi{constructor(o,t){super("UpdateLeadSourceAction"),this.leadSource=o,this.leadSourceId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.leadSource,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.leadSourceId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateLeadSource({leadSourceId:this.leadSourceId,input:this.leadSource}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let kc=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.LeadSourceBusinessProviderService",t,a),this.data=i}createLeadSource(t){const i=new zG(t);return i.Do(this),i.response}updateLeadSource(t,i){const a=new qG(t,i);return a.Do(this),a.response}importLeadSources(t){const i=new HG(t);return i.Do(this),i.response}validateLeadSourceExcelData(t){const i=new jG(t);return i.Do(this),i.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),KG=(()=>{class s extends I.nH{constructor(t,i,a){super("LeadSourceService",a,t),this.businessProvider=i}createLeadSource(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createLeadSource(i)}updateLeadSource(t,i){return this.businessProvider.updateLeadSource(t,i)}importLeadSources(t){return this.businessProvider.importLeadSources(t)}validateLeadSourceExcelData(t){return this.businessProvider.validateLeadSourceExcelData(t)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(kc,8),e.LFG(kc),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),Vo=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){super({loading:!1,leadSources:[],done:!1,searchQuery:"",formName:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.leadSourceService=H,this.errors$=this.select(c=>c.errors),this.loading$=this.select(c=>c.loading),this.done$=this.select(c=>c.done),this.item$=this.select(c=>c.item),this.leadSources$=this.select(c=>c.leadSources),this.paging$=this.select(c=>c.paging),this.searchQuery$=this.select(c=>c.searchQuery),this.formName$=this.select(c=>c.formName),this.actionResult$=this.select(this.item$,this.done$,(c,d)=>({item:c,done:d}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.leadSources$,(c,d,n,r,m)=>({errors:c,loading:d,item:n,formName:r,leadSources:m}),{debounce:!0}),this.input$=this.select(this.paging$,this.searchQuery$,(c,d)=>({limit:c.limit,skip:c.skip,name:d,total:c.total})),this.setFormName=this.updater((c,d)=>Object.assign(Object.assign({},c),{formName:d})),this.setItem=this.updater((c,d)=>Object.assign(Object.assign({},c),{item:d})),this.addNewLeadSource=this.updater((c,d)=>Object.assign(Object.assign({},c),{leadSources:[...c.leadSources,d]})),this.updateLeadSource=this.updater((c,d)=>Object.assign(Object.assign({},c),{leadSources:c.leadSources.map(n=>n.id===d.id?d:n)})),this.addLeadSources=this.updater((c,d)=>Object.assign(Object.assign({},c),{leadSources:c.leadSources.concat(d)})),this.updateLeadSources=this.updater((c,d)=>Object.assign(Object.assign({},c),{leadSources:c.leadSources.map(n=>d.find(m=>m.id===n.id)||n)})),this.setSearchQuery=this.updater((c,d)=>Object.assign(Object.assign({},c),{searchQuery:d})),this.loadLeadSourceEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.data.userLeadSource({leadSourceId:d}).pipe((0,g._b)(n=>{this.patchState({item:n.data.item,errors:n.errors,loading:!1})},n=>this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})))))),this.loadLeadSourcesEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([d,n])=>this.data.userLeadSources({input:n}).pipe((0,g._b)(r=>this.patchState({paging:{limit:n.limit,skip:n.skip,total:r.data.count.total},leadSources:r.data.items,errors:r.errors,loading:!1}),r=>this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})))))),this.createLeadSourceEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.leadSourceService.createLeadSource(Object.assign({},d)).pipe((0,g._b)(n=>{this.addNewLeadSource(n),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:n,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},n=>{n.graphQLErrors?(this.toast.error(n.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})):(this.toast.error(n.Message),this.formService.setErrors(n.Data))}))))),this.updateLeadSourceEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.leadSourceService.updateLeadSource(d,d.id).pipe((0,g._b)(r=>{this.updateLeadSource(r),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:r,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.deleteLeadSourceEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.data.userDeleteLeadSource({leadSourceId:n.id}).pipe((0,g._b)(r=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:r.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.importExcelEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.leadSourceService.importLeadSources(d).pipe((0,ce.K)(n=>{var r;return this.toast.error(null!==(r=n.Message)&&void 0!==r?r:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(n=>{const r=JSON.parse(n.created),m=JSON.parse(n.updated),p=JSON.parse(n.failed),_=r.length+m.length+p.length;this.addLeadSources(r),this.updateLeadSources(m),this.toast.success(`${r.length} created, ${m.length} updated, ${p.length} failed of total ${_}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("leadSourceId")?(this.route.snapshot.paramMap.get("leadSourceId"),this.setFormName("leadSource_edit")):this.setFormName("leadSource_create")}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.leadSourceService.validateLeadSourceExcelData(t)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(KG))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function ZG(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.leadSource)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let Bc=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"leadSource_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({id:null,name:""}),this.store.vm$.subscribe(i=>{this.leadSource=i.item})):t.formName&&t.formName.currentValue&&"leadSource_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadLeadSourceEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.leadSource=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Vo),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-lead-source-form"]],inputs:{leadSource:"leadSource",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,ZG,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),Yc=(()=>{class s{constructor(){this.autoHeight=!1,this.leadSources=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[,{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-lead-source-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",leadSources:"leadSources"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.leadSources)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function kG(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-lead-source-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","leadSource_edit")("formControl",t.formControl)("leadSource",t.leadSource)}}const BG=function(){return{}};function YG(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-lead-source-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","leadSource_create")("formControl",t.formControl)("leadSource",e.DdM(3,BG))}}function XG(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-lead-source-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("leadSources",o.data.items)}let e3=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadLeadSourcesEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.leadSources$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Vo))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","leadSource","send","close"],[1,"w-full","h-full","bg-white",3,"leadSources","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,kG,2,3,"ng-template",null,1,e.W1O),e.YNc(3,YG,1,4,"ng-template",null,2,e.W1O),e.YNc(5,XG,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,Bc,Yc],encapsulation:2}),s})();function t3(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-lead-source-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","leadSource_edit")("leadSource",t.value)}}const i3=function(){return{}};function s3(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-lead-source-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","leadSource_create")("leadSource",e.DdM(2,i3))}function o3(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-lead-source-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("leadSources",t.items)}}let a3=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:6,consts:[[3,"data","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","leadSource","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","leadSources","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,t3,1,2,"ng-template",null,1,e.W1O),e.YNc(3,s3,1,3,"ng-template",null,2,e.W1O),e.YNc(5,o3,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,Bc,Yc],encapsulation:2}),s})(),r3=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[Vo],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"lead-source-select",component:e3,wrappers:["form-field"]},{name:"lead-source-grid",component:a3}]})]}),s})(),n3=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[r3]}),s})();class Si extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class l3 extends Si{constructor(o){super("ValidateLeadStatusExcelDataAction"),this.valid=!1,this.excelData=o}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name)}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class c3 extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class d3 extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new c3("name","The leadstatus name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class u3 extends Si{constructor(o){super("CreateLeadStatusAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new d3("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateLeadStatus({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class m3 extends Si{constructor(o){super("UpdateLeadStatusesAction"),this.leadStatuses=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.leadStatuses,!0))}performAction(){this.response=this.businessProvider.data.userUpdateLeadStatuses({input:{leadStatuses:this.leadStatuses}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class p3 extends Si{constructor(o,t){super("UpdateLeadStatusAction"),this.leadStatus=o,this.leadStatusId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.leadStatus,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.leadStatusId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateLeadStatus({leadStatusId:this.leadStatusId,input:this.leadStatus}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let Xc=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.LeadStatusBusinessProviderService",t,a),this.data=i}createLeadStatus(t){const i=new u3(t);return i.Do(this),i.response}updateLeadStatus(t,i){const a=new p3(t,i);return a.Do(this),a.response}importLeadStatuses(t){const i=new m3(t);return i.Do(this),i.response}validateLeadStatusExcelData(t){const i=new l3(t);return i.Do(this),i.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),h3=(()=>{class s extends I.nH{constructor(t,i,a){super("LeadStatusService",a,t),this.businessProvider=i}createLeadStatus(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createLeadStatus(i)}updateLeadStatus(t,i){return this.businessProvider.updateLeadStatus(t,i)}importLeadStatuses(t){return this.businessProvider.importLeadStatuses(t)}validateLeadStatusExcelData(t){return this.businessProvider.validateLeadStatusExcelData(t)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(Xc,8),e.LFG(Xc),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),jo=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){super({loading:!1,leadStatuses:[],done:!1,searchQuery:"",formName:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.leadStatusService=H,this.errors$=this.select(c=>c.errors),this.loading$=this.select(c=>c.loading),this.done$=this.select(c=>c.done),this.item$=this.select(c=>c.item),this.leadStatuses$=this.select(c=>c.leadStatuses),this.paging$=this.select(c=>c.paging),this.searchQuery$=this.select(c=>c.searchQuery),this.formName$=this.select(c=>c.formName),this.actionResult$=this.select(this.item$,this.done$,(c,d)=>({item:c,done:d}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.leadStatuses$,(c,d,n,r,m)=>({errors:c,loading:d,item:n,formName:r,leadStatuses:m}),{debounce:!0}),this.input$=this.select(this.paging$,this.searchQuery$,(c,d)=>({limit:c.limit,skip:c.skip,name:d,total:c.total})),this.setFormName=this.updater((c,d)=>Object.assign(Object.assign({},c),{formName:d})),this.setItem=this.updater((c,d)=>Object.assign(Object.assign({},c),{item:d})),this.addNewLeadStatus=this.updater((c,d)=>Object.assign(Object.assign({},c),{leadStatuses:[...c.leadStatuses,d]})),this.updateLeadStatus=this.updater((c,d)=>Object.assign(Object.assign({},c),{leadStatuses:c.leadStatuses.map(n=>n.id===d.id?d:n)})),this.addLeadStatuses=this.updater((c,d)=>Object.assign(Object.assign({},c),{leadStatuses:c.leadStatuses.concat(d)})),this.updateLeadStatuses=this.updater((c,d)=>Object.assign(Object.assign({},c),{leadStatuses:c.leadStatuses.map(n=>d.find(m=>m.id===n.id)||n)})),this.setSearchQuery=this.updater((c,d)=>Object.assign(Object.assign({},c),{searchQuery:d})),this.loadLeadStatusEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.data.userLeadStatus({leadStatusId:d}).pipe((0,g._b)(n=>{this.patchState({item:n.data.item,errors:n.errors,loading:!1})},n=>this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})))))),this.loadLeadStatusesEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([d,n])=>this.data.userLeadStatuses({input:n}).pipe((0,g._b)(r=>this.patchState({paging:{limit:n.limit,skip:n.skip,total:r.data.count.total},leadStatuses:r.data.items,errors:r.errors,loading:!1}),r=>this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})))))),this.createLeadStatusEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.leadStatusService.createLeadStatus(Object.assign({},d)).pipe((0,g._b)(n=>{this.addNewLeadStatus(n),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:n,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},n=>{n.graphQLErrors?(this.toast.error(n.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})):(this.toast.error(n.Message),this.formService.setErrors(n.Data))}))))),this.updateLeadStatusEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.leadStatusService.updateLeadStatus(d,d.id).pipe((0,g._b)(r=>{this.updateLeadStatus(r),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:r,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.deleteLeadStatusEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.data.userDeleteLeadStatus({leadStatusId:n.id}).pipe((0,g._b)(r=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:r.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.importExcelEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.leadStatusService.importLeadStatuses(d).pipe((0,ce.K)(n=>{var r;return this.toast.error(null!==(r=n.Message)&&void 0!==r?r:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(n=>{const r=JSON.parse(n.created),m=JSON.parse(n.updated),p=JSON.parse(n.failed),_=r.length+m.length+p.length;this.addLeadStatuses(r),this.updateLeadStatuses(m),this.toast.success(`${r.length} created, ${m.length} updated, ${p.length} failed of total ${_}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("leadStatusId")?(this.route.snapshot.paramMap.get("leadStatusId"),this.setFormName("leadStatus_edit")):this.setFormName("leadStatus_create")}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.leadStatusService.validateLeadStatusExcelData(t)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(h3))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function f3(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.leadStatus)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let ed=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"leadStatus_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({id:null,name:""}),this.store.vm$.subscribe(i=>{this.leadStatus=i.item})):t.formName&&t.formName.currentValue&&"leadStatus_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadLeadStatusEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.leadStatus=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(jo),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-lead-status-form"]],inputs:{leadStatus:"leadStatus",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,f3,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),td=(()=>{class s{constructor(){this.autoHeight=!1,this.leadStatuses=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[,{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-lead-status-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",leadStatuses:"leadStatuses"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.leadStatuses)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function _3(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-lead-status-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","leadStatus_edit")("formControl",t.formControl)("leadStatus",t.leadStatus)}}const g3=function(){return{}};function C3(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-lead-status-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","leadStatus_create")("formControl",t.formControl)("leadStatus",e.DdM(3,g3))}}function v3(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-lead-status-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("leadStatuses",o.data.items)}let S3=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadLeadStatusesEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.leadStatuses$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(jo))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","leadStatus","send","close"],[1,"w-full","h-full","bg-white",3,"leadStatuses","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,_3,2,3,"ng-template",null,1,e.W1O),e.YNc(3,C3,1,4,"ng-template",null,2,e.W1O),e.YNc(5,v3,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,ed,td],encapsulation:2}),s})();function b3(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-lead-status-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","leadStatus_edit")("leadStatus",t.value)}}const T3=function(){return{}};function y3(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-lead-status-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","leadStatus_create")("leadStatus",e.DdM(2,T3))}function w3(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-lead-status-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("leadStatuses",t.items)}}let x3=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:6,consts:[[3,"data","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","leadStatus","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","leadStatuses","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,b3,1,2,"ng-template",null,1,e.W1O),e.YNc(3,y3,1,3,"ng-template",null,2,e.W1O),e.YNc(5,w3,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,ed,td],encapsulation:2}),s})(),N3=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[jo],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"lead-status-select",component:S3,wrappers:["form-field"]},{name:"lead-status-grid",component:x3}]})]}),s})(),A3=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[N3]}),s})();var Uo=Q(19647);function F3(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.legalCase)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let id=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"legalCase_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.legalCase=i.item})):t.formName&&t.formName.currentValue&&"legalCase_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadLegalCaseEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.legalCase=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Uo.d),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-legal-case-form"]],inputs:{legalCase:"legalCase",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,F3,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),sd=(()=>{class s{constructor(){this.autoHeight=!1,this.legalCases=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[{field:"accidentType.name",headerName:"Accident Type",filter:"agTextColumnFilter"},{field:"patient.name",headerName:"Patient",filter:"agTextColumnFilter"},{field:"medLevel.name",headerName:"Med Level",filter:"agTextColumnFilter"},{field:"firm.name",headerName:"Firm",filter:"agTextColumnFilter"},{field:"attorney.name",headerName:"Attorney",filter:"agTextColumnFilter"},{field:"caseStatus.name",headerName:"Case Status",filter:"agTextColumnFilter"},{field:"caseType.name",headerName:"Case Type",filter:"agTextColumnFilter"},{field:"patientTreatmentStatus.name",headerName:"Patient Treatment Status",filter:"agTextColumnFilter"},{field:"caseProgressStatus.name",headerName:"Case Progress Status",filter:"agTextColumnFilter"},{field:"adverseInsuranceStatus.name",headerName:"Adverse Insurance Status",filter:"agTextColumnFilter"},{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{field:"accidentTypeId",filter:"agTextColumnFilter",hide:!0},{field:"patientId",filter:"agTextColumnFilter",hide:!0},{field:"medLevelId",filter:"agTextColumnFilter",hide:!0},{field:"firmId",filter:"agTextColumnFilter",hide:!0},{field:"attorneyId",filter:"agTextColumnFilter",hide:!0},{field:"agentId",filter:"agTextColumnFilter"},{field:"caseStatusId",filter:"agTextColumnFilter",hide:!0},{field:"caseTypeId",filter:"agTextColumnFilter",hide:!0},{field:"patientTreatmentStatusId",filter:"agTextColumnFilter",hide:!0},{field:"medicalRecordNumber",filter:"agTextColumnFilter"},{field:"pharmacyControlNumber",filter:"agTextColumnFilter"},{field:"pchGroupNumber",filter:"agTextColumnFilter"},{field:"dateOfLoss",filter:"agDateColumnFilter"},{field:"caseStatusDate",filter:"agDateColumnFilter"},{field:"caseStatusOther",filter:"agTextColumnFilter"},{field:"paralegal",filter:"agTextColumnFilter"},{field:"paralegalContact",filter:"agTextColumnFilter"},{field:"caseNoteSummary",filter:"agTextColumnFilter"},{headerName:"Policy Limit",field:"policyLimit",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.policyLimit,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{headerName:"Attorney Fee",field:"attorneyFee",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.attorneyFee,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{field:"referringPhysician",filter:"agTextColumnFilter"},{headerName:"No More Treatment",field:"noMoreTreatment",filter:"agSetColumnFilter",cellRenderer:"checkboxRenderer"},{headerName:"Medpay",field:"medpay",filter:"agSetColumnFilter",cellRenderer:"checkboxRenderer"},{field:"fileNumber",filter:"agTextColumnFilter"},{field:"caseNumber",filter:"agTextColumnFilter"},{field:"accidentState",filter:"agTextColumnFilter"},{field:"assignedTo",filter:"agTextColumnFilter"},{headerName:"Attorney Paid",field:"attorneyPaid",filter:"agSetColumnFilter",cellRenderer:"checkboxRenderer"},{field:"attorneySentDate",filter:"agDateColumnFilter"},{headerName:"Write off",field:"writeOff",filter:"agSetColumnFilter",cellRenderer:"checkboxRenderer"},{headerName:"No MRI",field:"noMRI",filter:"agSetColumnFilter",cellRenderer:"checkboxRenderer"},{headerName:"No PT",field:"noPT",filter:"agSetColumnFilter",cellRenderer:"checkboxRenderer"},{headerName:"No First Appointment",field:"noFirstAppointment",filter:"agSetColumnFilter",cellRenderer:"checkboxRenderer"},{headerName:"Hot",field:"hot",filter:"agSetColumnFilter",cellRenderer:"checkboxRenderer"},{headerName:"Documents Uploaded",field:"documentsUploaded",filter:"agSetColumnFilter",cellRenderer:"checkboxRenderer"},{headerName:"Attorney Review",field:"attorneyReview",filter:"agSetColumnFilter",cellRenderer:"checkboxRenderer"},{headerName:"Escalated Review",field:"escalatedReview",filter:"agSetColumnFilter",cellRenderer:"checkboxRenderer"},{headerName:"In Active",field:"inActive",filter:"agSetColumnFilter",cellRenderer:"checkboxRenderer"},{headerName:"Criteria 1712",field:"criteria1712",filter:"agSetColumnFilter",cellRenderer:"checkboxRenderer"},{field:"documentUploadedDate",filter:"agDateColumnFilter"},{field:"patientDischargedGatheringRecordsDate",filter:"agDateColumnFilter"},{field:"resubmitted",filter:"agDateColumnFilter"},{field:"caseProgressStatusId",filter:"agTextColumnFilter",hide:!0},{field:"firmCaseManager",filter:"agTextColumnFilter"},{field:"adverseInsuranceStatusId",filter:"agTextColumnFilter",hide:!0},{field:"createdBy",filter:"agTextColumnFilter"},{field:"renegotiatePayOffDate",filter:"agDateColumnFilter"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-legal-case-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",legalCases:"legalCases"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.legalCases)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function P3(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-legal-case-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","legalCase_edit")("formControl",t.formControl)("legalCase",t.legalCase)}}const I3=function(){return{}};function D3(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-legal-case-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","legalCase_create")("formControl",t.formControl)("legalCase",e.DdM(3,I3))}}function M3(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-legal-case-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("legalCases",o.data.items)}let W3=(()=>{class s extends R.fS{constructor(t,i){if(super(),this.store=t,this.route=i,this.routerKeys=["accidentTypeId","patientId","medLevelId","firmId","attorneyId","caseStatusId","caseTypeId","patientTreatmentStatusId","caseProgressStatusId","adverseInsuranceStatusId"],this.route.snapshot.paramMap.has("patientId")){var a=this.route.snapshot.paramMap.get("patientId");this.store.setPatientId(a)}this.store.loadLegalCasesEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.legalCases$.pipe((0,h.w)(i=>(0,F.of)(i)))}formRouterKeyDidChange(t){t.accidentTypeId&&this.store.setAccidentTypeId(t.accidentTypeId),t.patientId&&this.store.setPatientId(t.patientId),t.medLevelId&&this.store.setMedLevelId(t.medLevelId),t.firmId&&this.store.setFirmId(t.firmId),t.attorneyId&&this.store.setAttorneyId(t.attorneyId),t.caseStatusId&&this.store.setCaseStatusId(t.caseStatusId),t.caseTypeId&&this.store.setCaseTypeId(t.caseTypeId),t.patientTreatmentStatusId&&this.store.setPatientTreatmentStatusId(t.patientTreatmentStatusId),t.caseProgressStatusId&&this.store.setCaseProgressStatusId(t.caseProgressStatusId),t.adverseInsuranceStatusId&&this.store.setAdverseInsuranceStatusId(t.adverseInsuranceStatusId),this.store.loadLegalCasesEffect()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Uo.d),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e._Bn([Uo.d]),e.qOj],decls:7,vars:7,consts:[[3,"to","control","listTemplate","editTemplate","createTemplate","key","routerKeys","selectionChanged","formRouterKeyDidChange"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","legalCase","send","close"],[1,"w-full","h-full","bg-white",3,"legalCases","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value})("formRouterKeyDidChange",function(l){return i.formRouterKeyDidChange(l)}),e.qZA(),e.YNc(1,P3,2,3,"ng-template",null,1,e.W1O),e.YNc(3,D3,1,4,"ng-template",null,2,e.W1O),e.YNc(5,M3,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)("routerKeys",i.routerKeys)}},dependencies:[W.JJ,W.oH,Z.$,id,sd],encapsulation:2}),s})();function E3(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-legal-case-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","legalCase_edit")("legalCase",t.value)}}const O3=function(){return{}};function L3(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-legal-case-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","legalCase_create")("legalCase",e.DdM(2,O3))}function $3(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-legal-case-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("legalCases",t.items)}}let G3=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","legalCase","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","legalCases","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,E3,1,2,"ng-template",null,1,e.W1O),e.YNc(3,L3,1,3,"ng-template",null,2,e.W1O),e.YNc(5,$3,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,id,sd],encapsulation:2}),s})(),R3=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"legal-case-select",component:W3,wrappers:["form-field"]},{name:"legal-case-grid",component:G3}]})]}),s})(),Q3=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[R3]}),s})();var Jo=Q(3866);function V3(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.location)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let od=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"location_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.location=i.item})):t.formName&&t.formName.currentValue&&"location_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadLocationEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.location=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Jo.v),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-location-form"]],inputs:{location:"location",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,V3,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),ad=(()=>{class s{constructor(){this.autoHeight=!1,this.locations=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[{field:"placeOfService.name",headerName:"Place of Service",filter:"agTextColumnFilter"},{field:"vendorLocation.name",headerName:"Vendor Location",filter:"agTextColumnFilter"},{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{field:"locationName",filter:"agTextColumnFilter"},{field:"line1",filter:"agTextColumnFilter"},{field:"line2",filter:"agTextColumnFilter"},{field:"city",filter:"agTextColumnFilter"},{field:"state",filter:"agTextColumnFilter"},{field:"postalCode",filter:"agTextColumnFilter"},{headerName:"Latitude",field:"latitude",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.latitude,"",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{headerName:"Longitude",field:"longitude",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.longitude,"",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{field:"abbrev",filter:"agTextColumnFilter"},{field:"division",filter:"agTextColumnFilter"},{field:"country",filter:"agTextColumnFilter"},{field:"officePhone",filter:"agTextColumnFilter"},{field:"fax",filter:"agTextColumnFilter"},{field:"attentionTo",filter:"agTextColumnFilter"},{field:"placeOfServiceId",filter:"agTextColumnFilter",hide:!0}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-location-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",locations:"locations"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.locations)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function j3(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-location-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","location_edit")("formControl",t.formControl)("location",t.location)}}const U3=function(){return{}};function J3(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-location-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","location_create")("formControl",t.formControl)("location",e.DdM(3,U3))}}function z3(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-location-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("locations",o.data.items)}let H3=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.routerKeys=["placeOfServiceId","vendorLocationId","vendorId","clinicalProviderId"],this.store.loadLocationsEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.locations$.pipe((0,h.w)(i=>(0,F.of)(i)))}formRouterKeyDidChange(t){t.placeOfServiceId&&this.store.setPlaceOfServiceId(t.placeOfServiceId),t.vendorLocationId&&this.store.setVendorLocationId(t.vendorLocationId),t.vendorId&&this.store.setVendorId(t.vendorId),t.clinicalProviderId&&this.store.setClinicalProviderId(t.clinicalProviderId),this.store.loadLocationsEffect()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Jo.v))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e._Bn([Jo.v]),e.qOj],decls:7,vars:8,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","routerKeys","selectionChanged","formRouterKeyDidChange"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","location","send","close"],[1,"w-full","h-full","bg-white",3,"locations","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value})("formRouterKeyDidChange",function(l){return i.formRouterKeyDidChange(l)}),e.qZA(),e.YNc(1,j3,2,3,"ng-template",null,1,e.W1O),e.YNc(3,J3,1,4,"ng-template",null,2,e.W1O),e.YNc(5,z3,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)("routerKeys",i.routerKeys)}},dependencies:[W.JJ,W.oH,Z.$,od,ad],encapsulation:2}),s})();function q3(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-location-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","location_edit")("location",t.value)}}const K3=function(){return{}};function Z3(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-location-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","location_create")("location",e.DdM(2,K3))}function k3(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-location-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("locations",t.items)}}let B3=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","location","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","locations","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,q3,1,2,"ng-template",null,1,e.W1O),e.YNc(3,Z3,1,3,"ng-template",null,2,e.W1O),e.YNc(5,k3,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,od,ad],encapsulation:2}),s})(),Y3=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"location-select",component:H3,wrappers:["form-field"]},{name:"location-grid",component:B3}]})]}),s})(),X3=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[Y3]}),s})();class bi extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class eR extends bi{constructor(o){super("ValidateManufacturerExcelDataAction"),this.valid=!1,this.excelData=o}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name)}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class tR extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class iR extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new tR("name","The manufacturer name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class sR extends bi{constructor(o){super("CreateManufacturerAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new iR("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateManufacturer({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class oR extends bi{constructor(o){super("UpdateManufacturersAction"),this.manufacturers=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.manufacturers,!0))}performAction(){this.response=this.businessProvider.data.userUpdateManufacturers({input:{manufacturers:this.manufacturers}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class aR extends bi{constructor(o,t){super("UpdateManufacturerAction"),this.manufacturer=o,this.manufacturerId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.manufacturer,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.manufacturerId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateManufacturer({manufacturerId:this.manufacturerId,input:this.manufacturer}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let rd=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.ManufacturerBusinessProviderService",t,a),this.data=i}createManufacturer(t){const i=new sR(t);return i.Do(this),i.response}updateManufacturer(t,i){const a=new aR(t,i);return a.Do(this),a.response}importManufacturers(t){const i=new oR(t);return i.Do(this),i.response}validateManufacturerExcelData(t){const i=new eR(t);return i.Do(this),i.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),rR=(()=>{class s extends I.nH{constructor(t,i,a){super("ManufacturerService",a,t),this.businessProvider=i}createManufacturer(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createManufacturer(i)}updateManufacturer(t,i){return this.businessProvider.updateManufacturer(t,i)}importManufacturers(t){return this.businessProvider.importManufacturers(t)}validateManufacturerExcelData(t){return this.businessProvider.validateManufacturerExcelData(t)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(rd,8),e.LFG(rd),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),zo=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){super({loading:!1,manufacturers:[],done:!1,searchQuery:"",formName:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.manufacturerService=H,this.errors$=this.select(c=>c.errors),this.loading$=this.select(c=>c.loading),this.done$=this.select(c=>c.done),this.item$=this.select(c=>c.item),this.manufacturers$=this.select(c=>c.manufacturers),this.paging$=this.select(c=>c.paging),this.searchQuery$=this.select(c=>c.searchQuery),this.formName$=this.select(c=>c.formName),this.actionResult$=this.select(this.item$,this.done$,(c,d)=>({item:c,done:d}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.manufacturers$,(c,d,n,r,m)=>({errors:c,loading:d,item:n,formName:r,manufacturers:m}),{debounce:!0}),this.input$=this.select(this.paging$,this.searchQuery$,(c,d)=>({limit:c.limit,skip:c.skip,name:d,total:c.total})),this.setFormName=this.updater((c,d)=>Object.assign(Object.assign({},c),{formName:d})),this.setItem=this.updater((c,d)=>Object.assign(Object.assign({},c),{item:d})),this.addNewManufacturer=this.updater((c,d)=>Object.assign(Object.assign({},c),{manufacturers:[...c.manufacturers,d]})),this.updateManufacturer=this.updater((c,d)=>Object.assign(Object.assign({},c),{manufacturers:c.manufacturers.map(n=>n.id===d.id?d:n)})),this.addManufacturers=this.updater((c,d)=>Object.assign(Object.assign({},c),{manufacturers:c.manufacturers.concat(d)})),this.updateManufacturers=this.updater((c,d)=>Object.assign(Object.assign({},c),{manufacturers:c.manufacturers.map(n=>d.find(m=>m.id===n.id)||n)})),this.setSearchQuery=this.updater((c,d)=>Object.assign(Object.assign({},c),{searchQuery:d})),this.loadManufacturerEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.data.userManufacturer({manufacturerId:d}).pipe((0,g._b)(n=>{this.patchState({item:n.data.item,errors:n.errors,loading:!1})},n=>this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})))))),this.loadManufacturersEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([d,n])=>this.data.userManufacturers({input:n}).pipe((0,g._b)(r=>this.patchState({paging:{limit:n.limit,skip:n.skip,total:r.data.count.total},manufacturers:r.data.items,errors:r.errors,loading:!1}),r=>this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})))))),this.createManufacturerEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.manufacturerService.createManufacturer(Object.assign({},d)).pipe((0,g._b)(n=>{this.addNewManufacturer(n),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:n,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},n=>{n.graphQLErrors?(this.toast.error(n.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})):(this.toast.error(n.Message),this.formService.setErrors(n.Data))}))))),this.updateManufacturerEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.manufacturerService.updateManufacturer(d,d.id).pipe((0,g._b)(r=>{this.updateManufacturer(r),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:r,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.deleteManufacturerEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.data.userDeleteManufacturer({manufacturerId:n.id}).pipe((0,g._b)(r=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:r.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.importExcelEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.manufacturerService.importManufacturers(d).pipe((0,ce.K)(n=>{var r;return this.toast.error(null!==(r=n.Message)&&void 0!==r?r:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(n=>{const r=JSON.parse(n.created),m=JSON.parse(n.updated),p=JSON.parse(n.failed),_=r.length+m.length+p.length;this.addManufacturers(r),this.updateManufacturers(m),this.toast.success(`${r.length} created, ${m.length} updated, ${p.length} failed of total ${_}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("manufacturerId")?(this.route.snapshot.paramMap.get("manufacturerId"),this.setFormName("manufacturer_edit")):this.setFormName("manufacturer_create")}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.manufacturerService.validateManufacturerExcelData(t)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(rR))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function nR(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.manufacturer)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let nd=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"manufacturer_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.manufacturer=i.item})):t.formName&&t.formName.currentValue&&"manufacturer_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadManufacturerEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.manufacturer=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(zo),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-manufacturer-form"]],inputs:{manufacturer:"manufacturer",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,nR,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),ld=(()=>{class s{constructor(){this.autoHeight=!1,this.manufacturers=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[,{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{field:"primaryPhoneNumber",filter:"agTextColumnFilter"},{field:"primaryEmailAddress",filter:"agTextColumnFilter"},{field:"primaryAddressLine1",filter:"agTextColumnFilter"},{field:"primaryAddressLine2",filter:"agTextColumnFilter"},{field:"primaryAddressCity",filter:"agTextColumnFilter"},{field:"primaryAddressStateOrProvince",filter:"agTextColumnFilter"},{field:"primaryAddressPostalCode",filter:"agTextColumnFilter"},{field:"notes",filter:"agTextColumnFilter"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-manufacturer-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",manufacturers:"manufacturers"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.manufacturers)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function lR(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-manufacturer-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","manufacturer_edit")("formControl",t.formControl)("manufacturer",t.manufacturer)}}const cR=function(){return{}};function dR(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-manufacturer-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","manufacturer_create")("formControl",t.formControl)("manufacturer",e.DdM(3,cR))}}function uR(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-manufacturer-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("manufacturers",o.data.items)}let mR=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadManufacturersEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.manufacturers$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(zo))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","manufacturer","send","close"],[1,"w-full","h-full","bg-white",3,"manufacturers","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,lR,2,3,"ng-template",null,1,e.W1O),e.YNc(3,dR,1,4,"ng-template",null,2,e.W1O),e.YNc(5,uR,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,nd,ld],encapsulation:2}),s})();function pR(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-manufacturer-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","manufacturer_edit")("manufacturer",t.value)}}const hR=function(){return{}};function fR(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-manufacturer-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","manufacturer_create")("manufacturer",e.DdM(2,hR))}function _R(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-manufacturer-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("manufacturers",t.items)}}let gR=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","manufacturer","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","manufacturers","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,pR,1,2,"ng-template",null,1,e.W1O),e.YNc(3,fR,1,3,"ng-template",null,2,e.W1O),e.YNc(5,_R,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,nd,ld],encapsulation:2}),s})(),CR=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[zo],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"manufacturer-select",component:mR,wrappers:["form-field"]},{name:"manufacturer-grid",component:gR}]})]}),s})(),vR=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[CR]}),s})();class Ti extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class SR extends Ti{constructor(o,t){super("ValidateMedicalConditionProviderExcelDataAction"),this.valid=!1,this.excelData=o,this.clinicalProviders=t}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name),this.validationContext.addRule(new f.mi(`clinicalProviderName_${i}_is_valid}`,"Clinical Provider Is Not Valid","clinicalProvider.name",t.clinicalProvider,this.clinicalProviders,!0))}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class bR extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class TR extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new bR("name","The medicalconditionprovider name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class yR extends Ti{constructor(o){super("CreateMedicalConditionProviderAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new TR("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateMedicalConditionProvider({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class wR extends Ti{constructor(o){super("UpdateMedicalConditionProvidersAction"),this.medicalConditionProviders=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.medicalConditionProviders,!0))}performAction(){this.response=this.businessProvider.data.userUpdateMedicalConditionProviders({input:{medicalConditionProviders:this.medicalConditionProviders}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class xR extends Ti{constructor(o,t){super("UpdateMedicalConditionProviderAction"),this.medicalConditionProvider=o,this.medicalConditionProviderId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.medicalConditionProvider,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.medicalConditionProviderId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateMedicalConditionProvider({medicalConditionProviderId:this.medicalConditionProviderId,input:this.medicalConditionProvider}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let cd=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.MedicalConditionProviderBusinessProviderService",t,a),this.data=i}createMedicalConditionProvider(t){const i=new yR(t);return i.Do(this),i.response}updateMedicalConditionProvider(t,i){const a=new xR(t,i);return a.Do(this),a.response}importMedicalConditionProviders(t){const i=new wR(t);return i.Do(this),i.response}validateMedicalConditionProviderExcelData(t,i){const a=new SR(t,i);return a.Do(this),a.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),NR=(()=>{class s extends I.nH{constructor(t,i,a){super("MedicalConditionProviderService",a,t),this.businessProvider=i}createMedicalConditionProvider(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createMedicalConditionProvider(i)}updateMedicalConditionProvider(t,i){return this.businessProvider.updateMedicalConditionProvider(t,i)}importMedicalConditionProviders(t){return this.businessProvider.importMedicalConditionProviders(t)}validateMedicalConditionProviderExcelData(t,i){return this.businessProvider.validateMedicalConditionProviderExcelData(t,i)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(cd,8),e.LFG(cd),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),Ho=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){if(super({loading:!1,medicalConditionProviders:[],done:!1,searchQuery:"",formName:void 0,clinicalProviderId:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.medicalConditionProviderService=H,this.errors$=this.select(d=>d.errors),this.loading$=this.select(d=>d.loading),this.done$=this.select(d=>d.done),this.item$=this.select(d=>d.item),this.medicalConditionProviders$=this.select(d=>d.medicalConditionProviders),this.clinicalProviders$=this.select(d=>d.clinicalProviders||[]),this.clinicalProviderId$=this.select(d=>d.clinicalProviderId),this.paging$=this.select(d=>d.paging),this.searchQuery$=this.select(d=>d.searchQuery),this.formName$=this.select(d=>d.formName),this.actionResult$=this.select(this.item$,this.done$,(d,n)=>({item:d,done:n}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.medicalConditionProviders$,this.clinicalProviders$,(d,n,r,m,p,_)=>({errors:d,loading:n,item:r,formName:m,medicalConditionProviders:p,clinicalProviders:_}),{debounce:!0}),this.input$=this.select(this.paging$,this.clinicalProviderId$,this.searchQuery$,(d,n,r)=>({limit:d.limit,skip:d.skip,name:r,clinicalProviderId:n,total:d.total})),this.setFormName=this.updater((d,n)=>Object.assign(Object.assign({},d),{formName:n})),this.setClinicalProviderId=this.updater((d,n)=>Object.assign(Object.assign({},d),{clinicalProviderId:n})),this.filterClinicalProviders=d=>this.data.userSelectClinicalProviders({input:{name:d}}).pipe((0,g._b)(n=>{let r=n.data.items;return this.patchState({clinicalProviders:r}),r},n=>this.patchState({errors:n.graphQLErrors?n.graphQLErrors:n})),(0,he.U)(n=>n.data.items)),this.addClinicalProvider=this.updater((d,n)=>Object.assign(Object.assign({},d),{clinicalProviders:d.clinicalProviders.concat(n)})),this.setItem=this.updater((d,n)=>Object.assign(Object.assign({},d),{item:n})),this.addNewMedicalConditionProvider=this.updater((d,n)=>Object.assign(Object.assign({},d),{medicalConditionProviders:[...d.medicalConditionProviders,n]})),this.updateMedicalConditionProvider=this.updater((d,n)=>Object.assign(Object.assign({},d),{medicalConditionProviders:d.medicalConditionProviders.map(r=>r.id===n.id?n:r)})),this.addMedicalConditionProviders=this.updater((d,n)=>Object.assign(Object.assign({},d),{medicalConditionProviders:d.medicalConditionProviders.concat(n)})),this.updateMedicalConditionProviders=this.updater((d,n)=>Object.assign(Object.assign({},d),{medicalConditionProviders:d.medicalConditionProviders.map(r=>n.find(p=>p.id===r.id)||r)})),this.setSearchQuery=this.updater((d,n)=>Object.assign(Object.assign({},d),{searchQuery:n})),this.loadMedicalConditionProviderEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(n=>this.data.userMedicalConditionProvider({medicalConditionProviderId:n}).pipe((0,g._b)(r=>{this.patchState({item:r.data.item,errors:r.errors,loading:!1})},r=>this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})))))),this.loadMedicalConditionProvidersEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([n,r])=>this.data.userMedicalConditionProviders({input:r}).pipe((0,g._b)(m=>this.patchState({paging:{limit:r.limit,skip:r.skip,total:m.data.count.total},medicalConditionProviders:m.data.items,errors:m.errors,loading:!1}),m=>this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})))))),this.createMedicalConditionProviderEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(n=>this.medicalConditionProviderService.createMedicalConditionProvider(Object.assign({},n)).pipe((0,g._b)(r=>{this.addNewMedicalConditionProvider(r),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:r,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.updateMedicalConditionProviderEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([n,r])=>this.medicalConditionProviderService.updateMedicalConditionProvider(n,n.id).pipe((0,g._b)(m=>{this.updateMedicalConditionProvider(m),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:m,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},m=>{m.graphQLErrors?(this.toast.error(m.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})):(this.toast.error(m.Message),this.formService.setErrors(m.Data))}))))),this.deleteMedicalConditionProviderEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([n,r])=>this.data.userDeleteMedicalConditionProvider({medicalConditionProviderId:r.id}).pipe((0,g._b)(m=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:m.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},m=>{m.graphQLErrors?(this.toast.error(m.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})):(this.toast.error(m.Message),this.formService.setErrors(m.Data))}))))),this.importExcelEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(n=>this.medicalConditionProviderService.importMedicalConditionProviders(n).pipe((0,ce.K)(r=>{var m;return this.toast.error(null!==(m=r.Message)&&void 0!==m?m:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(r=>{const m=JSON.parse(r.created),p=JSON.parse(r.updated),_=JSON.parse(r.failed),w=m.length+p.length+_.length;this.addMedicalConditionProviders(m),this.updateMedicalConditionProviders(p),this.toast.success(`${m.length} created, ${p.length} updated, ${_.length} failed of total ${w}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("medicalConditionProviderId")?(this.route.snapshot.paramMap.get("medicalConditionProviderId"),this.setFormName("medicalConditionProvider_edit")):this.setFormName("medicalConditionProvider_create"),this.route.snapshot.paramMap.has("clinicalProviderId")){var c=this.route.snapshot.paramMap.get("clinicalProviderId");this.setClinicalProviderId(c)}}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.medicalConditionProviderService.validateMedicalConditionProviderExcelData(t,i.clinicalProviders)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(NR))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function AR(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.medicalConditionProvider)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let dd=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"medicalConditionProvider_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.medicalConditionProvider=i.item})):t.formName&&t.formName.currentValue&&"medicalConditionProvider_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadMedicalConditionProviderEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.medicalConditionProvider=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Ho),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-medical-condition-provider-form"]],inputs:{medicalConditionProvider:"medicalConditionProvider",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,AR,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),ud=(()=>{class s{constructor(){this.autoHeight=!1,this.medicalConditionProviders=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[{field:"clinicalProvider.name",headerName:"Clinical Provider",filter:"agTextColumnFilter"},{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{field:"medicalConditionId",filter:"agTextColumnFilter",hide:!0},{field:"clinicalProviderId",filter:"agTextColumnFilter",hide:!0}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-medical-condition-provider-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",medicalConditionProviders:"medicalConditionProviders"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.medicalConditionProviders)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function FR(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-medical-condition-provider-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","medicalConditionProvider_edit")("formControl",t.formControl)("medicalConditionProvider",t.medicalConditionProvider)}}const PR=function(){return{}};function IR(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-medical-condition-provider-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","medicalConditionProvider_create")("formControl",t.formControl)("medicalConditionProvider",e.DdM(3,PR))}}function DR(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-medical-condition-provider-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("medicalConditionProviders",o.data.items)}let MR=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadMedicalConditionProvidersEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.medicalConditionProviders$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Ho))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","medicalConditionProvider","send","close"],[1,"w-full","h-full","bg-white",3,"medicalConditionProviders","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,FR,2,3,"ng-template",null,1,e.W1O),e.YNc(3,IR,1,4,"ng-template",null,2,e.W1O),e.YNc(5,DR,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,dd,ud],encapsulation:2}),s})();function WR(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-medical-condition-provider-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","medicalConditionProvider_edit")("medicalConditionProvider",t.value)}}const ER=function(){return{}};function OR(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-medical-condition-provider-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","medicalConditionProvider_create")("medicalConditionProvider",e.DdM(2,ER))}function LR(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-medical-condition-provider-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("medicalConditionProviders",t.items)}}let $R=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","medicalConditionProvider","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","medicalConditionProviders","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,WR,1,2,"ng-template",null,1,e.W1O),e.YNc(3,OR,1,3,"ng-template",null,2,e.W1O),e.YNc(5,LR,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,dd,ud],encapsulation:2}),s})(),GR=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[Ho],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"medical-condition-provider-select",component:MR,wrappers:["form-field"]},{name:"medical-condition-provider-grid",component:$R}]})]}),s})(),RR=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[GR]}),s})();class yi extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class QR extends yi{constructor(o,t){super("ValidateMedicalRecordExcelDataAction"),this.valid=!1,this.excelData=o,this.clinicalProviders=t}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name),this.validationContext.addRule(new f.mi(`clinicalProviderName_${i}_is_valid}`,"Clinical Provider Is Not Valid","clinicalProvider.name",t.clinicalProvider,this.clinicalProviders,!0))}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class VR extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class jR extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new VR("name","The medicalrecord name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class UR extends yi{constructor(o){super("CreateMedicalRecordAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new jR("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateMedicalRecord({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class JR extends yi{constructor(o){super("UpdateMedicalRecordsAction"),this.medicalRecords=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.medicalRecords,!0))}performAction(){this.response=this.businessProvider.data.userUpdateMedicalRecords({input:{medicalRecords:this.medicalRecords}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class zR extends yi{constructor(o,t){super("UpdateMedicalRecordAction"),this.medicalRecord=o,this.medicalRecordId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.medicalRecord,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.medicalRecordId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateMedicalRecord({medicalRecordId:this.medicalRecordId,input:this.medicalRecord}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let md=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.MedicalRecordBusinessProviderService",t,a),this.data=i}createMedicalRecord(t){const i=new UR(t);return i.Do(this),i.response}updateMedicalRecord(t,i){const a=new zR(t,i);return a.Do(this),a.response}importMedicalRecords(t){const i=new JR(t);return i.Do(this),i.response}validateMedicalRecordExcelData(t,i){const a=new QR(t,i);return a.Do(this),a.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),HR=(()=>{class s extends I.nH{constructor(t,i,a){super("MedicalRecordService",a,t),this.businessProvider=i}createMedicalRecord(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createMedicalRecord(i)}updateMedicalRecord(t,i){return this.businessProvider.updateMedicalRecord(t,i)}importMedicalRecords(t){return this.businessProvider.importMedicalRecords(t)}validateMedicalRecordExcelData(t,i){return this.businessProvider.validateMedicalRecordExcelData(t,i)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(md,8),e.LFG(md),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),qo=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){if(super({loading:!1,medicalRecords:[],done:!1,searchQuery:"",formName:void 0,clinicalProviderId:void 0,dateFilter:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.medicalRecordService=H,this.errors$=this.select(d=>d.errors),this.loading$=this.select(d=>d.loading),this.done$=this.select(d=>d.done),this.item$=this.select(d=>d.item),this.medicalRecords$=this.select(d=>d.medicalRecords),this.clinicalProviders$=this.select(d=>d.clinicalProviders||[]),this.dateFilter$=this.select(d=>d.dateFilter),this.clinicalProviderId$=this.select(d=>d.clinicalProviderId),this.paging$=this.select(d=>d.paging),this.searchQuery$=this.select(d=>d.searchQuery),this.formName$=this.select(d=>d.formName),this.actionResult$=this.select(this.item$,this.done$,(d,n)=>({item:d,done:n}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.medicalRecords$,this.clinicalProviders$,(d,n,r,m,p,_)=>({errors:d,loading:n,item:r,formName:m,medicalRecords:p,clinicalProviders:_}),{debounce:!0}),this.input$=this.select(this.paging$,this.clinicalProviderId$,this.searchQuery$,this.dateFilter$,(d,n,r,m)=>({limit:d.limit,skip:d.skip,name:r,clinicalProviderId:n,dateFilter:m,total:d.total})),this.setFormName=this.updater((d,n)=>Object.assign(Object.assign({},d),{formName:n})),this.setDateFilter=this.updater((d,n)=>Object.assign(Object.assign({},d),{dateFilter:n})),this.setClinicalProviderId=this.updater((d,n)=>Object.assign(Object.assign({},d),{clinicalProviderId:n})),this.setSkip=this.updater((d,n)=>Object.assign(Object.assign({},d),{paging:Object.assign(Object.assign({},d.paging),{skip:n})})),this.setLimit=this.updater((d,n)=>Object.assign(Object.assign({},d),{paging:Object.assign(Object.assign({},d.paging),{limit:n})})),this.filterClinicalProviders=d=>this.data.userSelectClinicalProviders({input:{name:d}}).pipe((0,g._b)(n=>{let r=n.data.items;return this.patchState({clinicalProviders:r}),r},n=>this.patchState({errors:n.graphQLErrors?n.graphQLErrors:n})),(0,he.U)(n=>n.data.items)),this.addClinicalProvider=this.updater((d,n)=>Object.assign(Object.assign({},d),{clinicalProviders:d.clinicalProviders.concat(n)})),this.setItem=this.updater((d,n)=>Object.assign(Object.assign({},d),{item:n})),this.addNewMedicalRecord=this.updater((d,n)=>Object.assign(Object.assign({},d),{medicalRecords:[...d.medicalRecords,n]})),this.updateMedicalRecord=this.updater((d,n)=>Object.assign(Object.assign({},d),{medicalRecords:d.medicalRecords.map(r=>r.id===n.id?n:r)})),this.addMedicalRecords=this.updater((d,n)=>Object.assign(Object.assign({},d),{medicalRecords:d.medicalRecords.concat(n)})),this.updateMedicalRecords=this.updater((d,n)=>Object.assign(Object.assign({},d),{medicalRecords:d.medicalRecords.map(r=>n.find(p=>p.id===r.id)||r)})),this.setSearchQuery=this.updater((d,n)=>Object.assign(Object.assign({},d),{searchQuery:n})),this.loadMedicalRecordEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(n=>this.data.userMedicalRecord({medicalRecordId:n}).pipe((0,g._b)(r=>{this.patchState({item:r.data.item,errors:r.errors,loading:!1})},r=>this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})))))),this.loadMedicalRecordsEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([n,r])=>this.data.userMedicalRecords({input:r}).pipe((0,g._b)(m=>this.patchState({paging:{limit:r.limit,skip:r.skip,total:m.data.count.total},medicalRecords:m.data.items,errors:m.errors,loading:!1}),m=>this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})))))),this.createMedicalRecordEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(n=>this.medicalRecordService.createMedicalRecord(Object.assign({},n)).pipe((0,g._b)(r=>{this.addNewMedicalRecord(r),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:r,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.updateMedicalRecordEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([n,r])=>this.medicalRecordService.updateMedicalRecord(n,n.id).pipe((0,g._b)(m=>{this.updateMedicalRecord(m),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:m,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},m=>{m.graphQLErrors?(this.toast.error(m.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})):(this.toast.error(m.Message),this.formService.setErrors(m.Data))}))))),this.deleteMedicalRecordEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([n,r])=>this.data.userDeleteMedicalRecord({medicalRecordId:r.id}).pipe((0,g._b)(m=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:m.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},m=>{m.graphQLErrors?(this.toast.error(m.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})):(this.toast.error(m.Message),this.formService.setErrors(m.Data))}))))),this.importExcelEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(n=>this.medicalRecordService.importMedicalRecords(n).pipe((0,ce.K)(r=>{var m;return this.toast.error(null!==(m=r.Message)&&void 0!==m?m:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(r=>{const m=JSON.parse(r.created),p=JSON.parse(r.updated),_=JSON.parse(r.failed),w=m.length+p.length+_.length;this.addMedicalRecords(m),this.updateMedicalRecords(p),this.toast.success(`${m.length} created, ${p.length} updated, ${_.length} failed of total ${w}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("medicalRecordId")?(this.route.snapshot.paramMap.get("medicalRecordId"),this.setFormName("medicalRecord_edit")):this.setFormName("medicalRecord_create"),this.route.snapshot.paramMap.has("clinicalProviderId")){var c=this.route.snapshot.paramMap.get("clinicalProviderId");this.setClinicalProviderId(c)}}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.medicalRecordService.validateMedicalRecordExcelData(t,i.clinicalProviders)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(HR))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function qR(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.medicalRecord)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let pd=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"medicalRecord_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.medicalRecord=i.item})):t.formName&&t.formName.currentValue&&"medicalRecord_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadMedicalRecordEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.medicalRecord=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(qo),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-medical-record-form"]],inputs:{medicalRecord:"medicalRecord",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,qR,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),hd=(()=>{class s{constructor(){this.autoHeight=!1,this.medicalRecords=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[{field:"clinicalProvider.name",headerName:"Clinical Provider",filter:"agTextColumnFilter"},{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{field:"clinicalProviderId",filter:"agTextColumnFilter",hide:!0}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-medical-record-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",medicalRecords:"medicalRecords"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.medicalRecords)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function KR(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-medical-record-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","medicalRecord_edit")("formControl",t.formControl)("medicalRecord",t.medicalRecord)}}const ZR=function(){return{}};function kR(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-medical-record-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","medicalRecord_create")("formControl",t.formControl)("medicalRecord",e.DdM(3,ZR))}}function BR(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-medical-record-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("medicalRecords",o.data.items)}let YR=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadMedicalRecordsEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.medicalRecords$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(qo))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","medicalRecord","send","close"],[1,"w-full","h-full","bg-white",3,"medicalRecords","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,KR,2,3,"ng-template",null,1,e.W1O),e.YNc(3,kR,1,4,"ng-template",null,2,e.W1O),e.YNc(5,BR,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,pd,hd],encapsulation:2}),s})();function XR(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-medical-record-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","medicalRecord_edit")("medicalRecord",t.value)}}const e2=function(){return{}};function t2(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-medical-record-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","medicalRecord_create")("medicalRecord",e.DdM(2,e2))}function i2(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-medical-record-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("medicalRecords",t.items)}}let s2=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","medicalRecord","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","medicalRecords","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,XR,1,2,"ng-template",null,1,e.W1O),e.YNc(3,t2,1,3,"ng-template",null,2,e.W1O),e.YNc(5,i2,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,pd,hd],encapsulation:2}),s})(),o2=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[qo],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"medical-record-select",component:YR,wrappers:["form-field"]},{name:"medical-record-grid",component:s2}]})]}),s})(),a2=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[o2]}),s})();class wi extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class r2 extends wi{constructor(o){super("ValidateMedicalRecordStatusExcelDataAction"),this.valid=!1,this.excelData=o}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name)}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class n2 extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class l2 extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new n2("name","The medicalrecordstatus name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class c2 extends wi{constructor(o){super("CreateMedicalRecordStatusAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new l2("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateMedicalRecordStatus({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class d2 extends wi{constructor(o){super("UpdateMedicalRecordStatusesAction"),this.medicalRecordStatuses=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.medicalRecordStatuses,!0))}performAction(){this.response=this.businessProvider.data.userUpdateMedicalRecordStatuses({input:{medicalRecordStatuses:this.medicalRecordStatuses}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class u2 extends wi{constructor(o,t){super("UpdateMedicalRecordStatusAction"),this.medicalRecordStatus=o,this.medicalRecordStatusId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.medicalRecordStatus,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.medicalRecordStatusId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateMedicalRecordStatus({medicalRecordStatusId:this.medicalRecordStatusId,input:this.medicalRecordStatus}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let fd=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.MedicalRecordStatusBusinessProviderService",t,a),this.data=i}createMedicalRecordStatus(t){const i=new c2(t);return i.Do(this),i.response}updateMedicalRecordStatus(t,i){const a=new u2(t,i);return a.Do(this),a.response}importMedicalRecordStatuses(t){const i=new d2(t);return i.Do(this),i.response}validateMedicalRecordStatusExcelData(t){const i=new r2(t);return i.Do(this),i.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),m2=(()=>{class s extends I.nH{constructor(t,i,a){super("MedicalRecordStatusService",a,t),this.businessProvider=i}createMedicalRecordStatus(t){return this.businessProvider.createMedicalRecordStatus(t)}updateMedicalRecordStatus(t,i){return this.businessProvider.updateMedicalRecordStatus(t,i)}importMedicalRecordStatuses(t){return this.businessProvider.importMedicalRecordStatuses(t)}validateMedicalRecordStatusExcelData(t){return this.businessProvider.validateMedicalRecordStatusExcelData(t)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(fd,8),e.LFG(fd),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),xi=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){super({loading:!1,medicalRecordStatuses:[],done:!1,searchQuery:"",formName:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.medicalRecordStatusService=H,this.errors$=this.select(c=>c.errors),this.loading$=this.select(c=>c.loading),this.done$=this.select(c=>c.done),this.item$=this.select(c=>c.item),this.medicalRecordStatuses$=this.select(c=>c.medicalRecordStatuses),this.paging$=this.select(c=>c.paging),this.searchQuery$=this.select(c=>c.searchQuery),this.formName$=this.select(c=>c.formName),this.actionResult$=this.select(this.item$,this.done$,(c,d)=>({item:c,done:d}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.medicalRecordStatuses$,(c,d,n,r,m)=>({errors:c,loading:d,item:n,formName:r,medicalRecordStatuses:m}),{debounce:!0}),this.input$=this.select(this.paging$,this.searchQuery$,(c,d)=>({limit:c.limit,skip:c.skip,name:d,total:c.total})),this.setFormName=this.updater((c,d)=>Object.assign(Object.assign({},c),{formName:d})),this.setItem=this.updater((c,d)=>Object.assign(Object.assign({},c),{item:d})),this.addNewMedicalRecordStatus=this.updater((c,d)=>Object.assign(Object.assign({},c),{medicalRecordStatuses:[...c.medicalRecordStatuses,d]})),this.updateMedicalRecordStatus=this.updater((c,d)=>Object.assign(Object.assign({},c),{medicalRecordStatuses:c.medicalRecordStatuses.map(n=>n.id===d.id?d:n)})),this.addMedicalRecordStatuses=this.updater((c,d)=>Object.assign(Object.assign({},c),{medicalRecordStatuses:c.medicalRecordStatuses.concat(d)})),this.updateMedicalRecordStatuses=this.updater((c,d)=>Object.assign(Object.assign({},c),{medicalRecordStatuses:c.medicalRecordStatuses.map(n=>d.find(m=>m.id===n.id)||n)})),this.setSearchQuery=this.updater((c,d)=>Object.assign(Object.assign({},c),{searchQuery:d})),this.loadMedicalRecordStatusEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.data.userMedicalRecordStatus({medicalRecordStatusId:d}).pipe((0,g._b)(n=>{this.patchState({item:n.data.item,errors:n.errors,loading:!1})},n=>this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})))))),this.loadMedicalRecordStatusesEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([d,n])=>this.data.userMedicalRecordStatuses({input:n}).pipe((0,g._b)(r=>this.patchState({paging:{limit:n.limit,skip:n.skip,total:r.data.count.total},medicalRecordStatuses:r.data.items,errors:r.errors,loading:!1}),r=>this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})))))),this.createMedicalRecordStatusEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.medicalRecordStatusService.createMedicalRecordStatus(Object.assign({},d)).pipe((0,g._b)(n=>{this.addNewMedicalRecordStatus(n),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:n,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},n=>{n.graphQLErrors?(this.toast.error(n.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})):(this.toast.error(n.Message),this.formService.setErrors(n.Data))}))))),this.updateMedicalRecordStatusEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.medicalRecordStatusService.updateMedicalRecordStatus(d,d.id).pipe((0,g._b)(r=>{this.updateMedicalRecordStatus(r),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:r,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.deleteMedicalRecordStatusEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.data.userDeleteMedicalRecordStatus({medicalRecordStatusId:n.id}).pipe((0,g._b)(r=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:r.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.importExcelEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.medicalRecordStatusService.importMedicalRecordStatuses(d).pipe((0,ce.K)(n=>{var r;return this.toast.error(null!==(r=n.Message)&&void 0!==r?r:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(n=>{const r=JSON.parse(n.created),m=JSON.parse(n.updated),p=JSON.parse(n.failed),_=r.length+m.length+p.length;this.addMedicalRecordStatuses(r),this.updateMedicalRecordStatuses(m),this.toast.success(`${r.length} created, ${m.length} updated, ${p.length} failed of total ${_}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("medicalRecordStatusId")?(this.route.snapshot.paramMap.get("medicalRecordStatusId"),this.setFormName("medicalRecordStatus_edit")):this.setFormName("medicalRecordStatus_create")}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.medicalRecordStatusService.validateMedicalRecordStatusExcelData(t)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(m2))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function p2(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.medicalRecordStatus)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let _d=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"medicalRecordStatus_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.medicalRecordStatus=i.item})):t.formName&&t.formName.currentValue&&"medicalRecordStatus_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadMedicalRecordStatusEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.medicalRecordStatus=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(xi),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-medical-record-status-form"]],inputs:{medicalRecordStatus:"medicalRecordStatus",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,p2,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),gd=(()=>{class s{constructor(){this.autoHeight=!1,this.medicalRecordStatuses=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[,{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-medical-record-status-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",medicalRecordStatuses:"medicalRecordStatuses"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","data","showSidebar","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("data",i.medicalRecordStatuses)("showSidebar",!1)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function h2(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-medical-record-status-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","medicalRecordStatus_edit")("formControl",t.formControl)("medicalRecordStatus",t.medicalRecordStatus)}}const f2=function(){return{}};function _2(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-medical-record-status-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","medicalRecordStatus_create")("formControl",t.formControl)("medicalRecordStatus",e.DdM(3,f2))}}function g2(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-medical-record-status-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("medicalRecordStatuses",o.data.items)}let C2=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadMedicalRecordStatusesEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.medicalRecordStatuses$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(xi))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e._Bn([xi]),e.qOj],decls:7,vars:5,consts:[[3,"to","control","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","medicalRecordStatus","send","close"],[1,"w-full","h-full","bg-white",3,"medicalRecordStatuses","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"ui-select-form",0),e.YNc(1,h2,2,3,"ng-template",null,1,e.W1O),e.YNc(3,_2,1,4,"ng-template",null,2,e.W1O),e.YNc(5,g2,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[W.JJ,W.oH,Z.$,_d,gd],encapsulation:2}),s})();function v2(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-medical-record-status-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","medicalRecordStatus_edit")("medicalRecordStatus",t.value)}}const S2=function(){return{}};function b2(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-medical-record-status-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","medicalRecordStatus_create")("medicalRecordStatus",e.DdM(2,S2))}function T2(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-medical-record-status-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("medicalRecordStatuses",t.items)}}let y2=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:6,consts:[[3,"data","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","medicalRecordStatus","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","medicalRecordStatuses","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,v2,1,2,"ng-template",null,1,e.W1O),e.YNc(3,b2,1,3,"ng-template",null,2,e.W1O),e.YNc(5,T2,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,_d,gd],encapsulation:2}),s})(),w2=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[xi],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"medical-record-status-select",component:C2,wrappers:["form-field"]},{name:"medical-record-status-grid",component:y2}]})]}),s})(),x2=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[w2]}),s})();class Ni extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class N2 extends Ni{constructor(o){super("ValidateMedLevelExcelDataAction"),this.valid=!1,this.excelData=o}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name)}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class A2 extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class F2 extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new A2("name","The medlevel name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class P2 extends Ni{constructor(o){super("CreateMedLevelAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new F2("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateMedLevel({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class I2 extends Ni{constructor(o){super("UpdateMedLevelsAction"),this.medLevels=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.medLevels,!0))}performAction(){this.response=this.businessProvider.data.userUpdateMedLevels({input:{medLevels:this.medLevels}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class D2 extends Ni{constructor(o,t){super("UpdateMedLevelAction"),this.medLevel=o,this.medLevelId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.medLevel,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.medLevelId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateMedLevel({medLevelId:this.medLevelId,input:this.medLevel}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let Cd=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.MedLevelBusinessProviderService",t,a),this.data=i}createMedLevel(t){const i=new P2(t);return i.Do(this),i.response}updateMedLevel(t,i){const a=new D2(t,i);return a.Do(this),a.response}importMedLevels(t){const i=new I2(t);return i.Do(this),i.response}validateMedLevelExcelData(t){const i=new N2(t);return i.Do(this),i.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),M2=(()=>{class s extends I.nH{constructor(t,i,a){super("MedLevelService",a,t),this.businessProvider=i}createMedLevel(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createMedLevel(i)}updateMedLevel(t,i){return this.businessProvider.updateMedLevel(t,i)}importMedLevels(t){return this.businessProvider.importMedLevels(t)}validateMedLevelExcelData(t){return this.businessProvider.validateMedLevelExcelData(t)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(Cd,8),e.LFG(Cd),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),Ko=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){super({loading:!1,medLevels:[],done:!1,searchQuery:"",formName:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.medLevelService=H,this.errors$=this.select(c=>c.errors),this.loading$=this.select(c=>c.loading),this.done$=this.select(c=>c.done),this.item$=this.select(c=>c.item),this.medLevels$=this.select(c=>c.medLevels),this.paging$=this.select(c=>c.paging),this.searchQuery$=this.select(c=>c.searchQuery),this.formName$=this.select(c=>c.formName),this.actionResult$=this.select(this.item$,this.done$,(c,d)=>({item:c,done:d}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.medLevels$,(c,d,n,r,m)=>({errors:c,loading:d,item:n,formName:r,medLevels:m}),{debounce:!0}),this.input$=this.select(this.paging$,this.searchQuery$,(c,d)=>({limit:c.limit,skip:c.skip,name:d,total:c.total})),this.setFormName=this.updater((c,d)=>Object.assign(Object.assign({},c),{formName:d})),this.setItem=this.updater((c,d)=>Object.assign(Object.assign({},c),{item:d})),this.addNewMedLevel=this.updater((c,d)=>Object.assign(Object.assign({},c),{medLevels:[...c.medLevels,d]})),this.updateMedLevel=this.updater((c,d)=>Object.assign(Object.assign({},c),{medLevels:c.medLevels.map(n=>n.id===d.id?d:n)})),this.addMedLevels=this.updater((c,d)=>Object.assign(Object.assign({},c),{medLevels:c.medLevels.concat(d)})),this.updateMedLevels=this.updater((c,d)=>Object.assign(Object.assign({},c),{medLevels:c.medLevels.map(n=>d.find(m=>m.id===n.id)||n)})),this.setSearchQuery=this.updater((c,d)=>Object.assign(Object.assign({},c),{searchQuery:d})),this.loadMedLevelEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.data.userMedLevel({medLevelId:d}).pipe((0,g._b)(n=>{this.patchState({item:n.data.item,errors:n.errors,loading:!1})},n=>this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})))))),this.loadMedLevelsEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([d,n])=>this.data.userMedLevels({input:n}).pipe((0,g._b)(r=>this.patchState({paging:{limit:n.limit,skip:n.skip,total:r.data.count.total},medLevels:r.data.items,errors:r.errors,loading:!1}),r=>this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})))))),this.createMedLevelEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.medLevelService.createMedLevel(Object.assign({},d)).pipe((0,g._b)(n=>{this.addNewMedLevel(n),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:n,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},n=>{n.graphQLErrors?(this.toast.error(n.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})):(this.toast.error(n.Message),this.formService.setErrors(n.Data))}))))),this.updateMedLevelEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.medLevelService.updateMedLevel(d,d.id).pipe((0,g._b)(r=>{this.updateMedLevel(r),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:r,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.deleteMedLevelEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.data.userDeleteMedLevel({medLevelId:n.id}).pipe((0,g._b)(r=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:r.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.importExcelEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.medLevelService.importMedLevels(d).pipe((0,ce.K)(n=>{var r;return this.toast.error(null!==(r=n.Message)&&void 0!==r?r:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(n=>{const r=JSON.parse(n.created),m=JSON.parse(n.updated),p=JSON.parse(n.failed),_=r.length+m.length+p.length;this.addMedLevels(r),this.updateMedLevels(m),this.toast.success(`${r.length} created, ${m.length} updated, ${p.length} failed of total ${_}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("medLevelId")?(this.route.snapshot.paramMap.get("medLevelId"),this.setFormName("medLevel_edit")):this.setFormName("medLevel_create")}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.medLevelService.validateMedLevelExcelData(t)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(M2))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function W2(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.medLevel)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let vd=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"medLevel_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.medLevel=i.item})):t.formName&&t.formName.currentValue&&"medLevel_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadMedLevelEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.medLevel=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Ko),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-med-level-form"]],inputs:{medLevel:"medLevel",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,W2,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),Sd=(()=>{class s{constructor(){this.autoHeight=!1,this.medLevels=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[,{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{headerName:"Approved Site Costs",field:"approvedSiteCosts",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.approvedSiteCosts,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{headerName:"Maximum Medical Bills to Date",field:"maximumMedicalBillsToDate",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.maximumMedicalBillsToDate,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-med-level-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",medLevels:"medLevels"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.medLevels)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function E2(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-med-level-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","medLevel_edit")("formControl",t.formControl)("medLevel",t.medLevel)}}const O2=function(){return{}};function L2(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-med-level-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","medLevel_create")("formControl",t.formControl)("medLevel",e.DdM(3,O2))}}function $2(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-med-level-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("medLevels",o.data.items)}let G2=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadMedLevelsEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.medLevels$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Ko))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","medLevel","send","close"],[1,"w-full","h-full","bg-white",3,"medLevels","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,E2,2,3,"ng-template",null,1,e.W1O),e.YNc(3,L2,1,4,"ng-template",null,2,e.W1O),e.YNc(5,$2,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,vd,Sd],encapsulation:2}),s})();function R2(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-med-level-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","medLevel_edit")("medLevel",t.value)}}const Q2=function(){return{}};function V2(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-med-level-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","medLevel_create")("medLevel",e.DdM(2,Q2))}function j2(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-med-level-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("medLevels",t.items)}}let U2=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","medLevel","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","medLevels","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,R2,1,2,"ng-template",null,1,e.W1O),e.YNc(3,V2,1,3,"ng-template",null,2,e.W1O),e.YNc(5,j2,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,vd,Sd],encapsulation:2}),s})(),J2=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[Ko],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"med-level-select",component:G2,wrappers:["form-field"]},{name:"med-level-grid",component:U2}]})]}),s})(),z2=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[J2]}),s})();class Ai extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class H2 extends Ai{constructor(o){super("ValidateOrganizationExcelDataAction"),this.valid=!1,this.excelData=o}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name)}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class q2 extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class K2 extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new q2("name","The organization name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class Z2 extends Ai{constructor(o){super("CreateOrganizationAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new K2("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateOrganization({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class k2 extends Ai{constructor(o){super("UpdateOrganizationsAction"),this.organizations=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.organizations,!0))}performAction(){this.response=this.businessProvider.data.userUpdateOrganizations({input:{organizations:this.organizations}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class B2 extends Ai{constructor(o,t){super("UpdateOrganizationAction"),this.organization=o,this.organizationId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.organization,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.organizationId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateOrganization({organizationId:this.organizationId,input:this.organization}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let bd=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.OrganizationBusinessProviderService",t,a),this.data=i}createOrganization(t){const i=new Z2(t);return i.Do(this),i.response}updateOrganization(t,i){const a=new B2(t,i);return a.Do(this),a.response}importOrganizations(t){const i=new k2(t);return i.Do(this),i.response}validateOrganizationExcelData(t){const i=new H2(t);return i.Do(this),i.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),Y2=(()=>{class s extends I.nH{constructor(t,i,a){super("OrganizationService",a,t),this.businessProvider=i}createOrganization(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createOrganization(i)}updateOrganization(t,i){return this.businessProvider.updateOrganization(t,i)}importOrganizations(t){return this.businessProvider.importOrganizations(t)}validateOrganizationExcelData(t){return this.businessProvider.validateOrganizationExcelData(t)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(bd,8),e.LFG(bd),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),Zo=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){super({loading:!1,organizations:[],done:!1,searchQuery:"",formName:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.organizationService=H,this.errors$=this.select(c=>c.errors),this.loading$=this.select(c=>c.loading),this.done$=this.select(c=>c.done),this.item$=this.select(c=>c.item),this.organizations$=this.select(c=>c.organizations),this.paging$=this.select(c=>c.paging),this.searchQuery$=this.select(c=>c.searchQuery),this.formName$=this.select(c=>c.formName),this.actionResult$=this.select(this.item$,this.done$,(c,d)=>({item:c,done:d}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.organizations$,(c,d,n,r,m)=>({errors:c,loading:d,item:n,formName:r,organizations:m}),{debounce:!0}),this.input$=this.select(this.paging$,this.searchQuery$,(c,d)=>({limit:c.limit,skip:c.skip,name:d,total:c.total})),this.setFormName=this.updater((c,d)=>Object.assign(Object.assign({},c),{formName:d})),this.setItem=this.updater((c,d)=>Object.assign(Object.assign({},c),{item:d})),this.addNewOrganization=this.updater((c,d)=>Object.assign(Object.assign({},c),{organizations:[...c.organizations,d]})),this.updateOrganization=this.updater((c,d)=>Object.assign(Object.assign({},c),{organizations:c.organizations.map(n=>n.id===d.id?d:n)})),this.addOrganizations=this.updater((c,d)=>Object.assign(Object.assign({},c),{organizations:c.organizations.concat(d)})),this.updateOrganizations=this.updater((c,d)=>Object.assign(Object.assign({},c),{organizations:c.organizations.map(n=>d.find(m=>m.id===n.id)||n)})),this.setSearchQuery=this.updater((c,d)=>Object.assign(Object.assign({},c),{searchQuery:d})),this.loadOrganizationEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.data.userOrganization({organizationId:d}).pipe((0,g._b)(n=>{this.patchState({item:n.data.item,errors:n.errors,loading:!1})},n=>this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})))))),this.loadOrganizationsEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([d,n])=>this.data.userOrganizations({input:n}).pipe((0,g._b)(r=>this.patchState({paging:{limit:n.limit,skip:n.skip,total:r.data.count.total},organizations:r.data.items,errors:r.errors,loading:!1}),r=>this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})))))),this.createOrganizationEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.organizationService.createOrganization(Object.assign({},d)).pipe((0,g._b)(n=>{this.addNewOrganization(n),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:n,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},n=>{n.graphQLErrors?(this.toast.error(n.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})):(this.toast.error(n.Message),this.formService.setErrors(n.Data))}))))),this.updateOrganizationEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.organizationService.updateOrganization(d,d.id).pipe((0,g._b)(r=>{this.updateOrganization(r),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:r,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.deleteOrganizationEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.data.userDeleteOrganization({organizationId:n.id}).pipe((0,g._b)(r=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:r.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.importExcelEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.organizationService.importOrganizations(d).pipe((0,ce.K)(n=>{var r;return this.toast.error(null!==(r=n.Message)&&void 0!==r?r:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(n=>{const r=JSON.parse(n.created),m=JSON.parse(n.updated),p=JSON.parse(n.failed),_=r.length+m.length+p.length;this.addOrganizations(r),this.updateOrganizations(m),this.toast.success(`${r.length} created, ${m.length} updated, ${p.length} failed of total ${_}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("organizationId")?(this.route.snapshot.paramMap.get("organizationId"),this.setFormName("organization_edit")):this.setFormName("organization_create")}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.organizationService.validateOrganizationExcelData(t)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(Y2))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function X2(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.organization)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let Td=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"organization_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.organization=i.item})):t.formName&&t.formName.currentValue&&"organization_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadOrganizationEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.organization=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Zo),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-organization-form"]],inputs:{organization:"organization",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,X2,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),yd=(()=>{class s{constructor(){this.autoHeight=!1,this.organizations=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[,{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-organization-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",organizations:"organizations"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.organizations)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function eQ(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-organization-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","organization_edit")("formControl",t.formControl)("organization",t.organization)}}const tQ=function(){return{}};function iQ(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-organization-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","organization_create")("formControl",t.formControl)("organization",e.DdM(3,tQ))}}function sQ(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-organization-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("organizations",o.data.items)}let oQ=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadOrganizationsEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.organizations$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Zo))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","organization","send","close"],[1,"w-full","h-full","bg-white",3,"organizations","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,eQ,2,3,"ng-template",null,1,e.W1O),e.YNc(3,iQ,1,4,"ng-template",null,2,e.W1O),e.YNc(5,sQ,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,Td,yd],encapsulation:2}),s})();function aQ(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-organization-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","organization_edit")("organization",t.value)}}const rQ=function(){return{}};function nQ(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-organization-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","organization_create")("organization",e.DdM(2,rQ))}function lQ(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-organization-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("organizations",t.items)}}let cQ=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","organization","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","organizations","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,aQ,1,2,"ng-template",null,1,e.W1O),e.YNc(3,nQ,1,3,"ng-template",null,2,e.W1O),e.YNc(5,lQ,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,Td,yd],encapsulation:2}),s})(),dQ=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[Zo],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"organization-select",component:oQ,wrappers:["form-field"]},{name:"organization-grid",component:cQ}]})]}),s})(),uQ=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[dQ]}),s})();class Fi extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class mQ extends Fi{constructor(o,t,i,a){super("ValidatePatientExcelDataAction"),this.valid=!1,this.excelData=o,this.ethnicities=t,this.genders=i,this.languages=a}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name),this.validationContext.addRule(new f.mi(`ethnicityName_${i}_is_valid}`,"Ethnicity Is Not Valid","ethnicity.name",t.ethnicity,this.ethnicities,!0)),this.validationContext.addRule(new f.mi(`genderName_${i}_is_valid}`,"Gender Is Not Valid","gender.name",t.gender,this.genders,!0)),this.validationContext.addRule(new f.mi(`languageName_${i}_is_valid}`,"Language Is Not Valid","language.name",t.language,this.languages,!0))}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class pQ extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class hQ extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new pQ("name","The patient name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class fQ extends Fi{constructor(o){super("CreatePatientAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new hQ("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreatePatient({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class _Q extends Fi{constructor(o){super("UpdatePatientsAction"),this.patients=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.patients,!0))}performAction(){this.response=this.businessProvider.data.userUpdatePatients({input:{patients:this.patients}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class gQ extends Fi{constructor(o,t){super("UpdatePatientAction"),this.patient=o,this.patientId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.patient,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.patientId,!0))}performAction(){this.response=this.businessProvider.data.userUpdatePatient({patientId:this.patientId,input:this.patient}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let wd=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.PatientBusinessProviderService",t,a),this.data=i}createPatient(t){const i=new fQ(t);return i.Do(this),i.response}updatePatient(t,i){const a=new gQ(t,i);return a.Do(this),a.response}importPatients(t){const i=new _Q(t);return i.Do(this),i.response}validatePatientExcelData(t,i,a,l){const u=new mQ(t,i,a,l);return u.Do(this),u.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),CQ=(()=>{class s extends I.nH{constructor(t,i,a){super("PatientService",a,t),this.businessProvider=i}createPatient(t){var i,a,l,u;t.notes=(null===(i=t.notes)||void 0===i?void 0:i.length)>1e3?null===(a=t.notes)||void 0===a?void 0:a.substring(0,999):t.notes,t.debtorRemarks=(null===(l=t.debtorRemarks)||void 0===l?void 0:l.length)>1e3?null===(u=t.debtorRemarks)||void 0===u?void 0:u.substring(0,999):t.debtorRemarks;const H=Object.fromEntries(Object.entries(t).filter(([A,c])=>null!==c));return this.businessProvider.createPatient(H)}updatePatient(t,i){var a,l,u,H;return t.notes=(null===(a=t.notes)||void 0===a?void 0:a.length)>1e3?null===(l=t.notes)||void 0===l?void 0:l.substring(0,999):t.notes,t.debtorRemarks=(null===(u=t.debtorRemarks)||void 0===u?void 0:u.length)>1e3?null===(H=t.debtorRemarks)||void 0===H?void 0:H.substring(0,999):t.debtorRemarks,this.businessProvider.updatePatient(t,i)}importPatients(t){return this.businessProvider.importPatients(t)}validatePatientExcelData(t,i,a,l){return this.businessProvider.validatePatientExcelData(t,i,a,l)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(wd,8),e.LFG(wd),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),ko=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){if(super({loading:!1,patients:[],done:!1,searchQuery:"",memberRegistrationNumber:void 0,formName:void 0,ethnicityId:void 0,genderId:void 0,languageId:void 0,clinicalProviderId:void 0,locationId:void 0,vendorLocationId:void 0,isAllPatients:!1,fromDate:void 0,toDate:void 0,paging:{limit:1e4,skip:0},mrn:void 0}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.patientService=H,this.errors$=this.select(r=>r.errors),this.loading$=this.select(r=>r.loading),this.isAllPatients$=this.select(r=>r.isAllPatients),this.done$=this.select(r=>r.done),this.item$=this.select(r=>r.item),this.patients$=this.select(r=>r.patients),this.ethnicities$=this.select(r=>r.ethnicities||[]),this.genders$=this.select(r=>r.genders||[]),this.languages$=this.select(r=>r.languages||[]),this.clinicalProviderId$=this.select(r=>r.clinicalProviderId),this.locationId$=this.select(r=>r.locationId),this.ethnicityId$=this.select(r=>r.ethnicityId),this.genderId$=this.select(r=>r.genderId),this.languageId$=this.select(r=>r.languageId),this.paging$=this.select(r=>r.paging),this.searchQuery$=this.select(r=>r.searchQuery),this.memberRegistrationNumber$=this.select(r=>r.memberRegistrationNumber),this.fromDate$=this.select(r=>r.fromDate),this.toDate$=this.select(r=>r.toDate),this.vendorLocationId$=this.select(r=>r.vendorLocationId),this.formName$=this.select(r=>r.formName),this.mrn$=this.select(r=>r.mrn),this.actionResult$=this.select(this.item$,this.done$,(r,m)=>({item:r,done:m}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.patients$,this.ethnicities$,this.genders$,this.languages$,(r,m,p,_,w,J,_e,ve)=>({errors:r,loading:m,item:p,formName:_,patients:w,ethnicities:J,genders:_e,languages:ve}),{debounce:!0}),this.input$=this.select(this.paging$,this.ethnicityId$,this.genderId$,this.clinicalProviderId$,this.locationId$,this.vendorLocationId$,this.languageId$,this.searchQuery$,this.memberRegistrationNumber$,this.fromDate$,this.toDate$,this.isAllPatients$,this.mrn$,(r,m,p,_,w,J,_e,ve,ae,le,Y,oe,ge)=>({limit:r.limit,skip:r.skip,name:ve,ethnicityId:m,genderId:p,languageId:_e,total:r.total,clinicalProviderId:_,locationId:w,vendorLocationId:J,memberRegistrationNumber:ae,fromDate:le,toDate:Y,medicalRecordNumber:ge,isAllPatients:oe})),this.setFormName=this.updater((r,m)=>Object.assign(Object.assign({},r),{formName:m})),this.setEthnicityId=this.updater((r,m)=>Object.assign(Object.assign({},r),{ethnicityId:m})),this.setIsAllPatients=this.updater((r,m)=>Object.assign(Object.assign({},r),{isAllPatients:m})),this.setmedicalRecordNumber=this.updater((r,m)=>Object.assign(Object.assign({},r),{mrn:m})),this.setGenderId=this.updater((r,m)=>Object.assign(Object.assign({},r),{genderId:m})),this.setClinicalProviderId=this.updater((r,m)=>Object.assign(Object.assign({},r),{clinicalProviderId:m})),this.setLocationId=this.updater((r,m)=>Object.assign(Object.assign({},r),{locationId:m})),this.setVendorLocationId=this.updater((r,m)=>Object.assign(Object.assign({},r),{vendorLocationId:m})),this.setLanguageId=this.updater((r,m)=>Object.assign(Object.assign({},r),{languageId:m})),this.setLimit=this.updater((r,m)=>Object.assign(Object.assign({},r),{paging:Object.assign(Object.assign({},r.paging),{limit:m})})),this.setSkip=this.updater((r,m)=>Object.assign(Object.assign({},r),{paging:Object.assign(Object.assign({},r.paging),{skip:m})})),this.filterEthnicities=r=>this.data.userSelectEthnicities({input:{name:r}}).pipe((0,g._b)(m=>{let p=m.data.items;return this.patchState({ethnicities:p}),p},m=>this.patchState({errors:m.graphQLErrors?m.graphQLErrors:m})),(0,he.U)(m=>m.data.items)),this.filterGenders=r=>this.data.userSelectGenders({input:{name:r}}).pipe((0,g._b)(m=>{let p=m.data.items;return this.patchState({genders:p}),p},m=>this.patchState({errors:m.graphQLErrors?m.graphQLErrors:m})),(0,he.U)(m=>m.data.items)),this.filterLanguages=r=>this.data.userSelectLanguages({input:{name:r}}).pipe((0,g._b)(m=>{let p=m.data.items;return this.patchState({languages:p}),p},m=>this.patchState({errors:m.graphQLErrors?m.graphQLErrors:m})),(0,he.U)(m=>m.data.items)),this.addEthnicity=this.updater((r,m)=>Object.assign(Object.assign({},r),{ethnicities:r.ethnicities.concat(m)})),this.addGender=this.updater((r,m)=>Object.assign(Object.assign({},r),{genders:r.genders.concat(m)})),this.addLanguage=this.updater((r,m)=>Object.assign(Object.assign({},r),{languages:r.languages.concat(m)})),this.setItem=this.updater((r,m)=>Object.assign(Object.assign({},r),{item:m})),this.addNewPatient=this.updater((r,m)=>Object.assign(Object.assign({},r),{patients:[...r.patients,m]})),this.updatePatient=this.updater((r,m)=>Object.assign(Object.assign({},r),{patients:r.patients.map(p=>p.id===m.id?m:p)})),this.addPatients=this.updater((r,m)=>Object.assign(Object.assign({},r),{patients:r.patients.concat(m)})),this.updatePatients=this.updater((r,m)=>Object.assign(Object.assign({},r),{patients:r.patients.map(p=>m.find(w=>w.id===p.id)||p)})),this.setSearchQuery=this.updater((r,m)=>Object.assign(Object.assign({},r),{searchQuery:m})),this.setMemberRegistrationNumber=this.updater((r,m)=>Object.assign(Object.assign({},r),{memberRegistrationNumber:m})),this.setFromDate=this.updater((r,m)=>Object.assign(Object.assign({},r),{fromDate:m})),this.setToDate=this.updater((r,m)=>Object.assign(Object.assign({},r),{toDate:m})),this.loadPatientEffect=this.effect(r=>r.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(m=>this.data.userPatient({patientId:m}).pipe((0,g._b)(p=>{this.patchState({item:p.data.item,errors:p.errors,loading:!1})},p=>this.patchState({loading:!1,errors:p.graphQLErrors?p.graphQLErrors:p})))))),this.loadPatientsEffect=this.effect(r=>r.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([m,p])=>this.data.userPatients({input:p}).pipe((0,g._b)(_=>(console.log("Skip:::::",_),this.patchState({paging:{limit:p.limit,skip:p.skip,total:_.data.count.total},patients:_.data.items,errors:_.errors,loading:!1})),_=>this.patchState({loading:!1,errors:_.graphQLErrors?_.graphQLErrors:_})))))),this.createPatientEffect=this.effect(r=>r.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(m=>this.patientService.createPatient(Object.assign({},m)).pipe((0,g._b)(p=>{this.addNewPatient(p),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:p,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},p=>{p.graphQLErrors?(this.toast.error(p.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:p.graphQLErrors?p.graphQLErrors:p})):(this.toast.error(p.Message),this.formService.setErrors(p.Data))}))))),this.updatePatientEffect=this.effect(r=>r.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([m,p])=>this.patientService.updatePatient(m,m.id).pipe((0,g._b)(_=>{this.updatePatient(_),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:_,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},_=>{_.graphQLErrors?(this.toast.error(_.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:_.graphQLErrors?_.graphQLErrors:_})):(this.toast.error(_.Message),this.formService.setErrors(_.Data))}))))),this.deletePatientEffect=this.effect(r=>r.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([m,p])=>this.data.userDeletePatient({patientId:p.id}).pipe((0,g._b)(_=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:_.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},_=>{_.graphQLErrors?(this.toast.error(_.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:_.graphQLErrors?_.graphQLErrors:_})):(this.toast.error(_.Message),this.formService.setErrors(_.Data))}))))),this.importExcelEffect=this.effect(r=>r.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(m=>this.patientService.importPatients(m).pipe((0,ce.K)(p=>{var _;return this.toast.error(null!==(_=p.Message)&&void 0!==_?_:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(p=>{const _=JSON.parse(p.created),w=JSON.parse(p.updated),J=JSON.parse(p.failed),_e=_.length+w.length+J.length;this.addPatients(_),this.updatePatients(w),this.toast.success(`${_.length} created, ${w.length} updated, ${J.length} failed of total ${_e}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("patientId")?(this.route.snapshot.paramMap.get("patientId"),this.setFormName("patient_edit")):this.setFormName("patient_create"),this.route.snapshot.paramMap.has("ethnicityId")){var c=this.route.snapshot.paramMap.get("ethnicityId");this.setEthnicityId(c)}if(this.route.snapshot.paramMap.has("genderId")){var d=this.route.snapshot.paramMap.get("genderId");this.setGenderId(d)}if(this.route.snapshot.paramMap.has("languageId")){var n=this.route.snapshot.paramMap.get("languageId");this.setLanguageId(n)}}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.patientService.validatePatientExcelData(t,i.ethnicities,i.genders,i.languages)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(CQ))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function vQ(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.patient)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let xd=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"patient_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.patient=i.item})):t.formName&&t.formName.currentValue&&"patient_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadPatientEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.patient=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(ko),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-patient-form"]],inputs:{patient:"patient",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,vQ,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),Nd=(()=>{class s{constructor(){this.autoHeight=!1,this.patients=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[{field:"ethnicity.name",headerName:"Ethnicity",filter:"agTextColumnFilter"},{field:"gender.name",headerName:"Gender",filter:"agTextColumnFilter"},{field:"language.name",headerName:"Language",filter:"agTextColumnFilter"},{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{field:"firstName",filter:"agTextColumnFilter"},{field:"middleName",filter:"agTextColumnFilter"},{field:"lastName",filter:"agTextColumnFilter"},{field:"suffix",filter:"agTextColumnFilter"},{field:"genderId",filter:"agTextColumnFilter",hide:!0},{field:"nickname",filter:"agTextColumnFilter"},{field:"height",filter:"agTextColumnFilter"},{field:"weight",filter:"agTextColumnFilter"},{field:"dateOfBirth",filter:"agDateColumnFilter"},{field:"primaryPhoneNumber",filter:"agTextColumnFilter"},{headerName:"Is Primary Phone Mobile",field:"isPrimaryPhoneMobile",filter:"agSetColumnFilter",cellRenderer:"checkboxRenderer"},{field:"secondaryPhoneNumber",filter:"agTextColumnFilter"},{headerName:"Is Secondary Phone Mobile",field:"isSecondaryPhoneMobile",filter:"agSetColumnFilter",cellRenderer:"checkboxRenderer"},{field:"memberRegistrationNumber",filter:"agTextColumnFilter"},{field:"ethnicityId",filter:"agTextColumnFilter",hide:!0},{field:"languageId",filter:"agTextColumnFilter",hide:!0},{headerName:"Requires Translator",field:"requiresTranslator",filter:"agSetColumnFilter",cellRenderer:"checkboxRenderer"},{field:"socialSecurityNumber",filter:"agTextColumnFilter"},{field:"honorific",filter:"agTextColumnFilter"},{field:"primaryEmailAddress",filter:"agTextColumnFilter"},{field:"primaryAddressLine1",filter:"agTextColumnFilter"},{field:"primaryAddressLine2",filter:"agTextColumnFilter"},{field:"primaryAddressCity",filter:"agTextColumnFilter"},{field:"primaryAddressStateOrProvince",filter:"agTextColumnFilter"},{field:"primaryAddressPostalCode",filter:"agTextColumnFilter"},{field:"notes",filter:"agTextColumnFilter"},{headerName:"Latitude",field:"latitude",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.latitude,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{headerName:"Longitude",field:"longitude",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.longitude,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{field:"emergencyContactId",filter:"agTextColumnFilter",hide:!0},{field:"homePhoneNumber",filter:"agTextColumnFilter"},{field:"mobileNumber",filter:"agTextColumnFilter"},{field:"bmi",filter:"agTextColumnFilter"},{field:"occupation",filter:"agTextColumnFilter"},{field:"debtorRemarks",filter:"agTextColumnFilter"},{field:"workAddressLine1",filter:"agTextColumnFilter"},{field:"workAddressLine2",filter:"agTextColumnFilter"},{field:"workAddressCity",filter:"agTextColumnFilter"},{field:"workAddressStateOrProvince",filter:"agTextColumnFilter"},{field:"workAddressPostalCode",filter:"agTextColumnFilter"},{headerName:"Work Latitude",field:"workLatitude",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.latitude,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{headerName:"Work Longitude",field:"workLongitude",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.longitude,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-patient-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",patients:"patients"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.patients)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function SQ(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-patient-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","patient_edit")("formControl",t.formControl)("patient",t.patient)}}const bQ=function(){return{}};function TQ(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-patient-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","patient_create")("formControl",t.formControl)("patient",e.DdM(3,bQ))}}function yQ(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-patient-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("patients",o.data.items)}let wQ=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadPatientsEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.patients$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(ko))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","patient","send","close"],[1,"w-full","h-full","bg-white",3,"patients","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,SQ,2,3,"ng-template",null,1,e.W1O),e.YNc(3,TQ,1,4,"ng-template",null,2,e.W1O),e.YNc(5,yQ,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,xd,Nd],encapsulation:2}),s})();function xQ(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-patient-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","patient_edit")("patient",t.value)}}const NQ=function(){return{}};function AQ(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-patient-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","patient_create")("patient",e.DdM(2,NQ))}function FQ(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-patient-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("patients",t.items)}}let PQ=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","patient","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","patients","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,xQ,1,2,"ng-template",null,1,e.W1O),e.YNc(3,AQ,1,3,"ng-template",null,2,e.W1O),e.YNc(5,FQ,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,xd,Nd],encapsulation:2}),s})(),IQ=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[ko],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"patient-select",component:wQ,wrappers:["form-field"]},{name:"patient-grid",component:PQ}]})]}),s})(),DQ=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[IQ]}),s})();class Pi extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class MQ extends Pi{constructor(o,t){super("ValidatePatientStudyExcelDataAction"),this.valid=!1,this.excelData=o,this.patients=t}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name),this.validationContext.addRule(new f.mi(`patientName_${i}_is_valid}`,"Patient Is Not Valid","patient.name",t.patient,this.patients,!0))}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class WQ extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class EQ extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new WQ("name","The patientstudy name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class OQ extends Pi{constructor(o){super("CreatePatientStudyAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new EQ("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreatePatientStudy({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class LQ extends Pi{constructor(o){super("UpdatePatientStudiesAction"),this.patientStudies=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.patientStudies,!0))}performAction(){this.response=this.businessProvider.data.userUpdatePatientStudies({input:{patientStudies:this.patientStudies}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class $Q extends Pi{constructor(o,t){super("UpdatePatientStudyAction"),this.patientStudy=o,this.patientStudyId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.patientStudy,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.patientStudyId,!0))}performAction(){this.response=this.businessProvider.data.userUpdatePatientStudy({patientStudyId:this.patientStudyId,input:this.patientStudy}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let Ad=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.PatientStudyBusinessProviderService",t,a),this.data=i}createPatientStudy(t){const i=new OQ(t);return i.Do(this),i.response}updatePatientStudy(t,i){const a=new $Q(t,i);return a.Do(this),a.response}importPatientStudies(t){const i=new LQ(t);return i.Do(this),i.response}validatePatientStudyExcelData(t,i){const a=new MQ(t,i);return a.Do(this),a.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),GQ=(()=>{class s extends I.nH{constructor(t,i,a){super("PatientStudyService",a,t),this.businessProvider=i}createPatientStudy(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createPatientStudy(i)}updatePatientStudy(t,i){return this.businessProvider.updatePatientStudy(t,i)}importPatientStudies(t){return this.businessProvider.importPatientStudies(t)}validatePatientStudyExcelData(t,i){return this.businessProvider.validatePatientStudyExcelData(t,i)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(Ad,8),e.LFG(Ad),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),Bo=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){if(super({loading:!1,patientStudies:[],done:!1,searchQuery:"",formName:void 0,patientId:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.patientStudyService=H,this.errors$=this.select(d=>d.errors),this.loading$=this.select(d=>d.loading),this.done$=this.select(d=>d.done),this.item$=this.select(d=>d.item),this.patientStudies$=this.select(d=>d.patientStudies),this.patients$=this.select(d=>d.patients||[]),this.patientId$=this.select(d=>d.patientId),this.paging$=this.select(d=>d.paging),this.searchQuery$=this.select(d=>d.searchQuery),this.formName$=this.select(d=>d.formName),this.actionResult$=this.select(this.item$,this.done$,(d,n)=>({item:d,done:n}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.patientStudies$,this.patients$,(d,n,r,m,p,_)=>({errors:d,loading:n,item:r,formName:m,patientStudies:p,patients:_}),{debounce:!0}),this.input$=this.select(this.paging$,this.patientId$,this.searchQuery$,(d,n,r)=>({limit:d.limit,skip:d.skip,name:r,patientId:n,total:d.total})),this.setFormName=this.updater((d,n)=>Object.assign(Object.assign({},d),{formName:n})),this.setPatientId=this.updater((d,n)=>Object.assign(Object.assign({},d),{patientId:n})),this.filterPatients=d=>this.data.userSelectPatients({input:{name:d}}).pipe((0,g._b)(n=>{let r=n.data.items;return this.patchState({patients:r}),r},n=>this.patchState({errors:n.graphQLErrors?n.graphQLErrors:n})),(0,he.U)(n=>n.data.items)),this.addPatient=this.updater((d,n)=>Object.assign(Object.assign({},d),{patients:d.patients.concat(n)})),this.setItem=this.updater((d,n)=>Object.assign(Object.assign({},d),{item:n})),this.addNewPatientStudy=this.updater((d,n)=>Object.assign(Object.assign({},d),{patientStudies:[...d.patientStudies,n]})),this.updatePatientStudy=this.updater((d,n)=>Object.assign(Object.assign({},d),{patientStudies:d.patientStudies.map(r=>r.id===n.id?n:r)})),this.addPatientStudies=this.updater((d,n)=>Object.assign(Object.assign({},d),{patientStudies:d.patientStudies.concat(n)})),this.updatePatientStudies=this.updater((d,n)=>Object.assign(Object.assign({},d),{patientStudies:d.patientStudies.map(r=>n.find(p=>p.id===r.id)||r)})),this.setSearchQuery=this.updater((d,n)=>Object.assign(Object.assign({},d),{searchQuery:n})),this.loadPatientStudyEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(n=>this.data.userPatientStudy({patientStudyId:n}).pipe((0,g._b)(r=>{this.patchState({item:r.data.item,errors:r.errors,loading:!1})},r=>this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})))))),this.loadPatientStudiesEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([n,r])=>this.data.userPatientStudies({input:r}).pipe((0,g._b)(m=>this.patchState({paging:{limit:r.limit,skip:r.skip,total:m.data.count.total},patientStudies:m.data.items,errors:m.errors,loading:!1}),m=>this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})))))),this.createPatientStudyEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(n=>this.patientStudyService.createPatientStudy(Object.assign({},n)).pipe((0,g._b)(r=>{this.addNewPatientStudy(r),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:r,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.updatePatientStudyEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([n,r])=>this.patientStudyService.updatePatientStudy(n,n.id).pipe((0,g._b)(m=>{this.updatePatientStudy(m),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:m,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},m=>{m.graphQLErrors?(this.toast.error(m.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})):(this.toast.error(m.Message),this.formService.setErrors(m.Data))}))))),this.deletePatientStudyEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([n,r])=>this.data.userDeletePatientStudy({patientStudyId:r.id}).pipe((0,g._b)(m=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:m.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},m=>{m.graphQLErrors?(this.toast.error(m.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})):(this.toast.error(m.Message),this.formService.setErrors(m.Data))}))))),this.importExcelEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(n=>this.patientStudyService.importPatientStudies(n).pipe((0,ce.K)(r=>{var m;return this.toast.error(null!==(m=r.Message)&&void 0!==m?m:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(r=>{const m=JSON.parse(r.created),p=JSON.parse(r.updated),_=JSON.parse(r.failed),w=m.length+p.length+_.length;this.addPatientStudies(m),this.updatePatientStudies(p),this.toast.success(`${m.length} created, ${p.length} updated, ${_.length} failed of total ${w}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("patientStudyId")?(this.route.snapshot.paramMap.get("patientStudyId"),this.setFormName("patientStudy_edit")):this.setFormName("patientStudy_create"),this.route.snapshot.paramMap.has("patientId")){var c=this.route.snapshot.paramMap.get("patientId");this.setPatientId(c)}}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.patientStudyService.validatePatientStudyExcelData(t,i.patients)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(GQ))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function RQ(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.patientStudy)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let Fd=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"patientStudy_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.patientStudy=i.item})):t.formName&&t.formName.currentValue&&"patientStudy_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadPatientStudyEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.patientStudy=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Bo),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-patient-study-form"]],inputs:{patientStudy:"patientStudy",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,RQ,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),Pd=(()=>{class s{constructor(){this.autoHeight=!1,this.patientStudies=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[{field:"patient.name",headerName:"Patient",filter:"agTextColumnFilter"},{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{field:"patientId",filter:"agTextColumnFilter",hide:!0}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-patient-study-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",patientStudies:"patientStudies"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.patientStudies)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function QQ(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-patient-study-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","patientStudy_edit")("formControl",t.formControl)("patientStudy",t.patientStudy)}}const VQ=function(){return{}};function jQ(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-patient-study-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","patientStudy_create")("formControl",t.formControl)("patientStudy",e.DdM(3,VQ))}}function UQ(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-patient-study-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("patientStudies",o.data.items)}let JQ=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadPatientStudiesEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.patientStudies$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Bo))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","patientStudy","send","close"],[1,"w-full","h-full","bg-white",3,"patientStudies","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,QQ,2,3,"ng-template",null,1,e.W1O),e.YNc(3,jQ,1,4,"ng-template",null,2,e.W1O),e.YNc(5,UQ,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,Fd,Pd],encapsulation:2}),s})();function zQ(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-patient-study-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","patientStudy_edit")("patientStudy",t.value)}}const HQ=function(){return{}};function qQ(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-patient-study-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","patientStudy_create")("patientStudy",e.DdM(2,HQ))}function KQ(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-patient-study-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("patientStudies",t.items)}}let ZQ=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","patientStudy","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","patientStudies","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,zQ,1,2,"ng-template",null,1,e.W1O),e.YNc(3,qQ,1,3,"ng-template",null,2,e.W1O),e.YNc(5,KQ,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,Fd,Pd],encapsulation:2}),s})(),kQ=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[Bo],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"patient-study-select",component:JQ,wrappers:["form-field"]},{name:"patient-study-grid",component:ZQ}]})]}),s})(),BQ=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[kQ]}),s})();class Ii extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class YQ extends Ii{constructor(o){super("ValidatePatientTreatmentStatusExcelDataAction"),this.valid=!1,this.excelData=o}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name)}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class XQ extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class eV extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new XQ("name","The patienttreatmentstatus name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class tV extends Ii{constructor(o){super("CreatePatientTreatmentStatusAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new eV("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreatePatientTreatmentStatus({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class iV extends Ii{constructor(o){super("UpdatePatientTreatmentStatusesAction"),this.patientTreatmentStatuses=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.patientTreatmentStatuses,!0))}performAction(){this.response=this.businessProvider.data.userUpdatePatientTreatmentStatuses({input:{patientTreatmentStatuses:this.patientTreatmentStatuses}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class sV extends Ii{constructor(o,t){super("UpdatePatientTreatmentStatusAction"),this.patientTreatmentStatus=o,this.patientTreatmentStatusId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.patientTreatmentStatus,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.patientTreatmentStatusId,!0))}performAction(){this.response=this.businessProvider.data.userUpdatePatientTreatmentStatus({patientTreatmentStatusId:this.patientTreatmentStatusId,input:this.patientTreatmentStatus}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let Id=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.PatientTreatmentStatusBusinessProviderService",t,a),this.data=i}createPatientTreatmentStatus(t){const i=new tV(t);return i.Do(this),i.response}updatePatientTreatmentStatus(t,i){const a=new sV(t,i);return a.Do(this),a.response}importPatientTreatmentStatuses(t){const i=new iV(t);return i.Do(this),i.response}validatePatientTreatmentStatusExcelData(t){const i=new YQ(t);return i.Do(this),i.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),oV=(()=>{class s extends I.nH{constructor(t,i,a){super("PatientTreatmentStatusService",a,t),this.businessProvider=i}createPatientTreatmentStatus(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createPatientTreatmentStatus(i)}updatePatientTreatmentStatus(t,i){return this.businessProvider.updatePatientTreatmentStatus(t,i)}importPatientTreatmentStatuses(t){return this.businessProvider.importPatientTreatmentStatuses(t)}validatePatientTreatmentStatusExcelData(t){return this.businessProvider.validatePatientTreatmentStatusExcelData(t)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(Id,8),e.LFG(Id),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),Yo=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){super({loading:!1,patientTreatmentStatuses:[],done:!1,searchQuery:"",formName:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.patientTreatmentStatusService=H,this.errors$=this.select(c=>c.errors),this.loading$=this.select(c=>c.loading),this.done$=this.select(c=>c.done),this.item$=this.select(c=>c.item),this.patientTreatmentStatuses$=this.select(c=>c.patientTreatmentStatuses),this.paging$=this.select(c=>c.paging),this.searchQuery$=this.select(c=>c.searchQuery),this.formName$=this.select(c=>c.formName),this.actionResult$=this.select(this.item$,this.done$,(c,d)=>({item:c,done:d}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.patientTreatmentStatuses$,(c,d,n,r,m)=>({errors:c,loading:d,item:n,formName:r,patientTreatmentStatuses:m}),{debounce:!0}),this.input$=this.select(this.paging$,this.searchQuery$,(c,d)=>({limit:c.limit,skip:c.skip,name:d,total:c.total})),this.setFormName=this.updater((c,d)=>Object.assign(Object.assign({},c),{formName:d})),this.setItem=this.updater((c,d)=>Object.assign(Object.assign({},c),{item:d})),this.addNewPatientTreatmentStatus=this.updater((c,d)=>Object.assign(Object.assign({},c),{patientTreatmentStatuses:[...c.patientTreatmentStatuses,d]})),this.updatePatientTreatmentStatus=this.updater((c,d)=>Object.assign(Object.assign({},c),{patientTreatmentStatuses:c.patientTreatmentStatuses.map(n=>n.id===d.id?d:n)})),this.addPatientTreatmentStatuses=this.updater((c,d)=>Object.assign(Object.assign({},c),{patientTreatmentStatuses:c.patientTreatmentStatuses.concat(d)})),this.updatePatientTreatmentStatuses=this.updater((c,d)=>Object.assign(Object.assign({},c),{patientTreatmentStatuses:c.patientTreatmentStatuses.map(n=>d.find(m=>m.id===n.id)||n)})),this.setSearchQuery=this.updater((c,d)=>Object.assign(Object.assign({},c),{searchQuery:d})),this.loadPatientTreatmentStatusEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.data.userPatientTreatmentStatus({patientTreatmentStatusId:d}).pipe((0,g._b)(n=>{this.patchState({item:n.data.item,errors:n.errors,loading:!1})},n=>this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})))))),this.loadPatientTreatmentStatusesEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([d,n])=>this.data.userPatientTreatmentStatuses({input:n}).pipe((0,g._b)(r=>this.patchState({paging:{limit:n.limit,skip:n.skip,total:r.data.count.total},patientTreatmentStatuses:r.data.items,errors:r.errors,loading:!1}),r=>this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})))))),this.createPatientTreatmentStatusEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.patientTreatmentStatusService.createPatientTreatmentStatus(Object.assign({},d)).pipe((0,g._b)(n=>{this.addNewPatientTreatmentStatus(n),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:n,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},n=>{n.graphQLErrors?(this.toast.error(n.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})):(this.toast.error(n.Message),this.formService.setErrors(n.Data))}))))),this.updatePatientTreatmentStatusEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.patientTreatmentStatusService.updatePatientTreatmentStatus(d,d.id).pipe((0,g._b)(r=>{this.updatePatientTreatmentStatus(r),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:r,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.deletePatientTreatmentStatusEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.data.userDeletePatientTreatmentStatus({patientTreatmentStatusId:n.id}).pipe((0,g._b)(r=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:r.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.importExcelEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.patientTreatmentStatusService.importPatientTreatmentStatuses(d).pipe((0,ce.K)(n=>{var r;return this.toast.error(null!==(r=n.Message)&&void 0!==r?r:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(n=>{const r=JSON.parse(n.created),m=JSON.parse(n.updated),p=JSON.parse(n.failed),_=r.length+m.length+p.length;this.addPatientTreatmentStatuses(r),this.updatePatientTreatmentStatuses(m),this.toast.success(`${r.length} created, ${m.length} updated, ${p.length} failed of total ${_}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("patientTreatmentStatusId")?(this.route.snapshot.paramMap.get("patientTreatmentStatusId"),this.setFormName("patientTreatmentStatus_edit")):this.setFormName("patientTreatmentStatus_create")}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.patientTreatmentStatusService.validatePatientTreatmentStatusExcelData(t)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(oV))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function aV(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.patientTreatmentStatus)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let Dd=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"patientTreatmentStatus_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.patientTreatmentStatus=i.item})):t.formName&&t.formName.currentValue&&"patientTreatmentStatus_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadPatientTreatmentStatusEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.patientTreatmentStatus=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Yo),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-patient-treatment-status-form"]],inputs:{patientTreatmentStatus:"patientTreatmentStatus",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,aV,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),Md=(()=>{class s{constructor(){this.autoHeight=!1,this.patientTreatmentStatuses=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[,{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-patient-treatment-status-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",patientTreatmentStatuses:"patientTreatmentStatuses"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.patientTreatmentStatuses)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function rV(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-patient-treatment-status-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","patientTreatmentStatus_edit")("formControl",t.formControl)("patientTreatmentStatus",t.patientTreatmentStatus)}}const nV=function(){return{}};function lV(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-patient-treatment-status-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","patientTreatmentStatus_create")("formControl",t.formControl)("patientTreatmentStatus",e.DdM(3,nV))}}function cV(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-patient-treatment-status-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("patientTreatmentStatuses",o.data.items)}let dV=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadPatientTreatmentStatusesEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.patientTreatmentStatuses$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Yo))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","patientTreatmentStatus","send","close"],[1,"w-full","h-full","bg-white",3,"patientTreatmentStatuses","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,rV,2,3,"ng-template",null,1,e.W1O),e.YNc(3,lV,1,4,"ng-template",null,2,e.W1O),e.YNc(5,cV,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,Dd,Md],encapsulation:2}),s})();function uV(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-patient-treatment-status-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","patientTreatmentStatus_edit")("patientTreatmentStatus",t.value)}}const mV=function(){return{}};function pV(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-patient-treatment-status-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","patientTreatmentStatus_create")("patientTreatmentStatus",e.DdM(2,mV))}function hV(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-patient-treatment-status-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("patientTreatmentStatuses",t.items)}}let fV=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","patientTreatmentStatus","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","patientTreatmentStatuses","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,uV,1,2,"ng-template",null,1,e.W1O),e.YNc(3,pV,1,3,"ng-template",null,2,e.W1O),e.YNc(5,hV,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,Dd,Md],encapsulation:2}),s})(),_V=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[Yo],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"patient-treatment-status-select",component:dV,wrappers:["form-field"]},{name:"patient-treatment-status-grid",component:fV}]})]}),s})(),gV=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[_V]}),s})();class Di extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class CV extends Di{constructor(o){super("ValidatePaymentApplicationMethodExcelDataAction"),this.valid=!1,this.excelData=o}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name)}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class vV extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class SV extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new vV("name","The paymentapplicationmethod name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class bV extends Di{constructor(o){super("CreatePaymentApplicationMethodAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new SV("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreatePaymentApplicationMethod({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class TV extends Di{constructor(o){super("UpdatePaymentApplicationMethodsAction"),this.paymentApplicationMethods=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.paymentApplicationMethods,!0))}performAction(){this.response=this.businessProvider.data.userUpdatePaymentApplicationMethods({input:{paymentApplicationMethods:this.paymentApplicationMethods}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class yV extends Di{constructor(o,t){super("UpdatePaymentApplicationMethodAction"),this.paymentApplicationMethod=o,this.paymentApplicationMethodId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.paymentApplicationMethod,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.paymentApplicationMethodId,!0))}performAction(){this.response=this.businessProvider.data.userUpdatePaymentApplicationMethod({paymentApplicationMethodId:this.paymentApplicationMethodId,input:this.paymentApplicationMethod}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let Wd=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.PaymentApplicationMethodBusinessProviderService",t,a),this.data=i}createPaymentApplicationMethod(t){const i=new bV(t);return i.Do(this),i.response}updatePaymentApplicationMethod(t,i){const a=new yV(t,i);return a.Do(this),a.response}importPaymentApplicationMethods(t){const i=new TV(t);return i.Do(this),i.response}validatePaymentApplicationMethodExcelData(t){const i=new CV(t);return i.Do(this),i.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),wV=(()=>{class s extends I.nH{constructor(t,i,a){super("PaymentApplicationMethodService",a,t),this.businessProvider=i}createPaymentApplicationMethod(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createPaymentApplicationMethod(i)}updatePaymentApplicationMethod(t,i){return this.businessProvider.updatePaymentApplicationMethod(t,i)}importPaymentApplicationMethods(t){return this.businessProvider.importPaymentApplicationMethods(t)}validatePaymentApplicationMethodExcelData(t){return this.businessProvider.validatePaymentApplicationMethodExcelData(t)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(Wd,8),e.LFG(Wd),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),Xo=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){super({loading:!1,paymentApplicationMethods:[],done:!1,searchQuery:"",formName:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.paymentApplicationMethodService=H,this.errors$=this.select(c=>c.errors),this.loading$=this.select(c=>c.loading),this.done$=this.select(c=>c.done),this.item$=this.select(c=>c.item),this.paymentApplicationMethods$=this.select(c=>c.paymentApplicationMethods),this.paging$=this.select(c=>c.paging),this.searchQuery$=this.select(c=>c.searchQuery),this.formName$=this.select(c=>c.formName),this.actionResult$=this.select(this.item$,this.done$,(c,d)=>({item:c,done:d}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.paymentApplicationMethods$,(c,d,n,r,m)=>({errors:c,loading:d,item:n,formName:r,paymentApplicationMethods:m}),{debounce:!0}),this.input$=this.select(this.paging$,this.searchQuery$,(c,d)=>({limit:c.limit,skip:c.skip,name:d,total:c.total})),this.setFormName=this.updater((c,d)=>Object.assign(Object.assign({},c),{formName:d})),this.setItem=this.updater((c,d)=>Object.assign(Object.assign({},c),{item:d})),this.addNewPaymentApplicationMethod=this.updater((c,d)=>Object.assign(Object.assign({},c),{paymentApplicationMethods:[...c.paymentApplicationMethods,d]})),this.updatePaymentApplicationMethod=this.updater((c,d)=>Object.assign(Object.assign({},c),{paymentApplicationMethods:c.paymentApplicationMethods.map(n=>n.id===d.id?d:n)})),this.addPaymentApplicationMethods=this.updater((c,d)=>Object.assign(Object.assign({},c),{paymentApplicationMethods:c.paymentApplicationMethods.concat(d)})),this.updatePaymentApplicationMethods=this.updater((c,d)=>Object.assign(Object.assign({},c),{paymentApplicationMethods:c.paymentApplicationMethods.map(n=>d.find(m=>m.id===n.id)||n)})),this.setSearchQuery=this.updater((c,d)=>Object.assign(Object.assign({},c),{searchQuery:d})),this.loadPaymentApplicationMethodEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.data.userPaymentApplicationMethod({paymentApplicationMethodId:d}).pipe((0,g._b)(n=>{this.patchState({item:n.data.item,errors:n.errors,loading:!1})},n=>this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})))))),this.loadPaymentApplicationMethodsEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([d,n])=>this.data.userPaymentApplicationMethods({input:n}).pipe((0,g._b)(r=>this.patchState({paging:{limit:n.limit,skip:n.skip,total:r.data.count.total},paymentApplicationMethods:r.data.items,errors:r.errors,loading:!1}),r=>this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})))))),this.createPaymentApplicationMethodEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.paymentApplicationMethodService.createPaymentApplicationMethod(Object.assign({},d)).pipe((0,g._b)(n=>{this.addNewPaymentApplicationMethod(n),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:n,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},n=>{n.graphQLErrors?(this.toast.error(n.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})):(this.toast.error(n.Message),this.formService.setErrors(n.Data))}))))),this.updatePaymentApplicationMethodEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.paymentApplicationMethodService.updatePaymentApplicationMethod(d,d.id).pipe((0,g._b)(r=>{this.updatePaymentApplicationMethod(r),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:r,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.deletePaymentApplicationMethodEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.data.userDeletePaymentApplicationMethod({paymentApplicationMethodId:n.id}).pipe((0,g._b)(r=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:r.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.importExcelEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.paymentApplicationMethodService.importPaymentApplicationMethods(d).pipe((0,ce.K)(n=>{var r;return this.toast.error(null!==(r=n.Message)&&void 0!==r?r:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(n=>{const r=JSON.parse(n.created),m=JSON.parse(n.updated),p=JSON.parse(n.failed),_=r.length+m.length+p.length;this.addPaymentApplicationMethods(r),this.updatePaymentApplicationMethods(m),this.toast.success(`${r.length} created, ${m.length} updated, ${p.length} failed of total ${_}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("paymentApplicationMethodId")?(this.route.snapshot.paramMap.get("paymentApplicationMethodId"),this.setFormName("paymentApplicationMethod_edit")):this.setFormName("paymentApplicationMethod_create")}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.paymentApplicationMethodService.validatePaymentApplicationMethodExcelData(t)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(wV))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function xV(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.paymentApplicationMethod)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let Ed=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"paymentApplicationMethod_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.paymentApplicationMethod=i.item})):t.formName&&t.formName.currentValue&&"paymentApplicationMethod_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadPaymentApplicationMethodEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.paymentApplicationMethod=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Xo),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-payment-application-method-form"]],inputs:{paymentApplicationMethod:"paymentApplicationMethod",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,xV,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),Od=(()=>{class s{constructor(){this.autoHeight=!1,this.paymentApplicationMethods=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[,{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-payment-application-method-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",paymentApplicationMethods:"paymentApplicationMethods"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.paymentApplicationMethods)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function NV(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-payment-application-method-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","paymentApplicationMethod_edit")("formControl",t.formControl)("paymentApplicationMethod",t.paymentApplicationMethod)}}const AV=function(){return{}};function FV(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-payment-application-method-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","paymentApplicationMethod_create")("formControl",t.formControl)("paymentApplicationMethod",e.DdM(3,AV))}}function PV(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-payment-application-method-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("paymentApplicationMethods",o.data.items)}let IV=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadPaymentApplicationMethodsEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.paymentApplicationMethods$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Xo))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","paymentApplicationMethod","send","close"],[1,"w-full","h-full","bg-white",3,"paymentApplicationMethods","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,NV,2,3,"ng-template",null,1,e.W1O),e.YNc(3,FV,1,4,"ng-template",null,2,e.W1O),e.YNc(5,PV,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,Ed,Od],encapsulation:2}),s})();function DV(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-payment-application-method-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","paymentApplicationMethod_edit")("paymentApplicationMethod",t.value)}}const MV=function(){return{}};function WV(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-payment-application-method-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","paymentApplicationMethod_create")("paymentApplicationMethod",e.DdM(2,MV))}function EV(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-payment-application-method-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("paymentApplicationMethods",t.items)}}let OV=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","paymentApplicationMethod","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","paymentApplicationMethods","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,DV,1,2,"ng-template",null,1,e.W1O),e.YNc(3,WV,1,3,"ng-template",null,2,e.W1O),e.YNc(5,EV,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,Ed,Od],encapsulation:2}),s})(),LV=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[Xo],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"payment-application-method-select",component:IV,wrappers:["form-field"]},{name:"payment-application-method-grid",component:OV}]})]}),s})(),$V=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[LV]}),s})();class Mi extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class GV extends Mi{constructor(o,t,i,a,l,u){super("ValidatePaymentExcelDataAction"),this.valid=!1,this.excelData=o,this.batchControls=t,this.banks=i,this.payorTypes=a,this.paymentTypes=l,this.paymentApplicationMethods=u}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name),this.validationContext.addRule(new f.mi(`batchControlName_${i}_is_valid}`,"Batch Control Is Not Valid","batchControl.name",t.batchControl,this.batchControls,!0)),this.validationContext.addRule(new f.mi(`bankName_${i}_is_valid}`,"Bank Is Not Valid","bank.name",t.bank,this.banks,!0)),this.validationContext.addRule(new f.mi(`payorTypeName_${i}_is_valid}`,"Payor Type Is Not Valid","payorType.name",t.payorType,this.payorTypes,!0)),this.validationContext.addRule(new f.mi(`paymentTypeName_${i}_is_valid}`,"Payment Type Is Not Valid","paymentType.name",t.paymentType,this.paymentTypes,!0)),this.validationContext.addRule(new f.mi(`paymentApplicationMethodName_${i}_is_valid}`,"Payment Application Method Is Not Valid","paymentApplicationMethod.name",t.paymentApplicationMethod,this.paymentApplicationMethods,!0))}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class RV extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class QV extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new RV("name","The payment name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class VV extends Mi{constructor(o){super("CreatePaymentAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new QV("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreatePayment({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class jV extends Mi{constructor(o){super("UpdatePaymentsAction"),this.payments=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.payments,!0))}performAction(){this.response=this.businessProvider.data.userUpdatePayments({input:{payments:this.payments}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class UV extends Mi{constructor(o,t){super("UpdatePaymentAction"),this.payment=o,this.paymentId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.payment,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.paymentId,!0))}performAction(){this.response=this.businessProvider.data.userUpdatePayment({paymentId:this.paymentId,input:this.payment}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let Ld=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.PaymentBusinessProviderService",t,a),this.data=i}createPayment(t){const i=new VV(t);return i.Do(this),i.response}updatePayment(t,i){const a=new UV(t,i);return a.Do(this),a.response}importPayments(t){const i=new jV(t);return i.Do(this),i.response}validatePaymentExcelData(t,i,a,l,u,H){const A=new GV(t,i,a,l,u,H);return A.Do(this),A.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),JV=(()=>{class s extends I.nH{constructor(t,i,a){super("PaymentService",a,t),this.businessProvider=i}createPayment(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createPayment(i)}updatePayment(t,i){return this.businessProvider.updatePayment(t,i)}importPayments(t){return this.businessProvider.importPayments(t)}validatePaymentExcelData(t,i,a,l,u,H){return this.businessProvider.validatePaymentExcelData(t,i,a,l,u,H)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(Ld,8),e.LFG(Ld),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),ea=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){if(super({loading:!1,payments:[],done:!1,searchQuery:"",formName:void 0,batchControlId:void 0,bankId:void 0,payorTypeId:void 0,paymentTypeId:void 0,paymentApplicationMethodId:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.paymentService=H,this.errors$=this.select(p=>p.errors),this.loading$=this.select(p=>p.loading),this.done$=this.select(p=>p.done),this.item$=this.select(p=>p.item),this.payments$=this.select(p=>p.payments),this.batchControls$=this.select(p=>p.batchControls||[]),this.banks$=this.select(p=>p.banks||[]),this.payorTypes$=this.select(p=>p.payorTypes||[]),this.paymentTypes$=this.select(p=>p.paymentTypes||[]),this.paymentApplicationMethods$=this.select(p=>p.paymentApplicationMethods||[]),this.batchControlId$=this.select(p=>p.batchControlId),this.bankId$=this.select(p=>p.bankId),this.payorTypeId$=this.select(p=>p.payorTypeId),this.paymentTypeId$=this.select(p=>p.paymentTypeId),this.paymentApplicationMethodId$=this.select(p=>p.paymentApplicationMethodId),this.paging$=this.select(p=>p.paging),this.searchQuery$=this.select(p=>p.searchQuery),this.formName$=this.select(p=>p.formName),this.actionResult$=this.select(this.item$,this.done$,(p,_)=>({item:p,done:_}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.payments$,this.batchControls$,this.banks$,this.payorTypes$,this.paymentTypes$,this.paymentApplicationMethods$,(p,_,w,J,_e,ve,ae,le,Y,oe)=>({errors:p,loading:_,item:w,formName:J,payments:_e,batchControls:ve,banks:ae,payorTypes:le,paymentTypes:Y,paymentApplicationMethods:oe}),{debounce:!0}),this.input$=this.select(this.paging$,this.batchControlId$,this.bankId$,this.payorTypeId$,this.paymentTypeId$,this.paymentApplicationMethodId$,this.searchQuery$,(p,_,w,J,_e,ve,ae)=>({limit:p.limit,skip:p.skip,name:ae,batchControlId:_,bankId:w,payorTypeId:J,paymentTypeId:_e,paymentApplicationMethodId:ve,total:p.total})),this.setFormName=this.updater((p,_)=>Object.assign(Object.assign({},p),{formName:_})),this.setBatchControlId=this.updater((p,_)=>Object.assign(Object.assign({},p),{batchControlId:_})),this.setBankId=this.updater((p,_)=>Object.assign(Object.assign({},p),{bankId:_})),this.setPayorTypeId=this.updater((p,_)=>Object.assign(Object.assign({},p),{payorTypeId:_})),this.setPaymentTypeId=this.updater((p,_)=>Object.assign(Object.assign({},p),{paymentTypeId:_})),this.setPaymentApplicationMethodId=this.updater((p,_)=>Object.assign(Object.assign({},p),{paymentApplicationMethodId:_})),this.filterBatchControls=p=>this.data.userSelectBatchControls({input:{name:p}}).pipe((0,g._b)(_=>{let w=_.data.items;return this.patchState({batchControls:w}),w},_=>this.patchState({errors:_.graphQLErrors?_.graphQLErrors:_})),(0,he.U)(_=>_.data.items)),this.filterBanks=p=>this.data.userSelectBanks({input:{name:p}}).pipe((0,g._b)(_=>{let w=_.data.items;return this.patchState({banks:w}),w},_=>this.patchState({errors:_.graphQLErrors?_.graphQLErrors:_})),(0,he.U)(_=>_.data.items)),this.filterPayorTypes=p=>this.data.userSelectPayorTypes({input:{name:p}}).pipe((0,g._b)(_=>{let w=_.data.items;return this.patchState({payorTypes:w}),w},_=>this.patchState({errors:_.graphQLErrors?_.graphQLErrors:_})),(0,he.U)(_=>_.data.items)),this.filterPaymentTypes=p=>this.data.userSelectPaymentTypes({input:{name:p}}).pipe((0,g._b)(_=>{let w=_.data.items;return this.patchState({paymentTypes:w}),w},_=>this.patchState({errors:_.graphQLErrors?_.graphQLErrors:_})),(0,he.U)(_=>_.data.items)),this.filterPaymentApplicationMethods=p=>this.data.userSelectPaymentApplicationMethods({input:{name:p}}).pipe((0,g._b)(_=>{let w=_.data.items;return this.patchState({paymentApplicationMethods:w}),w},_=>this.patchState({errors:_.graphQLErrors?_.graphQLErrors:_})),(0,he.U)(_=>_.data.items)),this.addBatchControl=this.updater((p,_)=>Object.assign(Object.assign({},p),{batchControls:p.batchControls.concat(_)})),this.addBank=this.updater((p,_)=>Object.assign(Object.assign({},p),{banks:p.banks.concat(_)})),this.addPayorType=this.updater((p,_)=>Object.assign(Object.assign({},p),{payorTypes:p.payorTypes.concat(_)})),this.addPaymentType=this.updater((p,_)=>Object.assign(Object.assign({},p),{paymentTypes:p.paymentTypes.concat(_)})),this.addPaymentApplicationMethod=this.updater((p,_)=>Object.assign(Object.assign({},p),{paymentApplicationMethods:p.paymentApplicationMethods.concat(_)})),this.setItem=this.updater((p,_)=>Object.assign(Object.assign({},p),{item:_})),this.addNewPayment=this.updater((p,_)=>Object.assign(Object.assign({},p),{payments:[...p.payments,_]})),this.updatePayment=this.updater((p,_)=>Object.assign(Object.assign({},p),{payments:p.payments.map(w=>w.id===_.id?_:w)})),this.addPayments=this.updater((p,_)=>Object.assign(Object.assign({},p),{payments:p.payments.concat(_)})),this.updatePayments=this.updater((p,_)=>Object.assign(Object.assign({},p),{payments:p.payments.map(w=>_.find(_e=>_e.id===w.id)||w)})),this.setSearchQuery=this.updater((p,_)=>Object.assign(Object.assign({},p),{searchQuery:_})),this.loadPaymentEffect=this.effect(p=>p.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(_=>this.data.userPayment({paymentId:_}).pipe((0,g._b)(w=>{this.patchState({item:w.data.item,errors:w.errors,loading:!1})},w=>this.patchState({loading:!1,errors:w.graphQLErrors?w.graphQLErrors:w})))))),this.loadPaymentsEffect=this.effect(p=>p.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([_,w])=>this.data.userPayments({input:w}).pipe((0,g._b)(J=>this.patchState({paging:{limit:w.limit,skip:w.skip,total:J.data.count.total},payments:J.data.items,errors:J.errors,loading:!1}),J=>this.patchState({loading:!1,errors:J.graphQLErrors?J.graphQLErrors:J})))))),this.createPaymentEffect=this.effect(p=>p.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(_=>this.paymentService.createPayment(Object.assign({},_)).pipe((0,g._b)(w=>{this.addNewPayment(w),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:w,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},w=>{w.graphQLErrors?(this.toast.error(w.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:w.graphQLErrors?w.graphQLErrors:w})):(this.toast.error(w.Message),this.formService.setErrors(w.Data))}))))),this.updatePaymentEffect=this.effect(p=>p.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([_,w])=>this.paymentService.updatePayment(_,_.id).pipe((0,g._b)(J=>{this.updatePayment(J),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:J,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},J=>{J.graphQLErrors?(this.toast.error(J.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:J.graphQLErrors?J.graphQLErrors:J})):(this.toast.error(J.Message),this.formService.setErrors(J.Data))}))))),this.deletePaymentEffect=this.effect(p=>p.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([_,w])=>this.data.userDeletePayment({paymentId:w.id}).pipe((0,g._b)(J=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:J.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},J=>{J.graphQLErrors?(this.toast.error(J.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:J.graphQLErrors?J.graphQLErrors:J})):(this.toast.error(J.Message),this.formService.setErrors(J.Data))}))))),this.importExcelEffect=this.effect(p=>p.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(_=>this.paymentService.importPayments(_).pipe((0,ce.K)(w=>{var J;return this.toast.error(null!==(J=w.Message)&&void 0!==J?J:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(w=>{const J=JSON.parse(w.created),_e=JSON.parse(w.updated),ve=JSON.parse(w.failed),ae=J.length+_e.length+ve.length;this.addPayments(J),this.updatePayments(_e),this.toast.success(`${J.length} created, ${_e.length} updated, ${ve.length} failed of total ${ae}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("paymentId")?(this.route.snapshot.paramMap.get("paymentId"),this.setFormName("payment_edit")):this.setFormName("payment_create"),this.route.snapshot.paramMap.has("batchControlId")){var c=this.route.snapshot.paramMap.get("batchControlId");this.setBatchControlId(c)}if(this.route.snapshot.paramMap.has("bankId")){var d=this.route.snapshot.paramMap.get("bankId");this.setBankId(d)}if(this.route.snapshot.paramMap.has("payorTypeId")){var n=this.route.snapshot.paramMap.get("payorTypeId");this.setPayorTypeId(n)}if(this.route.snapshot.paramMap.has("paymentTypeId")){var r=this.route.snapshot.paramMap.get("paymentTypeId");this.setPaymentTypeId(r)}if(this.route.snapshot.paramMap.has("paymentApplicationMethodId")){var m=this.route.snapshot.paramMap.get("paymentApplicationMethodId");this.setPaymentApplicationMethodId(m)}}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.paymentService.validatePaymentExcelData(t,i.batchControls,i.banks,i.payorTypes,i.paymentTypes,i.paymentApplicationMethods)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(JV))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function zV(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.payment)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let $d=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"payment_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.payment=i.item})):t.formName&&t.formName.currentValue&&"payment_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadPaymentEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.payment=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(ea),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-payment-form"]],inputs:{payment:"payment",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,zV,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),Gd=(()=>{class s{constructor(){this.autoHeight=!1,this.payments=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[{field:"batchControl.name",headerName:"Batch Control",filter:"agTextColumnFilter"},{field:"bank.name",headerName:"Bank",filter:"agTextColumnFilter"},{field:"payorType.name",headerName:"Payor Type",filter:"agTextColumnFilter"},{field:"paymentType.name",headerName:"Payment Type",filter:"agTextColumnFilter"},{field:"paymentApplicationMethod.name",headerName:"Payment Application Method",filter:"agTextColumnFilter"},{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"paidOn",filter:"agDateColumnFilter"},{field:"name",filter:"agTextColumnFilter"},{field:"batchControlId",filter:"agTextColumnFilter",hide:!0},{field:"bankId",filter:"agTextColumnFilter",hide:!0},{field:"payorTypeId",filter:"agTextColumnFilter",hide:!0},{field:"paymentTypeId",filter:"agTextColumnFilter",hide:!0},{headerName:"Amount",field:"amount",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.amount,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{headerName:"Collected",field:"collected",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.collected,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{headerName:"Dac",field:"dac",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.dac,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{headerName:"Is Partial",field:"isPartial",filter:"agSetColumnFilter",cellRenderer:"checkboxRenderer"},{field:"dateReceived",filter:"agDateColumnFilter"},{field:"memo",filter:"agTextColumnFilter"},{field:"createdBy",filter:"agTextColumnFilter"},{field:"dateCreated",filter:"agDateColumnFilter"},{field:"securitizationGroup",filter:"agTextColumnFilter"},{field:"paymentApplicationMethodId",filter:"agTextColumnFilter",hide:!0}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-payment-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",payments:"payments"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.payments)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function HV(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-payment-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","payment_edit")("formControl",t.formControl)("payment",t.payment)}}const qV=function(){return{}};function KV(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-payment-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","payment_create")("formControl",t.formControl)("payment",e.DdM(3,qV))}}function ZV(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-payment-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("payments",o.data.items)}let kV=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadPaymentsEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.payments$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(ea))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","payment","send","close"],[1,"w-full","h-full","bg-white",3,"payments","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,HV,2,3,"ng-template",null,1,e.W1O),e.YNc(3,KV,1,4,"ng-template",null,2,e.W1O),e.YNc(5,ZV,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,$d,Gd],encapsulation:2}),s})();function BV(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-payment-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","payment_edit")("payment",t.value)}}const YV=function(){return{}};function XV(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-payment-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","payment_create")("payment",e.DdM(2,YV))}function ej(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-payment-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("payments",t.items)}}let tj=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","payment","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","payments","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,BV,1,2,"ng-template",null,1,e.W1O),e.YNc(3,XV,1,3,"ng-template",null,2,e.W1O),e.YNc(5,ej,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,$d,Gd],encapsulation:2}),s})(),ij=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[ea],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"payment-select",component:kV,wrappers:["form-field"]},{name:"payment-grid",component:tj}]})]}),s})(),sj=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[ij]}),s})();class Wi extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class oj extends Wi{constructor(o){super("ValidatePaymentTypeExcelDataAction"),this.valid=!1,this.excelData=o}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name)}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class aj extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class rj extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new aj("name","The paymenttype name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class nj extends Wi{constructor(o){super("CreatePaymentTypeAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new rj("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreatePaymentType({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class lj extends Wi{constructor(o){super("UpdatePaymentTypesAction"),this.paymentTypes=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.paymentTypes,!0))}performAction(){this.response=this.businessProvider.data.userUpdatePaymentTypes({input:{paymentTypes:this.paymentTypes}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class cj extends Wi{constructor(o,t){super("UpdatePaymentTypeAction"),this.paymentType=o,this.paymentTypeId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.paymentType,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.paymentTypeId,!0))}performAction(){this.response=this.businessProvider.data.userUpdatePaymentType({paymentTypeId:this.paymentTypeId,input:this.paymentType}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let Rd=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.PaymentTypeBusinessProviderService",t,a),this.data=i}createPaymentType(t){const i=new nj(t);return i.Do(this),i.response}updatePaymentType(t,i){const a=new cj(t,i);return a.Do(this),a.response}importPaymentTypes(t){const i=new lj(t);return i.Do(this),i.response}validatePaymentTypeExcelData(t){const i=new oj(t);return i.Do(this),i.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),dj=(()=>{class s extends I.nH{constructor(t,i,a){super("PaymentTypeService",a,t),this.businessProvider=i}createPaymentType(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createPaymentType(i)}updatePaymentType(t,i){return this.businessProvider.updatePaymentType(t,i)}importPaymentTypes(t){return this.businessProvider.importPaymentTypes(t)}validatePaymentTypeExcelData(t){return this.businessProvider.validatePaymentTypeExcelData(t)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(Rd,8),e.LFG(Rd),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),ta=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){super({loading:!1,paymentTypes:[],done:!1,searchQuery:"",formName:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.paymentTypeService=H,this.errors$=this.select(c=>c.errors),this.loading$=this.select(c=>c.loading),this.done$=this.select(c=>c.done),this.item$=this.select(c=>c.item),this.paymentTypes$=this.select(c=>c.paymentTypes),this.paging$=this.select(c=>c.paging),this.searchQuery$=this.select(c=>c.searchQuery),this.formName$=this.select(c=>c.formName),this.actionResult$=this.select(this.item$,this.done$,(c,d)=>({item:c,done:d}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.paymentTypes$,(c,d,n,r,m)=>({errors:c,loading:d,item:n,formName:r,paymentTypes:m}),{debounce:!0}),this.input$=this.select(this.paging$,this.searchQuery$,(c,d)=>({limit:c.limit,skip:c.skip,name:d,total:c.total})),this.setFormName=this.updater((c,d)=>Object.assign(Object.assign({},c),{formName:d})),this.setItem=this.updater((c,d)=>Object.assign(Object.assign({},c),{item:d})),this.addNewPaymentType=this.updater((c,d)=>Object.assign(Object.assign({},c),{paymentTypes:[...c.paymentTypes,d]})),this.updatePaymentType=this.updater((c,d)=>Object.assign(Object.assign({},c),{paymentTypes:c.paymentTypes.map(n=>n.id===d.id?d:n)})),this.addPaymentTypes=this.updater((c,d)=>Object.assign(Object.assign({},c),{paymentTypes:c.paymentTypes.concat(d)})),this.updatePaymentTypes=this.updater((c,d)=>Object.assign(Object.assign({},c),{paymentTypes:c.paymentTypes.map(n=>d.find(m=>m.id===n.id)||n)})),this.setSearchQuery=this.updater((c,d)=>Object.assign(Object.assign({},c),{searchQuery:d})),this.loadPaymentTypeEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.data.userPaymentType({paymentTypeId:d}).pipe((0,g._b)(n=>{this.patchState({item:n.data.item,errors:n.errors,loading:!1})},n=>this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})))))),this.loadPaymentTypesEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([d,n])=>this.data.userPaymentTypes({input:n}).pipe((0,g._b)(r=>this.patchState({paging:{limit:n.limit,skip:n.skip,total:r.data.count.total},paymentTypes:r.data.items,errors:r.errors,loading:!1}),r=>this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})))))),this.createPaymentTypeEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.paymentTypeService.createPaymentType(Object.assign({},d)).pipe((0,g._b)(n=>{this.addNewPaymentType(n),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:n,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},n=>{n.graphQLErrors?(this.toast.error(n.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})):(this.toast.error(n.Message),this.formService.setErrors(n.Data))}))))),this.updatePaymentTypeEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.paymentTypeService.updatePaymentType(d,d.id).pipe((0,g._b)(r=>{this.updatePaymentType(r),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:r,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.deletePaymentTypeEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.data.userDeletePaymentType({paymentTypeId:n.id}).pipe((0,g._b)(r=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:r.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.importExcelEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.paymentTypeService.importPaymentTypes(d).pipe((0,ce.K)(n=>{var r;return this.toast.error(null!==(r=n.Message)&&void 0!==r?r:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(n=>{const r=JSON.parse(n.created),m=JSON.parse(n.updated),p=JSON.parse(n.failed),_=r.length+m.length+p.length;this.addPaymentTypes(r),this.updatePaymentTypes(m),this.toast.success(`${r.length} created, ${m.length} updated, ${p.length} failed of total ${_}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("paymentTypeId")?(this.route.snapshot.paramMap.get("paymentTypeId"),this.setFormName("paymentType_edit")):this.setFormName("paymentType_create")}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.paymentTypeService.validatePaymentTypeExcelData(t)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(dj))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function uj(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.paymentType)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let Qd=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"paymentType_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.paymentType=i.item})):t.formName&&t.formName.currentValue&&"paymentType_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadPaymentTypeEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.paymentType=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(ta),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-payment-type-form"]],inputs:{paymentType:"paymentType",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,uj,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),Vd=(()=>{class s{constructor(){this.autoHeight=!1,this.paymentTypes=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[,{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-payment-type-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",paymentTypes:"paymentTypes"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.paymentTypes)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function mj(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-payment-type-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","paymentType_edit")("formControl",t.formControl)("paymentType",t.paymentType)}}const pj=function(){return{}};function hj(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-payment-type-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","paymentType_create")("formControl",t.formControl)("paymentType",e.DdM(3,pj))}}function fj(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-payment-type-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("paymentTypes",o.data.items)}let _j=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadPaymentTypesEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.paymentTypes$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(ta))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","paymentType","send","close"],[1,"w-full","h-full","bg-white",3,"paymentTypes","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,mj,2,3,"ng-template",null,1,e.W1O),e.YNc(3,hj,1,4,"ng-template",null,2,e.W1O),e.YNc(5,fj,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,Qd,Vd],encapsulation:2}),s})();function gj(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-payment-type-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","paymentType_edit")("paymentType",t.value)}}const Cj=function(){return{}};function vj(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-payment-type-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","paymentType_create")("paymentType",e.DdM(2,Cj))}function Sj(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-payment-type-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("paymentTypes",t.items)}}let bj=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","paymentType","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","paymentTypes","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,gj,1,2,"ng-template",null,1,e.W1O),e.YNc(3,vj,1,3,"ng-template",null,2,e.W1O),e.YNc(5,Sj,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,Qd,Vd],encapsulation:2}),s})(),Tj=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[ta],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"payment-type-select",component:_j,wrappers:["form-field"]},{name:"payment-type-grid",component:bj}]})]}),s})(),yj=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[Tj]}),s})();class Ei extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class wj extends Ei{constructor(o){super("ValidatePayorTypeExcelDataAction"),this.valid=!1,this.excelData=o}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name)}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class xj extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class Nj extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new xj("name","The payortype name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class Aj extends Ei{constructor(o){super("CreatePayorTypeAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new Nj("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreatePayorType({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class Fj extends Ei{constructor(o){super("UpdatePayorTypesAction"),this.payorTypes=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.payorTypes,!0))}performAction(){this.response=this.businessProvider.data.userUpdatePayorTypes({input:{payorTypes:this.payorTypes}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class Pj extends Ei{constructor(o,t){super("UpdatePayorTypeAction"),this.payorType=o,this.payorTypeId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.payorType,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.payorTypeId,!0))}performAction(){this.response=this.businessProvider.data.userUpdatePayorType({payorTypeId:this.payorTypeId,input:this.payorType}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let jd=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.PayorTypeBusinessProviderService",t,a),this.data=i}createPayorType(t){const i=new Aj(t);return i.Do(this),i.response}updatePayorType(t,i){const a=new Pj(t,i);return a.Do(this),a.response}importPayorTypes(t){const i=new Fj(t);return i.Do(this),i.response}validatePayorTypeExcelData(t){const i=new wj(t);return i.Do(this),i.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),Ij=(()=>{class s extends I.nH{constructor(t,i,a){super("PayorTypeService",a,t),this.businessProvider=i}createPayorType(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createPayorType(i)}updatePayorType(t,i){return this.businessProvider.updatePayorType(t,i)}importPayorTypes(t){return this.businessProvider.importPayorTypes(t)}validatePayorTypeExcelData(t){return this.businessProvider.validatePayorTypeExcelData(t)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(jd,8),e.LFG(jd),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),ia=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){super({loading:!1,payorTypes:[],done:!1,searchQuery:"",formName:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.payorTypeService=H,this.errors$=this.select(c=>c.errors),this.loading$=this.select(c=>c.loading),this.done$=this.select(c=>c.done),this.item$=this.select(c=>c.item),this.payorTypes$=this.select(c=>c.payorTypes),this.paging$=this.select(c=>c.paging),this.searchQuery$=this.select(c=>c.searchQuery),this.formName$=this.select(c=>c.formName),this.actionResult$=this.select(this.item$,this.done$,(c,d)=>({item:c,done:d}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.payorTypes$,(c,d,n,r,m)=>({errors:c,loading:d,item:n,formName:r,payorTypes:m}),{debounce:!0}),this.input$=this.select(this.paging$,this.searchQuery$,(c,d)=>({limit:c.limit,skip:c.skip,name:d,total:c.total})),this.setFormName=this.updater((c,d)=>Object.assign(Object.assign({},c),{formName:d})),this.setItem=this.updater((c,d)=>Object.assign(Object.assign({},c),{item:d})),this.addNewPayorType=this.updater((c,d)=>Object.assign(Object.assign({},c),{payorTypes:[...c.payorTypes,d]})),this.updatePayorType=this.updater((c,d)=>Object.assign(Object.assign({},c),{payorTypes:c.payorTypes.map(n=>n.id===d.id?d:n)})),this.addPayorTypes=this.updater((c,d)=>Object.assign(Object.assign({},c),{payorTypes:c.payorTypes.concat(d)})),this.updatePayorTypes=this.updater((c,d)=>Object.assign(Object.assign({},c),{payorTypes:c.payorTypes.map(n=>d.find(m=>m.id===n.id)||n)})),this.setSearchQuery=this.updater((c,d)=>Object.assign(Object.assign({},c),{searchQuery:d})),this.loadPayorTypeEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.data.userPayorType({payorTypeId:d}).pipe((0,g._b)(n=>{this.patchState({item:n.data.item,errors:n.errors,loading:!1})},n=>this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})))))),this.loadPayorTypesEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([d,n])=>this.data.userPayorTypes({input:n}).pipe((0,g._b)(r=>this.patchState({paging:{limit:n.limit,skip:n.skip,total:r.data.count.total},payorTypes:r.data.items,errors:r.errors,loading:!1}),r=>this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})))))),this.createPayorTypeEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.payorTypeService.createPayorType(Object.assign({},d)).pipe((0,g._b)(n=>{this.addNewPayorType(n),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:n,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},n=>{n.graphQLErrors?(this.toast.error(n.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})):(this.toast.error(n.Message),this.formService.setErrors(n.Data))}))))),this.updatePayorTypeEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.payorTypeService.updatePayorType(d,d.id).pipe((0,g._b)(r=>{this.updatePayorType(r),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:r,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.deletePayorTypeEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.data.userDeletePayorType({payorTypeId:n.id}).pipe((0,g._b)(r=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:r.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.importExcelEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.payorTypeService.importPayorTypes(d).pipe((0,ce.K)(n=>{var r;return this.toast.error(null!==(r=n.Message)&&void 0!==r?r:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(n=>{const r=JSON.parse(n.created),m=JSON.parse(n.updated),p=JSON.parse(n.failed),_=r.length+m.length+p.length;this.addPayorTypes(r),this.updatePayorTypes(m),this.toast.success(`${r.length} created, ${m.length} updated, ${p.length} failed of total ${_}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("payorTypeId")?(this.route.snapshot.paramMap.get("payorTypeId"),this.setFormName("payorType_edit")):this.setFormName("payorType_create")}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.payorTypeService.validatePayorTypeExcelData(t)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(Ij))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function Dj(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.payorType)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let Ud=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"payorType_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.payorType=i.item})):t.formName&&t.formName.currentValue&&"payorType_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadPayorTypeEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.payorType=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(ia),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-payor-type-form"]],inputs:{payorType:"payorType",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,Dj,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),Jd=(()=>{class s{constructor(){this.autoHeight=!1,this.payorTypes=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[,{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-payor-type-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",payorTypes:"payorTypes"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.payorTypes)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function Mj(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-payor-type-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","payorType_edit")("formControl",t.formControl)("payorType",t.payorType)}}const Wj=function(){return{}};function Ej(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-payor-type-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","payorType_create")("formControl",t.formControl)("payorType",e.DdM(3,Wj))}}function Oj(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-payor-type-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("payorTypes",o.data.items)}let Lj=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadPayorTypesEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.payorTypes$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(ia))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","payorType","send","close"],[1,"w-full","h-full","bg-white",3,"payorTypes","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,Mj,2,3,"ng-template",null,1,e.W1O),e.YNc(3,Ej,1,4,"ng-template",null,2,e.W1O),e.YNc(5,Oj,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,Ud,Jd],encapsulation:2}),s})();function $j(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-payor-type-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","payorType_edit")("payorType",t.value)}}const Gj=function(){return{}};function Rj(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-payor-type-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","payorType_create")("payorType",e.DdM(2,Gj))}function Qj(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-payor-type-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("payorTypes",t.items)}}let Vj=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","payorType","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","payorTypes","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,$j,1,2,"ng-template",null,1,e.W1O),e.YNc(3,Rj,1,3,"ng-template",null,2,e.W1O),e.YNc(5,Qj,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,Ud,Jd],encapsulation:2}),s})(),jj=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[ia],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"payor-type-select",component:Lj,wrappers:["form-field"]},{name:"payor-type-grid",component:Vj}]})]}),s})(),Uj=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[jj]}),s})();class Oi extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class Jj extends Oi{constructor(o,t){super("ValidatePchProviderExcelDataAction"),this.valid=!1,this.excelData=o,this.clinicalProviders=t}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name),this.validationContext.addRule(new f.mi(`clinicalProviderName_${i}_is_valid}`,"Clinical Provider Is Not Valid","clinicalProvider.name",t.clinicalProvider,this.clinicalProviders,!0))}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class zj extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class Hj extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new zj("name","The pchprovider name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class qj extends Oi{constructor(o){super("CreatePchProviderAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new Hj("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreatePchProvider({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class Kj extends Oi{constructor(o){super("UpdatePchProvidersAction"),this.pchProviders=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.pchProviders,!0))}performAction(){this.response=this.businessProvider.data.userUpdatePchProviders({input:{pchProviders:this.pchProviders}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class Zj extends Oi{constructor(o,t){super("UpdatePchProviderAction"),this.pchProvider=o,this.pchProviderId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.pchProvider,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.pchProviderId,!0))}performAction(){this.response=this.businessProvider.data.userUpdatePchProvider({pchProviderId:this.pchProviderId,input:this.pchProvider}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let zd=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.PchProviderBusinessProviderService",t,a),this.data=i}createPchProvider(t){const i=new qj(t);return i.Do(this),i.response}updatePchProvider(t,i){const a=new Zj(t,i);return a.Do(this),a.response}importPchProviders(t){const i=new Kj(t);return i.Do(this),i.response}validatePchProviderExcelData(t,i){const a=new Jj(t,i);return a.Do(this),a.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),kj=(()=>{class s extends I.nH{constructor(t,i,a){super("PchProviderService",a,t),this.businessProvider=i}createPchProvider(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createPchProvider(i)}updatePchProvider(t,i){return this.businessProvider.updatePchProvider(t,i)}importPchProviders(t){return this.businessProvider.importPchProviders(t)}validatePchProviderExcelData(t,i){return this.businessProvider.validatePchProviderExcelData(t,i)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(zd,8),e.LFG(zd),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),sa=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){if(super({loading:!1,pchProviders:[],done:!1,searchQuery:"",formName:void 0,clinicalProviderId:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.pchProviderService=H,this.errors$=this.select(d=>d.errors),this.loading$=this.select(d=>d.loading),this.done$=this.select(d=>d.done),this.item$=this.select(d=>d.item),this.pchProviders$=this.select(d=>d.pchProviders),this.clinicalProviders$=this.select(d=>d.clinicalProviders||[]),this.clinicalProviderId$=this.select(d=>d.clinicalProviderId),this.paging$=this.select(d=>d.paging),this.searchQuery$=this.select(d=>d.searchQuery),this.formName$=this.select(d=>d.formName),this.actionResult$=this.select(this.item$,this.done$,(d,n)=>({item:d,done:n}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.pchProviders$,this.clinicalProviders$,(d,n,r,m,p,_)=>({errors:d,loading:n,item:r,formName:m,pchProviders:p,clinicalProviders:_}),{debounce:!0}),this.input$=this.select(this.paging$,this.clinicalProviderId$,this.searchQuery$,(d,n,r)=>({limit:d.limit,skip:d.skip,name:r,clinicalProviderId:n,total:d.total})),this.setFormName=this.updater((d,n)=>Object.assign(Object.assign({},d),{formName:n})),this.setClinicalProviderId=this.updater((d,n)=>Object.assign(Object.assign({},d),{clinicalProviderId:n})),this.filterClinicalProviders=d=>this.data.userSelectClinicalProviders({input:{name:d}}).pipe((0,g._b)(n=>{let r=n.data.items;return this.patchState({clinicalProviders:r}),r},n=>this.patchState({errors:n.graphQLErrors?n.graphQLErrors:n})),(0,he.U)(n=>n.data.items)),this.addClinicalProvider=this.updater((d,n)=>Object.assign(Object.assign({},d),{clinicalProviders:d.clinicalProviders.concat(n)})),this.setItem=this.updater((d,n)=>Object.assign(Object.assign({},d),{item:n})),this.addNewPchProvider=this.updater((d,n)=>Object.assign(Object.assign({},d),{pchProviders:[...d.pchProviders,n]})),this.updatePchProvider=this.updater((d,n)=>Object.assign(Object.assign({},d),{pchProviders:d.pchProviders.map(r=>r.id===n.id?n:r)})),this.addPchProviders=this.updater((d,n)=>Object.assign(Object.assign({},d),{pchProviders:d.pchProviders.concat(n)})),this.updatePchProviders=this.updater((d,n)=>Object.assign(Object.assign({},d),{pchProviders:d.pchProviders.map(r=>n.find(p=>p.id===r.id)||r)})),this.setSearchQuery=this.updater((d,n)=>Object.assign(Object.assign({},d),{searchQuery:n})),this.loadPchProviderEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(n=>this.data.userPchProvider({pchProviderId:n}).pipe((0,g._b)(r=>{this.patchState({item:r.data.item,errors:r.errors,loading:!1})},r=>this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})))))),this.loadPchProvidersEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([n,r])=>this.data.userPchProviders({input:r}).pipe((0,g._b)(m=>this.patchState({paging:{limit:r.limit,skip:r.skip,total:m.data.count.total},pchProviders:m.data.items,errors:m.errors,loading:!1}),m=>this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})))))),this.createPchProviderEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(n=>this.pchProviderService.createPchProvider(Object.assign({},n)).pipe((0,g._b)(r=>{this.addNewPchProvider(r),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:r,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.updatePchProviderEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([n,r])=>this.pchProviderService.updatePchProvider(n,n.id).pipe((0,g._b)(m=>{this.updatePchProvider(m),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:m,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},m=>{m.graphQLErrors?(this.toast.error(m.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})):(this.toast.error(m.Message),this.formService.setErrors(m.Data))}))))),this.deletePchProviderEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([n,r])=>this.data.userDeletePchProvider({pchProviderId:r.id}).pipe((0,g._b)(m=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:m.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},m=>{m.graphQLErrors?(this.toast.error(m.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})):(this.toast.error(m.Message),this.formService.setErrors(m.Data))}))))),this.importExcelEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(n=>this.pchProviderService.importPchProviders(n).pipe((0,ce.K)(r=>{var m;return this.toast.error(null!==(m=r.Message)&&void 0!==m?m:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(r=>{const m=JSON.parse(r.created),p=JSON.parse(r.updated),_=JSON.parse(r.failed),w=m.length+p.length+_.length;this.addPchProviders(m),this.updatePchProviders(p),this.toast.success(`${m.length} created, ${p.length} updated, ${_.length} failed of total ${w}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("pchProviderId")?(this.route.snapshot.paramMap.get("pchProviderId"),this.setFormName("pchProvider_edit")):this.setFormName("pchProvider_create"),this.route.snapshot.paramMap.has("clinicalProviderId")){var c=this.route.snapshot.paramMap.get("clinicalProviderId");this.setClinicalProviderId(c)}}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.pchProviderService.validatePchProviderExcelData(t,i.clinicalProviders)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(kj))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function Bj(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.pchProvider)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let Hd=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"pchProvider_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.pchProvider=i.item})):t.formName&&t.formName.currentValue&&"pchProvider_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadPchProviderEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.pchProvider=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(sa),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-pch-provider-form"]],inputs:{pchProvider:"pchProvider",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,Bj,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),qd=(()=>{class s{constructor(){this.autoHeight=!1,this.pchProviders=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[{field:"clinicalProvider.name",headerName:"Clinical Provider",filter:"agTextColumnFilter"},{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{field:"clinicalProviderId",filter:"agTextColumnFilter",hide:!0}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-pch-provider-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",pchProviders:"pchProviders"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.pchProviders)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function Yj(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-pch-provider-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","pchProvider_edit")("formControl",t.formControl)("pchProvider",t.pchProvider)}}const Xj=function(){return{}};function eU(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-pch-provider-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","pchProvider_create")("formControl",t.formControl)("pchProvider",e.DdM(3,Xj))}}function tU(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-pch-provider-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("pchProviders",o.data.items)}let iU=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadPchProvidersEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.pchProviders$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(sa))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","pchProvider","send","close"],[1,"w-full","h-full","bg-white",3,"pchProviders","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,Yj,2,3,"ng-template",null,1,e.W1O),e.YNc(3,eU,1,4,"ng-template",null,2,e.W1O),e.YNc(5,tU,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,Hd,qd],encapsulation:2}),s})();function sU(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-pch-provider-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","pchProvider_edit")("pchProvider",t.value)}}const oU=function(){return{}};function aU(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-pch-provider-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","pchProvider_create")("pchProvider",e.DdM(2,oU))}function rU(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-pch-provider-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("pchProviders",t.items)}}let nU=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","pchProvider","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","pchProviders","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,sU,1,2,"ng-template",null,1,e.W1O),e.YNc(3,aU,1,3,"ng-template",null,2,e.W1O),e.YNc(5,rU,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,Hd,qd],encapsulation:2}),s})(),lU=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[sa],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"pch-provider-select",component:iU,wrappers:["form-field"]},{name:"pch-provider-grid",component:nU}]})]}),s})(),cU=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[lU]}),s})();class Li extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class dU extends Li{constructor(o){super("ValidatePlaceOfServiceExcelDataAction"),this.valid=!1,this.excelData=o}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name)}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class uU extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class mU extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new uU("name","The placeofservice name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class pU extends Li{constructor(o){super("CreatePlaceOfServiceAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new mU("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreatePlaceOfService({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class hU extends Li{constructor(o){super("UpdatePlaceOfServicesAction"),this.placeOfServices=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.placeOfServices,!0))}performAction(){this.response=this.businessProvider.data.userUpdatePlaceOfServices({input:{placeOfServices:this.placeOfServices}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class fU extends Li{constructor(o,t){super("UpdatePlaceOfServiceAction"),this.placeOfService=o,this.placeOfServiceId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.placeOfService,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.placeOfServiceId,!0))}performAction(){this.response=this.businessProvider.data.userUpdatePlaceOfService({placeOfServiceId:this.placeOfServiceId,input:this.placeOfService}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let Kd=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.PlaceOfServiceBusinessProviderService",t,a),this.data=i}createPlaceOfService(t){const i=new pU(t);return i.Do(this),i.response}updatePlaceOfService(t,i){const a=new fU(t,i);return a.Do(this),a.response}importPlaceOfServices(t){const i=new hU(t);return i.Do(this),i.response}validatePlaceOfServiceExcelData(t){const i=new dU(t);return i.Do(this),i.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),_U=(()=>{class s extends I.nH{constructor(t,i,a){super("PlaceOfServiceService",a,t),this.businessProvider=i}createPlaceOfService(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createPlaceOfService(i)}updatePlaceOfService(t,i){return this.businessProvider.updatePlaceOfService(t,i)}importPlaceOfServices(t){return this.businessProvider.importPlaceOfServices(t)}validatePlaceOfServiceExcelData(t){return this.businessProvider.validatePlaceOfServiceExcelData(t)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(Kd,8),e.LFG(Kd),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),oa=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){super({loading:!1,placeOfServices:[],done:!1,searchQuery:"",formName:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.placeOfServiceService=H,this.errors$=this.select(c=>c.errors),this.loading$=this.select(c=>c.loading),this.done$=this.select(c=>c.done),this.item$=this.select(c=>c.item),this.placeOfServices$=this.select(c=>c.placeOfServices),this.paging$=this.select(c=>c.paging),this.searchQuery$=this.select(c=>c.searchQuery),this.formName$=this.select(c=>c.formName),this.actionResult$=this.select(this.item$,this.done$,(c,d)=>({item:c,done:d}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.placeOfServices$,(c,d,n,r,m)=>({errors:c,loading:d,item:n,formName:r,placeOfServices:m}),{debounce:!0}),this.input$=this.select(this.paging$,this.searchQuery$,(c,d)=>({limit:c.limit,skip:c.skip,name:d,total:c.total})),this.setFormName=this.updater((c,d)=>Object.assign(Object.assign({},c),{formName:d})),this.setItem=this.updater((c,d)=>Object.assign(Object.assign({},c),{item:d})),this.addNewPlaceOfService=this.updater((c,d)=>Object.assign(Object.assign({},c),{placeOfServices:[...c.placeOfServices,d]})),this.updatePlaceOfService=this.updater((c,d)=>Object.assign(Object.assign({},c),{placeOfServices:c.placeOfServices.map(n=>n.id===d.id?d:n)})),this.addPlaceOfServices=this.updater((c,d)=>Object.assign(Object.assign({},c),{placeOfServices:c.placeOfServices.concat(d)})),this.updatePlaceOfServices=this.updater((c,d)=>Object.assign(Object.assign({},c),{placeOfServices:c.placeOfServices.map(n=>d.find(m=>m.id===n.id)||n)})),this.setSearchQuery=this.updater((c,d)=>Object.assign(Object.assign({},c),{searchQuery:d})),this.loadPlaceOfServiceEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.data.userPlaceOfService({placeOfServiceId:d}).pipe((0,g._b)(n=>{this.patchState({item:n.data.item,errors:n.errors,loading:!1})},n=>this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})))))),this.loadPlaceOfServicesEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([d,n])=>this.data.userPlaceOfServices({input:n}).pipe((0,g._b)(r=>this.patchState({paging:{limit:n.limit,skip:n.skip,total:r.data.count.total},placeOfServices:r.data.items,errors:r.errors,loading:!1}),r=>this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})))))),this.createPlaceOfServiceEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.placeOfServiceService.createPlaceOfService(Object.assign({},d)).pipe((0,g._b)(n=>{this.addNewPlaceOfService(n),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:n,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},n=>{n.graphQLErrors?(this.toast.error(n.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})):(this.toast.error(n.Message),this.formService.setErrors(n.Data))}))))),this.updatePlaceOfServiceEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.placeOfServiceService.updatePlaceOfService(d,d.id).pipe((0,g._b)(r=>{this.updatePlaceOfService(r),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:r,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.deletePlaceOfServiceEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.data.userDeletePlaceOfService({placeOfServiceId:n.id}).pipe((0,g._b)(r=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:r.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.importExcelEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.placeOfServiceService.importPlaceOfServices(d).pipe((0,ce.K)(n=>{var r;return this.toast.error(null!==(r=n.Message)&&void 0!==r?r:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(n=>{const r=JSON.parse(n.created),m=JSON.parse(n.updated),p=JSON.parse(n.failed),_=r.length+m.length+p.length;this.addPlaceOfServices(r),this.updatePlaceOfServices(m),this.toast.success(`${r.length} created, ${m.length} updated, ${p.length} failed of total ${_}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("placeOfServiceId")?(this.route.snapshot.paramMap.get("placeOfServiceId"),this.setFormName("placeOfService_edit")):this.setFormName("placeOfService_create")}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.placeOfServiceService.validatePlaceOfServiceExcelData(t)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(_U))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function gU(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.placeOfService)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let Zd=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"placeOfService_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({id:null,name:""}),this.store.vm$.subscribe(i=>{this.placeOfService=i.item})):t.formName&&t.formName.currentValue&&"placeOfService_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadPlaceOfServiceEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.placeOfService=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(oa),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-place-of-service-form"]],inputs:{placeOfService:"placeOfService",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,gU,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),kd=(()=>{class s{constructor(){this.autoHeight=!1,this.placeOfServices=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[,{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{headerName:"Is Facility",field:"isFacility",filter:"agSetColumnFilter",cellRenderer:"checkboxRenderer"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-place-of-service-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",placeOfServices:"placeOfServices"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.placeOfServices)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function CU(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-place-of-service-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","placeOfService_edit")("formControl",t.formControl)("placeOfService",t.placeOfService)}}const vU=function(){return{}};function SU(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-place-of-service-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","placeOfService_create")("formControl",t.formControl)("placeOfService",e.DdM(3,vU))}}function bU(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-place-of-service-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("placeOfServices",o.data.items)}let TU=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadPlaceOfServicesEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.placeOfServices$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(oa))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","placeOfService","send","close"],[1,"w-full","h-full","bg-white",3,"placeOfServices","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,CU,2,3,"ng-template",null,1,e.W1O),e.YNc(3,SU,1,4,"ng-template",null,2,e.W1O),e.YNc(5,bU,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,Zd,kd],encapsulation:2}),s})();function yU(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-place-of-service-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","placeOfService_edit")("placeOfService",t.value)}}const wU=function(){return{}};function xU(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-place-of-service-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","placeOfService_create")("placeOfService",e.DdM(2,wU))}function NU(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-place-of-service-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("placeOfServices",t.items)}}let AU=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","placeOfService","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","placeOfServices","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,yU,1,2,"ng-template",null,1,e.W1O),e.YNc(3,xU,1,3,"ng-template",null,2,e.W1O),e.YNc(5,NU,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,Zd,kd],encapsulation:2}),s})(),FU=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[oa],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"place-of-service-select",component:TU,wrappers:["form-field"]},{name:"place-of-service-grid",component:AU}]})]}),s})(),PU=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[FU]}),s})();class $i extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class IU extends $i{constructor(o){super("ValidatePortfolioExcelDataAction"),this.valid=!1,this.excelData=o}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name)}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class DU extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class MU extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new DU("name","The portfolio name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class WU extends $i{constructor(o){super("CreatePortfolioAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new MU("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreatePortfolio({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class EU extends $i{constructor(o){super("UpdatePortfoliosAction"),this.portfolios=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.portfolios,!0))}performAction(){this.response=this.businessProvider.data.userUpdatePortfolios({input:{portfolios:this.portfolios}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class OU extends $i{constructor(o,t){super("UpdatePortfolioAction"),this.portfolio=o,this.portfolioId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.portfolio,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.portfolioId,!0))}performAction(){this.response=this.businessProvider.data.userUpdatePortfolio({portfolioId:this.portfolioId,input:this.portfolio}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let Bd=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.PortfolioBusinessProviderService",t,a),this.data=i}createPortfolio(t){const i=new WU(t);return i.Do(this),i.response}updatePortfolio(t,i){const a=new OU(t,i);return a.Do(this),a.response}importPortfolios(t){const i=new EU(t);return i.Do(this),i.response}validatePortfolioExcelData(t){const i=new IU(t);return i.Do(this),i.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),LU=(()=>{class s extends I.nH{constructor(t,i,a){super("PortfolioService",a,t),this.businessProvider=i}createPortfolio(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createPortfolio(i)}updatePortfolio(t,i){return this.businessProvider.updatePortfolio(t,i)}importPortfolios(t){return this.businessProvider.importPortfolios(t)}validatePortfolioExcelData(t){return this.businessProvider.validatePortfolioExcelData(t)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(Bd,8),e.LFG(Bd),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),aa=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){super({loading:!1,portfolios:[],done:!1,searchQuery:"",formName:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.portfolioService=H,this.errors$=this.select(c=>c.errors),this.loading$=this.select(c=>c.loading),this.done$=this.select(c=>c.done),this.item$=this.select(c=>c.item),this.portfolios$=this.select(c=>c.portfolios),this.paging$=this.select(c=>c.paging),this.searchQuery$=this.select(c=>c.searchQuery),this.formName$=this.select(c=>c.formName),this.actionResult$=this.select(this.item$,this.done$,(c,d)=>({item:c,done:d}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.portfolios$,(c,d,n,r,m)=>({errors:c,loading:d,item:n,formName:r,portfolios:m}),{debounce:!0}),this.input$=this.select(this.paging$,this.searchQuery$,(c,d)=>({limit:c.limit,skip:c.skip,name:d,total:c.total})),this.setFormName=this.updater((c,d)=>Object.assign(Object.assign({},c),{formName:d})),this.setItem=this.updater((c,d)=>Object.assign(Object.assign({},c),{item:d})),this.addNewPortfolio=this.updater((c,d)=>Object.assign(Object.assign({},c),{portfolios:[...c.portfolios,d]})),this.updatePortfolio=this.updater((c,d)=>Object.assign(Object.assign({},c),{portfolios:c.portfolios.map(n=>n.id===d.id?d:n)})),this.addPortfolios=this.updater((c,d)=>Object.assign(Object.assign({},c),{portfolios:c.portfolios.concat(d)})),this.updatePortfolios=this.updater((c,d)=>Object.assign(Object.assign({},c),{portfolios:c.portfolios.map(n=>d.find(m=>m.id===n.id)||n)})),this.setSearchQuery=this.updater((c,d)=>Object.assign(Object.assign({},c),{searchQuery:d})),this.loadPortfolioEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.data.userPortfolio({portfolioId:d}).pipe((0,g._b)(n=>{this.patchState({item:n.data.item,errors:n.errors,loading:!1})},n=>this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})))))),this.loadPortfoliosEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([d,n])=>this.data.userPortfolios({input:n}).pipe((0,g._b)(r=>this.patchState({paging:{limit:n.limit,skip:n.skip,total:r.data.count.total},portfolios:r.data.items,errors:r.errors,loading:!1}),r=>this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})))))),this.createPortfolioEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.portfolioService.createPortfolio(Object.assign({},d)).pipe((0,g._b)(n=>{this.addNewPortfolio(n),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:n,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},n=>{n.graphQLErrors?(this.toast.error(n.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})):(this.toast.error(n.Message),this.formService.setErrors(n.Data))}))))),this.updatePortfolioEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.portfolioService.updatePortfolio(d,d.id).pipe((0,g._b)(r=>{this.updatePortfolio(r),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:r,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.deletePortfolioEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.data.userDeletePortfolio({portfolioId:n.id}).pipe((0,g._b)(r=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:r.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.importExcelEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.portfolioService.importPortfolios(d).pipe((0,ce.K)(n=>{var r;return this.toast.error(null!==(r=n.Message)&&void 0!==r?r:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(n=>{const r=JSON.parse(n.created),m=JSON.parse(n.updated),p=JSON.parse(n.failed),_=r.length+m.length+p.length;this.addPortfolios(r),this.updatePortfolios(m),this.toast.success(`${r.length} created, ${m.length} updated, ${p.length} failed of total ${_}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("portfolioId")?(this.route.snapshot.paramMap.get("portfolioId"),this.setFormName("portfolio_edit")):this.setFormName("portfolio_create")}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.portfolioService.validatePortfolioExcelData(t)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(LU))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function $U(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.portfolio)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let Yd=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"portfolio_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.portfolio=i.item})):t.formName&&t.formName.currentValue&&"portfolio_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadPortfolioEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.portfolio=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(aa),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-portfolio-form"]],inputs:{portfolio:"portfolio",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,$U,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),Xd=(()=>{class s{constructor(){this.autoHeight=!1,this.portfolios=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[,{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-portfolio-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",portfolios:"portfolios"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.portfolios)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function GU(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-portfolio-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","portfolio_edit")("formControl",t.formControl)("portfolio",t.portfolio)}}const RU=function(){return{}};function QU(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-portfolio-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","portfolio_create")("formControl",t.formControl)("portfolio",e.DdM(3,RU))}}function VU(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-portfolio-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("portfolios",o.data.items)}let jU=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadPortfoliosEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.portfolios$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(aa))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","portfolio","send","close"],[1,"w-full","h-full","bg-white",3,"portfolios","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,GU,2,3,"ng-template",null,1,e.W1O),e.YNc(3,QU,1,4,"ng-template",null,2,e.W1O),e.YNc(5,VU,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,Yd,Xd],encapsulation:2}),s})();function UU(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-portfolio-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","portfolio_edit")("portfolio",t.value)}}const JU=function(){return{}};function zU(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-portfolio-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","portfolio_create")("portfolio",e.DdM(2,JU))}function HU(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-portfolio-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("portfolios",t.items)}}let qU=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","portfolio","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","portfolios","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,UU,1,2,"ng-template",null,1,e.W1O),e.YNc(3,zU,1,3,"ng-template",null,2,e.W1O),e.YNc(5,HU,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,Yd,Xd],encapsulation:2}),s})(),KU=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[aa],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"portfolio-select",component:jU,wrappers:["form-field"]},{name:"portfolio-grid",component:qU}]})]}),s})(),ZU=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[KU]}),s})();var eu=Q(15439);class Gi extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class kU extends Gi{constructor(o,t,i){super("ValidatePrescriptionExcelDataAction"),this.valid=!1,this.excelData=o,this.patients=t,this.documents=i}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name),this.validationContext.addRule(new f.mi(`patientName_${i}_is_valid}`,"Patient Is Not Valid","patient.name",t.patient,this.patients,!0)),this.validationContext.addRule(new f.mi(`documentName_${i}_is_valid}`,"Document Is Not Valid","document.name",t.document,this.documents,!0))}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class BU extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class YU extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new BU("name","The prescription name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class XU extends Gi{constructor(o){super("CreatePrescriptionAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new YU("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreatePrescription({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class e6 extends Gi{constructor(o){super("UpdatePrescriptionsAction"),this.prescriptions=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.prescriptions,!0))}performAction(){this.response=this.businessProvider.data.userUpdatePrescriptions({input:{prescriptions:this.prescriptions}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class t6 extends Gi{constructor(o,t){super("UpdatePrescriptionAction"),this.prescription=o,this.prescriptionId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.prescription,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.prescriptionId,!0))}performAction(){this.response=this.businessProvider.data.userUpdatePrescription({prescriptionId:this.prescriptionId,input:this.prescription}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let tu=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.PrescriptionBusinessProviderService",t,a),this.data=i}createPrescription(t){const i=new XU(t);return i.Do(this),i.response}updatePrescription(t,i){const a=new t6(t,i);return a.Do(this),a.response}importPrescriptions(t){const i=new e6(t);return i.Do(this),i.response}validatePrescriptionExcelData(t,i,a){const l=new kU(t,i,a);return l.Do(this),l.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),i6=(()=>{class s extends I.nH{constructor(t,i,a){super("PrescriptionService",a,t),this.businessProvider=i}createPrescription(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createPrescription(i)}updatePrescription(t,i){return this.businessProvider.updatePrescription(t,i)}importPrescriptions(t){return this.businessProvider.importPrescriptions(t)}validatePrescriptionExcelData(t,i,a){return this.businessProvider.validatePrescriptionExcelData(t,i,a)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(tu,8),e.LFG(tu),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),ra=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){if(super({loading:!1,prescriptions:[],done:!1,searchQuery:"",formName:void 0,patientId:void 0,documentId:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.prescriptionService=H,this.errors$=this.select(A=>A.errors),this.loading$=this.select(A=>A.loading),this.done$=this.select(A=>A.done),this.item$=this.select(A=>A.item),this.prescriptions$=this.select(A=>{const c=A.prescriptions;return console.log("-----------------"),c.sort((d,n)=>eu(d.createdAt).isBefore(eu(n.createdAt))?1:-1),c}),this.patients$=this.select(A=>A.patients||[]),this.documents$=this.select(A=>A.documents||[]),this.patientId$=this.select(A=>A.patientId),this.documentId$=this.select(A=>A.documentId),this.paging$=this.select(A=>A.paging),this.searchQuery$=this.select(A=>A.searchQuery),this.formName$=this.select(A=>A.formName),this.actionResult$=this.select(this.item$,this.done$,(A,c)=>({item:A,done:c}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.prescriptions$,this.patients$,this.documents$,(A,c,d,n,r,m,p)=>({errors:A,loading:c,item:d,formName:n,prescriptions:r,patients:m,documents:p}),{debounce:!0}),this.input$=this.select(this.paging$,this.patientId$,this.documentId$,this.searchQuery$,(A,c,d,n)=>({limit:A.limit,skip:A.skip,name:n,patientId:c,documentId:d,total:A.total})),this.setFormName=this.updater((A,c)=>Object.assign(Object.assign({},A),{formName:c})),this.setPatientId=this.updater((A,c)=>Object.assign(Object.assign({},A),{patientId:c})),this.setDocumentId=this.updater((A,c)=>Object.assign(Object.assign({},A),{documentId:c})),this.setSkip=this.updater((A,c)=>Object.assign(Object.assign({},A),{paging:Object.assign(Object.assign({},A.paging),{skip:c})})),this.setLimit=this.updater((A,c)=>Object.assign(Object.assign({},A),{paging:Object.assign(Object.assign({},A.paging),{limit:c})})),this.filterPatients=A=>this.data.userSelectPatients({input:{name:A}}).pipe((0,g._b)(c=>{const d=c.data.items;return this.patchState({patients:d}),d},c=>this.patchState({errors:c.graphQLErrors?c.graphQLErrors:c})),(0,he.U)(c=>c.data.items)),this.filterDocuments=A=>this.data.userSelectDocuments({input:{name:A}}).pipe((0,g._b)(c=>{const d=c.data.items;return this.patchState({documents:d}),d},c=>this.patchState({errors:c.graphQLErrors?c.graphQLErrors:c})),(0,he.U)(c=>c.data.items)),this.addPatient=this.updater((A,c)=>Object.assign(Object.assign({},A),{patients:A.patients.concat(c)})),this.addDocument=this.updater((A,c)=>Object.assign(Object.assign({},A),{documents:A.documents.concat(c)})),this.setItem=this.updater((A,c)=>Object.assign(Object.assign({},A),{item:c})),this.addNewPrescription=this.updater((A,c)=>Object.assign(Object.assign({},A),{prescriptions:[...A.prescriptions,c]})),this.updatePrescription=this.updater((A,c)=>Object.assign(Object.assign({},A),{prescriptions:A.prescriptions.map(d=>d.id===c.id?c:d)})),this.addPrescriptions=this.updater((A,c)=>Object.assign(Object.assign({},A),{prescriptions:A.prescriptions.concat(c)})),this.updatePrescriptions=this.updater((A,c)=>Object.assign(Object.assign({},A),{prescriptions:A.prescriptions.map(d=>c.find(r=>r.id===d.id)||d)})),this.setSearchQuery=this.updater((A,c)=>Object.assign(Object.assign({},A),{searchQuery:c})),this.loadPrescriptionEffect=this.effect(A=>A.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(c=>this.data.userPrescription({prescriptionId:c}).pipe((0,g._b)(d=>{this.patchState({item:d.data.item,errors:d.errors,loading:!1})},d=>this.patchState({loading:!1,errors:d.graphQLErrors?d.graphQLErrors:d})))))),this.loadPrescriptionsEffect=this.effect(A=>A.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([c,d])=>this.data.userPrescriptions({input:d}).pipe((0,g._b)(n=>this.patchState({paging:{limit:d.limit,skip:d.skip,total:n.data.count.total},prescriptions:n.data.items,errors:n.errors,loading:!1}),n=>this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})))))),this.createPrescriptionEffect=this.effect(A=>A.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(c=>this.prescriptionService.createPrescription(Object.assign({},c)).pipe((0,g._b)(d=>{this.addNewPrescription(d),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:d,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},d=>{d.graphQLErrors?(this.toast.error(d.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:d.graphQLErrors?d.graphQLErrors:d})):(this.toast.error(d.Message),this.formService.setErrors(d.Data))}))))),this.updatePrescriptionEffect=this.effect(A=>A.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([c,d])=>this.prescriptionService.updatePrescription(c,c.id).pipe((0,g._b)(n=>{this.updatePrescription(n),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:n,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},n=>{n.graphQLErrors?(this.toast.error(n.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})):(this.toast.error(n.Message),this.formService.setErrors(n.Data))}))))),this.deletePrescriptionEffect=this.effect(A=>A.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([c,d])=>this.data.userDeletePrescription({prescriptionId:d.id}).pipe((0,g._b)(n=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:n.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},n=>{n.graphQLErrors?(this.toast.error(n.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})):(this.toast.error(n.Message),this.formService.setErrors(n.Data))}))))),this.importExcelEffect=this.effect(A=>A.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(c=>this.prescriptionService.importPrescriptions(c).pipe((0,ce.K)(d=>{var n;return this.toast.error(null!==(n=d.Message)&&void 0!==n?n:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(d=>{const n=JSON.parse(d.created),r=JSON.parse(d.updated),m=JSON.parse(d.failed),p=n.length+r.length+m.length;this.addPrescriptions(n),this.updatePrescriptions(r),this.toast.success(`${n.length} created, ${r.length} updated, ${m.length} failed of total ${p}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("prescriptionId")?(this.route.snapshot.paramMap.get("prescriptionId"),this.setFormName("prescription_edit")):this.setFormName("prescription_create"),this.route.snapshot.paramMap.has("patientId")){const A=this.route.snapshot.paramMap.get("patientId");this.setPatientId(A)}if(this.route.snapshot.paramMap.has("documentId")){const A=this.route.snapshot.paramMap.get("documentId");this.setDocumentId(A)}}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.prescriptionService.validatePrescriptionExcelData(t,i.patients,i.documents)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(i6))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function s6(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.prescription)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let iu=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"prescription_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.prescription=i.item})):t.formName&&t.formName.currentValue&&"prescription_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadPrescriptionEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.prescription=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(ra),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-prescription-form"]],inputs:{prescription:"prescription",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,s6,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),su=(()=>{class s{constructor(){this.autoHeight=!1,this.prescriptions=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[{field:"patient.name",headerName:"Patient",filter:"agTextColumnFilter"},{field:"document.name",headerName:"Document",filter:"agTextColumnFilter"},{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{field:"medicalProvider",filter:"agTextColumnFilter"},{field:"dateWritten",filter:"agDateColumnFilter"},{field:"days",filter:"agTextColumnFilter"},{field:"note",filter:"agTextColumnFilter"},{field:"category",filter:"agTextColumnFilter"},{field:"kind",filter:"agTextColumnFilter"},{headerName:"Quantity",field:"quantity",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.quantity,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{field:"refills",filter:"agTextColumnFilter"},{field:"rxNumber",filter:"agTextColumnFilter"},{field:"sig",filter:"agTextColumnFilter"},{field:"strength",filter:"agTextColumnFilter"},{field:"unit",filter:"agTextColumnFilter"},{field:"patientId",filter:"agTextColumnFilter",hide:!0},{field:"documentId",filter:"agTextColumnFilter",hide:!0}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-prescription-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",prescriptions:"prescriptions"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.prescriptions)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function o6(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-prescription-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","prescription_edit")("formControl",t.formControl)("prescription",t.prescription)}}const a6=function(){return{}};function r6(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-prescription-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","prescription_create")("formControl",t.formControl)("prescription",e.DdM(3,a6))}}function n6(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-prescription-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("prescriptions",o.data.items)}let l6=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadPrescriptionsEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.prescriptions$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(ra))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","prescription","send","close"],[1,"w-full","h-full","bg-white",3,"prescriptions","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,o6,2,3,"ng-template",null,1,e.W1O),e.YNc(3,r6,1,4,"ng-template",null,2,e.W1O),e.YNc(5,n6,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,iu,su],encapsulation:2}),s})();function c6(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-prescription-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","prescription_edit")("prescription",t.value)}}const d6=function(){return{}};function u6(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-prescription-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","prescription_create")("prescription",e.DdM(2,d6))}function m6(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-prescription-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("prescriptions",t.items)}}let p6=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","prescription","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","prescriptions","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,c6,1,2,"ng-template",null,1,e.W1O),e.YNc(3,u6,1,3,"ng-template",null,2,e.W1O),e.YNc(5,m6,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,iu,su],encapsulation:2}),s})(),h6=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[ra],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"prescription-select",component:l6,wrappers:["form-field"]},{name:"prescription-grid",component:p6}]})]}),s})(),f6=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[h6]}),s})();class Ri extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class _6 extends Ri{constructor(o,t,i){super("ValidatePriorAuthDmeExcelDataAction"),this.valid=!1,this.excelData=o,this.priorAuthorizationRequests=t,this.durableMedicalEquipments=i}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name),this.validationContext.addRule(new f.mi(`priorAuthorizationRequestName_${i}_is_valid}`,"Prior Authorization Request Is Not Valid","priorAuthorizationRequest.name",t.priorAuthorizationRequest,this.priorAuthorizationRequests,!0)),this.validationContext.addRule(new f.mi(`durableMedicalEquipmentName_${i}_is_valid}`,"Durable Medical Equipment Is Not Valid","durableMedicalEquipment.name",t.durableMedicalEquipment,this.durableMedicalEquipments,!0))}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class g6 extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class C6 extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new g6("name","The priorauthdme name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class v6 extends Ri{constructor(o){super("CreatePriorAuthDmeAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new C6("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreatePriorAuthDme({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class S6 extends Ri{constructor(o){super("UpdatePriorAuthDmesAction"),this.priorAuthDmes=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.priorAuthDmes,!0))}performAction(){this.response=this.businessProvider.data.userUpdatePriorAuthDmes({input:{priorAuthDmes:this.priorAuthDmes}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class b6 extends Ri{constructor(o,t){super("UpdatePriorAuthDmeAction"),this.priorAuthDme=o,this.priorAuthDmeId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.priorAuthDme,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.priorAuthDmeId,!0))}performAction(){this.response=this.businessProvider.data.userUpdatePriorAuthDme({priorAuthDmeId:this.priorAuthDmeId,input:this.priorAuthDme}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let ou=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.PriorAuthDmeBusinessProviderService",t,a),this.data=i}createPriorAuthDme(t){const i=new v6(t);return i.Do(this),i.response}updatePriorAuthDme(t,i){const a=new b6(t,i);return a.Do(this),a.response}importPriorAuthDmes(t){const i=new S6(t);return i.Do(this),i.response}validatePriorAuthDmeExcelData(t,i,a){const l=new _6(t,i,a);return l.Do(this),l.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),T6=(()=>{class s extends I.nH{constructor(t,i,a){super("PriorAuthDmeService",a,t),this.businessProvider=i}createPriorAuthDme(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createPriorAuthDme(i)}updatePriorAuthDme(t,i){return this.businessProvider.updatePriorAuthDme(t,i)}importPriorAuthDmes(t){return this.businessProvider.importPriorAuthDmes(t)}validatePriorAuthDmeExcelData(t,i,a){return this.businessProvider.validatePriorAuthDmeExcelData(t,i,a)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(ou,8),e.LFG(ou),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),na=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){if(super({loading:!1,priorAuthDmes:[],done:!1,searchQuery:"",formName:void 0,priorAuthId:void 0,durableMedicalEquipmentId:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.priorAuthDmeService=H,this.errors$=this.select(n=>n.errors),this.loading$=this.select(n=>n.loading),this.done$=this.select(n=>n.done),this.item$=this.select(n=>n.item),this.priorAuthDmes$=this.select(n=>n.priorAuthDmes),this.priorAuthorizationRequests$=this.select(n=>n.priorAuthorizationRequests||[]),this.durableMedicalEquipments$=this.select(n=>n.durableMedicalEquipments||[]),this.priorAuthId$=this.select(n=>n.priorAuthId),this.durableMedicalEquipmentId$=this.select(n=>n.durableMedicalEquipmentId),this.paging$=this.select(n=>n.paging),this.searchQuery$=this.select(n=>n.searchQuery),this.formName$=this.select(n=>n.formName),this.actionResult$=this.select(this.item$,this.done$,(n,r)=>({item:n,done:r}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.priorAuthDmes$,this.priorAuthorizationRequests$,this.durableMedicalEquipments$,(n,r,m,p,_,w,J)=>({errors:n,loading:r,item:m,formName:p,priorAuthDmes:_,priorAuthorizationRequests:w,durableMedicalEquipments:J}),{debounce:!0}),this.input$=this.select(this.paging$,this.priorAuthId$,this.durableMedicalEquipmentId$,this.searchQuery$,(n,r,m,p)=>({limit:n.limit,skip:n.skip,name:p,priorAuthId:r,durableMedicalEquipmentId:m,total:n.total})),this.setFormName=this.updater((n,r)=>Object.assign(Object.assign({},n),{formName:r})),this.setPriorAuthId=this.updater((n,r)=>Object.assign(Object.assign({},n),{priorAuthId:r})),this.setDurableMedicalEquipmentId=this.updater((n,r)=>Object.assign(Object.assign({},n),{durableMedicalEquipmentId:r})),this.filterPriorAuthorizationRequests=n=>this.data.userSelectPriorAuthorizationRequests({input:{name:n}}).pipe((0,g._b)(r=>{let m=r.data.items;return this.patchState({priorAuthorizationRequests:m}),m},r=>this.patchState({errors:r.graphQLErrors?r.graphQLErrors:r})),(0,he.U)(r=>r.data.items)),this.filterDurableMedicalEquipments=n=>this.data.userSelectDurableMedicalEquipments({input:{name:n}}).pipe((0,g._b)(r=>{let m=r.data.items;return this.patchState({durableMedicalEquipments:m}),m},r=>this.patchState({errors:r.graphQLErrors?r.graphQLErrors:r})),(0,he.U)(r=>r.data.items)),this.addPriorAuthorizationRequest=this.updater((n,r)=>Object.assign(Object.assign({},n),{priorAuthorizationRequests:n.priorAuthorizationRequests.concat(r)})),this.addDurableMedicalEquipment=this.updater((n,r)=>Object.assign(Object.assign({},n),{durableMedicalEquipments:n.durableMedicalEquipments.concat(r)})),this.setItem=this.updater((n,r)=>Object.assign(Object.assign({},n),{item:r})),this.addNewPriorAuthDme=this.updater((n,r)=>Object.assign(Object.assign({},n),{priorAuthDmes:[...n.priorAuthDmes,r]})),this.updatePriorAuthDme=this.updater((n,r)=>Object.assign(Object.assign({},n),{priorAuthDmes:n.priorAuthDmes.map(m=>m.id===r.id?r:m)})),this.addPriorAuthDmes=this.updater((n,r)=>Object.assign(Object.assign({},n),{priorAuthDmes:n.priorAuthDmes.concat(r)})),this.updatePriorAuthDmes=this.updater((n,r)=>Object.assign(Object.assign({},n),{priorAuthDmes:n.priorAuthDmes.map(m=>r.find(_=>_.id===m.id)||m)})),this.setSearchQuery=this.updater((n,r)=>Object.assign(Object.assign({},n),{searchQuery:r})),this.loadPriorAuthDmeEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(r=>this.data.userPriorAuthDme({priorAuthDmeId:r}).pipe((0,g._b)(m=>{this.patchState({item:m.data.item,errors:m.errors,loading:!1})},m=>this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})))))),this.loadPriorAuthDmesEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([r,m])=>this.data.userPriorAuthDmes({input:m}).pipe((0,g._b)(p=>(console.log("$$$$$$$$$$$$$$$$$$$$$$"),console.log(p.data.items),this.patchState({paging:{limit:m.limit,skip:m.skip,total:p.data.count.total},priorAuthDmes:p.data.items,errors:p.errors,loading:!1})),p=>this.patchState({loading:!1,errors:p.graphQLErrors?p.graphQLErrors:p})))))),this.createPriorAuthDmeEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(r=>{const m=Object.fromEntries(Object.entries(r).filter(([p,_])=>null!==_));return this.priorAuthDmeService.createPriorAuthDme(m).pipe((0,g._b)(p=>{this.addNewPriorAuthDme(p),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:p,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},p=>{p.graphQLErrors?(this.toast.error(p.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:p.graphQLErrors?p.graphQLErrors:p})):(this.toast.error(p.Message),this.formService.setErrors(p.Data))}))}))),this.updatePriorAuthDmeEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([r,m])=>this.priorAuthDmeService.updatePriorAuthDme(r,r.id).pipe((0,g._b)(p=>{this.updatePriorAuthDme(p),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:p,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},p=>{p.graphQLErrors?(this.toast.error(p.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:p.graphQLErrors?p.graphQLErrors:p})):(this.toast.error(p.Message),this.formService.setErrors(p.Data))}))))),this.deletePriorAuthDmeEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([r,m])=>this.data.userDeletePriorAuthDme({priorAuthDmeId:m.id}).pipe((0,g._b)(p=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:p.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},p=>{p.graphQLErrors?(this.toast.error(p.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:p.graphQLErrors?p.graphQLErrors:p})):(this.toast.error(p.Message),this.formService.setErrors(p.Data))}))))),this.importExcelEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(r=>this.priorAuthDmeService.importPriorAuthDmes(r).pipe((0,ce.K)(m=>{var p;return this.toast.error(null!==(p=m.Message)&&void 0!==p?p:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(m=>{const p=JSON.parse(m.created),_=JSON.parse(m.updated),w=JSON.parse(m.failed),J=p.length+_.length+w.length;this.addPriorAuthDmes(p),this.updatePriorAuthDmes(_),this.toast.success(`${p.length} created, ${_.length} updated, ${w.length} failed of total ${J}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("priorAuthDmeId")?(this.route.snapshot.paramMap.get("priorAuthDmeId"),this.setFormName("priorAuthDme_edit")):this.setFormName("priorAuthDme_create"),this.route.snapshot.paramMap.has("priorAuthId")){var c=this.route.snapshot.paramMap.get("priorAuthId");this.setPriorAuthId(c)}if(this.route.snapshot.paramMap.has("durableMedicalEquipmentId")){var d=this.route.snapshot.paramMap.get("durableMedicalEquipmentId");this.setDurableMedicalEquipmentId(d)}}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.priorAuthDmeService.validatePriorAuthDmeExcelData(t,i.priorAuthorizationRequests,i.durableMedicalEquipments)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(T6))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function y6(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.priorAuthDme)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let au=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"priorAuthDme_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({id:null,name:""}),this.store.vm$.subscribe(i=>{this.priorAuthDme=i.item})):t.formName&&t.formName.currentValue&&"priorAuthDme_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadPriorAuthDmeEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.priorAuthDme=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(na),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-prior-auth-dme-form"]],inputs:{priorAuthDme:"priorAuthDme",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,y6,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),ru=(()=>{class s{constructor(){this.autoHeight=!1,this.priorAuthDmes=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[{field:"priorAuthorizationRequest.name",headerName:"Prior Authorization Request",filter:"agTextColumnFilter"},{field:"durableMedicalEquipment.name",headerName:"Durable Medical Equipment",filter:"agTextColumnFilter"},{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{headerName:"Estimated Cost",field:"estimatedCost",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.estimatedCost,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{field:"priorAuthId",filter:"agTextColumnFilter",hide:!0},{field:"durableMedicalEquipmentId",filter:"agTextColumnFilter",hide:!0}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-prior-auth-dme-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",priorAuthDmes:"priorAuthDmes"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.priorAuthDmes)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function w6(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-prior-auth-dme-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","priorAuthDme_edit")("formControl",t.formControl)("priorAuthDme",t.priorAuthDme)}}const x6=function(){return{}};function N6(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-prior-auth-dme-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","priorAuthDme_create")("formControl",t.formControl)("priorAuthDme",e.DdM(3,x6))}}function A6(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-prior-auth-dme-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("priorAuthDmes",o.data.items)}let F6=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadPriorAuthDmesEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.priorAuthDmes$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(na))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","priorAuthDme","send","close"],[1,"w-full","h-full","bg-white",3,"priorAuthDmes","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,w6,2,3,"ng-template",null,1,e.W1O),e.YNc(3,N6,1,4,"ng-template",null,2,e.W1O),e.YNc(5,A6,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,au,ru],encapsulation:2}),s})();function P6(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-prior-auth-dme-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","priorAuthDme_edit")("priorAuthDme",t.value)}}const I6=function(){return{}};function D6(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-prior-auth-dme-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","priorAuthDme_create")("priorAuthDme",e.DdM(2,I6))}function M6(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-prior-auth-dme-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("priorAuthDmes",t.items)}}let W6=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","priorAuthDme","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","priorAuthDmes","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,P6,1,2,"ng-template",null,1,e.W1O),e.YNc(3,D6,1,3,"ng-template",null,2,e.W1O),e.YNc(5,M6,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,au,ru],encapsulation:2}),s})(),E6=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[na],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"prior-auth-dme-select",component:F6,wrappers:["form-field"]},{name:"prior-auth-dme-grid",component:W6}]})]}),s})(),O6=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[E6]}),s})();class Qi extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class L6 extends Qi{constructor(o,t,i){super("ValidatePriorAuthGuidelineExcelDataAction"),this.valid=!1,this.excelData=o,this.guidelines=t,this.priorAuthorizationRequests=i}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name),this.validationContext.addRule(new f.mi(`guidelineName_${i}_is_valid}`,"Guideline Is Not Valid","guideline.name",t.guideline,this.guidelines,!0)),this.validationContext.addRule(new f.mi(`priorAuthorizationRequestName_${i}_is_valid}`,"Prior Authorization Request Is Not Valid","priorAuthorizationRequest.name",t.priorAuthorizationRequest,this.priorAuthorizationRequests,!0))}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class $6 extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class G6 extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new $6("name","The priorauthguideline name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class R6 extends Qi{constructor(o){super("CreatePriorAuthGuidelineAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new G6("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreatePriorAuthGuideline({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class Q6 extends Qi{constructor(o){super("UpdatePriorAuthGuidelinesAction"),this.priorAuthGuidelines=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.priorAuthGuidelines,!0))}performAction(){this.response=this.businessProvider.data.userUpdatePriorAuthGuidelines({input:{priorAuthGuidelines:this.priorAuthGuidelines}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class V6 extends Qi{constructor(o,t){super("UpdatePriorAuthGuidelineAction"),this.priorAuthGuideline=o,this.priorAuthGuidelineId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.priorAuthGuideline,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.priorAuthGuidelineId,!0))}performAction(){this.response=this.businessProvider.data.userUpdatePriorAuthGuideline({priorAuthGuidelineId:this.priorAuthGuidelineId,input:this.priorAuthGuideline}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let nu=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.PriorAuthGuidelineBusinessProviderService",t,a),this.data=i}createPriorAuthGuideline(t){const i=new R6(t);return i.Do(this),i.response}updatePriorAuthGuideline(t,i){const a=new V6(t,i);return a.Do(this),a.response}importPriorAuthGuidelines(t){const i=new Q6(t);return i.Do(this),i.response}validatePriorAuthGuidelineExcelData(t,i,a){const l=new L6(t,i,a);return l.Do(this),l.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),j6=(()=>{class s extends I.nH{constructor(t,i,a){super("PriorAuthGuidelineService",a,t),this.businessProvider=i}createPriorAuthGuideline(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createPriorAuthGuideline(i)}updatePriorAuthGuideline(t,i){return this.businessProvider.updatePriorAuthGuideline(t,i)}importPriorAuthGuidelines(t){return this.businessProvider.importPriorAuthGuidelines(t)}validatePriorAuthGuidelineExcelData(t,i,a){return this.businessProvider.validatePriorAuthGuidelineExcelData(t,i,a)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(nu,8),e.LFG(nu),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),la=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){if(super({loading:!1,priorAuthGuidelines:[],done:!1,searchQuery:"",formName:void 0,guidelineId:void 0,priorAuthorizationRequestId:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.priorAuthGuidelineService=H,this.errors$=this.select(n=>n.errors),this.loading$=this.select(n=>n.loading),this.done$=this.select(n=>n.done),this.item$=this.select(n=>n.item),this.priorAuthGuidelines$=this.select(n=>n.priorAuthGuidelines),this.guidelines$=this.select(n=>n.guidelines||[]),this.priorAuthorizationRequests$=this.select(n=>n.priorAuthorizationRequests||[]),this.guidelineId$=this.select(n=>n.guidelineId),this.priorAuthorizationRequestId$=this.select(n=>n.priorAuthorizationRequestId),this.paging$=this.select(n=>n.paging),this.searchQuery$=this.select(n=>n.searchQuery),this.formName$=this.select(n=>n.formName),this.actionResult$=this.select(this.item$,this.done$,(n,r)=>({item:n,done:r}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.priorAuthGuidelines$,this.guidelines$,this.priorAuthorizationRequests$,(n,r,m,p,_,w,J)=>({errors:n,loading:r,item:m,formName:p,priorAuthGuidelines:_,guidelines:w,priorAuthorizationRequests:J}),{debounce:!0}),this.input$=this.select(this.paging$,this.guidelineId$,this.priorAuthorizationRequestId$,this.searchQuery$,(n,r,m,p)=>({limit:n.limit,skip:n.skip,name:p,guidelineId:r,priorAuthorizationRequestId:m,total:n.total})),this.setFormName=this.updater((n,r)=>Object.assign(Object.assign({},n),{formName:r})),this.setGuidelineId=this.updater((n,r)=>Object.assign(Object.assign({},n),{guidelineId:r})),this.setPriorAuthorizationRequestId=this.updater((n,r)=>Object.assign(Object.assign({},n),{priorAuthorizationRequestId:r})),this.filterGuidelines=n=>this.data.userSelectGuidelines({input:{name:n}}).pipe((0,g._b)(r=>{let m=r.data.items;return this.patchState({guidelines:m}),m},r=>this.patchState({errors:r.graphQLErrors?r.graphQLErrors:r})),(0,he.U)(r=>r.data.items)),this.filterPriorAuthorizationRequests=n=>this.data.userSelectPriorAuthorizationRequests({input:{name:n}}).pipe((0,g._b)(r=>{let m=r.data.items;return this.patchState({priorAuthorizationRequests:m}),m},r=>this.patchState({errors:r.graphQLErrors?r.graphQLErrors:r})),(0,he.U)(r=>r.data.items)),this.addGuideline=this.updater((n,r)=>Object.assign(Object.assign({},n),{guidelines:n.guidelines.concat(r)})),this.addPriorAuthorizationRequest=this.updater((n,r)=>Object.assign(Object.assign({},n),{priorAuthorizationRequests:n.priorAuthorizationRequests.concat(r)})),this.setItem=this.updater((n,r)=>Object.assign(Object.assign({},n),{item:r})),this.addNewPriorAuthGuideline=this.updater((n,r)=>Object.assign(Object.assign({},n),{priorAuthGuidelines:[...n.priorAuthGuidelines,r]})),this.updatePriorAuthGuideline=this.updater((n,r)=>Object.assign(Object.assign({},n),{priorAuthGuidelines:n.priorAuthGuidelines.map(m=>m.id===r.id?r:m)})),this.addPriorAuthGuidelines=this.updater((n,r)=>Object.assign(Object.assign({},n),{priorAuthGuidelines:n.priorAuthGuidelines.concat(r)})),this.updatePriorAuthGuidelines=this.updater((n,r)=>Object.assign(Object.assign({},n),{priorAuthGuidelines:n.priorAuthGuidelines.map(m=>r.find(_=>_.id===m.id)||m)})),this.setSearchQuery=this.updater((n,r)=>Object.assign(Object.assign({},n),{searchQuery:r})),this.loadPriorAuthGuidelineEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(r=>this.data.userPriorAuthGuideline({priorAuthGuidelineId:r}).pipe((0,g._b)(m=>{this.patchState({item:m.data.item,errors:m.errors,loading:!1})},m=>this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})))))),this.loadPriorAuthGuidelinesEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([r,m])=>this.data.userPriorAuthGuidelines({input:m}).pipe((0,g._b)(p=>this.patchState({paging:{limit:m.limit,skip:m.skip,total:p.data.count.total},priorAuthGuidelines:p.data.items,errors:p.errors,loading:!1}),p=>this.patchState({loading:!1,errors:p.graphQLErrors?p.graphQLErrors:p})))))),this.createPriorAuthGuidelineEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(r=>this.priorAuthGuidelineService.createPriorAuthGuideline(Object.assign({},r)).pipe((0,g._b)(m=>{this.addNewPriorAuthGuideline(m),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:m,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},m=>{m.graphQLErrors?(this.toast.error(m.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})):(this.toast.error(m.Message),this.formService.setErrors(m.Data))}))))),this.updatePriorAuthGuidelineEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([r,m])=>this.priorAuthGuidelineService.updatePriorAuthGuideline(r,r.id).pipe((0,g._b)(p=>{this.updatePriorAuthGuideline(p),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:p,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},p=>{p.graphQLErrors?(this.toast.error(p.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:p.graphQLErrors?p.graphQLErrors:p})):(this.toast.error(p.Message),this.formService.setErrors(p.Data))}))))),this.deletePriorAuthGuidelineEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([r,m])=>this.data.userDeletePriorAuthGuideline({priorAuthGuidelineId:m.id}).pipe((0,g._b)(p=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:p.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},p=>{p.graphQLErrors?(this.toast.error(p.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:p.graphQLErrors?p.graphQLErrors:p})):(this.toast.error(p.Message),this.formService.setErrors(p.Data))}))))),this.importExcelEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(r=>this.priorAuthGuidelineService.importPriorAuthGuidelines(r).pipe((0,ce.K)(m=>{var p;return this.toast.error(null!==(p=m.Message)&&void 0!==p?p:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(m=>{const p=JSON.parse(m.created),_=JSON.parse(m.updated),w=JSON.parse(m.failed),J=p.length+_.length+w.length;this.addPriorAuthGuidelines(p),this.updatePriorAuthGuidelines(_),this.toast.success(`${p.length} created, ${_.length} updated, ${w.length} failed of total ${J}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("priorAuthGuidelineId")?(this.route.snapshot.paramMap.get("priorAuthGuidelineId"),this.setFormName("priorAuthGuideline_edit")):this.setFormName("priorAuthGuideline_create"),this.route.snapshot.paramMap.has("guidelineId")){var c=this.route.snapshot.paramMap.get("guidelineId");this.setGuidelineId(c)}if(this.route.snapshot.paramMap.has("priorAuthorizationRequestId")){var d=this.route.snapshot.paramMap.get("priorAuthorizationRequestId");this.setPriorAuthorizationRequestId(d)}}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.priorAuthGuidelineService.validatePriorAuthGuidelineExcelData(t,i.guidelines,i.priorAuthorizationRequests)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(j6))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function U6(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.priorAuthGuideline)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let lu=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"priorAuthGuideline_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.priorAuthGuideline=i.item})):t.formName&&t.formName.currentValue&&"priorAuthGuideline_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadPriorAuthGuidelineEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.priorAuthGuideline=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(la),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-prior-auth-guideline-form"]],inputs:{priorAuthGuideline:"priorAuthGuideline",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,U6,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),cu=(()=>{class s{constructor(){this.autoHeight=!1,this.priorAuthGuidelines=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[{field:"guideline.name",headerName:"Guideline",filter:"agTextColumnFilter"},{field:"priorAuthorizationRequest.name",headerName:"Prior Authorization Request",filter:"agTextColumnFilter"},{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{field:"guidelineId",filter:"agTextColumnFilter",hide:!0},{field:"priorAuthorizationRequestId",filter:"agTextColumnFilter",hide:!0}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-prior-auth-guideline-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",priorAuthGuidelines:"priorAuthGuidelines"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.priorAuthGuidelines)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function J6(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-prior-auth-guideline-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","priorAuthGuideline_edit")("formControl",t.formControl)("priorAuthGuideline",t.priorAuthGuideline)}}const z6=function(){return{}};function H6(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-prior-auth-guideline-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","priorAuthGuideline_create")("formControl",t.formControl)("priorAuthGuideline",e.DdM(3,z6))}}function q6(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-prior-auth-guideline-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("priorAuthGuidelines",o.data.items)}let K6=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadPriorAuthGuidelinesEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.priorAuthGuidelines$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(la))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","priorAuthGuideline","send","close"],[1,"w-full","h-full","bg-white",3,"priorAuthGuidelines","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,J6,2,3,"ng-template",null,1,e.W1O),e.YNc(3,H6,1,4,"ng-template",null,2,e.W1O),e.YNc(5,q6,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,lu,cu],encapsulation:2}),s})();function Z6(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-prior-auth-guideline-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","priorAuthGuideline_edit")("priorAuthGuideline",t.value)}}const k6=function(){return{}};function B6(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-prior-auth-guideline-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","priorAuthGuideline_create")("priorAuthGuideline",e.DdM(2,k6))}function Y6(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-prior-auth-guideline-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("priorAuthGuidelines",t.items)}}let X6=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","priorAuthGuideline","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","priorAuthGuidelines","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,Z6,1,2,"ng-template",null,1,e.W1O),e.YNc(3,B6,1,3,"ng-template",null,2,e.W1O),e.YNc(5,Y6,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,lu,cu],encapsulation:2}),s})(),eJ=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[la],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"prior-auth-guideline-select",component:K6,wrappers:["form-field"]},{name:"prior-auth-guideline-grid",component:X6}]})]}),s})(),tJ=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[eJ]}),s})();class Vi extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class iJ extends Vi{constructor(o,t,i){super("ValidatePriorAuthorizationDiagnosisCodeExcelDataAction"),this.valid=!1,this.excelData=o,this.diagnoses=t,this.priorAuthorizationRequests=i}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name),this.validationContext.addRule(new f.mi(`diagnosisName_${i}_is_valid}`,"Diagnosis Is Not Valid","diagnosis.name",t.diagnosis,this.diagnoses,!0)),this.validationContext.addRule(new f.mi(`priorAuthorizationRequestName_${i}_is_valid}`,"Prior Authorization Request Is Not Valid","priorAuthorizationRequest.name",t.priorAuthorizationRequest,this.priorAuthorizationRequests,!0))}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class sJ extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class oJ extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new sJ("name","The priorauthorizationdiagnosiscode name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class aJ extends Vi{constructor(o){super("CreatePriorAuthorizationDiagnosisCodeAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new oJ("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreatePriorAuthorizationDiagnosisCode({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class rJ extends Vi{constructor(o){super("UpdatePriorAuthorizationDiagnosisCodesAction"),this.priorAuthorizationDiagnosisCodes=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.priorAuthorizationDiagnosisCodes,!0))}performAction(){this.response=this.businessProvider.data.userUpdatePriorAuthorizationDiagnosisCodes({input:{priorAuthorizationDiagnosisCodes:this.priorAuthorizationDiagnosisCodes}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class nJ extends Vi{constructor(o,t){super("UpdatePriorAuthorizationDiagnosisCodeAction"),this.priorAuthorizationDiagnosisCode=o,this.priorAuthorizationDiagnosisCodeId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.priorAuthorizationDiagnosisCode,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.priorAuthorizationDiagnosisCodeId,!0))}performAction(){this.response=this.businessProvider.data.userUpdatePriorAuthorizationDiagnosisCode({priorAuthorizationDiagnosisCodeId:this.priorAuthorizationDiagnosisCodeId,input:this.priorAuthorizationDiagnosisCode}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let du=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.PriorAuthorizationDiagnosisCodeBusinessProviderService",t,a),this.data=i}createPriorAuthorizationDiagnosisCode(t){const i=new aJ(t);return i.Do(this),i.response}updatePriorAuthorizationDiagnosisCode(t,i){const a=new nJ(t,i);return a.Do(this),a.response}importPriorAuthorizationDiagnosisCodes(t){const i=new rJ(t);return i.Do(this),i.response}validatePriorAuthorizationDiagnosisCodeExcelData(t,i,a){const l=new iJ(t,i,a);return l.Do(this),l.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),lJ=(()=>{class s extends I.nH{constructor(t,i,a){super("PriorAuthorizationDiagnosisCodeService",a,t),this.businessProvider=i}createPriorAuthorizationDiagnosisCode(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createPriorAuthorizationDiagnosisCode(i)}updatePriorAuthorizationDiagnosisCode(t,i){return this.businessProvider.updatePriorAuthorizationDiagnosisCode(t,i)}importPriorAuthorizationDiagnosisCodes(t){return this.businessProvider.importPriorAuthorizationDiagnosisCodes(t)}validatePriorAuthorizationDiagnosisCodeExcelData(t,i,a){return this.businessProvider.validatePriorAuthorizationDiagnosisCodeExcelData(t,i,a)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(du,8),e.LFG(du),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),ca=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){if(super({loading:!1,priorAuthorizationDiagnosisCodes:[],done:!1,searchQuery:"",formName:void 0,diagnosisCodeId:void 0,priorAuthorizationRequestId:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.priorAuthorizationDiagnosisCodeService=H,this.errors$=this.select(n=>n.errors),this.loading$=this.select(n=>n.loading),this.done$=this.select(n=>n.done),this.item$=this.select(n=>n.item),this.priorAuthorizationDiagnosisCodes$=this.select(n=>n.priorAuthorizationDiagnosisCodes),this.diagnosisCodes$=this.select(n=>n.diagnosisCodes||[]),this.priorAuthorizationRequests$=this.select(n=>n.priorAuthorizationRequests||[]),this.diagnosisCodeId$=this.select(n=>n.diagnosisCodeId),this.priorAuthorizationRequestId$=this.select(n=>n.priorAuthorizationRequestId),this.paging$=this.select(n=>n.paging),this.searchQuery$=this.select(n=>n.searchQuery),this.formName$=this.select(n=>n.formName),this.actionResult$=this.select(this.item$,this.done$,(n,r)=>({item:n,done:r}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.priorAuthorizationDiagnosisCodes$,this.diagnosisCodes$,this.priorAuthorizationRequests$,(n,r,m,p,_,w,J)=>({errors:n,loading:r,item:m,formName:p,priorAuthorizationDiagnosisCodes:_,diagnosisCodes:w,priorAuthorizationRequests:J}),{debounce:!0}),this.input$=this.select(this.paging$,this.diagnosisCodeId$,this.priorAuthorizationRequestId$,this.searchQuery$,(n,r,m,p)=>({limit:n.limit,skip:n.skip,name:p,diagnosisCodeId:r,priorAuthorizationRequestId:m,total:n.total})),this.setFormName=this.updater((n,r)=>Object.assign(Object.assign({},n),{formName:r})),this.setDiagnosisCodeId=this.updater((n,r)=>Object.assign(Object.assign({},n),{diagnosisCodeId:r})),this.setPriorAuthorizationRequestId=this.updater((n,r)=>Object.assign(Object.assign({},n),{priorAuthorizationRequestId:r})),this.filterDiagnosisCodes=n=>this.data.userSelectDiagnosisCodes({input:{name:n}}).pipe((0,g._b)(r=>{let m=r.data.items;return this.patchState({diagnosisCodes:m}),m},r=>this.patchState({errors:r.graphQLErrors?r.graphQLErrors:r})),(0,he.U)(r=>r.data.items)),this.filterPriorAuthorizationRequests=n=>this.data.userSelectPriorAuthorizationRequests({input:{name:n}}).pipe((0,g._b)(r=>{let m=r.data.items;return this.patchState({priorAuthorizationRequests:m}),m},r=>this.patchState({errors:r.graphQLErrors?r.graphQLErrors:r})),(0,he.U)(r=>r.data.items)),this.addDiagnosisCode=this.updater((n,r)=>Object.assign(Object.assign({},n),{diagnosisCodes:n.diagnosisCodes.concat(r)})),this.addPriorAuthorizationRequest=this.updater((n,r)=>Object.assign(Object.assign({},n),{priorAuthorizationRequests:n.priorAuthorizationRequests.concat(r)})),this.setItem=this.updater((n,r)=>Object.assign(Object.assign({},n),{item:r})),this.addNewPriorAuthorizationDiagnosisCode=this.updater((n,r)=>Object.assign(Object.assign({},n),{priorAuthorizationDiagnosisCodes:[...n.priorAuthorizationDiagnosisCodes,r]})),this.updatePriorAuthorizationDiagnosisCode=this.updater((n,r)=>Object.assign(Object.assign({},n),{priorAuthorizationDiagnosisCodes:n.priorAuthorizationDiagnosisCodes.map(m=>m.id===r.id?r:m)})),this.addPriorAuthorizationDiagnosisCodes=this.updater((n,r)=>Object.assign(Object.assign({},n),{priorAuthorizationDiagnosisCodes:n.priorAuthorizationDiagnosisCodes.concat(r)})),this.updatePriorAuthorizationDiagnosisCodes=this.updater((n,r)=>Object.assign(Object.assign({},n),{priorAuthorizationDiagnosisCodes:n.priorAuthorizationDiagnosisCodes.map(m=>r.find(_=>_.id===m.id)||m)})),this.setSearchQuery=this.updater((n,r)=>Object.assign(Object.assign({},n),{searchQuery:r})),this.loadPriorAuthorizationDiagnosisCodeEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(r=>this.data.userPriorAuthorizationDiagnosisCode({priorAuthorizationDiagnosisCodeId:r}).pipe((0,g._b)(m=>{this.patchState({item:m.data.item,errors:m.errors,loading:!1})},m=>this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})))))),this.loadPriorAuthorizationDiagnosisCodesEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([r,m])=>this.data.userPriorAuthorizationDiagnosisCodes({input:m}).pipe((0,g._b)(p=>this.patchState({paging:{limit:m.limit,skip:m.skip,total:p.data.count.total},priorAuthorizationDiagnosisCodes:p.data.items,errors:p.errors,loading:!1}),p=>this.patchState({loading:!1,errors:p.graphQLErrors?p.graphQLErrors:p})))))),this.createPriorAuthorizationDiagnosisCodeEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(r=>this.priorAuthorizationDiagnosisCodeService.createPriorAuthorizationDiagnosisCode(Object.assign({},r)).pipe((0,g._b)(m=>{this.addNewPriorAuthorizationDiagnosisCode(m),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:m,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},m=>{m.graphQLErrors?(this.toast.error(m.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})):(this.toast.error(m.Message),this.formService.setErrors(m.Data))}))))),this.updatePriorAuthorizationDiagnosisCodeEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([r,m])=>this.priorAuthorizationDiagnosisCodeService.updatePriorAuthorizationDiagnosisCode(r,r.id).pipe((0,g._b)(p=>{this.updatePriorAuthorizationDiagnosisCode(p),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:p,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},p=>{p.graphQLErrors?(this.toast.error(p.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:p.graphQLErrors?p.graphQLErrors:p})):(this.toast.error(p.Message),this.formService.setErrors(p.Data))}))))),this.deletePriorAuthorizationDiagnosisCodeEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([r,m])=>this.data.userDeletePriorAuthorizationDiagnosisCode({priorAuthorizationDiagnosisCodeId:m.id}).pipe((0,g._b)(p=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:p.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},p=>{p.graphQLErrors?(this.toast.error(p.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:p.graphQLErrors?p.graphQLErrors:p})):(this.toast.error(p.Message),this.formService.setErrors(p.Data))}))))),this.importExcelEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(r=>this.priorAuthorizationDiagnosisCodeService.importPriorAuthorizationDiagnosisCodes(r).pipe((0,ce.K)(m=>{var p;return this.toast.error(null!==(p=m.Message)&&void 0!==p?p:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(m=>{const p=JSON.parse(m.created),_=JSON.parse(m.updated),w=JSON.parse(m.failed),J=p.length+_.length+w.length;this.addPriorAuthorizationDiagnosisCodes(p),this.updatePriorAuthorizationDiagnosisCodes(_),this.toast.success(`${p.length} created, ${_.length} updated, ${w.length} failed of total ${J}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("priorAuthorizationDiagnosisCodeId")?(this.route.snapshot.paramMap.get("priorAuthorizationDiagnosisCodeId"),this.setFormName("priorAuthorizationDiagnosisCode_edit")):this.setFormName("priorAuthorizationDiagnosisCode_create"),this.route.snapshot.paramMap.has("diagnosisCodeId")){var c=this.route.snapshot.paramMap.get("diagnosisCodeId");this.setDiagnosisCodeId(c)}if(this.route.snapshot.paramMap.has("priorAuthorizationRequestId")){var d=this.route.snapshot.paramMap.get("priorAuthorizationRequestId");this.setPriorAuthorizationRequestId(d)}}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.priorAuthorizationDiagnosisCodeService.validatePriorAuthorizationDiagnosisCodeExcelData(t,i.diagnosisCodes,i.priorAuthorizationRequests)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(lJ))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function cJ(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.priorAuthorizationDiagnosisCode)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let uu=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"priorAuthorizationDiagnosisCode_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.priorAuthorizationDiagnosisCode=i.item})):t.formName&&t.formName.currentValue&&"priorAuthorizationDiagnosisCode_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadPriorAuthorizationDiagnosisCodeEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.priorAuthorizationDiagnosisCode=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(ca),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-prior-authorization-diagnosis-code-form"]],inputs:{priorAuthorizationDiagnosisCode:"priorAuthorizationDiagnosisCode",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,cJ,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),mu=(()=>{class s{constructor(){this.autoHeight=!1,this.priorAuthorizationDiagnosisCodes=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[{field:"diagnosis.name",headerName:"Diagnosis",filter:"agTextColumnFilter"},{field:"priorAuthorizationRequest.name",headerName:"Prior Authorization Request",filter:"agTextColumnFilter"},{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{field:"diagnosisCodeId",filter:"agTextColumnFilter",hide:!0},{field:"priorAuthorizationRequestId",filter:"agTextColumnFilter",hide:!0}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-prior-authorization-diagnosis-code-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",priorAuthorizationDiagnosisCodes:"priorAuthorizationDiagnosisCodes"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.priorAuthorizationDiagnosisCodes)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function dJ(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-prior-authorization-diagnosis-code-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","priorAuthorizationDiagnosisCode_edit")("formControl",t.formControl)("priorAuthorizationDiagnosisCode",t.priorAuthorizationDiagnosisCode)}}const uJ=function(){return{}};function mJ(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-prior-authorization-diagnosis-code-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","priorAuthorizationDiagnosisCode_create")("formControl",t.formControl)("priorAuthorizationDiagnosisCode",e.DdM(3,uJ))}}function pJ(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-prior-authorization-diagnosis-code-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("priorAuthorizationDiagnosisCodes",o.data.items)}let hJ=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadPriorAuthorizationDiagnosisCodesEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.priorAuthorizationDiagnosisCodes$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(ca))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","priorAuthorizationDiagnosisCode","send","close"],[1,"w-full","h-full","bg-white",3,"priorAuthorizationDiagnosisCodes","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,dJ,2,3,"ng-template",null,1,e.W1O),e.YNc(3,mJ,1,4,"ng-template",null,2,e.W1O),e.YNc(5,pJ,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,uu,mu],encapsulation:2}),s})();function fJ(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-prior-authorization-diagnosis-code-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","priorAuthorizationDiagnosisCode_edit")("priorAuthorizationDiagnosisCode",t.value)}}const _J=function(){return{}};function gJ(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-prior-authorization-diagnosis-code-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","priorAuthorizationDiagnosisCode_create")("priorAuthorizationDiagnosisCode",e.DdM(2,_J))}function CJ(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-prior-authorization-diagnosis-code-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("priorAuthorizationDiagnosisCodes",t.items)}}let vJ=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","priorAuthorizationDiagnosisCode","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","priorAuthorizationDiagnosisCodes","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,fJ,1,2,"ng-template",null,1,e.W1O),e.YNc(3,gJ,1,3,"ng-template",null,2,e.W1O),e.YNc(5,CJ,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,uu,mu],encapsulation:2}),s})(),SJ=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[ca],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"prior-authorization-diagnosis-code-select",component:hJ,wrappers:["form-field"]},{name:"prior-authorization-diagnosis-code-grid",component:vJ}]})]}),s})(),bJ=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[SJ]}),s})();class ji extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class TJ extends ji{constructor(o,t,i){super("ValidatePriorAuthorizationEquipmentExcelDataAction"),this.valid=!1,this.excelData=o,this.equipment=t,this.priorAuthorizationRequests=i}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name),this.validationContext.addRule(new f.mi(`equipmentName_${i}_is_valid}`,"Equipment Is Not Valid","equipment.name",t.equipment,this.equipment,!0)),this.validationContext.addRule(new f.mi(`priorAuthorizationRequestName_${i}_is_valid}`,"Prior Authorization Request Is Not Valid","priorAuthorizationRequest.name",t.priorAuthorizationRequest,this.priorAuthorizationRequests,!0))}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class yJ extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class wJ extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new yJ("name","The priorauthorizationequipment name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class xJ extends ji{constructor(o){super("CreatePriorAuthorizationEquipmentAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new wJ("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreatePriorAuthorizationEquipment({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class NJ extends ji{constructor(o){super("UpdatePriorAuthorizationEquipmentsAction"),this.priorAuthorizationEquipments=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.priorAuthorizationEquipments,!0))}performAction(){this.response=this.businessProvider.data.userUpdatePriorAuthorizationEquipments({input:{priorAuthorizationEquipments:this.priorAuthorizationEquipments}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class AJ extends ji{constructor(o,t){super("UpdatePriorAuthorizationEquipmentAction"),this.priorAuthorizationEquipment=o,this.priorAuthorizationEquipmentId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.priorAuthorizationEquipment,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.priorAuthorizationEquipmentId,!0))}performAction(){this.response=this.businessProvider.data.userUpdatePriorAuthorizationEquipment({priorAuthorizationEquipmentId:this.priorAuthorizationEquipmentId,input:this.priorAuthorizationEquipment}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let pu=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.PriorAuthorizationEquipmentBusinessProviderService",t,a),this.data=i}createPriorAuthorizationEquipment(t){const i=new xJ(t);return i.Do(this),i.response}updatePriorAuthorizationEquipment(t,i){const a=new AJ(t,i);return a.Do(this),a.response}importPriorAuthorizationEquipments(t){const i=new NJ(t);return i.Do(this),i.response}validatePriorAuthorizationEquipmentExcelData(t,i,a){const l=new TJ(t,i,a);return l.Do(this),l.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),FJ=(()=>{class s extends I.nH{constructor(t,i,a){super("PriorAuthorizationEquipmentService",a,t),this.businessProvider=i}createPriorAuthorizationEquipment(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createPriorAuthorizationEquipment(i)}updatePriorAuthorizationEquipment(t,i){return this.businessProvider.updatePriorAuthorizationEquipment(t,i)}importPriorAuthorizationEquipments(t){return this.businessProvider.importPriorAuthorizationEquipments(t)}validatePriorAuthorizationEquipmentExcelData(t,i,a){return this.businessProvider.validatePriorAuthorizationEquipmentExcelData(t,i,a)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(pu,8),e.LFG(pu),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),da=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){if(super({loading:!1,priorAuthorizationEquipments:[],done:!1,searchQuery:"",formName:void 0,equipmentId:void 0,priorAuthorizationRequestId:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.priorAuthorizationEquipmentService=H,this.errors$=this.select(n=>n.errors),this.loading$=this.select(n=>n.loading),this.done$=this.select(n=>n.done),this.item$=this.select(n=>n.item),this.priorAuthorizationEquipments$=this.select(n=>n.priorAuthorizationEquipments),this.equipments$=this.select(n=>n.equipments||[]),this.priorAuthorizationRequests$=this.select(n=>n.priorAuthorizationRequests||[]),this.equipmentId$=this.select(n=>n.equipmentId),this.priorAuthorizationRequestId$=this.select(n=>n.priorAuthorizationRequestId),this.paging$=this.select(n=>n.paging),this.searchQuery$=this.select(n=>n.searchQuery),this.formName$=this.select(n=>n.formName),this.actionResult$=this.select(this.item$,this.done$,(n,r)=>({item:n,done:r}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.priorAuthorizationEquipments$,this.equipments$,this.priorAuthorizationRequests$,(n,r,m,p,_,w,J)=>({errors:n,loading:r,item:m,formName:p,priorAuthorizationEquipments:_,equipments:w,priorAuthorizationRequests:J}),{debounce:!0}),this.input$=this.select(this.paging$,this.equipmentId$,this.priorAuthorizationRequestId$,this.searchQuery$,(n,r,m,p)=>({limit:n.limit,skip:n.skip,name:p,equipmentId:r,priorAuthorizationRequestId:m,total:n.total})),this.setFormName=this.updater((n,r)=>Object.assign(Object.assign({},n),{formName:r})),this.setEquipmentId=this.updater((n,r)=>Object.assign(Object.assign({},n),{equipmentId:r})),this.setPriorAuthorizationRequestId=this.updater((n,r)=>Object.assign(Object.assign({},n),{priorAuthorizationRequestId:r})),this.filterEquipments=n=>this.data.userSelectEquipments({input:{name:n}}).pipe((0,g._b)(r=>{let m=r.data.items;return this.patchState({equipments:m}),m},r=>this.patchState({errors:r.graphQLErrors?r.graphQLErrors:r})),(0,he.U)(r=>r.data.items)),this.filterPriorAuthorizationRequests=n=>this.data.userSelectPriorAuthorizationRequests({input:{name:n}}).pipe((0,g._b)(r=>{let m=r.data.items;return this.patchState({priorAuthorizationRequests:m}),m},r=>this.patchState({errors:r.graphQLErrors?r.graphQLErrors:r})),(0,he.U)(r=>r.data.items)),this.addEquipment=this.updater((n,r)=>Object.assign(Object.assign({},n),{equipments:n.equipments.concat(r)})),this.addPriorAuthorizationRequest=this.updater((n,r)=>Object.assign(Object.assign({},n),{priorAuthorizationRequests:n.priorAuthorizationRequests.concat(r)})),this.setItem=this.updater((n,r)=>Object.assign(Object.assign({},n),{item:r})),this.addNewPriorAuthorizationEquipment=this.updater((n,r)=>Object.assign(Object.assign({},n),{priorAuthorizationEquipments:[...n.priorAuthorizationEquipments,r]})),this.updatePriorAuthorizationEquipment=this.updater((n,r)=>Object.assign(Object.assign({},n),{priorAuthorizationEquipments:n.priorAuthorizationEquipments.map(m=>m.id===r.id?r:m)})),this.addPriorAuthorizationEquipments=this.updater((n,r)=>Object.assign(Object.assign({},n),{priorAuthorizationEquipments:n.priorAuthorizationEquipments.concat(r)})),this.updatePriorAuthorizationEquipments=this.updater((n,r)=>Object.assign(Object.assign({},n),{priorAuthorizationEquipments:n.priorAuthorizationEquipments.map(m=>r.find(_=>_.id===m.id)||m)})),this.setSearchQuery=this.updater((n,r)=>Object.assign(Object.assign({},n),{searchQuery:r})),this.loadPriorAuthorizationEquipmentEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(r=>this.data.userPriorAuthorizationEquipment({priorAuthorizationEquipmentId:r}).pipe((0,g._b)(m=>{this.patchState({item:m.data.item,errors:m.errors,loading:!1})},m=>this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})))))),this.loadPriorAuthorizationEquipmentsEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([r,m])=>this.data.userPriorAuthorizationEquipments({input:m}).pipe((0,g._b)(p=>this.patchState({paging:{limit:m.limit,skip:m.skip,total:p.data.count.total},priorAuthorizationEquipments:p.data.items,errors:p.errors,loading:!1}),p=>this.patchState({loading:!1,errors:p.graphQLErrors?p.graphQLErrors:p})))))),this.createPriorAuthorizationEquipmentEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(r=>this.priorAuthorizationEquipmentService.createPriorAuthorizationEquipment(Object.assign({},r)).pipe((0,g._b)(m=>{this.addNewPriorAuthorizationEquipment(m),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:m,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},m=>{m.graphQLErrors?(this.toast.error(m.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})):(this.toast.error(m.Message),this.formService.setErrors(m.Data))}))))),this.updatePriorAuthorizationEquipmentEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([r,m])=>this.priorAuthorizationEquipmentService.updatePriorAuthorizationEquipment(r,r.id).pipe((0,g._b)(p=>{this.updatePriorAuthorizationEquipment(p),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:p,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},p=>{p.graphQLErrors?(this.toast.error(p.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:p.graphQLErrors?p.graphQLErrors:p})):(this.toast.error(p.Message),this.formService.setErrors(p.Data))}))))),this.deletePriorAuthorizationEquipmentEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([r,m])=>this.data.userDeletePriorAuthorizationEquipment({priorAuthorizationEquipmentId:m.id}).pipe((0,g._b)(p=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:p.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},p=>{p.graphQLErrors?(this.toast.error(p.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:p.graphQLErrors?p.graphQLErrors:p})):(this.toast.error(p.Message),this.formService.setErrors(p.Data))}))))),this.importExcelEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(r=>this.priorAuthorizationEquipmentService.importPriorAuthorizationEquipments(r).pipe((0,ce.K)(m=>{var p;return this.toast.error(null!==(p=m.Message)&&void 0!==p?p:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(m=>{const p=JSON.parse(m.created),_=JSON.parse(m.updated),w=JSON.parse(m.failed),J=p.length+_.length+w.length;this.addPriorAuthorizationEquipments(p),this.updatePriorAuthorizationEquipments(_),this.toast.success(`${p.length} created, ${_.length} updated, ${w.length} failed of total ${J}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("priorAuthorizationEquipmentId")?(this.route.snapshot.paramMap.get("priorAuthorizationEquipmentId"),this.setFormName("priorAuthorizationEquipment_edit")):this.setFormName("priorAuthorizationEquipment_create"),this.route.snapshot.paramMap.has("equipmentId")){var c=this.route.snapshot.paramMap.get("equipmentId");this.setEquipmentId(c)}if(this.route.snapshot.paramMap.has("priorAuthorizationRequestId")){var d=this.route.snapshot.paramMap.get("priorAuthorizationRequestId");this.setPriorAuthorizationRequestId(d)}}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.priorAuthorizationEquipmentService.validatePriorAuthorizationEquipmentExcelData(t,i.equipments,i.priorAuthorizationRequests)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(FJ))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function PJ(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.priorAuthorizationEquipment)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let hu=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"priorAuthorizationEquipment_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.priorAuthorizationEquipment=i.item})):t.formName&&t.formName.currentValue&&"priorAuthorizationEquipment_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadPriorAuthorizationEquipmentEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.priorAuthorizationEquipment=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(da),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-prior-authorization-equipment-form"]],inputs:{priorAuthorizationEquipment:"priorAuthorizationEquipment",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,PJ,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),fu=(()=>{class s{constructor(){this.autoHeight=!1,this.priorAuthorizationEquipments=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[{field:"equipment.name",headerName:"Equipment",filter:"agTextColumnFilter"},{field:"priorAuthorizationRequest.name",headerName:"Prior Authorization Request",filter:"agTextColumnFilter"},{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{headerName:"Estimated Cost",field:"estimatedCost",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.estimatedCost,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{field:"equipmentId",filter:"agTextColumnFilter",hide:!0},{field:"priorAuthorizationRequestId",filter:"agTextColumnFilter",hide:!0}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-prior-authorization-equipment-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",priorAuthorizationEquipments:"priorAuthorizationEquipments"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.priorAuthorizationEquipments)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function IJ(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-prior-authorization-equipment-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","priorAuthorizationEquipment_edit")("formControl",t.formControl)("priorAuthorizationEquipment",t.priorAuthorizationEquipment)}}const DJ=function(){return{}};function MJ(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-prior-authorization-equipment-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","priorAuthorizationEquipment_create")("formControl",t.formControl)("priorAuthorizationEquipment",e.DdM(3,DJ))}}function WJ(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-prior-authorization-equipment-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("priorAuthorizationEquipments",o.data.items)}let EJ=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadPriorAuthorizationEquipmentsEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.priorAuthorizationEquipments$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(da))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","priorAuthorizationEquipment","send","close"],[1,"w-full","h-full","bg-white",3,"priorAuthorizationEquipments","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,IJ,2,3,"ng-template",null,1,e.W1O),e.YNc(3,MJ,1,4,"ng-template",null,2,e.W1O),e.YNc(5,WJ,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,hu,fu],encapsulation:2}),s})();function OJ(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-prior-authorization-equipment-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","priorAuthorizationEquipment_edit")("priorAuthorizationEquipment",t.value)}}const LJ=function(){return{}};function $J(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-prior-authorization-equipment-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","priorAuthorizationEquipment_create")("priorAuthorizationEquipment",e.DdM(2,LJ))}function GJ(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-prior-authorization-equipment-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("priorAuthorizationEquipments",t.items)}}let RJ=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","priorAuthorizationEquipment","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","priorAuthorizationEquipments","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,OJ,1,2,"ng-template",null,1,e.W1O),e.YNc(3,$J,1,3,"ng-template",null,2,e.W1O),e.YNc(5,GJ,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,hu,fu],encapsulation:2}),s})(),QJ=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[da],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"prior-authorization-equipment-select",component:EJ,wrappers:["form-field"]},{name:"prior-authorization-equipment-grid",component:RJ}]})]}),s})(),VJ=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[QJ]}),s})();class Ui extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class jJ extends Ui{constructor(o,t,i){super("ValidatePriorAuthorizationImplantExcelDataAction"),this.valid=!1,this.excelData=o,this.implants=t,this.priorAuthorizationRequests=i}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name),this.validationContext.addRule(new f.mi(`implantName_${i}_is_valid}`,"Implant Is Not Valid","implant.name",t.implant,this.implants,!0)),this.validationContext.addRule(new f.mi(`priorAuthorizationRequestName_${i}_is_valid}`,"Prior Authorization Request Is Not Valid","priorAuthorizationRequest.name",t.priorAuthorizationRequest,this.priorAuthorizationRequests,!0))}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class UJ extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class JJ extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new UJ("name","The priorauthorizationimplant name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class zJ extends Ui{constructor(o){super("CreatePriorAuthorizationImplantAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new JJ("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreatePriorAuthorizationImplant({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class HJ extends Ui{constructor(o){super("UpdatePriorAuthorizationImplantsAction"),this.priorAuthorizationImplants=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.priorAuthorizationImplants,!0))}performAction(){this.response=this.businessProvider.data.userUpdatePriorAuthorizationImplants({input:{priorAuthorizationImplants:this.priorAuthorizationImplants}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class qJ extends Ui{constructor(o,t){super("UpdatePriorAuthorizationImplantAction"),this.priorAuthorizationImplant=o,this.priorAuthorizationImplantId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.priorAuthorizationImplant,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.priorAuthorizationImplantId,!0))}performAction(){this.response=this.businessProvider.data.userUpdatePriorAuthorizationImplant({priorAuthorizationImplantId:this.priorAuthorizationImplantId,input:this.priorAuthorizationImplant}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let _u=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.PriorAuthorizationImplantBusinessProviderService",t,a),this.data=i}createPriorAuthorizationImplant(t){const i=new zJ(t);return i.Do(this),i.response}updatePriorAuthorizationImplant(t,i){const a=new qJ(t,i);return a.Do(this),a.response}importPriorAuthorizationImplants(t){const i=new HJ(t);return i.Do(this),i.response}validatePriorAuthorizationImplantExcelData(t,i,a){const l=new jJ(t,i,a);return l.Do(this),l.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),KJ=(()=>{class s extends I.nH{constructor(t,i,a){super("PriorAuthorizationImplantService",a,t),this.businessProvider=i}createPriorAuthorizationImplant(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createPriorAuthorizationImplant(i)}updatePriorAuthorizationImplant(t,i){return this.businessProvider.updatePriorAuthorizationImplant(t,i)}importPriorAuthorizationImplants(t){return this.businessProvider.importPriorAuthorizationImplants(t)}validatePriorAuthorizationImplantExcelData(t,i,a){return this.businessProvider.validatePriorAuthorizationImplantExcelData(t,i,a)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(_u,8),e.LFG(_u),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),ua=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){if(super({loading:!1,priorAuthorizationImplants:[],done:!1,searchQuery:"",formName:void 0,implantId:void 0,priorAuthorizationRequestId:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.priorAuthorizationImplantService=H,this.errors$=this.select(n=>n.errors),this.loading$=this.select(n=>n.loading),this.done$=this.select(n=>n.done),this.item$=this.select(n=>n.item),this.priorAuthorizationImplants$=this.select(n=>n.priorAuthorizationImplants),this.implants$=this.select(n=>n.implants||[]),this.priorAuthorizationRequests$=this.select(n=>n.priorAuthorizationRequests||[]),this.implantId$=this.select(n=>n.implantId),this.priorAuthorizationRequestId$=this.select(n=>n.priorAuthorizationRequestId),this.paging$=this.select(n=>n.paging),this.searchQuery$=this.select(n=>n.searchQuery),this.formName$=this.select(n=>n.formName),this.actionResult$=this.select(this.item$,this.done$,(n,r)=>({item:n,done:r}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.priorAuthorizationImplants$,this.implants$,this.priorAuthorizationRequests$,(n,r,m,p,_,w,J)=>({errors:n,loading:r,item:m,formName:p,priorAuthorizationImplants:_,implants:w,priorAuthorizationRequests:J}),{debounce:!0}),this.input$=this.select(this.paging$,this.implantId$,this.priorAuthorizationRequestId$,this.searchQuery$,(n,r,m,p)=>({limit:n.limit,skip:n.skip,name:p,implantId:r,priorAuthorizationRequestId:m,total:n.total})),this.setFormName=this.updater((n,r)=>Object.assign(Object.assign({},n),{formName:r})),this.setImplantId=this.updater((n,r)=>Object.assign(Object.assign({},n),{implantId:r})),this.setPriorAuthorizationRequestId=this.updater((n,r)=>Object.assign(Object.assign({},n),{priorAuthorizationRequestId:r})),this.filterImplants=n=>this.data.userSelectImplants({input:{name:n}}).pipe((0,g._b)(r=>{let m=r.data.items;return this.patchState({implants:m}),m},r=>this.patchState({errors:r.graphQLErrors?r.graphQLErrors:r})),(0,he.U)(r=>r.data.items)),this.filterPriorAuthorizationRequests=n=>this.data.userSelectPriorAuthorizationRequests({input:{name:n}}).pipe((0,g._b)(r=>{let m=r.data.items;return this.patchState({priorAuthorizationRequests:m}),m},r=>this.patchState({errors:r.graphQLErrors?r.graphQLErrors:r})),(0,he.U)(r=>r.data.items)),this.addImplant=this.updater((n,r)=>Object.assign(Object.assign({},n),{implants:n.implants.concat(r)})),this.addPriorAuthorizationRequest=this.updater((n,r)=>Object.assign(Object.assign({},n),{priorAuthorizationRequests:n.priorAuthorizationRequests.concat(r)})),this.setItem=this.updater((n,r)=>Object.assign(Object.assign({},n),{item:r})),this.addNewPriorAuthorizationImplant=this.updater((n,r)=>Object.assign(Object.assign({},n),{priorAuthorizationImplants:[...n.priorAuthorizationImplants,r]})),this.updatePriorAuthorizationImplant=this.updater((n,r)=>Object.assign(Object.assign({},n),{priorAuthorizationImplants:n.priorAuthorizationImplants.map(m=>m.id===r.id?r:m)})),this.addPriorAuthorizationImplants=this.updater((n,r)=>Object.assign(Object.assign({},n),{priorAuthorizationImplants:n.priorAuthorizationImplants.concat(r)})),this.updatePriorAuthorizationImplants=this.updater((n,r)=>Object.assign(Object.assign({},n),{priorAuthorizationImplants:n.priorAuthorizationImplants.map(m=>r.find(_=>_.id===m.id)||m)})),this.setSearchQuery=this.updater((n,r)=>Object.assign(Object.assign({},n),{searchQuery:r})),this.loadPriorAuthorizationImplantEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(r=>this.data.userPriorAuthorizationImplant({priorAuthorizationImplantId:r}).pipe((0,g._b)(m=>{this.patchState({item:m.data.item,errors:m.errors,loading:!1})},m=>this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})))))),this.loadPriorAuthorizationImplantsEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([r,m])=>this.data.userPriorAuthorizationImplants({input:m}).pipe((0,g._b)(p=>this.patchState({paging:{limit:m.limit,skip:m.skip,total:p.data.count.total},priorAuthorizationImplants:p.data.items,errors:p.errors,loading:!1}),p=>this.patchState({loading:!1,errors:p.graphQLErrors?p.graphQLErrors:p})))))),this.createPriorAuthorizationImplantEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(r=>this.priorAuthorizationImplantService.createPriorAuthorizationImplant(Object.assign({},r)).pipe((0,g._b)(m=>{this.addNewPriorAuthorizationImplant(m),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:m,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},m=>{m.graphQLErrors?(this.toast.error(m.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})):(this.toast.error(m.Message),this.formService.setErrors(m.Data))}))))),this.updatePriorAuthorizationImplantEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([r,m])=>this.priorAuthorizationImplantService.updatePriorAuthorizationImplant(r,r.id).pipe((0,g._b)(p=>{this.updatePriorAuthorizationImplant(p),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:p,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},p=>{p.graphQLErrors?(this.toast.error(p.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:p.graphQLErrors?p.graphQLErrors:p})):(this.toast.error(p.Message),this.formService.setErrors(p.Data))}))))),this.deletePriorAuthorizationImplantEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([r,m])=>this.data.userDeletePriorAuthorizationImplant({priorAuthorizationImplantId:m.id}).pipe((0,g._b)(p=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:p.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},p=>{p.graphQLErrors?(this.toast.error(p.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:p.graphQLErrors?p.graphQLErrors:p})):(this.toast.error(p.Message),this.formService.setErrors(p.Data))}))))),this.importExcelEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(r=>this.priorAuthorizationImplantService.importPriorAuthorizationImplants(r).pipe((0,ce.K)(m=>{var p;return this.toast.error(null!==(p=m.Message)&&void 0!==p?p:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(m=>{const p=JSON.parse(m.created),_=JSON.parse(m.updated),w=JSON.parse(m.failed),J=p.length+_.length+w.length;this.addPriorAuthorizationImplants(p),this.updatePriorAuthorizationImplants(_),this.toast.success(`${p.length} created, ${_.length} updated, ${w.length} failed of total ${J}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("priorAuthorizationImplantId")?(this.route.snapshot.paramMap.get("priorAuthorizationImplantId"),this.setFormName("priorAuthorizationImplant_edit")):this.setFormName("priorAuthorizationImplant_create"),this.route.snapshot.paramMap.has("implantId")){var c=this.route.snapshot.paramMap.get("implantId");this.setImplantId(c)}if(this.route.snapshot.paramMap.has("priorAuthorizationRequestId")){var d=this.route.snapshot.paramMap.get("priorAuthorizationRequestId");this.setPriorAuthorizationRequestId(d)}}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.priorAuthorizationImplantService.validatePriorAuthorizationImplantExcelData(t,i.implants,i.priorAuthorizationRequests)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(KJ))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function ZJ(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.priorAuthorizationImplant)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let gu=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"priorAuthorizationImplant_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.priorAuthorizationImplant=i.item})):t.formName&&t.formName.currentValue&&"priorAuthorizationImplant_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadPriorAuthorizationImplantEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.priorAuthorizationImplant=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(ua),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-prior-authorization-implant-form"]],inputs:{priorAuthorizationImplant:"priorAuthorizationImplant",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,ZJ,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),Cu=(()=>{class s{constructor(){this.autoHeight=!1,this.priorAuthorizationImplants=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[{field:"implant.name",headerName:"Implant",filter:"agTextColumnFilter"},{field:"priorAuthorizationRequest.name",headerName:"Prior Authorization Request",filter:"agTextColumnFilter"},{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{headerName:"Estimated Cost",field:"estimatedCost",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.estimatedCost,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{field:"implantId",filter:"agTextColumnFilter",hide:!0},{field:"priorAuthorizationRequestId",filter:"agTextColumnFilter",hide:!0}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-prior-authorization-implant-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",priorAuthorizationImplants:"priorAuthorizationImplants"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.priorAuthorizationImplants)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function kJ(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-prior-authorization-implant-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","priorAuthorizationImplant_edit")("formControl",t.formControl)("priorAuthorizationImplant",t.priorAuthorizationImplant)}}const BJ=function(){return{}};function YJ(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-prior-authorization-implant-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","priorAuthorizationImplant_create")("formControl",t.formControl)("priorAuthorizationImplant",e.DdM(3,BJ))}}function XJ(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-prior-authorization-implant-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("priorAuthorizationImplants",o.data.items)}let ez=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadPriorAuthorizationImplantsEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.priorAuthorizationImplants$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(ua))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","priorAuthorizationImplant","send","close"],[1,"w-full","h-full","bg-white",3,"priorAuthorizationImplants","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,kJ,2,3,"ng-template",null,1,e.W1O),e.YNc(3,YJ,1,4,"ng-template",null,2,e.W1O),e.YNc(5,XJ,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,gu,Cu],encapsulation:2}),s})();function tz(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-prior-authorization-implant-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","priorAuthorizationImplant_edit")("priorAuthorizationImplant",t.value)}}const iz=function(){return{}};function sz(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-prior-authorization-implant-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","priorAuthorizationImplant_create")("priorAuthorizationImplant",e.DdM(2,iz))}function oz(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-prior-authorization-implant-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("priorAuthorizationImplants",t.items)}}let az=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","priorAuthorizationImplant","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","priorAuthorizationImplants","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,tz,1,2,"ng-template",null,1,e.W1O),e.YNc(3,sz,1,3,"ng-template",null,2,e.W1O),e.YNc(5,oz,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,gu,Cu],encapsulation:2}),s})(),rz=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[ua],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"prior-authorization-implant-select",component:ez,wrappers:["form-field"]},{name:"prior-authorization-implant-grid",component:az}]})]}),s})(),nz=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[rz]}),s})();class Ji extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class lz extends Ji{constructor(o,t,i,a){super("ValidatePriorAuthorizationProcedureCodeExcelDataAction"),this.valid=!1,this.excelData=o,this.costCategories=t,this.procedures=i,this.priorAuthorizationRequests=a}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name),this.validationContext.addRule(new f.mi(`costCategoryName_${i}_is_valid}`,"Cost Category Is Not Valid","costCategory.name",t.costCategory,this.costCategories,!0)),this.validationContext.addRule(new f.mi(`procedureName_${i}_is_valid}`,"Procedure Is Not Valid","procedure.name",t.procedure,this.procedures,!0)),this.validationContext.addRule(new f.mi(`priorAuthorizationRequestName_${i}_is_valid}`,"Prior Authorization Request Is Not Valid","priorAuthorizationRequest.name",t.priorAuthorizationRequest,this.priorAuthorizationRequests,!0))}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class cz extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class dz extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new cz("name","The priorauthorizationprocedurecode name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class uz extends Ji{constructor(o){super("CreatePriorAuthorizationProcedureCodeAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new dz("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreatePriorAuthorizationProcedureCode({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class mz extends Ji{constructor(o){super("UpdatePriorAuthorizationProcedureCodesAction"),this.priorAuthorizationProcedureCodes=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.priorAuthorizationProcedureCodes,!0))}performAction(){this.response=this.businessProvider.data.userUpdatePriorAuthorizationProcedureCodes({input:{priorAuthorizationProcedureCodes:this.priorAuthorizationProcedureCodes}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class pz extends Ji{constructor(o,t){super("UpdatePriorAuthorizationProcedureCodeAction"),this.priorAuthorizationProcedureCode=o,this.priorAuthorizationProcedureCodeId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.priorAuthorizationProcedureCode,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.priorAuthorizationProcedureCodeId,!0))}performAction(){this.response=this.businessProvider.data.userUpdatePriorAuthorizationProcedureCode({priorAuthorizationProcedureCodeId:this.priorAuthorizationProcedureCodeId,input:this.priorAuthorizationProcedureCode}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let vu=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.PriorAuthorizationProcedureCodeBusinessProviderService",t,a),this.data=i}createPriorAuthorizationProcedureCode(t){const i=new uz(t);return i.Do(this),i.response}updatePriorAuthorizationProcedureCode(t,i){const a=new pz(t,i);return a.Do(this),a.response}importPriorAuthorizationProcedureCodes(t){const i=new mz(t);return i.Do(this),i.response}validatePriorAuthorizationProcedureCodeExcelData(t,i,a,l){const u=new lz(t,i,a,l);return u.Do(this),u.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),hz=(()=>{class s extends I.nH{constructor(t,i,a){super("PriorAuthorizationProcedureCodeService",a,t),this.businessProvider=i}createPriorAuthorizationProcedureCode(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createPriorAuthorizationProcedureCode(i)}updatePriorAuthorizationProcedureCode(t,i){return this.businessProvider.updatePriorAuthorizationProcedureCode(t,i)}importPriorAuthorizationProcedureCodes(t){return this.businessProvider.importPriorAuthorizationProcedureCodes(t)}validatePriorAuthorizationProcedureCodeExcelData(t,i,a,l){return this.businessProvider.validatePriorAuthorizationProcedureCodeExcelData(t,i,a,l)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(vu,8),e.LFG(vu),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),ma=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){if(super({loading:!1,priorAuthorizationProcedureCodes:[],done:!1,searchQuery:"",formName:void 0,costCategoryId:void 0,procedureId:void 0,priorAuthorizationRequestId:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.priorAuthorizationProcedureCodeService=H,this.errors$=this.select(r=>r.errors),this.loading$=this.select(r=>r.loading),this.done$=this.select(r=>r.done),this.item$=this.select(r=>r.item),this.priorAuthorizationProcedureCodes$=this.select(r=>r.priorAuthorizationProcedureCodes),this.costCategories$=this.select(r=>r.costCategories||[]),this.procedures$=this.select(r=>r.procedures||[]),this.priorAuthorizationRequests$=this.select(r=>r.priorAuthorizationRequests||[]),this.costCategoryId$=this.select(r=>r.costCategoryId),this.procedureId$=this.select(r=>r.procedureId),this.priorAuthorizationRequestId$=this.select(r=>r.priorAuthorizationRequestId),this.paging$=this.select(r=>r.paging),this.searchQuery$=this.select(r=>r.searchQuery),this.formName$=this.select(r=>r.formName),this.actionResult$=this.select(this.item$,this.done$,(r,m)=>({item:r,done:m}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.priorAuthorizationProcedureCodes$,this.costCategories$,this.procedures$,this.priorAuthorizationRequests$,(r,m,p,_,w,J,_e,ve)=>({errors:r,loading:m,item:p,formName:_,priorAuthorizationProcedureCodes:w,costCategories:J,procedures:_e,priorAuthorizationRequests:ve}),{debounce:!0}),this.input$=this.select(this.paging$,this.costCategoryId$,this.procedureId$,this.priorAuthorizationRequestId$,this.searchQuery$,(r,m,p,_,w)=>({limit:r.limit,skip:r.skip,name:w,costCategoryId:m,procedureId:p,priorAuthorizationRequestId:_,total:r.total})),this.setFormName=this.updater((r,m)=>Object.assign(Object.assign({},r),{formName:m})),this.setCostCategoryId=this.updater((r,m)=>Object.assign(Object.assign({},r),{costCategoryId:m})),this.setProcedureId=this.updater((r,m)=>Object.assign(Object.assign({},r),{procedureId:m})),this.setPriorAuthorizationRequestId=this.updater((r,m)=>Object.assign(Object.assign({},r),{priorAuthorizationRequestId:m})),this.filterCostCategories=r=>this.data.userSelectCostCategories({input:{name:r}}).pipe((0,g._b)(m=>{let p=m.data.items;return this.patchState({costCategories:p}),p},m=>this.patchState({errors:m.graphQLErrors?m.graphQLErrors:m})),(0,he.U)(m=>m.data.items)),this.filterProcedures=r=>this.data.userSelectProcedures({input:{name:r}}).pipe((0,g._b)(m=>{let p=m.data.items;return this.patchState({procedures:p}),p},m=>this.patchState({errors:m.graphQLErrors?m.graphQLErrors:m})),(0,he.U)(m=>m.data.items)),this.filterPriorAuthorizationRequests=r=>this.data.userSelectPriorAuthorizationRequests({input:{name:r}}).pipe((0,g._b)(m=>{let p=m.data.items;return this.patchState({priorAuthorizationRequests:p}),p},m=>this.patchState({errors:m.graphQLErrors?m.graphQLErrors:m})),(0,he.U)(m=>m.data.items)),this.addCostCategory=this.updater((r,m)=>Object.assign(Object.assign({},r),{costCategories:r.costCategories.concat(m)})),this.addProcedure=this.updater((r,m)=>Object.assign(Object.assign({},r),{procedures:r.procedures.concat(m)})),this.addPriorAuthorizationRequest=this.updater((r,m)=>Object.assign(Object.assign({},r),{priorAuthorizationRequests:r.priorAuthorizationRequests.concat(m)})),this.setItem=this.updater((r,m)=>Object.assign(Object.assign({},r),{item:m})),this.addNewPriorAuthorizationProcedureCode=this.updater((r,m)=>Object.assign(Object.assign({},r),{priorAuthorizationProcedureCodes:[...r.priorAuthorizationProcedureCodes,m]})),this.updatePriorAuthorizationProcedureCode=this.updater((r,m)=>Object.assign(Object.assign({},r),{priorAuthorizationProcedureCodes:r.priorAuthorizationProcedureCodes.map(p=>p.id===m.id?m:p)})),this.addPriorAuthorizationProcedureCodes=this.updater((r,m)=>Object.assign(Object.assign({},r),{priorAuthorizationProcedureCodes:r.priorAuthorizationProcedureCodes.concat(m)})),this.updatePriorAuthorizationProcedureCodes=this.updater((r,m)=>Object.assign(Object.assign({},r),{priorAuthorizationProcedureCodes:r.priorAuthorizationProcedureCodes.map(p=>m.find(w=>w.id===p.id)||p)})),this.setSearchQuery=this.updater((r,m)=>Object.assign(Object.assign({},r),{searchQuery:m})),this.loadPriorAuthorizationProcedureCodeEffect=this.effect(r=>r.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(m=>this.data.userPriorAuthorizationProcedureCode({priorAuthorizationProcedureCodeId:m}).pipe((0,g._b)(p=>{this.patchState({item:p.data.item,errors:p.errors,loading:!1})},p=>this.patchState({loading:!1,errors:p.graphQLErrors?p.graphQLErrors:p})))))),this.loadPriorAuthorizationProcedureCodesEffect=this.effect(r=>r.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([m,p])=>this.data.userPriorAuthorizationProcedureCodes({input:p}).pipe((0,g._b)(_=>this.patchState({paging:{limit:p.limit,skip:p.skip,total:_.data.count.total},priorAuthorizationProcedureCodes:_.data.items,errors:_.errors,loading:!1}),_=>this.patchState({loading:!1,errors:_.graphQLErrors?_.graphQLErrors:_})))))),this.createPriorAuthorizationProcedureCodeEffect=this.effect(r=>r.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(m=>this.priorAuthorizationProcedureCodeService.createPriorAuthorizationProcedureCode(Object.assign({},m)).pipe((0,g._b)(p=>{this.addNewPriorAuthorizationProcedureCode(p),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:p,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},p=>{p.graphQLErrors?(this.toast.error(p.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:p.graphQLErrors?p.graphQLErrors:p})):(this.toast.error(p.Message),this.formService.setErrors(p.Data))}))))),this.updatePriorAuthorizationProcedureCodeEffect=this.effect(r=>r.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([m,p])=>this.priorAuthorizationProcedureCodeService.updatePriorAuthorizationProcedureCode(m,m.id).pipe((0,g._b)(_=>{this.updatePriorAuthorizationProcedureCode(_),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:_,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},_=>{_.graphQLErrors?(this.toast.error(_.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:_.graphQLErrors?_.graphQLErrors:_})):(this.toast.error(_.Message),this.formService.setErrors(_.Data))}))))),this.deletePriorAuthorizationProcedureCodeEffect=this.effect(r=>r.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([m,p])=>this.data.userDeletePriorAuthorizationProcedureCode({priorAuthorizationProcedureCodeId:p.id}).pipe((0,g._b)(_=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:_.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},_=>{_.graphQLErrors?(this.toast.error(_.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:_.graphQLErrors?_.graphQLErrors:_})):(this.toast.error(_.Message),this.formService.setErrors(_.Data))}))))),this.importExcelEffect=this.effect(r=>r.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(m=>this.priorAuthorizationProcedureCodeService.importPriorAuthorizationProcedureCodes(m).pipe((0,ce.K)(p=>{var _;return this.toast.error(null!==(_=p.Message)&&void 0!==_?_:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(p=>{const _=JSON.parse(p.created),w=JSON.parse(p.updated),J=JSON.parse(p.failed),_e=_.length+w.length+J.length;this.addPriorAuthorizationProcedureCodes(_),this.updatePriorAuthorizationProcedureCodes(w),this.toast.success(`${_.length} created, ${w.length} updated, ${J.length} failed of total ${_e}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("priorAuthorizationProcedureCodeId")?(this.route.snapshot.paramMap.get("priorAuthorizationProcedureCodeId"),this.setFormName("priorAuthorizationProcedureCode_edit")):this.setFormName("priorAuthorizationProcedureCode_create"),this.route.snapshot.paramMap.has("costCategoryId")){var c=this.route.snapshot.paramMap.get("costCategoryId");this.setCostCategoryId(c)}if(this.route.snapshot.paramMap.has("procedureId")){var d=this.route.snapshot.paramMap.get("procedureId");this.setProcedureId(d)}if(this.route.snapshot.paramMap.has("priorAuthorizationRequestId")){var n=this.route.snapshot.paramMap.get("priorAuthorizationRequestId");this.setPriorAuthorizationRequestId(n)}}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.priorAuthorizationProcedureCodeService.validatePriorAuthorizationProcedureCodeExcelData(t,i.costCategories,i.procedures,i.priorAuthorizationRequests)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(hz))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function fz(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.priorAuthorizationProcedureCode)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let Su=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"priorAuthorizationProcedureCode_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.priorAuthorizationProcedureCode=i.item})):t.formName&&t.formName.currentValue&&"priorAuthorizationProcedureCode_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadPriorAuthorizationProcedureCodeEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.priorAuthorizationProcedureCode=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(ma),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-prior-authorization-procedure-code-form"]],inputs:{priorAuthorizationProcedureCode:"priorAuthorizationProcedureCode",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,fz,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),bu=(()=>{class s{constructor(){this.autoHeight=!1,this.priorAuthorizationProcedureCodes=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[{field:"costCategory.name",headerName:"Cost Category",filter:"agTextColumnFilter"},{field:"procedure.name",headerName:"Procedure",filter:"agTextColumnFilter"},{field:"priorAuthorizationRequest.name",headerName:"Prior Authorization Request",filter:"agTextColumnFilter"},{field:"procedureId",filter:"agTextColumnFilter",hide:!0},{field:"priorAuthorizationRequestId",filter:"agTextColumnFilter",hide:!0},{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{field:"costCategoryId",filter:"agTextColumnFilter",hide:!0},{headerName:"Estimated Cost",field:"estimatedCost",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.estimatedCost,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-prior-authorization-procedure-code-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",priorAuthorizationProcedureCodes:"priorAuthorizationProcedureCodes"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.priorAuthorizationProcedureCodes)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function _z(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-prior-authorization-procedure-code-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","priorAuthorizationProcedureCode_edit")("formControl",t.formControl)("priorAuthorizationProcedureCode",t.priorAuthorizationProcedureCode)}}const gz=function(){return{}};function Cz(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-prior-authorization-procedure-code-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","priorAuthorizationProcedureCode_create")("formControl",t.formControl)("priorAuthorizationProcedureCode",e.DdM(3,gz))}}function vz(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-prior-authorization-procedure-code-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("priorAuthorizationProcedureCodes",o.data.items)}let Sz=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadPriorAuthorizationProcedureCodesEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.priorAuthorizationProcedureCodes$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(ma))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","priorAuthorizationProcedureCode","send","close"],[1,"w-full","h-full","bg-white",3,"priorAuthorizationProcedureCodes","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,_z,2,3,"ng-template",null,1,e.W1O),e.YNc(3,Cz,1,4,"ng-template",null,2,e.W1O),e.YNc(5,vz,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,Su,bu],encapsulation:2}),s})();function bz(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-prior-authorization-procedure-code-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","priorAuthorizationProcedureCode_edit")("priorAuthorizationProcedureCode",t.value)}}const Tz=function(){return{}};function yz(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-prior-authorization-procedure-code-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","priorAuthorizationProcedureCode_create")("priorAuthorizationProcedureCode",e.DdM(2,Tz))}function wz(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-prior-authorization-procedure-code-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("priorAuthorizationProcedureCodes",t.items)}}let xz=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","priorAuthorizationProcedureCode","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","priorAuthorizationProcedureCodes","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,bz,1,2,"ng-template",null,1,e.W1O),e.YNc(3,yz,1,3,"ng-template",null,2,e.W1O),e.YNc(5,wz,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,Su,bu],encapsulation:2}),s})(),Nz=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[ma],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"prior-authorization-procedure-code-select",component:Sz,wrappers:["form-field"]},{name:"prior-authorization-procedure-code-grid",component:xz}]})]}),s})(),Az=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[Nz]}),s})();class zi extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class Fz extends zi{constructor(o,t,i,a,l,u,H,A,c,d,n,r){super("ValidatePriorAuthorizationRequestExcelDataAction"),this.valid=!1,this.excelData=o,this.procedureSites=t,this.surgicalPositions=i,this.treatingProviders=a,this.referredTos=l,this.prescriptions=u,this.visitKinds=H,this.guidelineUseds=A,this.authorizationKinds=c,this.authorizationStatuses=d,this.patients=n,this.caseProcedures=r}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name),this.validationContext.addRule(new f.mi(`procedureSiteName_${i}_is_valid}`,"Procedure Site Is Not Valid","procedureSite.name",t.procedureSite,this.procedureSites,!0)),this.validationContext.addRule(new f.mi(`surgicalPositionName_${i}_is_valid}`,"Surgical Position Is Not Valid","surgicalPosition.name",t.surgicalPosition,this.surgicalPositions,!0)),this.validationContext.addRule(new f.mi(`treatingProviderName_${i}_is_valid}`,"Treating Provider Is Not Valid","treatingProvider.name",t.treatingProvider,this.treatingProviders,!0)),this.validationContext.addRule(new f.mi(`referredToName_${i}_is_valid}`,"Referred to Is Not Valid","referredTo.name",t.referredTo,this.referredTos,!0)),this.validationContext.addRule(new f.mi(`prescriptionName_${i}_is_valid}`,"Prescription Is Not Valid","prescription.name",t.prescription,this.prescriptions,!0)),this.validationContext.addRule(new f.mi(`visitKindName_${i}_is_valid}`,"Visit Kind Is Not Valid","visitKind.name",t.visitKind,this.visitKinds,!0)),this.validationContext.addRule(new f.mi(`guidelineUsedName_${i}_is_valid}`,"Guideline Used Is Not Valid","guidelineUsed.name",t.guidelineUsed,this.guidelineUseds,!0)),this.validationContext.addRule(new f.mi(`authorizationKindName_${i}_is_valid}`,"Authorization Kind Is Not Valid","authorizationKind.name",t.authorizationKind,this.authorizationKinds,!0)),this.validationContext.addRule(new f.mi(`authorizationStatusName_${i}_is_valid}`,"Authorization Status Is Not Valid","authorizationStatus.name",t.authorizationStatus,this.authorizationStatuses,!0)),this.validationContext.addRule(new f.mi(`patientName_${i}_is_valid}`,"Patient Is Not Valid","patient.name",t.patient,this.patients,!0)),this.validationContext.addRule(new f.mi(`caseProcedureName_${i}_is_valid}`,"Case Procedure Is Not Valid","caseProcedure.name",t.caseProcedure,this.caseProcedures,!0))}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class Pz extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class Iz extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new Pz("name","The priorauthorizationrequest name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class Dz extends zi{constructor(o){super("CreatePriorAuthorizationRequestAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new Iz("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreatePriorAuthorizationRequest({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class Mz extends zi{constructor(o){super("UpdatePriorAuthorizationRequestsAction"),this.priorAuthorizationRequests=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.priorAuthorizationRequests,!0))}performAction(){this.response=this.businessProvider.data.userUpdatePriorAuthorizationRequests({input:{priorAuthorizationRequests:this.priorAuthorizationRequests}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class Wz extends zi{constructor(o,t){super("UpdatePriorAuthorizationRequestAction"),this.priorAuthorizationRequest=o,this.priorAuthorizationRequestId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.priorAuthorizationRequest,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.priorAuthorizationRequestId,!0))}performAction(){this.response=this.businessProvider.data.userUpdatePriorAuthorizationRequest({priorAuthorizationRequestId:this.priorAuthorizationRequestId,input:this.priorAuthorizationRequest}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let Tu=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.PriorAuthorizationRequestBusinessProviderService",t,a),this.data=i}createPriorAuthorizationRequest(t){const i=new Dz(t);return i.Do(this),i.response}updatePriorAuthorizationRequest(t,i){const a=new Wz(t,i);return a.Do(this),a.response}importPriorAuthorizationRequests(t){const i=new Mz(t);return i.Do(this),i.response}validatePriorAuthorizationRequestExcelData(t,i,a,l,u,H,A,c,d,n,r,m){const p=new Fz(t,i,a,l,u,H,A,c,d,n,r,m);return p.Do(this),p.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),Ez=(()=>{class s extends I.nH{constructor(t,i,a){super("PriorAuthorizationRequestService",a,t),this.businessProvider=i}createPriorAuthorizationRequest(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createPriorAuthorizationRequest(i)}updatePriorAuthorizationRequest(t,i){return this.businessProvider.updatePriorAuthorizationRequest(t,i)}importPriorAuthorizationRequests(t){return this.businessProvider.importPriorAuthorizationRequests(t)}validatePriorAuthorizationRequestExcelData(t,i,a,l,u,H,A,c,d,n,r,m){return this.businessProvider.validatePriorAuthorizationRequestExcelData(t,i,a,l,u,H,A,c,d,n,r,m)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(Tu,8),e.LFG(Tu),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),pa=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){if(super({loading:!1,priorAuthorizationRequests:[],done:!1,searchQuery:"",formName:void 0,procedureSiteId:void 0,surgicalPositionId:void 0,treatingProviderId:void 0,referredToId:void 0,prescriptionId:void 0,visitKindId:void 0,guidelineUsedId:void 0,authorizationKindId:void 0,authorizationStatusId:void 0,billId:void 0,medicalReportId:void 0,patientId:void 0,caseProcedureId:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.priorAuthorizationRequestService=H,this.errors$=this.select(Y=>Y.errors),this.loading$=this.select(Y=>Y.loading),this.done$=this.select(Y=>Y.done),this.item$=this.select(Y=>Y.item),this.priorAuthorizationRequests$=this.select(Y=>Y.priorAuthorizationRequests),this.procedureSites$=this.select(Y=>Y.procedureSites||[]),this.surgicalPositions$=this.select(Y=>Y.surgicalPositions||[]),this.clinicalProviders$=this.select(Y=>Y.clinicalProviders||[]),this.documents$=this.select(Y=>Y.documents||[]),this.visitKinds$=this.select(Y=>Y.visitKinds||[]),this.guidelineUseds$=this.select(Y=>Y.guidelineUseds||[]),this.authorizationKinds$=this.select(Y=>Y.authorizationKinds||[]),this.authorizationStatuses$=this.select(Y=>Y.authorizationStatuses||[]),this.patients$=this.select(Y=>Y.patients||[]),this.caseProcedures$=this.select(Y=>Y.caseProcedures||[]),this.procedureSiteId$=this.select(Y=>Y.procedureSiteId),this.surgicalPositionId$=this.select(Y=>Y.surgicalPositionId),this.treatingProviderId$=this.select(Y=>Y.treatingProviderId),this.referredToId$=this.select(Y=>Y.referredToId),this.prescriptionId$=this.select(Y=>Y.prescriptionId),this.visitKindId$=this.select(Y=>Y.visitKindId),this.guidelineUsedId$=this.select(Y=>Y.guidelineUsedId),this.authorizationKindId$=this.select(Y=>Y.authorizationKindId),this.authorizationStatusId$=this.select(Y=>Y.authorizationStatusId),this.billId$=this.select(Y=>Y.billId),this.medicalReportId$=this.select(Y=>Y.medicalReportId),this.patientId$=this.select(Y=>Y.patientId),this.caseProcedureId$=this.select(Y=>Y.caseProcedureId),this.paging$=this.select(Y=>Y.paging),this.searchQuery$=this.select(Y=>Y.searchQuery),this.formName$=this.select(Y=>Y.formName),this.actionResult$=this.select(this.item$,this.done$,(Y,oe)=>({item:Y,done:oe}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.priorAuthorizationRequests$,this.procedureSites$,this.surgicalPositions$,this.clinicalProviders$,this.documents$,this.visitKinds$,this.guidelineUseds$,this.authorizationKinds$,this.authorizationStatuses$,this.patients$,this.caseProcedures$,(Y,oe,ge,Se,Oe,Ge,Ve,ze,He,qe,Ke,ke,Be,Ye,Qa)=>({errors:Y,loading:oe,item:ge,formName:Se,priorAuthorizationRequests:Oe,procedureSites:Ge,surgicalPositions:Ve,clinicalProviders:ze,documents:He,visitKinds:qe,guidelineUseds:Ke,authorizationKinds:ke,authorizationStatuses:Be,patients:Ye,caseProcedures:Qa}),{debounce:!0}),this.input$=this.select(this.paging$,this.procedureSiteId$,this.surgicalPositionId$,this.treatingProviderId$,this.referredToId$,this.prescriptionId$,this.visitKindId$,this.guidelineUsedId$,this.authorizationKindId$,this.authorizationStatusId$,this.billId$,this.medicalReportId$,this.patientId$,this.caseProcedureId$,this.searchQuery$,(Y,oe,ge,Se,Oe,Ge,Ve,ze,He,qe,Ke,ke,Be,Ye,Qa)=>({limit:Y.limit,skip:Y.skip,name:Qa,procedureSiteId:oe,surgicalPositionId:ge,treatingProviderId:Se,referredToId:Oe,prescriptionId:Ge,visitKindId:Ve,guidelineUsedId:ze,authorizationKindId:He,authorizationStatusId:qe,billId:Ke,medicalReportId:ke,patientId:Be,caseProcedureId:Ye,total:Y.total})),this.setFormName=this.updater((Y,oe)=>Object.assign(Object.assign({},Y),{formName:oe})),this.setProcedureSiteId=this.updater((Y,oe)=>Object.assign(Object.assign({},Y),{procedureSiteId:oe})),this.setSurgicalPositionId=this.updater((Y,oe)=>Object.assign(Object.assign({},Y),{surgicalPositionId:oe})),this.setTreatingProviderId=this.updater((Y,oe)=>Object.assign(Object.assign({},Y),{treatingProviderId:oe})),this.setReferredToId=this.updater((Y,oe)=>Object.assign(Object.assign({},Y),{referredToId:oe})),this.setPrescriptionId=this.updater((Y,oe)=>Object.assign(Object.assign({},Y),{prescriptionId:oe})),this.setVisitKindId=this.updater((Y,oe)=>Object.assign(Object.assign({},Y),{visitKindId:oe})),this.setGuidelineUsedId=this.updater((Y,oe)=>Object.assign(Object.assign({},Y),{guidelineUsedId:oe})),this.setAuthorizationKindId=this.updater((Y,oe)=>Object.assign(Object.assign({},Y),{authorizationKindId:oe})),this.setAuthorizationStatusId=this.updater((Y,oe)=>Object.assign(Object.assign({},Y),{authorizationStatusId:oe})),this.setBillId=this.updater((Y,oe)=>Object.assign(Object.assign({},Y),{billId:oe})),this.setMedicalReportId=this.updater((Y,oe)=>Object.assign(Object.assign({},Y),{medicalReportId:oe})),this.setPatientId=this.updater((Y,oe)=>Object.assign(Object.assign({},Y),{patientId:oe})),this.setCaseProcedureId=this.updater((Y,oe)=>Object.assign(Object.assign({},Y),{caseProcedureId:oe})),this.filterProcedureSites=Y=>this.data.userSelectProcedureSites({input:{name:Y}}).pipe((0,g._b)(oe=>{let ge=oe.data.items;return this.patchState({procedureSites:ge}),ge},oe=>this.patchState({errors:oe.graphQLErrors?oe.graphQLErrors:oe})),(0,he.U)(oe=>oe.data.items)),this.filterSurgicalPositions=Y=>this.data.userSelectSurgicalPositions({input:{name:Y}}).pipe((0,g._b)(oe=>{let ge=oe.data.items;return this.patchState({surgicalPositions:ge}),ge},oe=>this.patchState({errors:oe.graphQLErrors?oe.graphQLErrors:oe})),(0,he.U)(oe=>oe.data.items)),this.filterClinicalProviders=Y=>this.data.userSelectClinicalProviders({input:{name:Y}}).pipe((0,g._b)(oe=>{let ge=oe.data.items;return this.patchState({clinicalProviders:ge}),ge},oe=>this.patchState({errors:oe.graphQLErrors?oe.graphQLErrors:oe})),(0,he.U)(oe=>oe.data.items)),this.filterDocuments=Y=>this.data.userSelectDocuments({input:{name:Y}}).pipe((0,g._b)(oe=>{let ge=oe.data.items;return this.patchState({documents:ge}),ge},oe=>this.patchState({errors:oe.graphQLErrors?oe.graphQLErrors:oe})),(0,he.U)(oe=>oe.data.items)),this.filterVisitKinds=Y=>this.data.userSelectVisitKinds({input:{name:Y}}).pipe((0,g._b)(oe=>{let ge=oe.data.items;return this.patchState({visitKinds:ge}),ge},oe=>this.patchState({errors:oe.graphQLErrors?oe.graphQLErrors:oe})),(0,he.U)(oe=>oe.data.items)),this.filterGuidelineUseds=Y=>this.data.userSelectGuidelineUseds({input:{name:Y}}).pipe((0,g._b)(oe=>{let ge=oe.data.items;return this.patchState({guidelineUseds:ge}),ge},oe=>this.patchState({errors:oe.graphQLErrors?oe.graphQLErrors:oe})),(0,he.U)(oe=>oe.data.items)),this.filterAuthorizationKinds=Y=>this.data.userSelectAuthorizationKinds({input:{name:Y}}).pipe((0,g._b)(oe=>{let ge=oe.data.items;return this.patchState({authorizationKinds:ge}),ge},oe=>this.patchState({errors:oe.graphQLErrors?oe.graphQLErrors:oe})),(0,he.U)(oe=>oe.data.items)),this.filterAuthorizationStatuses=Y=>this.data.userSelectAuthorizationStatuses({input:{name:Y}}).pipe((0,g._b)(oe=>{let ge=oe.data.items;return this.patchState({authorizationStatuses:ge}),ge},oe=>this.patchState({errors:oe.graphQLErrors?oe.graphQLErrors:oe})),(0,he.U)(oe=>oe.data.items)),this.filterPatients=Y=>this.data.userSelectPatients({input:{name:Y}}).pipe((0,g._b)(oe=>{let ge=oe.data.items;return this.patchState({patients:ge}),ge},oe=>this.patchState({errors:oe.graphQLErrors?oe.graphQLErrors:oe})),(0,he.U)(oe=>oe.data.items)),this.filterCaseProcedures=Y=>this.data.userSelectCaseProcedures({input:{name:Y}}).pipe((0,g._b)(oe=>{let ge=oe.data.items;return this.patchState({caseProcedures:ge}),ge},oe=>this.patchState({errors:oe.graphQLErrors?oe.graphQLErrors:oe})),(0,he.U)(oe=>oe.data.items)),this.addProcedureSite=this.updater((Y,oe)=>Object.assign(Object.assign({},Y),{procedureSites:Y.procedureSites.concat(oe)})),this.addSurgicalPosition=this.updater((Y,oe)=>Object.assign(Object.assign({},Y),{surgicalPositions:Y.surgicalPositions.concat(oe)})),this.addClinicalProvider=this.updater((Y,oe)=>Object.assign(Object.assign({},Y),{clinicalProviders:Y.clinicalProviders.concat(oe)})),this.addDocument=this.updater((Y,oe)=>Object.assign(Object.assign({},Y),{documents:Y.documents.concat(oe)})),this.addVisitKind=this.updater((Y,oe)=>Object.assign(Object.assign({},Y),{visitKinds:Y.visitKinds.concat(oe)})),this.addGuidelineUsed=this.updater((Y,oe)=>Object.assign(Object.assign({},Y),{guidelineUseds:Y.guidelineUseds.concat(oe)})),this.addAuthorizationKind=this.updater((Y,oe)=>Object.assign(Object.assign({},Y),{authorizationKinds:Y.authorizationKinds.concat(oe)})),this.addAuthorizationStatus=this.updater((Y,oe)=>Object.assign(Object.assign({},Y),{authorizationStatuses:Y.authorizationStatuses.concat(oe)})),this.addPatient=this.updater((Y,oe)=>Object.assign(Object.assign({},Y),{patients:Y.patients.concat(oe)})),this.addCaseProcedure=this.updater((Y,oe)=>Object.assign(Object.assign({},Y),{caseProcedures:Y.caseProcedures.concat(oe)})),this.setItem=this.updater((Y,oe)=>Object.assign(Object.assign({},Y),{item:oe})),this.addNewPriorAuthorizationRequest=this.updater((Y,oe)=>Object.assign(Object.assign({},Y),{priorAuthorizationRequests:[...Y.priorAuthorizationRequests,oe]})),this.updatePriorAuthorizationRequest=this.updater((Y,oe)=>Object.assign(Object.assign({},Y),{priorAuthorizationRequests:Y.priorAuthorizationRequests.map(ge=>ge.id===oe.id?oe:ge)})),this.addPriorAuthorizationRequests=this.updater((Y,oe)=>Object.assign(Object.assign({},Y),{priorAuthorizationRequests:Y.priorAuthorizationRequests.concat(oe)})),this.updatePriorAuthorizationRequests=this.updater((Y,oe)=>Object.assign(Object.assign({},Y),{priorAuthorizationRequests:Y.priorAuthorizationRequests.map(ge=>oe.find(Oe=>Oe.id===ge.id)||ge)})),this.setSearchQuery=this.updater((Y,oe)=>Object.assign(Object.assign({},Y),{searchQuery:oe})),this.loadPriorAuthorizationRequestEffect=this.effect(Y=>Y.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(oe=>this.data.userPriorAuthorizationRequest({priorAuthorizationRequestId:oe}).pipe((0,g._b)(ge=>(console.log("-----------------------------------"),console.log(ge.data.item),this.patchState({item:ge.data.item,errors:ge.errors,loading:!1})),ge=>this.patchState({loading:!1,errors:ge.graphQLErrors?ge.graphQLErrors:ge})))))),this.loadPriorAuthorizationRequestsEffect=this.effect(Y=>Y.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([oe,ge])=>this.data.userPriorAuthorizationRequests({input:ge}).pipe((0,g._b)(Se=>this.patchState({paging:{limit:ge.limit,skip:ge.skip,total:Se.data.count.total},priorAuthorizationRequests:Se.data.items,errors:Se.errors,loading:!1}),Se=>this.patchState({loading:!1,errors:Se.graphQLErrors?Se.graphQLErrors:Se})))))),this.createPriorAuthorizationRequestEffect=this.effect(Y=>Y.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(oe=>this.priorAuthorizationRequestService.createPriorAuthorizationRequest(Object.assign({},oe)).pipe((0,g._b)(ge=>{this.addNewPriorAuthorizationRequest(ge),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:ge,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},ge=>{ge.graphQLErrors?(this.toast.error(ge.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:ge.graphQLErrors?ge.graphQLErrors:ge})):(this.toast.error(ge.Message),this.formService.setErrors(ge.Data))}))))),this.updatePriorAuthorizationRequestEffect=this.effect(Y=>Y.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([oe,ge])=>this.priorAuthorizationRequestService.updatePriorAuthorizationRequest(oe,oe.id).pipe((0,g._b)(Se=>{this.updatePriorAuthorizationRequest(Se),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:Se,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},Se=>{Se.graphQLErrors?(this.toast.error(Se.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:Se.graphQLErrors?Se.graphQLErrors:Se})):(this.toast.error(Se.Message),this.formService.setErrors(Se.Data))}))))),this.deletePriorAuthorizationRequestEffect=this.effect(Y=>Y.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([oe,ge])=>this.data.userDeletePriorAuthorizationRequest({priorAuthorizationRequestId:ge.id}).pipe((0,g._b)(Se=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:Se.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},Se=>{Se.graphQLErrors?(this.toast.error(Se.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:Se.graphQLErrors?Se.graphQLErrors:Se})):(this.toast.error(Se.Message),this.formService.setErrors(Se.Data))}))))),this.importExcelEffect=this.effect(Y=>Y.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(oe=>this.priorAuthorizationRequestService.importPriorAuthorizationRequests(oe).pipe((0,ce.K)(ge=>{var Se;return this.toast.error(null!==(Se=ge.Message)&&void 0!==Se?Se:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(ge=>{const Se=JSON.parse(ge.created),Oe=JSON.parse(ge.updated),Ge=JSON.parse(ge.failed),Ve=Se.length+Oe.length+Ge.length;this.addPriorAuthorizationRequests(Se),this.updatePriorAuthorizationRequests(Oe),this.toast.success(`${Se.length} created, ${Oe.length} updated, ${Ge.length} failed of total ${Ve}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("priorAuthorizationRequestId")?(this.route.snapshot.paramMap.get("priorAuthorizationRequestId"),this.setFormName("priorAuthorizationRequest_edit")):this.setFormName("priorAuthorizationRequest_create"),this.route.snapshot.paramMap.has("procedureSiteId")){var c=this.route.snapshot.paramMap.get("procedureSiteId");this.setProcedureSiteId(c)}if(this.route.snapshot.paramMap.has("surgicalPositionId")){var d=this.route.snapshot.paramMap.get("surgicalPositionId");this.setSurgicalPositionId(d)}if(this.route.snapshot.paramMap.has("treatingProviderId")){var n=this.route.snapshot.paramMap.get("treatingProviderId");this.setTreatingProviderId(n)}if(this.route.snapshot.paramMap.has("referredToId")){var r=this.route.snapshot.paramMap.get("referredToId");this.setReferredToId(r)}if(this.route.snapshot.paramMap.has("prescriptionId")){var m=this.route.snapshot.paramMap.get("prescriptionId");this.setPrescriptionId(m)}if(this.route.snapshot.paramMap.has("visitKindId")){var p=this.route.snapshot.paramMap.get("visitKindId");this.setVisitKindId(p)}if(this.route.snapshot.paramMap.has("guidelineUsedId")){var _=this.route.snapshot.paramMap.get("guidelineUsedId");this.setGuidelineUsedId(_)}if(this.route.snapshot.paramMap.has("authorizationKindId")){var w=this.route.snapshot.paramMap.get("authorizationKindId");this.setAuthorizationKindId(w)}if(this.route.snapshot.paramMap.has("authorizationStatusId")){var J=this.route.snapshot.paramMap.get("authorizationStatusId");this.setAuthorizationStatusId(J)}if(this.route.snapshot.paramMap.has("billId")){var _e=this.route.snapshot.paramMap.get("billId");this.setBillId(_e)}if(this.route.snapshot.paramMap.has("medicalReportId")){var ve=this.route.snapshot.paramMap.get("medicalReportId");this.setMedicalReportId(ve)}if(this.route.snapshot.paramMap.has("patientId")){var ae=this.route.snapshot.paramMap.get("patientId");this.setPatientId(ae)}if(this.route.snapshot.paramMap.has("caseProcedureId")){var le=this.route.snapshot.paramMap.get("caseProcedureId");this.setCaseProcedureId(le)}}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.priorAuthorizationRequestService.validatePriorAuthorizationRequestExcelData(t,i.procedureSites,i.surgicalPositions,i.clinicalProviders,i.clinicalProviders,i.documents,i.visitKinds,i.guidelineUseds,i.authorizationKinds,i.authorizationStatuses,i.patients,i.caseProcedures)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(Ez))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function Oz(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.priorAuthorizationRequest)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let yu=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"priorAuthorizationRequest_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({id:null,name:""}),this.store.vm$.subscribe(i=>{this.priorAuthorizationRequest=i.item})):t.formName&&t.formName.currentValue&&"priorAuthorizationRequest_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadPriorAuthorizationRequestEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.priorAuthorizationRequest=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(pa),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-prior-authorization-request-form"]],inputs:{priorAuthorizationRequest:"priorAuthorizationRequest",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,Oz,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),wu=(()=>{class s{constructor(){this.autoHeight=!1,this.priorAuthorizationRequests=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[{field:"procedureSite.name",headerName:"Procedure Site",filter:"agTextColumnFilter"},{field:"surgicalPosition.name",headerName:"Surgical Position",filter:"agTextColumnFilter"},{field:"treatingProvider.name",headerName:"Treating Provider",filter:"agTextColumnFilter"},{field:"referredTo.name",headerName:"Referred to",filter:"agTextColumnFilter"},{field:"prescription.name",headerName:"Prescription",filter:"agTextColumnFilter"},{field:"visitKind.name",headerName:"Visit Kind",filter:"agTextColumnFilter"},{field:"guidelineUsed.name",headerName:"Guideline Used",filter:"agTextColumnFilter"},{field:"authorizationKind.name",headerName:"Authorization Kind",filter:"agTextColumnFilter"},{field:"authorizationStatus.name",headerName:"Authorization Status",filter:"agTextColumnFilter"},{field:"bill.name",headerName:"Bill",filter:"agTextColumnFilter"},{field:"medicalReport.name",headerName:"Medical Report",filter:"agTextColumnFilter"},{field:"patient.name",headerName:"Patient",filter:"agTextColumnFilter"},{field:"caseProcedure.name",headerName:"Case Procedure",filter:"agTextColumnFilter"},{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{field:"referredOn",filter:"agDateColumnFilter"},{field:"approvedOn",filter:"agDateColumnFilter"},{field:"effectiveAsOf",filter:"agDateColumnFilter"},{field:"expiresOn",filter:"agDateColumnFilter"},{headerName:"Duration",field:"duration",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.duration,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{field:"procedureSiteId",filter:"agTextColumnFilter",hide:!0},{field:"surgicalPositionId",filter:"agTextColumnFilter",hide:!0},{field:"procedureDescription",filter:"agTextColumnFilter"},{field:"remarks",filter:"agTextColumnFilter"},{headerName:"Underwriting Approved",field:"underwritingApproved",filter:"agSetColumnFilter",cellRenderer:"checkboxRenderer"},{headerName:"Tpa Approved",field:"tpaApproved",filter:"agSetColumnFilter",cellRenderer:"checkboxRenderer"},{headerName:"Requires Medical Director",field:"requiresMedicalDirector",filter:"agSetColumnFilter",cellRenderer:"checkboxRenderer"},{field:"reviewedOn",filter:"agDateColumnFilter"},{field:"treatingProviderId",filter:"agTextColumnFilter",hide:!0},{field:"referredToId",filter:"agTextColumnFilter",hide:!0},{field:"priorAuthorizationNumber",filter:"agTextColumnFilter"},{field:"caseManager",filter:"agTextColumnFilter"},{field:"memberNumber",filter:"agTextColumnFilter"},{field:"medicalDirector",filter:"agTextColumnFilter"},{field:"tpaApprover",filter:"agTextColumnFilter"},{field:"underwriter",filter:"agTextColumnFilter"},{field:"prescriptionId",filter:"agTextColumnFilter",hide:!0},{field:"visitKindId",filter:"agTextColumnFilter",hide:!0},{field:"guidelineUsedId",filter:"agTextColumnFilter",hide:!0},{field:"guidelineRequires",filter:"agTextColumnFilter"},{field:"authorizationKindId",filter:"agTextColumnFilter",hide:!0},{field:"authorizationStatusId",filter:"agTextColumnFilter",hide:!0},{field:"billId",filter:"agTextColumnFilter",hide:!0},{field:"medicalReportId",filter:"agTextColumnFilter",hide:!0},{field:"patientId",filter:"agTextColumnFilter",hide:!0},{field:"caseProcedureId",filter:"agTextColumnFilter",hide:!0}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-prior-authorization-request-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",priorAuthorizationRequests:"priorAuthorizationRequests"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.priorAuthorizationRequests)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function Lz(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-prior-authorization-request-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","priorAuthorizationRequest_edit")("formControl",t.formControl)("priorAuthorizationRequest",t.priorAuthorizationRequest)}}const $z=function(){return{}};function Gz(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-prior-authorization-request-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","priorAuthorizationRequest_create")("formControl",t.formControl)("priorAuthorizationRequest",e.DdM(3,$z))}}function Rz(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-prior-authorization-request-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("priorAuthorizationRequests",o.data.items)}let Qz=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadPriorAuthorizationRequestsEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.priorAuthorizationRequests$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(pa))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","priorAuthorizationRequest","send","close"],[1,"w-full","h-full","bg-white",3,"priorAuthorizationRequests","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,Lz,2,3,"ng-template",null,1,e.W1O),e.YNc(3,Gz,1,4,"ng-template",null,2,e.W1O),e.YNc(5,Rz,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,yu,wu],encapsulation:2}),s})();function Vz(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-prior-authorization-request-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","priorAuthorizationRequest_edit")("priorAuthorizationRequest",t.value)}}const jz=function(){return{}};function Uz(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-prior-authorization-request-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","priorAuthorizationRequest_create")("priorAuthorizationRequest",e.DdM(2,jz))}function Jz(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-prior-authorization-request-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("priorAuthorizationRequests",t.items)}}let zz=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:6,consts:[[3,"data","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","priorAuthorizationRequest","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","priorAuthorizationRequests","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,Vz,1,2,"ng-template",null,1,e.W1O),e.YNc(3,Uz,1,3,"ng-template",null,2,e.W1O),e.YNc(5,Jz,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,yu,wu],encapsulation:2}),s})(),Hz=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[pa],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"prior-authorization-request-select",component:Qz,wrappers:["form-field"]},{name:"prior-authorization-request-grid",component:zz}]})]}),s})(),qz=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[Hz]}),s})();class Hi extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class Kz extends Hi{constructor(o,t,i){super("ValidatePriorMedsToDateExcelDataAction"),this.valid=!1,this.excelData=o,this.legalCases=t,this.priorMedsToDateStatuses=i}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name),this.validationContext.addRule(new f.mi(`legalCaseName_${i}_is_valid}`,"Legal Case Is Not Valid","legalCase.name",t.legalCase,this.legalCases,!0)),this.validationContext.addRule(new f.mi(`priorMedsToDateStatusName_${i}_is_valid}`,"Prior Meds to Date Status Is Not Valid","priorMedsToDateStatus.name",t.priorMedsToDateStatus,this.priorMedsToDateStatuses,!0))}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class Zz extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class kz extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new Zz("name","The priormedstodate name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class Bz extends Hi{constructor(o){super("CreatePriorMedsToDateAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new kz("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreatePriorMedsToDate({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class Yz extends Hi{constructor(o){super("UpdatePriorMedsToDatesAction"),this.priorMedsToDates=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.priorMedsToDates,!0))}performAction(){this.response=this.businessProvider.data.userUpdatePriorMedsToDates({input:{priorMedsToDates:this.priorMedsToDates}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class Xz extends Hi{constructor(o,t){super("UpdatePriorMedsToDateAction"),this.priorMedsToDate=o,this.priorMedsToDateId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.priorMedsToDate,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.priorMedsToDateId,!0))}performAction(){this.response=this.businessProvider.data.userUpdatePriorMedsToDate({priorMedsToDateId:this.priorMedsToDateId,input:this.priorMedsToDate}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let xu=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.PriorMedsToDateBusinessProviderService",t,a),this.data=i}createPriorMedsToDate(t){const i=new Bz(t);return i.Do(this),i.response}updatePriorMedsToDate(t,i){const a=new Xz(t,i);return a.Do(this),a.response}importPriorMedsToDates(t){const i=new Yz(t);return i.Do(this),i.response}validatePriorMedsToDateExcelData(t,i,a){const l=new Kz(t,i,a);return l.Do(this),l.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),eH=(()=>{class s extends I.nH{constructor(t,i,a){super("PriorMedsToDateService",a,t),this.businessProvider=i}createPriorMedsToDate(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createPriorMedsToDate(i)}updatePriorMedsToDate(t,i){return this.businessProvider.updatePriorMedsToDate(t,i)}importPriorMedsToDates(t){return this.businessProvider.importPriorMedsToDates(t)}validatePriorMedsToDateExcelData(t,i,a){return this.businessProvider.validatePriorMedsToDateExcelData(t,i,a)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(xu,8),e.LFG(xu),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),ha=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){if(super({loading:!1,priorMedsToDates:[],done:!1,searchQuery:"",formName:void 0,legalCaseId:void 0,priorMedsToDateStatusId:void 0,specialtyId:void 0,visitKindId:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.priorMedsToDateService=H,this.errors$=this.select(m=>m.errors),this.loading$=this.select(m=>m.loading),this.done$=this.select(m=>m.done),this.item$=this.select(m=>m.item),this.priorMedsToDates$=this.select(m=>m.priorMedsToDates),this.legalCases$=this.select(m=>m.legalCases||[]),this.priorMedsToDateStatuses$=this.select(m=>m.priorMedsToDateStatuses||[]),this.specialties$=this.select(m=>m.specialties||[]),this.visitKinds$=this.select(m=>m.visitKinds||[]),this.legalCaseId$=this.select(m=>m.legalCaseId),this.priorMedsToDateStatusId$=this.select(m=>m.priorMedsToDateStatusId),this.specialtyId$=this.select(m=>m.specialtyId),this.visitKindId$=this.select(m=>m.visitKindId),this.paging$=this.select(m=>m.paging),this.searchQuery$=this.select(m=>m.searchQuery),this.formName$=this.select(m=>m.formName),this.actionResult$=this.select(this.item$,this.done$,(m,p)=>({item:m,done:p}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.priorMedsToDates$,this.legalCases$,this.priorMedsToDateStatuses$,this.specialties$,this.visitKinds$,(m,p,_,w,J,_e,ve,ae,le)=>({errors:m,loading:p,item:_,formName:w,priorMedsToDates:J,legalCases:_e,priorMedsToDateStatuses:ve,specialties:ae,visitKinds:le}),{debounce:!0}),this.input$=this.select(this.paging$,this.legalCaseId$,this.priorMedsToDateStatusId$,this.specialtyId$,this.visitKindId$,this.searchQuery$,(m,p,_,w,J,_e)=>({limit:m.limit,skip:m.skip,name:_e,legalCaseId:p,priorMedsToDateStatusId:_,specialtyId:w,visitKindId:J,total:m.total})),this.setFormName=this.updater((m,p)=>Object.assign(Object.assign({},m),{formName:p})),this.setLegalCaseId=this.updater((m,p)=>Object.assign(Object.assign({},m),{legalCaseId:p})),this.setPriorMedsToDateStatusId=this.updater((m,p)=>Object.assign(Object.assign({},m),{priorMedsToDateStatusId:p})),this.setSpecialtyId=this.updater((m,p)=>Object.assign(Object.assign({},m),{specialtyId:p})),this.setVisitKindId=this.updater((m,p)=>Object.assign(Object.assign({},m),{visitKindId:p})),this.filterLegalCases=m=>this.data.userSelectLegalCases({input:{name:m}}).pipe((0,g._b)(p=>{let _=p.data.items;return this.patchState({legalCases:_}),_},p=>this.patchState({errors:p.graphQLErrors?p.graphQLErrors:p})),(0,he.U)(p=>p.data.items)),this.filterPriorMedsToDateStatuses=m=>this.data.userSelectPriorMedsToDateStatuses({input:{name:m}}).pipe((0,g._b)(p=>{let _=p.data.items;return this.patchState({priorMedsToDateStatuses:_}),_},p=>this.patchState({errors:p.graphQLErrors?p.graphQLErrors:p})),(0,he.U)(p=>p.data.items)),this.filterSpecialties=m=>this.data.userSelectSpecialties({input:{name:m}}).pipe((0,g._b)(p=>{let _=p.data.items;return this.patchState({specialties:_}),_},p=>this.patchState({errors:p.graphQLErrors?p.graphQLErrors:p})),(0,he.U)(p=>p.data.items)),this.filterVisitKinds=m=>this.data.userSelectVisitKinds({input:{name:m}}).pipe((0,g._b)(p=>{let _=p.data.items;return this.patchState({visitKinds:_}),_},p=>this.patchState({errors:p.graphQLErrors?p.graphQLErrors:p})),(0,he.U)(p=>p.data.items)),this.addLegalCase=this.updater((m,p)=>Object.assign(Object.assign({},m),{legalCases:m.legalCases.concat(p)})),this.addPriorMedsToDateStatus=this.updater((m,p)=>Object.assign(Object.assign({},m),{priorMedsToDateStatuses:m.priorMedsToDateStatuses.concat(p)})),this.addSpecialty=this.updater((m,p)=>Object.assign(Object.assign({},m),{specialties:m.specialties.concat(p)})),this.addVisitKind=this.updater((m,p)=>Object.assign(Object.assign({},m),{visitKinds:m.visitKinds.concat(p)})),this.setItem=this.updater((m,p)=>Object.assign(Object.assign({},m),{item:p})),this.addNewPriorMedsToDate=this.updater((m,p)=>Object.assign(Object.assign({},m),{priorMedsToDates:[...m.priorMedsToDates,p]})),this.updatePriorMedsToDate=this.updater((m,p)=>Object.assign(Object.assign({},m),{priorMedsToDates:m.priorMedsToDates.map(_=>_.id===p.id?p:_)})),this.addPriorMedsToDates=this.updater((m,p)=>Object.assign(Object.assign({},m),{priorMedsToDates:m.priorMedsToDates.concat(p)})),this.updatePriorMedsToDates=this.updater((m,p)=>Object.assign(Object.assign({},m),{priorMedsToDates:m.priorMedsToDates.map(_=>p.find(J=>J.id===_.id)||_)})),this.setSearchQuery=this.updater((m,p)=>Object.assign(Object.assign({},m),{searchQuery:p})),this.loadPriorMedsToDateEffect=this.effect(m=>m.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(p=>this.data.userPriorMedsToDate({priorMedsToDateId:p}).pipe((0,g._b)(_=>{this.patchState({item:_.data.item,errors:_.errors,loading:!1})},_=>this.patchState({loading:!1,errors:_.graphQLErrors?_.graphQLErrors:_})))))),this.loadPriorMedsToDatesEffect=this.effect(m=>m.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([p,_])=>this.data.userPriorMedsToDates({input:_}).pipe((0,g._b)(w=>(console.log("userPriorMedsToDates",w.data.items),this.patchState({paging:{limit:_.limit,skip:_.skip,total:w.data.count.total},priorMedsToDates:w.data.items,errors:w.errors,loading:!1})),w=>this.patchState({loading:!1,errors:w.graphQLErrors?w.graphQLErrors:w})))))),this.createPriorMedsToDateEffect=this.effect(m=>m.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(p=>this.priorMedsToDateService.createPriorMedsToDate(Object.assign({},p)).pipe((0,g._b)(_=>{this.addNewPriorMedsToDate(_),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:_,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},_=>{_.graphQLErrors?(this.toast.error(_.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:_.graphQLErrors?_.graphQLErrors:_})):(this.toast.error(_.Message),this.formService.setErrors(_.Data))}))))),this.updatePriorMedsToDateEffect=this.effect(m=>m.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([p,_])=>this.priorMedsToDateService.updatePriorMedsToDate(p,p.id).pipe((0,g._b)(w=>{this.updatePriorMedsToDate(w),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:w,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},w=>{w.graphQLErrors?(this.toast.error(w.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:w.graphQLErrors?w.graphQLErrors:w})):(this.toast.error(w.Message),this.formService.setErrors(w.Data))}))))),this.deletePriorMedsToDateEffect=this.effect(m=>m.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([p,_])=>this.data.userDeletePriorMedsToDate({priorMedsToDateId:_.id}).pipe((0,g._b)(w=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:w.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},w=>{w.graphQLErrors?(this.toast.error(w.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:w.graphQLErrors?w.graphQLErrors:w})):(this.toast.error(w.Message),this.formService.setErrors(w.Data))}))))),this.importExcelEffect=this.effect(m=>m.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(p=>this.priorMedsToDateService.importPriorMedsToDates(p).pipe((0,ce.K)(_=>{var w;return this.toast.error(null!==(w=_.Message)&&void 0!==w?w:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(_=>{const w=JSON.parse(_.created),J=JSON.parse(_.updated),_e=JSON.parse(_.failed),ve=w.length+J.length+_e.length;this.addPriorMedsToDates(w),this.updatePriorMedsToDates(J),this.toast.success(`${w.length} created, ${J.length} updated, ${_e.length} failed of total ${ve}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("priorMedsToDateId")?(this.route.snapshot.paramMap.get("priorMedsToDateId"),this.setFormName("priorMedsToDate_edit")):this.setFormName("priorMedsToDate_create"),this.route.snapshot.paramMap.has("legalCaseId")){var c=this.route.snapshot.paramMap.get("legalCaseId");this.setLegalCaseId(c)}if(this.route.snapshot.paramMap.has("priorMedsToDateStatusId")){var d=this.route.snapshot.paramMap.get("priorMedsToDateStatusId");this.setPriorMedsToDateStatusId(d)}if(this.route.snapshot.paramMap.has("specialtyId")){var n=this.route.snapshot.paramMap.get("specialtyId");this.setSpecialtyId(n)}if(this.route.snapshot.paramMap.has("visitKindId")){var r=this.route.snapshot.paramMap.get("visitKindId");this.setVisitKindId(r)}}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.priorMedsToDateService.validatePriorMedsToDateExcelData(t,i.legalCases,i.priorMedsToDateStatuses)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(eH))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function tH(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.priorMedsToDate)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let Nu=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"priorMedsToDate_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.priorMedsToDate=i.item})):t.formName&&t.formName.currentValue&&"priorMedsToDate_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadPriorMedsToDateEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.priorMedsToDate=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(ha),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-prior-meds-to-date-form"]],inputs:{priorMedsToDate:"priorMedsToDate",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,tH,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),Au=(()=>{class s{constructor(){this.autoHeight=!1,this.priorMedsToDates=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[{field:"legalCase.name",headerName:"Legal Case",filter:"agTextColumnFilter"},{field:"priorMedsToDateStatus.name",headerName:"Prior Meds to Date Status",filter:"agTextColumnFilter"},{field:"specialty.name",headerName:"Specialty",filter:"agTextColumnFilter"},{field:"visitKind.name",headerName:"Visit Kind",filter:"agTextColumnFilter"},{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{field:"legalCaseId",filter:"agTextColumnFilter",hide:!0},{field:"priorMedsToDateStatusId",filter:"agTextColumnFilter",hide:!0},{field:"specialtyId",filter:"agTextColumnFilter",hide:!0},{field:"visitKindId",filter:"agTextColumnFilter",hide:!0},{headerName:"Quantity",field:"quantity",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.quantity,"",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{headerName:"Amount",field:"amount",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.amount,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-prior-meds-to-date-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",priorMedsToDates:"priorMedsToDates"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.priorMedsToDates)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function iH(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-prior-meds-to-date-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","priorMedsToDate_edit")("formControl",t.formControl)("priorMedsToDate",t.priorMedsToDate)}}const sH=function(){return{}};function oH(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-prior-meds-to-date-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","priorMedsToDate_create")("formControl",t.formControl)("priorMedsToDate",e.DdM(3,sH))}}function aH(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-prior-meds-to-date-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("priorMedsToDates",o.data.items)}let rH=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadPriorMedsToDatesEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.priorMedsToDates$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(ha))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","priorMedsToDate","send","close"],[1,"w-full","h-full","bg-white",3,"priorMedsToDates","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,iH,2,3,"ng-template",null,1,e.W1O),e.YNc(3,oH,1,4,"ng-template",null,2,e.W1O),e.YNc(5,aH,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,Nu,Au],encapsulation:2}),s})();function nH(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-prior-meds-to-date-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","priorMedsToDate_edit")("priorMedsToDate",t.value)}}const lH=function(){return{}};function cH(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-prior-meds-to-date-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","priorMedsToDate_create")("priorMedsToDate",e.DdM(2,lH))}function dH(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-prior-meds-to-date-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("priorMedsToDates",t.items)}}let uH=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","priorMedsToDate","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","priorMedsToDates","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,nH,1,2,"ng-template",null,1,e.W1O),e.YNc(3,cH,1,3,"ng-template",null,2,e.W1O),e.YNc(5,dH,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,Nu,Au],encapsulation:2}),s})(),mH=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[ha],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"prior-meds-to-date-select",component:rH,wrappers:["form-field"]},{name:"prior-meds-to-date-grid",component:uH}]})]}),s})(),pH=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[mH]}),s})();class qi extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class hH extends qi{constructor(o){super("ValidatePriorMedsToDateStatusExcelDataAction"),this.valid=!1,this.excelData=o}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name)}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class fH extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class _H extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new fH("name","The priormedstodatestatus name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class gH extends qi{constructor(o){super("CreatePriorMedsToDateStatusAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new _H("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreatePriorMedsToDateStatus({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class CH extends qi{constructor(o){super("UpdatePriorMedsToDateStatusesAction"),this.priorMedsToDateStatuses=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.priorMedsToDateStatuses,!0))}performAction(){this.response=this.businessProvider.data.userUpdatePriorMedsToDateStatuses({input:{priorMedsToDateStatuses:this.priorMedsToDateStatuses}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class vH extends qi{constructor(o,t){super("UpdatePriorMedsToDateStatusAction"),this.priorMedsToDateStatus=o,this.priorMedsToDateStatusId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.priorMedsToDateStatus,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.priorMedsToDateStatusId,!0))}performAction(){this.response=this.businessProvider.data.userUpdatePriorMedsToDateStatus({priorMedsToDateStatusId:this.priorMedsToDateStatusId,input:this.priorMedsToDateStatus}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let Fu=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.PriorMedsToDateStatusBusinessProviderService",t,a),this.data=i}createPriorMedsToDateStatus(t){const i=new gH(t);return i.Do(this),i.response}updatePriorMedsToDateStatus(t,i){const a=new vH(t,i);return a.Do(this),a.response}importPriorMedsToDateStatuses(t){const i=new CH(t);return i.Do(this),i.response}validatePriorMedsToDateStatusExcelData(t){const i=new hH(t);return i.Do(this),i.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),SH=(()=>{class s extends I.nH{constructor(t,i,a){super("PriorMedsToDateStatusService",a,t),this.businessProvider=i}createPriorMedsToDateStatus(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createPriorMedsToDateStatus(i)}updatePriorMedsToDateStatus(t,i){return this.businessProvider.updatePriorMedsToDateStatus(t,i)}importPriorMedsToDateStatuses(t){return this.businessProvider.importPriorMedsToDateStatuses(t)}validatePriorMedsToDateStatusExcelData(t){return this.businessProvider.validatePriorMedsToDateStatusExcelData(t)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(Fu,8),e.LFG(Fu),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),fa=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){super({loading:!1,priorMedsToDateStatuses:[],done:!1,searchQuery:"",formName:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.priorMedsToDateStatusService=H,this.errors$=this.select(c=>c.errors),this.loading$=this.select(c=>c.loading),this.done$=this.select(c=>c.done),this.item$=this.select(c=>c.item),this.priorMedsToDateStatuses$=this.select(c=>c.priorMedsToDateStatuses),this.paging$=this.select(c=>c.paging),this.searchQuery$=this.select(c=>c.searchQuery),this.formName$=this.select(c=>c.formName),this.actionResult$=this.select(this.item$,this.done$,(c,d)=>({item:c,done:d}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.priorMedsToDateStatuses$,(c,d,n,r,m)=>({errors:c,loading:d,item:n,formName:r,priorMedsToDateStatuses:m}),{debounce:!0}),this.input$=this.select(this.paging$,this.searchQuery$,(c,d)=>({limit:c.limit,skip:c.skip,name:d,total:c.total})),this.setFormName=this.updater((c,d)=>Object.assign(Object.assign({},c),{formName:d})),this.setItem=this.updater((c,d)=>Object.assign(Object.assign({},c),{item:d})),this.addNewPriorMedsToDateStatus=this.updater((c,d)=>Object.assign(Object.assign({},c),{priorMedsToDateStatuses:[...c.priorMedsToDateStatuses,d]})),this.updatePriorMedsToDateStatus=this.updater((c,d)=>Object.assign(Object.assign({},c),{priorMedsToDateStatuses:c.priorMedsToDateStatuses.map(n=>n.id===d.id?d:n)})),this.addPriorMedsToDateStatuses=this.updater((c,d)=>Object.assign(Object.assign({},c),{priorMedsToDateStatuses:c.priorMedsToDateStatuses.concat(d)})),this.updatePriorMedsToDateStatuses=this.updater((c,d)=>Object.assign(Object.assign({},c),{priorMedsToDateStatuses:c.priorMedsToDateStatuses.map(n=>d.find(m=>m.id===n.id)||n)})),this.setSearchQuery=this.updater((c,d)=>Object.assign(Object.assign({},c),{searchQuery:d})),this.loadPriorMedsToDateStatusEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.data.userPriorMedsToDateStatus({priorMedsToDateStatusId:d}).pipe((0,g._b)(n=>{this.patchState({item:n.data.item,errors:n.errors,loading:!1})},n=>this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})))))),this.loadPriorMedsToDateStatusesEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([d,n])=>this.data.userPriorMedsToDateStatuses({input:n}).pipe((0,g._b)(r=>this.patchState({paging:{limit:n.limit,skip:n.skip,total:r.data.count.total},priorMedsToDateStatuses:r.data.items,errors:r.errors,loading:!1}),r=>this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})))))),this.createPriorMedsToDateStatusEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.priorMedsToDateStatusService.createPriorMedsToDateStatus(Object.assign({},d)).pipe((0,g._b)(n=>{this.addNewPriorMedsToDateStatus(n),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:n,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},n=>{n.graphQLErrors?(this.toast.error(n.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})):(this.toast.error(n.Message),this.formService.setErrors(n.Data))}))))),this.updatePriorMedsToDateStatusEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.priorMedsToDateStatusService.updatePriorMedsToDateStatus(d,d.id).pipe((0,g._b)(r=>{this.updatePriorMedsToDateStatus(r),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:r,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.deletePriorMedsToDateStatusEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.data.userDeletePriorMedsToDateStatus({priorMedsToDateStatusId:n.id}).pipe((0,g._b)(r=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:r.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.importExcelEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.priorMedsToDateStatusService.importPriorMedsToDateStatuses(d).pipe((0,ce.K)(n=>{var r;return this.toast.error(null!==(r=n.Message)&&void 0!==r?r:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(n=>{const r=JSON.parse(n.created),m=JSON.parse(n.updated),p=JSON.parse(n.failed),_=r.length+m.length+p.length;this.addPriorMedsToDateStatuses(r),this.updatePriorMedsToDateStatuses(m),this.toast.success(`${r.length} created, ${m.length} updated, ${p.length} failed of total ${_}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("priorMedsToDateStatusId")?(this.route.snapshot.paramMap.get("priorMedsToDateStatusId"),this.setFormName("priorMedsToDateStatus_edit")):this.setFormName("priorMedsToDateStatus_create")}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.priorMedsToDateStatusService.validatePriorMedsToDateStatusExcelData(t)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(SH))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function bH(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.priorMedsToDateStatus)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let Pu=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"priorMedsToDateStatus_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.priorMedsToDateStatus=i.item})):t.formName&&t.formName.currentValue&&"priorMedsToDateStatus_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadPriorMedsToDateStatusEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.priorMedsToDateStatus=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(fa),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-prior-meds-to-date-status-form"]],inputs:{priorMedsToDateStatus:"priorMedsToDateStatus",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,bH,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),Iu=(()=>{class s{constructor(){this.autoHeight=!1,this.priorMedsToDateStatuses=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[,{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-prior-meds-to-date-status-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",priorMedsToDateStatuses:"priorMedsToDateStatuses"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.priorMedsToDateStatuses)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function TH(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-prior-meds-to-date-status-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","priorMedsToDateStatus_edit")("formControl",t.formControl)("priorMedsToDateStatus",t.priorMedsToDateStatus)}}const yH=function(){return{}};function wH(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-prior-meds-to-date-status-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","priorMedsToDateStatus_create")("formControl",t.formControl)("priorMedsToDateStatus",e.DdM(3,yH))}}function xH(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-prior-meds-to-date-status-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("priorMedsToDateStatuses",o.data.items)}let NH=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadPriorMedsToDateStatusesEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.priorMedsToDateStatuses$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(fa))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","priorMedsToDateStatus","send","close"],[1,"w-full","h-full","bg-white",3,"priorMedsToDateStatuses","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,TH,2,3,"ng-template",null,1,e.W1O),e.YNc(3,wH,1,4,"ng-template",null,2,e.W1O),e.YNc(5,xH,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,Pu,Iu],encapsulation:2}),s})();function AH(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-prior-meds-to-date-status-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","priorMedsToDateStatus_edit")("priorMedsToDateStatus",t.value)}}const FH=function(){return{}};function PH(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-prior-meds-to-date-status-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","priorMedsToDateStatus_create")("priorMedsToDateStatus",e.DdM(2,FH))}function IH(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-prior-meds-to-date-status-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("priorMedsToDateStatuses",t.items)}}let DH=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","priorMedsToDateStatus","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","priorMedsToDateStatuses","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,AH,1,2,"ng-template",null,1,e.W1O),e.YNc(3,PH,1,3,"ng-template",null,2,e.W1O),e.YNc(5,IH,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,Pu,Iu],encapsulation:2}),s})(),MH=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[fa],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"prior-meds-to-date-status-select",component:NH,wrappers:["form-field"]},{name:"prior-meds-to-date-status-grid",component:DH}]})]}),s})(),WH=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[MH]}),s})();class Ki extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class EH extends Ki{constructor(o){super("ValidateProcedureExcelDataAction"),this.valid=!1,this.excelData=o}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name)}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class OH extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class LH extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new OH("name","The procedure name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class $H extends Ki{constructor(o){super("CreateProcedureAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new LH("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateProcedure({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class GH extends Ki{constructor(o){super("UpdateProceduresAction"),this.procedures=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.procedures,!0))}performAction(){this.response=this.businessProvider.data.userUpdateProcedures({input:{procedures:this.procedures}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class RH extends Ki{constructor(o,t){super("UpdateProcedureAction"),this.procedure=o,this.procedureId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.procedure,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.procedureId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateProcedure({procedureId:this.procedureId,input:this.procedure}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let Du=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.ProcedureBusinessProviderService",t,a),this.data=i}createProcedure(t){const i=new $H(t);return i.Do(this),i.response}updateProcedure(t,i){const a=new RH(t,i);return a.Do(this),a.response}importProcedures(t){const i=new GH(t);return i.Do(this),i.response}validateProcedureExcelData(t){const i=new EH(t);return i.Do(this),i.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),QH=(()=>{class s extends I.nH{constructor(t,i,a){super("ProcedureService",a,t),this.businessProvider=i}createProcedure(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createProcedure(i)}updateProcedure(t,i){return this.businessProvider.updateProcedure(t,i)}importProcedures(t){return this.businessProvider.importProcedures(t)}validateProcedureExcelData(t){return this.businessProvider.validateProcedureExcelData(t)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(Du,8),e.LFG(Du),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),_a=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){super({loading:!1,procedures:[],done:!1,searchQuery:"",formName:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.procedureService=H,this.errors$=this.select(c=>c.errors),this.loading$=this.select(c=>c.loading),this.done$=this.select(c=>c.done),this.item$=this.select(c=>c.item),this.procedures$=this.select(c=>c.procedures),this.paging$=this.select(c=>c.paging),this.searchQuery$=this.select(c=>c.searchQuery),this.formName$=this.select(c=>c.formName),this.actionResult$=this.select(this.item$,this.done$,(c,d)=>({item:c,done:d}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.procedures$,(c,d,n,r,m)=>({errors:c,loading:d,item:n,formName:r,procedures:m}),{debounce:!0}),this.input$=this.select(this.paging$,this.searchQuery$,(c,d)=>({limit:c.limit,skip:c.skip,name:d,total:c.total})),this.setFormName=this.updater((c,d)=>Object.assign(Object.assign({},c),{formName:d})),this.setItem=this.updater((c,d)=>Object.assign(Object.assign({},c),{item:d})),this.addNewProcedure=this.updater((c,d)=>Object.assign(Object.assign({},c),{procedures:[...c.procedures,d]})),this.updateProcedure=this.updater((c,d)=>Object.assign(Object.assign({},c),{procedures:c.procedures.map(n=>n.id===d.id?d:n)})),this.addProcedures=this.updater((c,d)=>Object.assign(Object.assign({},c),{procedures:c.procedures.concat(d)})),this.updateProcedures=this.updater((c,d)=>Object.assign(Object.assign({},c),{procedures:c.procedures.map(n=>d.find(m=>m.id===n.id)||n)})),this.setSearchQuery=this.updater((c,d)=>Object.assign(Object.assign({},c),{searchQuery:d})),this.loadProcedureEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.data.userProcedure({procedureId:d}).pipe((0,g._b)(n=>{this.patchState({item:n.data.item,errors:n.errors,loading:!1})},n=>this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})))))),this.loadProceduresEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([d,n])=>this.data.userProcedures({input:n}).pipe((0,g._b)(r=>this.patchState({paging:{limit:n.limit,skip:n.skip,total:r.data.count.total},procedures:r.data.items,errors:r.errors,loading:!1}),r=>this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})))))),this.createProcedureEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.procedureService.createProcedure(Object.assign({},d)).pipe((0,g._b)(n=>{this.addNewProcedure(n),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:n,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},n=>{n.graphQLErrors?(this.toast.error(n.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})):(this.toast.error(n.Message),this.formService.setErrors(n.Data))}))))),this.updateProcedureEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.procedureService.updateProcedure(d,d.id).pipe((0,g._b)(r=>{this.updateProcedure(r),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:r,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.deleteProcedureEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.data.userDeleteProcedure({procedureId:n.id}).pipe((0,g._b)(r=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:r.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.importExcelEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.procedureService.importProcedures(d).pipe((0,ce.K)(n=>{var r;return this.toast.error(null!==(r=n.Message)&&void 0!==r?r:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(n=>{const r=JSON.parse(n.created),m=JSON.parse(n.updated),p=JSON.parse(n.failed),_=r.length+m.length+p.length;this.addProcedures(r),this.updateProcedures(m),this.toast.success(`${r.length} created, ${m.length} updated, ${p.length} failed of total ${_}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("procedureId")?(this.route.snapshot.paramMap.get("procedureId"),this.setFormName("procedure_edit")):this.setFormName("procedure_create")}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.procedureService.validateProcedureExcelData(t)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(QH))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function VH(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.procedure)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let Mu=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"procedure_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.procedure=i.item})):t.formName&&t.formName.currentValue&&"procedure_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadProcedureEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.procedure=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(_a),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-procedure-form"]],inputs:{procedure:"procedure",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,VH,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),Wu=(()=>{class s{constructor(){this.autoHeight=!1,this.procedures=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[,{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{field:"code",filter:"agTextColumnFilter"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-procedure-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",procedures:"procedures"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.procedures)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function jH(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-procedure-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","procedure_edit")("formControl",t.formControl)("procedure",t.procedure)}}const UH=function(){return{}};function JH(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-procedure-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","procedure_create")("formControl",t.formControl)("procedure",e.DdM(3,UH))}}function zH(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-procedure-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("procedures",o.data.items)}let HH=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadProceduresEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.procedures$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(_a))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","procedure","send","close"],[1,"w-full","h-full","bg-white",3,"procedures","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,jH,2,3,"ng-template",null,1,e.W1O),e.YNc(3,JH,1,4,"ng-template",null,2,e.W1O),e.YNc(5,zH,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,Mu,Wu],encapsulation:2}),s})();function qH(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-procedure-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","procedure_edit")("procedure",t.value)}}const KH=function(){return{}};function ZH(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-procedure-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","procedure_create")("procedure",e.DdM(2,KH))}function kH(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-procedure-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("procedures",t.items)}}let BH=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","procedure","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","procedures","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,qH,1,2,"ng-template",null,1,e.W1O),e.YNc(3,ZH,1,3,"ng-template",null,2,e.W1O),e.YNc(5,kH,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,Mu,Wu],encapsulation:2}),s})(),YH=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[_a],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"procedure-select",component:HH,wrappers:["form-field"]},{name:"procedure-grid",component:BH}]})]}),s})(),XH=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[YH]}),s})();class Zi extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class eq extends Zi{constructor(o,t,i){super("ValidateProcedureOrTreatmentRequestAuthorizationExcelDataAction"),this.valid=!1,this.excelData=o,this.authorizations=t,this.procedureOrTreatmentRequests=i}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name),this.validationContext.addRule(new f.mi(`authorizationName_${i}_is_valid}`,"Authorization Is Not Valid","authorization.name",t.authorization,this.authorizations,!0)),this.validationContext.addRule(new f.mi(`procedureOrTreatmentRequestName_${i}_is_valid}`,"Procedure or Treatment Request Is Not Valid","procedureOrTreatmentRequest.name",t.procedureOrTreatmentRequest,this.procedureOrTreatmentRequests,!0))}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class tq extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class iq extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new tq("name","The procedureortreatmentrequestauthorization name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class sq extends Zi{constructor(o){super("CreateProcedureOrTreatmentRequestAuthorizationAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new iq("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateProcedureOrTreatmentRequestAuthorization({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class oq extends Zi{constructor(o){super("UpdateProcedureOrTreatmentRequestAuthorizationsAction"),this.procedureOrTreatmentRequestAuthorizations=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.procedureOrTreatmentRequestAuthorizations,!0))}performAction(){this.response=this.businessProvider.data.userUpdateProcedureOrTreatmentRequestAuthorizations({input:{procedureOrTreatmentRequestAuthorizations:this.procedureOrTreatmentRequestAuthorizations}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class aq extends Zi{constructor(o,t){super("UpdateProcedureOrTreatmentRequestAuthorizationAction"),this.procedureOrTreatmentRequestAuthorization=o,this.procedureOrTreatmentRequestAuthorizationId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.procedureOrTreatmentRequestAuthorization,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.procedureOrTreatmentRequestAuthorizationId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateProcedureOrTreatmentRequestAuthorization({procedureOrTreatmentRequestAuthorizationId:this.procedureOrTreatmentRequestAuthorizationId,input:this.procedureOrTreatmentRequestAuthorization}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let Eu=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.ProcedureOrTreatmentRequestAuthorizationBusinessProviderService",t,a),this.data=i}createProcedureOrTreatmentRequestAuthorization(t){const i=new sq(t);return i.Do(this),i.response}updateProcedureOrTreatmentRequestAuthorization(t,i){const a=new aq(t,i);return a.Do(this),a.response}importProcedureOrTreatmentRequestAuthorizations(t){const i=new oq(t);return i.Do(this),i.response}validateProcedureOrTreatmentRequestAuthorizationExcelData(t,i,a){const l=new eq(t,i,a);return l.Do(this),l.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),rq=(()=>{class s extends I.nH{constructor(t,i,a){super("ProcedureOrTreatmentRequestAuthorizationService",a,t),this.businessProvider=i}createProcedureOrTreatmentRequestAuthorization(t){return this.businessProvider.createProcedureOrTreatmentRequestAuthorization(t)}updateProcedureOrTreatmentRequestAuthorization(t,i){return this.businessProvider.updateProcedureOrTreatmentRequestAuthorization(t,i)}importProcedureOrTreatmentRequestAuthorizations(t){return this.businessProvider.importProcedureOrTreatmentRequestAuthorizations(t)}validateProcedureOrTreatmentRequestAuthorizationExcelData(t,i,a){return this.businessProvider.validateProcedureOrTreatmentRequestAuthorizationExcelData(t,i,a)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(Eu,8),e.LFG(Eu),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),ki=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){if(super({loading:!1,procedureOrTreatmentRequestAuthorizations:[],done:!1,searchQuery:"",formName:void 0,authorizationId:void 0,procedureOrTreatmentRequestId:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.procedureOrTreatmentRequestAuthorizationService=H,this.errors$=this.select(n=>n.errors),this.loading$=this.select(n=>n.loading),this.done$=this.select(n=>n.done),this.item$=this.select(n=>n.item),this.procedureOrTreatmentRequestAuthorizations$=this.select(n=>n.procedureOrTreatmentRequestAuthorizations),this.authorizations$=this.select(n=>n.authorizations||[]),this.procedureOrTreatmentRequests$=this.select(n=>n.procedureOrTreatmentRequests||[]),this.authorizationId$=this.select(n=>n.authorizationId),this.procedureOrTreatmentRequestId$=this.select(n=>n.procedureOrTreatmentRequestId),this.paging$=this.select(n=>n.paging),this.searchQuery$=this.select(n=>n.searchQuery),this.formName$=this.select(n=>n.formName),this.actionResult$=this.select(this.item$,this.done$,(n,r)=>({item:n,done:r}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.procedureOrTreatmentRequestAuthorizations$,this.authorizations$,this.procedureOrTreatmentRequests$,(n,r,m,p,_,w,J)=>({errors:n,loading:r,item:m,formName:p,procedureOrTreatmentRequestAuthorizations:_,authorizations:w,procedureOrTreatmentRequests:J}),{debounce:!0}),this.input$=this.select(this.paging$,this.authorizationId$,this.procedureOrTreatmentRequestId$,this.searchQuery$,(n,r,m,p)=>({limit:n.limit,skip:n.skip,name:p,authorizationId:r,procedureOrTreatmentRequestId:m,total:n.total})),this.setFormName=this.updater((n,r)=>Object.assign(Object.assign({},n),{formName:r})),this.setAuthorizationId=this.updater((n,r)=>Object.assign(Object.assign({},n),{authorizationId:r})),this.setProcedureOrTreatmentRequestId=this.updater((n,r)=>Object.assign(Object.assign({},n),{procedureOrTreatmentRequestId:r})),this.filterAuthorizations=n=>this.data.userSelectAuthorizations({input:{name:n}}).pipe((0,g._b)(r=>{let m=r.data.items;return this.patchState({authorizations:m}),m},r=>this.patchState({errors:r.graphQLErrors?r.graphQLErrors:r})),(0,he.U)(r=>r.data.items)),this.filterProcedureOrTreatmentRequests=n=>this.data.userSelectProcedureOrTreatmentRequests({input:{name:n}}).pipe((0,g._b)(r=>{let m=r.data.items;return this.patchState({procedureOrTreatmentRequests:m}),m},r=>this.patchState({errors:r.graphQLErrors?r.graphQLErrors:r})),(0,he.U)(r=>r.data.items)),this.addAuthorization=this.updater((n,r)=>Object.assign(Object.assign({},n),{authorizations:n.authorizations.concat(r)})),this.addProcedureOrTreatmentRequest=this.updater((n,r)=>Object.assign(Object.assign({},n),{procedureOrTreatmentRequests:n.procedureOrTreatmentRequests.concat(r)})),this.setItem=this.updater((n,r)=>Object.assign(Object.assign({},n),{item:r})),this.addNewProcedureOrTreatmentRequestAuthorization=this.updater((n,r)=>Object.assign(Object.assign({},n),{procedureOrTreatmentRequestAuthorizations:[...n.procedureOrTreatmentRequestAuthorizations,r]})),this.updateProcedureOrTreatmentRequestAuthorization=this.updater((n,r)=>Object.assign(Object.assign({},n),{procedureOrTreatmentRequestAuthorizations:n.procedureOrTreatmentRequestAuthorizations.map(m=>m.id===r.id?r:m)})),this.addProcedureOrTreatmentRequestAuthorizations=this.updater((n,r)=>Object.assign(Object.assign({},n),{procedureOrTreatmentRequestAuthorizations:n.procedureOrTreatmentRequestAuthorizations.concat(r)})),this.updateProcedureOrTreatmentRequestAuthorizations=this.updater((n,r)=>Object.assign(Object.assign({},n),{procedureOrTreatmentRequestAuthorizations:n.procedureOrTreatmentRequestAuthorizations.map(m=>r.find(_=>_.id===m.id)||m)})),this.setSearchQuery=this.updater((n,r)=>Object.assign(Object.assign({},n),{searchQuery:r})),this.loadProcedureOrTreatmentRequestAuthorizationEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(r=>this.data.userProcedureOrTreatmentRequestAuthorization({procedureOrTreatmentRequestAuthorizationId:r}).pipe((0,g._b)(m=>{this.patchState({item:m.data.item,errors:m.errors,loading:!1})},m=>this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})))))),this.loadProcedureOrTreatmentRequestAuthorizationsEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([r,m])=>this.data.userProcedureOrTreatmentRequestAuthorizations({input:m}).pipe((0,g._b)(p=>this.patchState({paging:{limit:m.limit,skip:m.skip,total:p.data.count.total},procedureOrTreatmentRequestAuthorizations:p.data.items,errors:p.errors,loading:!1}),p=>this.patchState({loading:!1,errors:p.graphQLErrors?p.graphQLErrors:p})))))),this.createProcedureOrTreatmentRequestAuthorizationEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(r=>this.procedureOrTreatmentRequestAuthorizationService.createProcedureOrTreatmentRequestAuthorization(Object.assign({},r)).pipe((0,g._b)(m=>{this.addNewProcedureOrTreatmentRequestAuthorization(m),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:m,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},m=>{m.graphQLErrors?(this.toast.error(m.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})):(this.toast.error(m.Message),this.formService.setErrors(m.Data))}))))),this.updateProcedureOrTreatmentRequestAuthorizationEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([r,m])=>this.procedureOrTreatmentRequestAuthorizationService.updateProcedureOrTreatmentRequestAuthorization(r,r.id).pipe((0,g._b)(p=>{this.updateProcedureOrTreatmentRequestAuthorization(p),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:p,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},p=>{p.graphQLErrors?(this.toast.error(p.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:p.graphQLErrors?p.graphQLErrors:p})):(this.toast.error(p.Message),this.formService.setErrors(p.Data))}))))),this.deleteProcedureOrTreatmentRequestAuthorizationEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([r,m])=>this.data.userDeleteProcedureOrTreatmentRequestAuthorization({procedureOrTreatmentRequestAuthorizationId:m.id}).pipe((0,g._b)(p=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:p.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},p=>{p.graphQLErrors?(this.toast.error(p.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:p.graphQLErrors?p.graphQLErrors:p})):(this.toast.error(p.Message),this.formService.setErrors(p.Data))}))))),this.importExcelEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(r=>this.procedureOrTreatmentRequestAuthorizationService.importProcedureOrTreatmentRequestAuthorizations(r).pipe((0,ce.K)(m=>{var p;return this.toast.error(null!==(p=m.Message)&&void 0!==p?p:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(m=>{const p=JSON.parse(m.created),_=JSON.parse(m.updated),w=JSON.parse(m.failed),J=p.length+_.length+w.length;this.addProcedureOrTreatmentRequestAuthorizations(p),this.updateProcedureOrTreatmentRequestAuthorizations(_),this.toast.success(`${p.length} created, ${_.length} updated, ${w.length} failed of total ${J}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("procedureOrTreatmentRequestAuthorizationId")?(this.route.snapshot.paramMap.get("procedureOrTreatmentRequestAuthorizationId"),this.setFormName("procedureOrTreatmentRequestAuthorization_edit")):this.setFormName("procedureOrTreatmentRequestAuthorization_create"),this.route.snapshot.paramMap.has("authorizationId")){var c=this.route.snapshot.paramMap.get("authorizationId");this.setAuthorizationId(c)}if(this.route.snapshot.paramMap.has("procedureOrTreatmentRequestId")){var d=this.route.snapshot.paramMap.get("procedureOrTreatmentRequestId");this.setProcedureOrTreatmentRequestId(d)}}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.procedureOrTreatmentRequestAuthorizationService.validateProcedureOrTreatmentRequestAuthorizationExcelData(t,i.authorizations,i.procedureOrTreatmentRequests)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(rq))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function nq(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.procedureOrTreatmentRequestAuthorization)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let Ou=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"procedureOrTreatmentRequestAuthorization_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({id:null,name:""}),this.store.vm$.subscribe(i=>{this.procedureOrTreatmentRequestAuthorization=i.item})):t.formName&&t.formName.currentValue&&"procedureOrTreatmentRequestAuthorization_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadProcedureOrTreatmentRequestAuthorizationEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.procedureOrTreatmentRequestAuthorization=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(ki),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-procedure-or-treatment-request-authorization-form"]],inputs:{procedureOrTreatmentRequestAuthorization:"procedureOrTreatmentRequestAuthorization",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,nq,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),Lu=(()=>{class s{constructor(){this.autoHeight=!1,this.procedureOrTreatmentRequestAuthorizations=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[{field:"authorization.name",headerName:"Authorization",filter:"agTextColumnFilter"},{field:"procedureOrTreatmentRequest.name",headerName:"Procedure or Treatment Request",filter:"agTextColumnFilter"},{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{field:"authorizationId",filter:"agTextColumnFilter",hide:!0},{field:"procedureOrTreatmentRequestId",filter:"agTextColumnFilter",hide:!0}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-procedure-or-treatment-request-authorization-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",procedureOrTreatmentRequestAuthorizations:"procedureOrTreatmentRequestAuthorizations"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:6,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.procedureOrTreatmentRequestAuthorizations)("showSidebar",!1)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function lq(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-procedure-or-treatment-request-authorization-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","procedureOrTreatmentRequestAuthorization_edit")("formControl",t.formControl)("procedureOrTreatmentRequestAuthorization",t.procedureOrTreatmentRequestAuthorization)}}const cq=function(){return{}};function dq(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-procedure-or-treatment-request-authorization-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","procedureOrTreatmentRequestAuthorization_create")("formControl",t.formControl)("procedureOrTreatmentRequestAuthorization",e.DdM(3,cq))}}function uq(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-procedure-or-treatment-request-authorization-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("procedureOrTreatmentRequestAuthorizations",o.data.items)}let mq=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadProcedureOrTreatmentRequestAuthorizationsEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.procedureOrTreatmentRequestAuthorizations$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(ki))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e._Bn([ki]),e.qOj],decls:7,vars:5,consts:[[3,"to","control","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","procedureOrTreatmentRequestAuthorization","send","close"],[1,"w-full","h-full","bg-white",3,"procedureOrTreatmentRequestAuthorizations","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"ui-select-form",0),e.YNc(1,lq,2,3,"ng-template",null,1,e.W1O),e.YNc(3,dq,1,4,"ng-template",null,2,e.W1O),e.YNc(5,uq,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[W.JJ,W.oH,Z.$,Ou,Lu],encapsulation:2}),s})();function pq(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-procedure-or-treatment-request-authorization-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","procedureOrTreatmentRequestAuthorization_edit")("procedureOrTreatmentRequestAuthorization",t.value)}}const hq=function(){return{}};function fq(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-procedure-or-treatment-request-authorization-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","procedureOrTreatmentRequestAuthorization_create")("procedureOrTreatmentRequestAuthorization",e.DdM(2,hq))}function _q(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-procedure-or-treatment-request-authorization-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("procedureOrTreatmentRequestAuthorizations",t.items)}}let gq=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:6,consts:[[3,"data","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","procedureOrTreatmentRequestAuthorization","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","procedureOrTreatmentRequestAuthorizations","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,pq,1,2,"ng-template",null,1,e.W1O),e.YNc(3,fq,1,3,"ng-template",null,2,e.W1O),e.YNc(5,_q,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,Ou,Lu],encapsulation:2}),s})(),Cq=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[ki],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"procedure-or-treatment-request-authorization-select",component:mq,wrappers:["form-field"]},{name:"procedure-or-treatment-request-authorization-grid",component:gq}]})]}),s})(),vq=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[Cq]}),s})();class Bi extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class Sq extends Bi{constructor(o){super("ValidateProcedureSiteExcelDataAction"),this.valid=!1,this.excelData=o}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name)}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class bq extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class Tq extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new bq("name","The proceduresite name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class yq extends Bi{constructor(o){super("CreateProcedureSiteAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new Tq("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateProcedureSite({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class wq extends Bi{constructor(o){super("UpdateProcedureSitesAction"),this.procedureSites=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.procedureSites,!0))}performAction(){this.response=this.businessProvider.data.userUpdateProcedureSites({input:{procedureSites:this.procedureSites}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class xq extends Bi{constructor(o,t){super("UpdateProcedureSiteAction"),this.procedureSite=o,this.procedureSiteId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.procedureSite,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.procedureSiteId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateProcedureSite({procedureSiteId:this.procedureSiteId,input:this.procedureSite}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let $u=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.ProcedureSiteBusinessProviderService",t,a),this.data=i}createProcedureSite(t){const i=new yq(t);return i.Do(this),i.response}updateProcedureSite(t,i){const a=new xq(t,i);return a.Do(this),a.response}importProcedureSites(t){const i=new wq(t);return i.Do(this),i.response}validateProcedureSiteExcelData(t){const i=new Sq(t);return i.Do(this),i.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),Nq=(()=>{class s extends I.nH{constructor(t,i,a){super("ProcedureSiteService",a,t),this.businessProvider=i}createProcedureSite(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createProcedureSite(i)}updateProcedureSite(t,i){return this.businessProvider.updateProcedureSite(t,i)}importProcedureSites(t){return this.businessProvider.importProcedureSites(t)}validateProcedureSiteExcelData(t){return this.businessProvider.validateProcedureSiteExcelData(t)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG($u,8),e.LFG($u),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),ga=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){super({loading:!1,procedureSites:[],done:!1,searchQuery:"",formName:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.procedureSiteService=H,this.errors$=this.select(c=>c.errors),this.loading$=this.select(c=>c.loading),this.done$=this.select(c=>c.done),this.item$=this.select(c=>c.item),this.procedureSites$=this.select(c=>c.procedureSites),this.paging$=this.select(c=>c.paging),this.searchQuery$=this.select(c=>c.searchQuery),this.formName$=this.select(c=>c.formName),this.actionResult$=this.select(this.item$,this.done$,(c,d)=>({item:c,done:d}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.procedureSites$,(c,d,n,r,m)=>({errors:c,loading:d,item:n,formName:r,procedureSites:m}),{debounce:!0}),this.input$=this.select(this.paging$,this.searchQuery$,(c,d)=>({limit:c.limit,skip:c.skip,name:d,total:c.total})),this.setFormName=this.updater((c,d)=>Object.assign(Object.assign({},c),{formName:d})),this.setItem=this.updater((c,d)=>Object.assign(Object.assign({},c),{item:d})),this.addNewProcedureSite=this.updater((c,d)=>Object.assign(Object.assign({},c),{procedureSites:[...c.procedureSites,d]})),this.updateProcedureSite=this.updater((c,d)=>Object.assign(Object.assign({},c),{procedureSites:c.procedureSites.map(n=>n.id===d.id?d:n)})),this.addProcedureSites=this.updater((c,d)=>Object.assign(Object.assign({},c),{procedureSites:c.procedureSites.concat(d)})),this.updateProcedureSites=this.updater((c,d)=>Object.assign(Object.assign({},c),{procedureSites:c.procedureSites.map(n=>d.find(m=>m.id===n.id)||n)})),this.setSearchQuery=this.updater((c,d)=>Object.assign(Object.assign({},c),{searchQuery:d})),this.loadProcedureSiteEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.data.userProcedureSite({procedureSiteId:d}).pipe((0,g._b)(n=>{this.patchState({item:n.data.item,errors:n.errors,loading:!1})},n=>this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})))))),this.loadProcedureSitesEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([d,n])=>this.data.userProcedureSites({input:n}).pipe((0,g._b)(r=>this.patchState({paging:{limit:n.limit,skip:n.skip,total:r.data.count.total},procedureSites:r.data.items,errors:r.errors,loading:!1}),r=>this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})))))),this.createProcedureSiteEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.procedureSiteService.createProcedureSite(Object.assign({},d)).pipe((0,g._b)(n=>{this.addNewProcedureSite(n),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:n,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},n=>{n.graphQLErrors?(this.toast.error(n.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})):(this.toast.error(n.Message),this.formService.setErrors(n.Data))}))))),this.updateProcedureSiteEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.procedureSiteService.updateProcedureSite(d,d.id).pipe((0,g._b)(r=>{this.updateProcedureSite(r),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:r,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.deleteProcedureSiteEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.data.userDeleteProcedureSite({procedureSiteId:n.id}).pipe((0,g._b)(r=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:r.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.importExcelEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.procedureSiteService.importProcedureSites(d).pipe((0,ce.K)(n=>{var r;return this.toast.error(null!==(r=n.Message)&&void 0!==r?r:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(n=>{const r=JSON.parse(n.created),m=JSON.parse(n.updated),p=JSON.parse(n.failed),_=r.length+m.length+p.length;this.addProcedureSites(r),this.updateProcedureSites(m),this.toast.success(`${r.length} created, ${m.length} updated, ${p.length} failed of total ${_}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("procedureSiteId")?(this.route.snapshot.paramMap.get("procedureSiteId"),this.setFormName("procedureSite_edit")):this.setFormName("procedureSite_create")}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.procedureSiteService.validateProcedureSiteExcelData(t)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(Nq))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function Aq(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.procedureSite)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let Gu=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"procedureSite_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.procedureSite=i.item})):t.formName&&t.formName.currentValue&&"procedureSite_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadProcedureSiteEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.procedureSite=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(ga),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-procedure-site-form"]],inputs:{procedureSite:"procedureSite",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,Aq,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),Ru=(()=>{class s{constructor(){this.autoHeight=!1,this.procedureSites=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[,{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{field:"code",filter:"agTextColumnFilter"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-procedure-site-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",procedureSites:"procedureSites"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.procedureSites)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function Fq(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-procedure-site-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","procedureSite_edit")("formControl",t.formControl)("procedureSite",t.procedureSite)}}const Pq=function(){return{}};function Iq(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-procedure-site-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","procedureSite_create")("formControl",t.formControl)("procedureSite",e.DdM(3,Pq))}}function Dq(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-procedure-site-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("procedureSites",o.data.items)}let Mq=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadProcedureSitesEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.procedureSites$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(ga))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","procedureSite","send","close"],[1,"w-full","h-full","bg-white",3,"procedureSites","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,Fq,2,3,"ng-template",null,1,e.W1O),e.YNc(3,Iq,1,4,"ng-template",null,2,e.W1O),e.YNc(5,Dq,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,Gu,Ru],encapsulation:2}),s})();function Wq(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-procedure-site-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","procedureSite_edit")("procedureSite",t.value)}}const Eq=function(){return{}};function Oq(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-procedure-site-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","procedureSite_create")("procedureSite",e.DdM(2,Eq))}function Lq(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-procedure-site-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("procedureSites",t.items)}}let $q=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","procedureSite","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","procedureSites","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,Wq,1,2,"ng-template",null,1,e.W1O),e.YNc(3,Oq,1,3,"ng-template",null,2,e.W1O),e.YNc(5,Lq,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,Gu,Ru],encapsulation:2}),s})(),Gq=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[ga],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"procedure-site-select",component:Mq,wrappers:["form-field"]},{name:"procedure-site-grid",component:$q}]})]}),s})(),Rq=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[Gq]}),s})();class Yi extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class Qq extends Yi{constructor(o){super("ValidateProcedureStatusExcelDataAction"),this.valid=!1,this.excelData=o}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name)}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class Vq extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class jq extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new Vq("name","The procedurestatus name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class Uq extends Yi{constructor(o){super("CreateProcedureStatusAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new jq("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateProcedureStatus({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class Jq extends Yi{constructor(o){super("UpdateProcedureStatusesAction"),this.procedureStatuses=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.procedureStatuses,!0))}performAction(){this.response=this.businessProvider.data.userUpdateProcedureStatuses({input:{procedureStatuses:this.procedureStatuses}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class zq extends Yi{constructor(o,t){super("UpdateProcedureStatusAction"),this.procedureStatus=o,this.procedureStatusId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.procedureStatus,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.procedureStatusId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateProcedureStatus({procedureStatusId:this.procedureStatusId,input:this.procedureStatus}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let Qu=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.ProcedureStatusBusinessProviderService",t,a),this.data=i}createProcedureStatus(t){const i=new Uq(t);return i.Do(this),i.response}updateProcedureStatus(t,i){const a=new zq(t,i);return a.Do(this),a.response}importProcedureStatuses(t){const i=new Jq(t);return i.Do(this),i.response}validateProcedureStatusExcelData(t){const i=new Qq(t);return i.Do(this),i.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),Hq=(()=>{class s extends I.nH{constructor(t,i,a){super("ProcedureStatusService",a,t),this.businessProvider=i}createProcedureStatus(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createProcedureStatus(i)}updateProcedureStatus(t,i){return this.businessProvider.updateProcedureStatus(t,i)}importProcedureStatuses(t){return this.businessProvider.importProcedureStatuses(t)}validateProcedureStatusExcelData(t){return this.businessProvider.validateProcedureStatusExcelData(t)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(Qu,8),e.LFG(Qu),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),Ca=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){super({loading:!1,procedureStatuses:[],done:!1,searchQuery:"",formName:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.procedureStatusService=H,this.errors$=this.select(c=>c.errors),this.loading$=this.select(c=>c.loading),this.done$=this.select(c=>c.done),this.item$=this.select(c=>c.item),this.procedureStatuses$=this.select(c=>c.procedureStatuses),this.paging$=this.select(c=>c.paging),this.searchQuery$=this.select(c=>c.searchQuery),this.formName$=this.select(c=>c.formName),this.actionResult$=this.select(this.item$,this.done$,(c,d)=>({item:c,done:d}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.procedureStatuses$,(c,d,n,r,m)=>({errors:c,loading:d,item:n,formName:r,procedureStatuses:m}),{debounce:!0}),this.input$=this.select(this.paging$,this.searchQuery$,(c,d)=>({limit:c.limit,skip:c.skip,name:d,total:c.total})),this.setFormName=this.updater((c,d)=>Object.assign(Object.assign({},c),{formName:d})),this.setItem=this.updater((c,d)=>Object.assign(Object.assign({},c),{item:d})),this.addNewProcedureStatus=this.updater((c,d)=>Object.assign(Object.assign({},c),{procedureStatuses:[...c.procedureStatuses,d]})),this.updateProcedureStatus=this.updater((c,d)=>Object.assign(Object.assign({},c),{procedureStatuses:c.procedureStatuses.map(n=>n.id===d.id?d:n)})),this.addProcedureStatuses=this.updater((c,d)=>Object.assign(Object.assign({},c),{procedureStatuses:c.procedureStatuses.concat(d)})),this.updateProcedureStatuses=this.updater((c,d)=>Object.assign(Object.assign({},c),{procedureStatuses:c.procedureStatuses.map(n=>d.find(m=>m.id===n.id)||n)})),this.setSearchQuery=this.updater((c,d)=>Object.assign(Object.assign({},c),{searchQuery:d})),this.loadProcedureStatusEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.data.userProcedureStatus({procedureStatusId:d}).pipe((0,g._b)(n=>{this.patchState({item:n.data.item,errors:n.errors,loading:!1})},n=>this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})))))),this.loadProcedureStatusesEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([d,n])=>this.data.userProcedureStatuses({input:n}).pipe((0,g._b)(r=>this.patchState({paging:{limit:n.limit,skip:n.skip,total:r.data.count.total},procedureStatuses:r.data.items,errors:r.errors,loading:!1}),r=>this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})))))),this.createProcedureStatusEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.procedureStatusService.createProcedureStatus(Object.assign({},d)).pipe((0,g._b)(n=>{this.addNewProcedureStatus(n),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:n,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},n=>{n.graphQLErrors?(this.toast.error(n.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})):(this.toast.error(n.Message),this.formService.setErrors(n.Data))}))))),this.updateProcedureStatusEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.procedureStatusService.updateProcedureStatus(d,d.id).pipe((0,g._b)(r=>{this.updateProcedureStatus(r),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:r,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.deleteProcedureStatusEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.data.userDeleteProcedureStatus({procedureStatusId:n.id}).pipe((0,g._b)(r=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:r.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.importExcelEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.procedureStatusService.importProcedureStatuses(d).pipe((0,ce.K)(n=>{var r;return this.toast.error(null!==(r=n.Message)&&void 0!==r?r:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(n=>{const r=JSON.parse(n.created),m=JSON.parse(n.updated),p=JSON.parse(n.failed),_=r.length+m.length+p.length;this.addProcedureStatuses(r),this.updateProcedureStatuses(m),this.toast.success(`${r.length} created, ${m.length} updated, ${p.length} failed of total ${_}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("procedureStatusId")?(this.route.snapshot.paramMap.get("procedureStatusId"),this.setFormName("procedureStatus_edit")):this.setFormName("procedureStatus_create")}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.procedureStatusService.validateProcedureStatusExcelData(t)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(Hq))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function qq(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.procedureStatus)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let Vu=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"procedureStatus_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.procedureStatus=i.item})):t.formName&&t.formName.currentValue&&"procedureStatus_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadProcedureStatusEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.procedureStatus=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Ca),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-procedure-status-form"]],inputs:{procedureStatus:"procedureStatus",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,qq,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),ju=(()=>{class s{constructor(){this.autoHeight=!1,this.procedureStatuses=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[,{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-procedure-status-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",procedureStatuses:"procedureStatuses"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.procedureStatuses)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function Kq(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-procedure-status-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","procedureStatus_edit")("formControl",t.formControl)("procedureStatus",t.procedureStatus)}}const Zq=function(){return{}};function kq(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-procedure-status-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","procedureStatus_create")("formControl",t.formControl)("procedureStatus",e.DdM(3,Zq))}}function Bq(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-procedure-status-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("procedureStatuses",o.data.items)}let Yq=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadProcedureStatusesEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.procedureStatuses$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Ca))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","procedureStatus","send","close"],[1,"w-full","h-full","bg-white",3,"procedureStatuses","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,Kq,2,3,"ng-template",null,1,e.W1O),e.YNc(3,kq,1,4,"ng-template",null,2,e.W1O),e.YNc(5,Bq,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,Vu,ju],encapsulation:2}),s})();function Xq(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-procedure-status-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","procedureStatus_edit")("procedureStatus",t.value)}}const eK=function(){return{}};function tK(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-procedure-status-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","procedureStatus_create")("procedureStatus",e.DdM(2,eK))}function iK(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-procedure-status-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("procedureStatuses",t.items)}}let sK=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","procedureStatus","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","procedureStatuses","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,Xq,1,2,"ng-template",null,1,e.W1O),e.YNc(3,tK,1,3,"ng-template",null,2,e.W1O),e.YNc(5,iK,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,Vu,ju],encapsulation:2}),s})(),oK=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[Ca],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"procedure-status-select",component:Yq,wrappers:["form-field"]},{name:"procedure-status-grid",component:sK}]})]}),s})(),aK=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[oK]}),s})();class Xi extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class rK extends Xi{constructor(o){super("ValidateProcedureTypeExcelDataAction"),this.valid=!1,this.excelData=o}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name)}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class nK extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class lK extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new nK("name","The proceduretype name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class cK extends Xi{constructor(o){super("CreateProcedureTypeAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new lK("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateProcedureType({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class dK extends Xi{constructor(o){super("UpdateProcedureTypesAction"),this.procedureTypes=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.procedureTypes,!0))}performAction(){this.response=this.businessProvider.data.userUpdateProcedureTypes({input:{procedureTypes:this.procedureTypes}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class uK extends Xi{constructor(o,t){super("UpdateProcedureTypeAction"),this.procedureType=o,this.procedureTypeId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.procedureType,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.procedureTypeId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateProcedureType({procedureTypeId:this.procedureTypeId,input:this.procedureType}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let Uu=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.ProcedureTypeBusinessProviderService",t,a),this.data=i}createProcedureType(t){const i=new cK(t);return i.Do(this),i.response}updateProcedureType(t,i){const a=new uK(t,i);return a.Do(this),a.response}importProcedureTypes(t){const i=new dK(t);return i.Do(this),i.response}validateProcedureTypeExcelData(t){const i=new rK(t);return i.Do(this),i.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),mK=(()=>{class s extends I.nH{constructor(t,i,a){super("ProcedureTypeService",a,t),this.businessProvider=i}createProcedureType(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createProcedureType(i)}updateProcedureType(t,i){return this.businessProvider.updateProcedureType(t,i)}importProcedureTypes(t){return this.businessProvider.importProcedureTypes(t)}validateProcedureTypeExcelData(t){return this.businessProvider.validateProcedureTypeExcelData(t)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(Uu,8),e.LFG(Uu),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),va=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){super({loading:!1,procedureTypes:[],done:!1,searchQuery:"",formName:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.procedureTypeService=H,this.errors$=this.select(c=>c.errors),this.loading$=this.select(c=>c.loading),this.done$=this.select(c=>c.done),this.item$=this.select(c=>c.item),this.procedureTypes$=this.select(c=>c.procedureTypes),this.paging$=this.select(c=>c.paging),this.searchQuery$=this.select(c=>c.searchQuery),this.formName$=this.select(c=>c.formName),this.actionResult$=this.select(this.item$,this.done$,(c,d)=>({item:c,done:d}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.procedureTypes$,(c,d,n,r,m)=>({errors:c,loading:d,item:n,formName:r,procedureTypes:m}),{debounce:!0}),this.input$=this.select(this.paging$,this.searchQuery$,(c,d)=>({limit:c.limit,skip:c.skip,name:d,total:c.total})),this.setFormName=this.updater((c,d)=>Object.assign(Object.assign({},c),{formName:d})),this.setItem=this.updater((c,d)=>Object.assign(Object.assign({},c),{item:d})),this.addNewProcedureType=this.updater((c,d)=>Object.assign(Object.assign({},c),{procedureTypes:[...c.procedureTypes,d]})),this.updateProcedureType=this.updater((c,d)=>Object.assign(Object.assign({},c),{procedureTypes:c.procedureTypes.map(n=>n.id===d.id?d:n)})),this.addProcedureTypes=this.updater((c,d)=>Object.assign(Object.assign({},c),{procedureTypes:c.procedureTypes.concat(d)})),this.updateProcedureTypes=this.updater((c,d)=>Object.assign(Object.assign({},c),{procedureTypes:c.procedureTypes.map(n=>d.find(m=>m.id===n.id)||n)})),this.setSearchQuery=this.updater((c,d)=>Object.assign(Object.assign({},c),{searchQuery:d})),this.loadProcedureTypeEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.data.userProcedureType({procedureTypeId:d}).pipe((0,g._b)(n=>{this.patchState({item:n.data.item,errors:n.errors,loading:!1})},n=>this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})))))),this.loadProcedureTypesEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([d,n])=>this.data.userProcedureTypes({input:n}).pipe((0,g._b)(r=>this.patchState({paging:{limit:n.limit,skip:n.skip,total:r.data.count.total},procedureTypes:r.data.items,errors:r.errors,loading:!1}),r=>this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})))))),this.createProcedureTypeEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.procedureTypeService.createProcedureType(Object.assign({},d)).pipe((0,g._b)(n=>{this.addNewProcedureType(n),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:n,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},n=>{n.graphQLErrors?(this.toast.error(n.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})):(this.toast.error(n.Message),this.formService.setErrors(n.Data))}))))),this.updateProcedureTypeEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.procedureTypeService.updateProcedureType(d,d.id).pipe((0,g._b)(r=>{this.updateProcedureType(r),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:r,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.deleteProcedureTypeEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.data.userDeleteProcedureType({procedureTypeId:n.id}).pipe((0,g._b)(r=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:r.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.importExcelEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.procedureTypeService.importProcedureTypes(d).pipe((0,ce.K)(n=>{var r;return this.toast.error(null!==(r=n.Message)&&void 0!==r?r:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(n=>{const r=JSON.parse(n.created),m=JSON.parse(n.updated),p=JSON.parse(n.failed),_=r.length+m.length+p.length;this.addProcedureTypes(r),this.updateProcedureTypes(m),this.toast.success(`${r.length} created, ${m.length} updated, ${p.length} failed of total ${_}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("procedureTypeId")?(this.route.snapshot.paramMap.get("procedureTypeId"),this.setFormName("procedureType_edit")):this.setFormName("procedureType_create")}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.procedureTypeService.validateProcedureTypeExcelData(t)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(mK))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function pK(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.procedureType)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let Ju=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"procedureType_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.procedureType=i.item})):t.formName&&t.formName.currentValue&&"procedureType_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadProcedureTypeEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.procedureType=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(va),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-procedure-type-form"]],inputs:{procedureType:"procedureType",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,pK,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),zu=(()=>{class s{constructor(){this.autoHeight=!1,this.procedureTypes=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[,{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{field:"orderIndex",filter:"agTextColumnFilter"},{field:"dateCreated",filter:"agDateColumnFilter"},{headerName:"Is System",field:"isSystem",filter:"agSetColumnFilter",cellRenderer:"checkboxRenderer"},{headerName:"Removed",field:"removed",filter:"agSetColumnFilter",cellRenderer:"checkboxRenderer"},{field:"modality",filter:"agTextColumnFilter"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-procedure-type-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",procedureTypes:"procedureTypes"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.procedureTypes)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function hK(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-procedure-type-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","procedureType_edit")("formControl",t.formControl)("procedureType",t.procedureType)}}const fK=function(){return{}};function _K(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-procedure-type-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","procedureType_create")("formControl",t.formControl)("procedureType",e.DdM(3,fK))}}function gK(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-procedure-type-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("procedureTypes",o.data.items)}let CK=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadProcedureTypesEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.procedureTypes$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(va))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","procedureType","send","close"],[1,"w-full","h-full","bg-white",3,"procedureTypes","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,hK,2,3,"ng-template",null,1,e.W1O),e.YNc(3,_K,1,4,"ng-template",null,2,e.W1O),e.YNc(5,gK,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,Ju,zu],encapsulation:2}),s})();function vK(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-procedure-type-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","procedureType_edit")("procedureType",t.value)}}const SK=function(){return{}};function bK(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-procedure-type-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","procedureType_create")("procedureType",e.DdM(2,SK))}function TK(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-procedure-type-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("procedureTypes",t.items)}}let yK=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","procedureType","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","procedureTypes","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,vK,1,2,"ng-template",null,1,e.W1O),e.YNc(3,bK,1,3,"ng-template",null,2,e.W1O),e.YNc(5,TK,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,Ju,zu],encapsulation:2}),s})(),wK=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[va],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"procedure-type-select",component:CK,wrappers:["form-field"]},{name:"procedure-type-grid",component:yK}]})]}),s})(),xK=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[wK]}),s})();class es extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class NK extends es{constructor(o,t,i,a,l){super("ValidateProcedureVendorExcelDataAction"),this.valid=!1,this.excelData=o,this.procedures=t,this.contracts=i,this.vendors=a,this.statuses=l}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name),this.validationContext.addRule(new f.mi(`procedureName_${i}_is_valid}`,"Procedure Is Not Valid","procedure.name",t.procedure,this.procedures,!0)),this.validationContext.addRule(new f.mi(`contractName_${i}_is_valid}`,"Contract Is Not Valid","contract.name",t.contract,this.contracts,!0)),this.validationContext.addRule(new f.mi(`vendorName_${i}_is_valid}`,"Vendor Is Not Valid","vendor.name",t.vendor,this.vendors,!0)),this.validationContext.addRule(new f.mi(`statusName_${i}_is_valid}`,"Status Is Not Valid","status.name",t.status,this.statuses,!0))}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class AK extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class FK extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new AK("name","The procedurevendor name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class PK extends es{constructor(o){super("CreateProcedureVendorAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new FK("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateProcedureVendor({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class IK extends es{constructor(o){super("UpdateProcedureVendorsAction"),this.procedureVendors=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.procedureVendors,!0))}performAction(){this.response=this.businessProvider.data.userUpdateProcedureVendors({input:{procedureVendors:this.procedureVendors}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class DK extends es{constructor(o,t){super("UpdateProcedureVendorAction"),this.procedureVendor=o,this.procedureVendorId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.procedureVendor,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.procedureVendorId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateProcedureVendor({procedureVendorId:this.procedureVendorId,input:this.procedureVendor}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let Hu=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.ProcedureVendorBusinessProviderService",t,a),this.data=i}createProcedureVendor(t){const i=new PK(t);return i.Do(this),i.response}updateProcedureVendor(t,i){const a=new DK(t,i);return a.Do(this),a.response}importProcedureVendors(t){const i=new IK(t);return i.Do(this),i.response}validateProcedureVendorExcelData(t,i,a,l,u){const H=new NK(t,i,a,l,u);return H.Do(this),H.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),MK=(()=>{class s extends I.nH{constructor(t,i,a){super("ProcedureVendorService",a,t),this.businessProvider=i}createProcedureVendor(t){return this.businessProvider.createProcedureVendor(t)}updateProcedureVendor(t,i){return this.businessProvider.updateProcedureVendor(t,i)}importProcedureVendors(t){return this.businessProvider.importProcedureVendors(t)}validateProcedureVendorExcelData(t,i,a,l,u){return this.businessProvider.validateProcedureVendorExcelData(t,i,a,l,u)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(Hu,8),e.LFG(Hu),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),ts=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){if(super({loading:!1,procedureVendors:[],done:!1,searchQuery:"",formName:void 0,procedureId:void 0,contractId:void 0,vendorId:void 0,statusId:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.procedureVendorService=H,this.errors$=this.select(m=>m.errors),this.loading$=this.select(m=>m.loading),this.done$=this.select(m=>m.done),this.item$=this.select(m=>m.item),this.procedureVendors$=this.select(m=>m.procedureVendors),this.caseProcedures$=this.select(m=>m.caseProcedures||[]),this.contracts$=this.select(m=>m.contracts||[]),this.vendors$=this.select(m=>m.vendors||[]),this.procedureVendorStatuses$=this.select(m=>m.procedureVendorStatuses||[]),this.procedureId$=this.select(m=>m.procedureId),this.contractId$=this.select(m=>m.contractId),this.vendorId$=this.select(m=>m.vendorId),this.statusId$=this.select(m=>m.statusId),this.paging$=this.select(m=>m.paging),this.searchQuery$=this.select(m=>m.searchQuery),this.formName$=this.select(m=>m.formName),this.actionResult$=this.select(this.item$,this.done$,(m,p)=>({item:m,done:p}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.procedureVendors$,this.caseProcedures$,this.contracts$,this.vendors$,this.procedureVendorStatuses$,(m,p,_,w,J,_e,ve,ae,le)=>({errors:m,loading:p,item:_,formName:w,procedureVendors:J,caseProcedures:_e,contracts:ve,vendors:ae,procedureVendorStatuses:le}),{debounce:!0}),this.input$=this.select(this.paging$,this.procedureId$,this.contractId$,this.vendorId$,this.statusId$,this.searchQuery$,(m,p,_,w,J,_e)=>({limit:m.limit,skip:m.skip,name:_e,procedureId:p,contractId:_,vendorId:w,statusId:J,total:m.total})),this.setFormName=this.updater((m,p)=>Object.assign(Object.assign({},m),{formName:p})),this.setProcedureId=this.updater((m,p)=>Object.assign(Object.assign({},m),{procedureId:p})),this.setContractId=this.updater((m,p)=>Object.assign(Object.assign({},m),{contractId:p})),this.setVendorId=this.updater((m,p)=>Object.assign(Object.assign({},m),{vendorId:p})),this.setStatusId=this.updater((m,p)=>Object.assign(Object.assign({},m),{statusId:p})),this.filterCaseProcedures=m=>this.data.userSelectCaseProcedures({input:{name:m}}).pipe((0,g._b)(p=>{let _=p.data.items;return this.patchState({caseProcedures:_}),_},p=>this.patchState({errors:p.graphQLErrors?p.graphQLErrors:p})),(0,he.U)(p=>p.data.items)),this.filterContracts=m=>this.data.userSelectContracts({input:{name:m}}).pipe((0,g._b)(p=>{let _=p.data.items;return this.patchState({contracts:_}),_},p=>this.patchState({errors:p.graphQLErrors?p.graphQLErrors:p})),(0,he.U)(p=>p.data.items)),this.filterVendors=m=>this.data.userSelectVendors({input:{name:m}}).pipe((0,g._b)(p=>{let _=p.data.items;return this.patchState({vendors:_}),_},p=>this.patchState({errors:p.graphQLErrors?p.graphQLErrors:p})),(0,he.U)(p=>p.data.items)),this.filterProcedureVendorStatuses=m=>this.data.userSelectProcedureVendorStatuses({input:{name:m}}).pipe((0,g._b)(p=>{let _=p.data.items;return this.patchState({procedureVendorStatuses:_}),_},p=>this.patchState({errors:p.graphQLErrors?p.graphQLErrors:p})),(0,he.U)(p=>p.data.items)),this.addCaseProcedure=this.updater((m,p)=>Object.assign(Object.assign({},m),{caseProcedures:m.caseProcedures.concat(p)})),this.addContract=this.updater((m,p)=>Object.assign(Object.assign({},m),{contracts:m.contracts.concat(p)})),this.addVendor=this.updater((m,p)=>Object.assign(Object.assign({},m),{vendors:m.vendors.concat(p)})),this.addProcedureVendorStatus=this.updater((m,p)=>Object.assign(Object.assign({},m),{procedureVendorStatuses:m.procedureVendorStatuses.concat(p)})),this.setItem=this.updater((m,p)=>Object.assign(Object.assign({},m),{item:p})),this.addNewProcedureVendor=this.updater((m,p)=>Object.assign(Object.assign({},m),{procedureVendors:[...m.procedureVendors,p]})),this.updateProcedureVendor=this.updater((m,p)=>Object.assign(Object.assign({},m),{procedureVendors:m.procedureVendors.map(_=>_.id===p.id?p:_)})),this.addProcedureVendors=this.updater((m,p)=>Object.assign(Object.assign({},m),{procedureVendors:m.procedureVendors.concat(p)})),this.updateProcedureVendors=this.updater((m,p)=>Object.assign(Object.assign({},m),{procedureVendors:m.procedureVendors.map(_=>p.find(J=>J.id===_.id)||_)})),this.setSearchQuery=this.updater((m,p)=>Object.assign(Object.assign({},m),{searchQuery:p})),this.loadProcedureVendorEffect=this.effect(m=>m.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(p=>this.data.userProcedureVendor({procedureVendorId:p}).pipe((0,g._b)(_=>{this.patchState({item:_.data.item,errors:_.errors,loading:!1})},_=>this.patchState({loading:!1,errors:_.graphQLErrors?_.graphQLErrors:_})))))),this.loadProcedureVendorsEffect=this.effect(m=>m.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([p,_])=>this.data.userProcedureVendors({input:_}).pipe((0,g._b)(w=>this.patchState({paging:{limit:_.limit,skip:_.skip,total:w.data.count.total},procedureVendors:w.data.items,errors:w.errors,loading:!1}),w=>this.patchState({loading:!1,errors:w.graphQLErrors?w.graphQLErrors:w})))))),this.createProcedureVendorEffect=this.effect(m=>m.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(p=>this.procedureVendorService.createProcedureVendor(Object.assign({},p)).pipe((0,g._b)(_=>{this.addNewProcedureVendor(_),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:_,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},_=>{_.graphQLErrors?(this.toast.error(_.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:_.graphQLErrors?_.graphQLErrors:_})):(this.toast.error(_.Message),this.formService.setErrors(_.Data))}))))),this.updateProcedureVendorEffect=this.effect(m=>m.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([p,_])=>this.procedureVendorService.updateProcedureVendor(p,p.id).pipe((0,g._b)(w=>{this.updateProcedureVendor(w),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:w,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},w=>{w.graphQLErrors?(this.toast.error(w.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:w.graphQLErrors?w.graphQLErrors:w})):(this.toast.error(w.Message),this.formService.setErrors(w.Data))}))))),this.deleteProcedureVendorEffect=this.effect(m=>m.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([p,_])=>this.data.userDeleteProcedureVendor({procedureVendorId:_.id}).pipe((0,g._b)(w=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:w.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},w=>{w.graphQLErrors?(this.toast.error(w.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:w.graphQLErrors?w.graphQLErrors:w})):(this.toast.error(w.Message),this.formService.setErrors(w.Data))}))))),this.importExcelEffect=this.effect(m=>m.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(p=>this.procedureVendorService.importProcedureVendors(p).pipe((0,ce.K)(_=>{var w;return this.toast.error(null!==(w=_.Message)&&void 0!==w?w:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(_=>{const w=JSON.parse(_.created),J=JSON.parse(_.updated),_e=JSON.parse(_.failed),ve=w.length+J.length+_e.length;this.addProcedureVendors(w),this.updateProcedureVendors(J),this.toast.success(`${w.length} created, ${J.length} updated, ${_e.length} failed of total ${ve}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("procedureVendorId")?(this.route.snapshot.paramMap.get("procedureVendorId"),this.setFormName("procedureVendor_edit")):this.setFormName("procedureVendor_create"),this.route.snapshot.paramMap.has("caseProcedureId")){var c=this.route.snapshot.paramMap.get("caseProcedureId");this.setProcedureId(c)}if(this.route.snapshot.paramMap.has("contractId")){var d=this.route.snapshot.paramMap.get("contractId");this.setContractId(d)}if(this.route.snapshot.paramMap.has("vendorId")){var n=this.route.snapshot.paramMap.get("vendorId");this.setVendorId(n)}if(this.route.snapshot.paramMap.has("statusId")){var r=this.route.snapshot.paramMap.get("statusId");this.setStatusId(r)}}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.procedureVendorService.validateProcedureVendorExcelData(t,i.caseProcedures,i.contracts,i.vendors,i.procedureVendorStatuses)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(MK))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function WK(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.procedureVendor)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let qu=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"procedureVendor_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({id:null,name:""}),this.store.vm$.subscribe(i=>{this.procedureVendor=i.item})):t.formName&&t.formName.currentValue&&"procedureVendor_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadProcedureVendorEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.procedureVendor=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(ts),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-procedure-vendor-form"]],inputs:{procedureVendor:"procedureVendor",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,WK,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),Ku=(()=>{class s{constructor(){this.autoHeight=!1,this.procedureVendors=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[{field:"procedure.name",headerName:"Procedure",filter:"agTextColumnFilter"},{field:"contract.name",headerName:"Contract",filter:"agTextColumnFilter"},{field:"vendor.name",headerName:"Vendor",filter:"agTextColumnFilter"},{field:"status.name",headerName:"Status",filter:"agTextColumnFilter"},{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{field:"procedureId",filter:"agTextColumnFilter",hide:!0},{field:"contractId",filter:"agTextColumnFilter",hide:!0},{field:"vendorId",filter:"agTextColumnFilter",hide:!0},{field:"statusId",filter:"agTextColumnFilter",hide:!0},{headerName:"Estimate",field:"estimate",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.estimate,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{headerName:"Funding Approved",field:"fundingApproved",filter:"agSetColumnFilter",cellRenderer:"checkboxRenderer"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-procedure-vendor-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",procedureVendors:"procedureVendors"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","data","showSidebar","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("data",i.procedureVendors)("showSidebar",!1)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function EK(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-procedure-vendor-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","procedureVendor_edit")("formControl",t.formControl)("procedureVendor",t.procedureVendor)}}const OK=function(){return{}};function LK(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-procedure-vendor-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","procedureVendor_create")("formControl",t.formControl)("procedureVendor",e.DdM(3,OK))}}function $K(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-procedure-vendor-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("procedureVendors",o.data.items)}let GK=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadProcedureVendorsEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.procedureVendors$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(ts))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e._Bn([ts]),e.qOj],decls:7,vars:5,consts:[[3,"to","control","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","procedureVendor","send","close"],[1,"w-full","h-full","bg-white",3,"procedureVendors","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"ui-select-form",0),e.YNc(1,EK,2,3,"ng-template",null,1,e.W1O),e.YNc(3,LK,1,4,"ng-template",null,2,e.W1O),e.YNc(5,$K,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[W.JJ,W.oH,Z.$,qu,Ku],encapsulation:2}),s})();function RK(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-procedure-vendor-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","procedureVendor_edit")("procedureVendor",t.value)}}const QK=function(){return{}};function VK(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-procedure-vendor-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","procedureVendor_create")("procedureVendor",e.DdM(2,QK))}function jK(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-procedure-vendor-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("procedureVendors",t.items)}}let UK=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:6,consts:[[3,"data","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","procedureVendor","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","procedureVendors","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,RK,1,2,"ng-template",null,1,e.W1O),e.YNc(3,VK,1,3,"ng-template",null,2,e.W1O),e.YNc(5,jK,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,qu,Ku],encapsulation:2}),s})(),JK=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[ts],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"procedure-vendor-select",component:GK,wrappers:["form-field"]},{name:"procedure-vendor-grid",component:UK}]})]}),s})(),zK=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[JK]}),s})();class is extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class HK extends is{constructor(o){super("ValidateProcedureVendorStatusExcelDataAction"),this.valid=!1,this.excelData=o}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name)}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class qK extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class KK extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new qK("name","The procedurevendorstatus name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class ZK extends is{constructor(o){super("CreateProcedureVendorStatusAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new KK("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateProcedureVendorStatus({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class kK extends is{constructor(o){super("UpdateProcedureVendorStatusesAction"),this.procedureVendorStatuses=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.procedureVendorStatuses,!0))}performAction(){this.response=this.businessProvider.data.userUpdateProcedureVendorStatuses({input:{procedureVendorStatuses:this.procedureVendorStatuses}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class BK extends is{constructor(o,t){super("UpdateProcedureVendorStatusAction"),this.procedureVendorStatus=o,this.procedureVendorStatusId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.procedureVendorStatus,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.procedureVendorStatusId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateProcedureVendorStatus({procedureVendorStatusId:this.procedureVendorStatusId,input:this.procedureVendorStatus}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let Zu=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.ProcedureVendorStatusBusinessProviderService",t,a),this.data=i}createProcedureVendorStatus(t){const i=new ZK(t);return i.Do(this),i.response}updateProcedureVendorStatus(t,i){const a=new BK(t,i);return a.Do(this),a.response}importProcedureVendorStatuses(t){const i=new kK(t);return i.Do(this),i.response}validateProcedureVendorStatusExcelData(t){const i=new HK(t);return i.Do(this),i.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),YK=(()=>{class s extends I.nH{constructor(t,i,a){super("ProcedureVendorStatusService",a,t),this.businessProvider=i}createProcedureVendorStatus(t){return this.businessProvider.createProcedureVendorStatus(t)}updateProcedureVendorStatus(t,i){return this.businessProvider.updateProcedureVendorStatus(t,i)}importProcedureVendorStatuses(t){return this.businessProvider.importProcedureVendorStatuses(t)}validateProcedureVendorStatusExcelData(t){return this.businessProvider.validateProcedureVendorStatusExcelData(t)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(Zu,8),e.LFG(Zu),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),ss=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){super({loading:!1,procedureVendorStatuses:[],done:!1,searchQuery:"",formName:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.procedureVendorStatusService=H,this.errors$=this.select(c=>c.errors),this.loading$=this.select(c=>c.loading),this.done$=this.select(c=>c.done),this.item$=this.select(c=>c.item),this.procedureVendorStatuses$=this.select(c=>c.procedureVendorStatuses),this.paging$=this.select(c=>c.paging),this.searchQuery$=this.select(c=>c.searchQuery),this.formName$=this.select(c=>c.formName),this.actionResult$=this.select(this.item$,this.done$,(c,d)=>({item:c,done:d}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.procedureVendorStatuses$,(c,d,n,r,m)=>({errors:c,loading:d,item:n,formName:r,procedureVendorStatuses:m}),{debounce:!0}),this.input$=this.select(this.paging$,this.searchQuery$,(c,d)=>({limit:c.limit,skip:c.skip,name:d,total:c.total})),this.setFormName=this.updater((c,d)=>Object.assign(Object.assign({},c),{formName:d})),this.setItem=this.updater((c,d)=>Object.assign(Object.assign({},c),{item:d})),this.addNewProcedureVendorStatus=this.updater((c,d)=>Object.assign(Object.assign({},c),{procedureVendorStatuses:[...c.procedureVendorStatuses,d]})),this.updateProcedureVendorStatus=this.updater((c,d)=>Object.assign(Object.assign({},c),{procedureVendorStatuses:c.procedureVendorStatuses.map(n=>n.id===d.id?d:n)})),this.addProcedureVendorStatuses=this.updater((c,d)=>Object.assign(Object.assign({},c),{procedureVendorStatuses:c.procedureVendorStatuses.concat(d)})),this.updateProcedureVendorStatuses=this.updater((c,d)=>Object.assign(Object.assign({},c),{procedureVendorStatuses:c.procedureVendorStatuses.map(n=>d.find(m=>m.id===n.id)||n)})),this.setSearchQuery=this.updater((c,d)=>Object.assign(Object.assign({},c),{searchQuery:d})),this.loadProcedureVendorStatusEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.data.userProcedureVendorStatus({procedureVendorStatusId:d}).pipe((0,g._b)(n=>{this.patchState({item:n.data.item,errors:n.errors,loading:!1})},n=>this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})))))),this.loadProcedureVendorStatusesEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([d,n])=>this.data.userProcedureVendorStatuses({input:n}).pipe((0,g._b)(r=>this.patchState({paging:{limit:n.limit,skip:n.skip,total:r.data.count.total},procedureVendorStatuses:r.data.items,errors:r.errors,loading:!1}),r=>this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})))))),this.createProcedureVendorStatusEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.procedureVendorStatusService.createProcedureVendorStatus(Object.assign({},d)).pipe((0,g._b)(n=>{this.addNewProcedureVendorStatus(n),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:n,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},n=>{n.graphQLErrors?(this.toast.error(n.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})):(this.toast.error(n.Message),this.formService.setErrors(n.Data))}))))),this.updateProcedureVendorStatusEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.procedureVendorStatusService.updateProcedureVendorStatus(d,d.id).pipe((0,g._b)(r=>{this.updateProcedureVendorStatus(r),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:r,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.deleteProcedureVendorStatusEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.data.userDeleteProcedureVendorStatus({procedureVendorStatusId:n.id}).pipe((0,g._b)(r=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:r.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.importExcelEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.procedureVendorStatusService.importProcedureVendorStatuses(d).pipe((0,ce.K)(n=>{var r;return this.toast.error(null!==(r=n.Message)&&void 0!==r?r:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(n=>{const r=JSON.parse(n.created),m=JSON.parse(n.updated),p=JSON.parse(n.failed),_=r.length+m.length+p.length;this.addProcedureVendorStatuses(r),this.updateProcedureVendorStatuses(m),this.toast.success(`${r.length} created, ${m.length} updated, ${p.length} failed of total ${_}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("procedureVendorStatusId")?(this.route.snapshot.paramMap.get("procedureVendorStatusId"),this.setFormName("procedureVendorStatus_edit")):this.setFormName("procedureVendorStatus_create")}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.procedureVendorStatusService.validateProcedureVendorStatusExcelData(t)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(YK))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function XK(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.procedureVendorStatus)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let ku=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"procedureVendorStatus_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.procedureVendorStatus=i.item})):t.formName&&t.formName.currentValue&&"procedureVendorStatus_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadProcedureVendorStatusEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.procedureVendorStatus=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(ss),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-procedure-vendor-status-form"]],inputs:{procedureVendorStatus:"procedureVendorStatus",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,XK,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),Bu=(()=>{class s{constructor(){this.autoHeight=!1,this.procedureVendorStatuses=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[,{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-procedure-vendor-status-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",procedureVendorStatuses:"procedureVendorStatuses"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","data","showSidebar","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("data",i.procedureVendorStatuses)("showSidebar",!1)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function e4(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-procedure-vendor-status-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","procedureVendorStatus_edit")("formControl",t.formControl)("procedureVendorStatus",t.procedureVendorStatus)}}const t4=function(){return{}};function i4(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-procedure-vendor-status-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","procedureVendorStatus_create")("formControl",t.formControl)("procedureVendorStatus",e.DdM(3,t4))}}function s4(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-procedure-vendor-status-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("procedureVendorStatuses",o.data.items)}let o4=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadProcedureVendorStatusesEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.procedureVendorStatuses$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(ss))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e._Bn([ss]),e.qOj],decls:7,vars:5,consts:[[3,"to","control","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","procedureVendorStatus","send","close"],[1,"w-full","h-full","bg-white",3,"procedureVendorStatuses","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"ui-select-form",0),e.YNc(1,e4,2,3,"ng-template",null,1,e.W1O),e.YNc(3,i4,1,4,"ng-template",null,2,e.W1O),e.YNc(5,s4,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[W.JJ,W.oH,Z.$,ku,Bu],encapsulation:2}),s})();function a4(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-procedure-vendor-status-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","procedureVendorStatus_edit")("procedureVendorStatus",t.value)}}const r4=function(){return{}};function n4(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-procedure-vendor-status-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","procedureVendorStatus_create")("procedureVendorStatus",e.DdM(2,r4))}function l4(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-procedure-vendor-status-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("procedureVendorStatuses",t.items)}}let c4=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:6,consts:[[3,"data","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","procedureVendorStatus","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","procedureVendorStatuses","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,a4,1,2,"ng-template",null,1,e.W1O),e.YNc(3,n4,1,3,"ng-template",null,2,e.W1O),e.YNc(5,l4,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,ku,Bu],encapsulation:2}),s})(),d4=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[ss],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"procedure-vendor-status-select",component:o4,wrappers:["form-field"]},{name:"procedure-vendor-status-grid",component:c4}]})]}),s})(),u4=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[d4]}),s})();class os extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class m4 extends os{constructor(o){super("ValidateProcessExcelDataAction"),this.valid=!1,this.excelData=o}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name)}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class p4 extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class h4 extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new p4("name","The process name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class f4 extends os{constructor(o){super("CreateProcessAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new h4("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateProcess({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class _4 extends os{constructor(o){super("UpdateProcessesAction"),this.processes=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.processes,!0))}performAction(){this.response=this.businessProvider.data.userUpdateProcesses({input:{processes:this.processes}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class g4 extends os{constructor(o,t){super("UpdateProcessAction"),this.process=o,this.processId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.process,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.processId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateProcess({processId:this.processId,input:this.process}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let Yu=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.ProcessBusinessProviderService",t,a),this.data=i}createProcess(t){const i=new f4(t);return i.Do(this),i.response}updateProcess(t,i){const a=new g4(t,i);return a.Do(this),a.response}importProcesses(t){const i=new _4(t);return i.Do(this),i.response}validateProcessExcelData(t){const i=new m4(t);return i.Do(this),i.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),C4=(()=>{class s extends I.nH{constructor(t,i,a){super("ProcessService",a,t),this.businessProvider=i}createProcess(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createProcess(i)}updateProcess(t,i){return this.businessProvider.updateProcess(t,i)}importProcesses(t){return this.businessProvider.importProcesses(t)}validateProcessExcelData(t){return this.businessProvider.validateProcessExcelData(t)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(Yu,8),e.LFG(Yu),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),Sa=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){super({loading:!1,processes:[],done:!1,searchQuery:"",formName:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.processService=H,this.errors$=this.select(c=>c.errors),this.loading$=this.select(c=>c.loading),this.done$=this.select(c=>c.done),this.item$=this.select(c=>c.item),this.processes$=this.select(c=>c.processes),this.paging$=this.select(c=>c.paging),this.searchQuery$=this.select(c=>c.searchQuery),this.formName$=this.select(c=>c.formName),this.actionResult$=this.select(this.item$,this.done$,(c,d)=>({item:c,done:d}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.processes$,(c,d,n,r,m)=>({errors:c,loading:d,item:n,formName:r,processes:m}),{debounce:!0}),this.input$=this.select(this.paging$,this.searchQuery$,(c,d)=>({limit:c.limit,skip:c.skip,name:d,total:c.total})),this.setFormName=this.updater((c,d)=>Object.assign(Object.assign({},c),{formName:d})),this.setItem=this.updater((c,d)=>Object.assign(Object.assign({},c),{item:d})),this.addNewProcess=this.updater((c,d)=>Object.assign(Object.assign({},c),{processes:[...c.processes,d]})),this.updateProcess=this.updater((c,d)=>Object.assign(Object.assign({},c),{processes:c.processes.map(n=>n.id===d.id?d:n)})),this.addProcesses=this.updater((c,d)=>Object.assign(Object.assign({},c),{processes:c.processes.concat(d)})),this.updateProcesses=this.updater((c,d)=>Object.assign(Object.assign({},c),{processes:c.processes.map(n=>d.find(m=>m.id===n.id)||n)})),this.setSearchQuery=this.updater((c,d)=>Object.assign(Object.assign({},c),{searchQuery:d})),this.loadProcessEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.data.userProcess({processId:d}).pipe((0,g._b)(n=>{this.patchState({item:n.data.item,errors:n.errors,loading:!1})},n=>this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})))))),this.loadProcessesEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([d,n])=>this.data.userProcesses({input:n}).pipe((0,g._b)(r=>this.patchState({paging:{limit:n.limit,skip:n.skip,total:r.data.count.total},processes:r.data.items,errors:r.errors,loading:!1}),r=>this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})))))),this.createProcessEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.processService.createProcess(Object.assign({},d)).pipe((0,g._b)(n=>{this.addNewProcess(n),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:n,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},n=>{n.graphQLErrors?(this.toast.error(n.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})):(this.toast.error(n.Message),this.formService.setErrors(n.Data))}))))),this.updateProcessEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.processService.updateProcess(d,d.id).pipe((0,g._b)(r=>{this.updateProcess(r),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:r,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.deleteProcessEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.data.userDeleteProcess({processId:n.id}).pipe((0,g._b)(r=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:r.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.importExcelEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.processService.importProcesses(d).pipe((0,ce.K)(n=>{var r;return this.toast.error(null!==(r=n.Message)&&void 0!==r?r:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(n=>{const r=JSON.parse(n.created),m=JSON.parse(n.updated),p=JSON.parse(n.failed),_=r.length+m.length+p.length;this.addProcesses(r),this.updateProcesses(m),this.toast.success(`${r.length} created, ${m.length} updated, ${p.length} failed of total ${_}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("processId")?(this.route.snapshot.paramMap.get("processId"),this.setFormName("process_edit")):this.setFormName("process_create")}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.processService.validateProcessExcelData(t)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(C4))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function v4(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.process)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let Xu=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"process_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.process=i.item})):t.formName&&t.formName.currentValue&&"process_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadProcessEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.process=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Sa),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-process-form"]],inputs:{process:"process",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,v4,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),em=(()=>{class s{constructor(){this.autoHeight=!1,this.processes=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[,{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-process-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",processes:"processes"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.processes)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function S4(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-process-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","process_edit")("formControl",t.formControl)("process",t.process)}}const b4=function(){return{}};function T4(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-process-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","process_create")("formControl",t.formControl)("process",e.DdM(3,b4))}}function y4(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-process-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("processes",o.data.items)}let w4=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadProcessesEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.processes$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Sa))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","process","send","close"],[1,"w-full","h-full","bg-white",3,"processes","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,S4,2,3,"ng-template",null,1,e.W1O),e.YNc(3,T4,1,4,"ng-template",null,2,e.W1O),e.YNc(5,y4,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,Xu,em],encapsulation:2}),s})();function x4(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-process-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","process_edit")("process",t.value)}}const N4=function(){return{}};function A4(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-process-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","process_create")("process",e.DdM(2,N4))}function F4(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-process-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("processes",t.items)}}let P4=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","process","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","processes","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,x4,1,2,"ng-template",null,1,e.W1O),e.YNc(3,A4,1,3,"ng-template",null,2,e.W1O),e.YNc(5,F4,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,Xu,em],encapsulation:2}),s})(),I4=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[Sa],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"process-select",component:w4,wrappers:["form-field"]},{name:"process-grid",component:P4}]})]}),s})(),D4=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[I4]}),s})();class as extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class M4 extends as{constructor(o){super("ValidateRecommendedOrderExcelDataAction"),this.valid=!1,this.excelData=o}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name)}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class W4 extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class E4 extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new W4("name","The recommendedorder name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class O4 extends as{constructor(o){super("CreateRecommendedOrderAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new E4("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateRecommendedOrder({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class L4 extends as{constructor(o){super("UpdateRecommendedOrdersAction"),this.recommendedOrders=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.recommendedOrders,!0))}performAction(){this.response=this.businessProvider.data.userUpdateRecommendedOrders({input:{recommendedOrders:this.recommendedOrders}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class $4 extends as{constructor(o,t){super("UpdateRecommendedOrderAction"),this.recommendedOrder=o,this.recommendedOrderId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.recommendedOrder,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.recommendedOrderId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateRecommendedOrder({recommendedOrderId:this.recommendedOrderId,input:this.recommendedOrder}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let tm=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.RecommendedOrderBusinessProviderService",t,a),this.data=i}createRecommendedOrder(t){const i=new O4(t);return i.Do(this),i.response}updateRecommendedOrder(t,i){const a=new $4(t,i);return a.Do(this),a.response}importRecommendedOrders(t){const i=new L4(t);return i.Do(this),i.response}validateRecommendedOrderExcelData(t){const i=new M4(t);return i.Do(this),i.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),G4=(()=>{class s extends I.nH{constructor(t,i,a){super("RecommendedOrderService",a,t),this.businessProvider=i}createRecommendedOrder(t){return this.businessProvider.createRecommendedOrder(t)}updateRecommendedOrder(t,i){return this.businessProvider.updateRecommendedOrder(t,i)}importRecommendedOrders(t){return this.businessProvider.importRecommendedOrders(t)}validateRecommendedOrderExcelData(t){return this.businessProvider.validateRecommendedOrderExcelData(t)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(tm,8),e.LFG(tm),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),rs=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){super({loading:!1,recommendedOrders:[],done:!1,searchQuery:"",formName:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.recommendedOrderService=H,this.errors$=this.select(c=>c.errors),this.loading$=this.select(c=>c.loading),this.done$=this.select(c=>c.done),this.item$=this.select(c=>c.item),this.recommendedOrders$=this.select(c=>c.recommendedOrders),this.paging$=this.select(c=>c.paging),this.searchQuery$=this.select(c=>c.searchQuery),this.formName$=this.select(c=>c.formName),this.actionResult$=this.select(this.item$,this.done$,(c,d)=>({item:c,done:d}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.recommendedOrders$,(c,d,n,r,m)=>({errors:c,loading:d,item:n,formName:r,recommendedOrders:m}),{debounce:!0}),this.input$=this.select(this.paging$,this.searchQuery$,(c,d)=>({limit:c.limit,skip:c.skip,name:d,total:c.total})),this.setFormName=this.updater((c,d)=>Object.assign(Object.assign({},c),{formName:d})),this.setItem=this.updater((c,d)=>Object.assign(Object.assign({},c),{item:d})),this.addNewRecommendedOrder=this.updater((c,d)=>Object.assign(Object.assign({},c),{recommendedOrders:[...c.recommendedOrders,d]})),this.updateRecommendedOrder=this.updater((c,d)=>Object.assign(Object.assign({},c),{recommendedOrders:c.recommendedOrders.map(n=>n.id===d.id?d:n)})),this.addRecommendedOrders=this.updater((c,d)=>Object.assign(Object.assign({},c),{recommendedOrders:c.recommendedOrders.concat(d)})),this.updateRecommendedOrders=this.updater((c,d)=>Object.assign(Object.assign({},c),{recommendedOrders:c.recommendedOrders.map(n=>d.find(m=>m.id===n.id)||n)})),this.setSearchQuery=this.updater((c,d)=>Object.assign(Object.assign({},c),{searchQuery:d})),this.loadRecommendedOrderEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.data.userRecommendedOrder({recommendedOrderId:d}).pipe((0,g._b)(n=>{this.patchState({item:n.data.item,errors:n.errors,loading:!1})},n=>this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})))))),this.loadRecommendedOrdersEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([d,n])=>this.data.userRecommendedOrders({input:n}).pipe((0,g._b)(r=>this.patchState({paging:{limit:n.limit,skip:n.skip,total:r.data.count.total},recommendedOrders:r.data.items,errors:r.errors,loading:!1}),r=>this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})))))),this.createRecommendedOrderEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.recommendedOrderService.createRecommendedOrder(Object.assign({},d)).pipe((0,g._b)(n=>{this.addNewRecommendedOrder(n),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:n,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},n=>{n.graphQLErrors?(this.toast.error(n.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})):(this.toast.error(n.Message),this.formService.setErrors(n.Data))}))))),this.updateRecommendedOrderEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.recommendedOrderService.updateRecommendedOrder(d,d.id).pipe((0,g._b)(r=>{this.updateRecommendedOrder(r),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:r,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.deleteRecommendedOrderEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.data.userDeleteRecommendedOrder({recommendedOrderId:n.id}).pipe((0,g._b)(r=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:r.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.importExcelEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.recommendedOrderService.importRecommendedOrders(d).pipe((0,ce.K)(n=>{var r;return this.toast.error(null!==(r=n.Message)&&void 0!==r?r:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(n=>{const r=JSON.parse(n.created),m=JSON.parse(n.updated),p=JSON.parse(n.failed),_=r.length+m.length+p.length;this.addRecommendedOrders(r),this.updateRecommendedOrders(m),this.toast.success(`${r.length} created, ${m.length} updated, ${p.length} failed of total ${_}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("recommendedOrderId")?(this.route.snapshot.paramMap.get("recommendedOrderId"),this.setFormName("recommendedOrder_edit")):this.setFormName("recommendedOrder_create")}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.recommendedOrderService.validateRecommendedOrderExcelData(t)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(G4))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function R4(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.recommendedOrder)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let im=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"recommendedOrder_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({id:null,name:""}),this.store.vm$.subscribe(i=>{this.recommendedOrder=i.item})):t.formName&&t.formName.currentValue&&"recommendedOrder_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadRecommendedOrderEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.recommendedOrder=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(rs),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-recommended-order-form"]],inputs:{recommendedOrder:"recommendedOrder",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,R4,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),sm=(()=>{class s{constructor(){this.autoHeight=!1,this.recommendedOrders=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[,{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{field:"patientId",filter:"agTextColumnFilter"},{field:"legalCaseId",filter:"agTextColumnFilter"},{field:"requestingProviderId",filter:"agTextColumnFilter"},{field:"status",filter:"agTextColumnFilter"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-recommended-order-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",recommendedOrders:"recommendedOrders"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:6,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.recommendedOrders)("showSidebar",!1)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function Q4(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-recommended-order-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","recommendedOrder_edit")("formControl",t.formControl)("recommendedOrder",t.recommendedOrder)}}const V4=function(){return{}};function j4(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-recommended-order-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","recommendedOrder_create")("formControl",t.formControl)("recommendedOrder",e.DdM(3,V4))}}function U4(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-recommended-order-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("recommendedOrders",o.data.items)}let J4=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadRecommendedOrdersEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.recommendedOrders$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(rs))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e._Bn([rs]),e.qOj],decls:7,vars:5,consts:[[3,"to","control","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","recommendedOrder","send","close"],[1,"w-full","h-full","bg-white",3,"recommendedOrders","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"ui-select-form",0),e.YNc(1,Q4,2,3,"ng-template",null,1,e.W1O),e.YNc(3,j4,1,4,"ng-template",null,2,e.W1O),e.YNc(5,U4,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[W.JJ,W.oH,Z.$,im,sm],encapsulation:2}),s})();function z4(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-recommended-order-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","recommendedOrder_edit")("recommendedOrder",t.value)}}const H4=function(){return{}};function q4(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-recommended-order-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","recommendedOrder_create")("recommendedOrder",e.DdM(2,H4))}function K4(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-recommended-order-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("recommendedOrders",t.items)}}let Z4=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:6,consts:[[3,"data","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","recommendedOrder","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","recommendedOrders","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,z4,1,2,"ng-template",null,1,e.W1O),e.YNc(3,q4,1,3,"ng-template",null,2,e.W1O),e.YNc(5,K4,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,im,sm],encapsulation:2}),s})(),k4=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[rs],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"recommended-order-select",component:J4,wrappers:["form-field"]},{name:"recommended-order-grid",component:Z4}]})]}),s})(),B4=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[k4]}),s})();class ns extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class Y4 extends ns{constructor(o){super("ValidateReconciliationPeriodTypeExcelDataAction"),this.valid=!1,this.excelData=o}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name)}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class X4 extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class eZ extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new X4("name","The reconciliationperiodtype name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class tZ extends ns{constructor(o){super("CreateReconciliationPeriodTypeAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new eZ("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateReconciliationPeriodType({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class iZ extends ns{constructor(o){super("UpdateReconciliationPeriodTypesAction"),this.reconciliationPeriodTypes=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.reconciliationPeriodTypes,!0))}performAction(){this.response=this.businessProvider.data.userUpdateReconciliationPeriodTypes({input:{reconciliationPeriodTypes:this.reconciliationPeriodTypes}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class sZ extends ns{constructor(o,t){super("UpdateReconciliationPeriodTypeAction"),this.reconciliationPeriodType=o,this.reconciliationPeriodTypeId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.reconciliationPeriodType,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.reconciliationPeriodTypeId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateReconciliationPeriodType({reconciliationPeriodTypeId:this.reconciliationPeriodTypeId,input:this.reconciliationPeriodType}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let om=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.ReconciliationPeriodTypeBusinessProviderService",t,a),this.data=i}createReconciliationPeriodType(t){const i=new tZ(t);return i.Do(this),i.response}updateReconciliationPeriodType(t,i){const a=new sZ(t,i);return a.Do(this),a.response}importReconciliationPeriodTypes(t){const i=new iZ(t);return i.Do(this),i.response}validateReconciliationPeriodTypeExcelData(t){const i=new Y4(t);return i.Do(this),i.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),oZ=(()=>{class s extends I.nH{constructor(t,i,a){super("ReconciliationPeriodTypeService",a,t),this.businessProvider=i}createReconciliationPeriodType(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createReconciliationPeriodType(i)}updateReconciliationPeriodType(t,i){return this.businessProvider.updateReconciliationPeriodType(t,i)}importReconciliationPeriodTypes(t){return this.businessProvider.importReconciliationPeriodTypes(t)}validateReconciliationPeriodTypeExcelData(t){return this.businessProvider.validateReconciliationPeriodTypeExcelData(t)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(om,8),e.LFG(om),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),ba=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){super({loading:!1,reconciliationPeriodTypes:[],done:!1,searchQuery:"",formName:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.reconciliationPeriodTypeService=H,this.errors$=this.select(c=>c.errors),this.loading$=this.select(c=>c.loading),this.done$=this.select(c=>c.done),this.item$=this.select(c=>c.item),this.reconciliationPeriodTypes$=this.select(c=>c.reconciliationPeriodTypes),this.paging$=this.select(c=>c.paging),this.searchQuery$=this.select(c=>c.searchQuery),this.formName$=this.select(c=>c.formName),this.actionResult$=this.select(this.item$,this.done$,(c,d)=>({item:c,done:d}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.reconciliationPeriodTypes$,(c,d,n,r,m)=>({errors:c,loading:d,item:n,formName:r,reconciliationPeriodTypes:m}),{debounce:!0}),this.input$=this.select(this.paging$,this.searchQuery$,(c,d)=>({limit:c.limit,skip:c.skip,name:d,total:c.total})),this.setFormName=this.updater((c,d)=>Object.assign(Object.assign({},c),{formName:d})),this.setItem=this.updater((c,d)=>Object.assign(Object.assign({},c),{item:d})),this.addNewReconciliationPeriodType=this.updater((c,d)=>Object.assign(Object.assign({},c),{reconciliationPeriodTypes:[...c.reconciliationPeriodTypes,d]})),this.updateReconciliationPeriodType=this.updater((c,d)=>Object.assign(Object.assign({},c),{reconciliationPeriodTypes:c.reconciliationPeriodTypes.map(n=>n.id===d.id?d:n)})),this.addReconciliationPeriodTypes=this.updater((c,d)=>Object.assign(Object.assign({},c),{reconciliationPeriodTypes:c.reconciliationPeriodTypes.concat(d)})),this.updateReconciliationPeriodTypes=this.updater((c,d)=>Object.assign(Object.assign({},c),{reconciliationPeriodTypes:c.reconciliationPeriodTypes.map(n=>d.find(m=>m.id===n.id)||n)})),this.setSearchQuery=this.updater((c,d)=>Object.assign(Object.assign({},c),{searchQuery:d})),this.loadReconciliationPeriodTypeEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.data.userReconciliationPeriodType({reconciliationPeriodTypeId:d}).pipe((0,g._b)(n=>{this.patchState({item:n.data.item,errors:n.errors,loading:!1})},n=>this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})))))),this.loadReconciliationPeriodTypesEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([d,n])=>this.data.userReconciliationPeriodTypes({input:n}).pipe((0,g._b)(r=>this.patchState({paging:{limit:n.limit,skip:n.skip,total:r.data.count.total},reconciliationPeriodTypes:r.data.items,errors:r.errors,loading:!1}),r=>this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})))))),this.createReconciliationPeriodTypeEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.reconciliationPeriodTypeService.createReconciliationPeriodType(Object.assign({},d)).pipe((0,g._b)(n=>{this.addNewReconciliationPeriodType(n),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:n,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},n=>{n.graphQLErrors?(this.toast.error(n.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})):(this.toast.error(n.Message),this.formService.setErrors(n.Data))}))))),this.updateReconciliationPeriodTypeEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.reconciliationPeriodTypeService.updateReconciliationPeriodType(d,d.id).pipe((0,g._b)(r=>{this.updateReconciliationPeriodType(r),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:r,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.deleteReconciliationPeriodTypeEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.data.userDeleteReconciliationPeriodType({reconciliationPeriodTypeId:n.id}).pipe((0,g._b)(r=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:r.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.importExcelEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.reconciliationPeriodTypeService.importReconciliationPeriodTypes(d).pipe((0,ce.K)(n=>{var r;return this.toast.error(null!==(r=n.Message)&&void 0!==r?r:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(n=>{const r=JSON.parse(n.created),m=JSON.parse(n.updated),p=JSON.parse(n.failed),_=r.length+m.length+p.length;this.addReconciliationPeriodTypes(r),this.updateReconciliationPeriodTypes(m),this.toast.success(`${r.length} created, ${m.length} updated, ${p.length} failed of total ${_}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("reconciliationPeriodTypeId")?(this.route.snapshot.paramMap.get("reconciliationPeriodTypeId"),this.setFormName("reconciliationPeriodType_edit")):this.setFormName("reconciliationPeriodType_create")}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.reconciliationPeriodTypeService.validateReconciliationPeriodTypeExcelData(t)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(oZ))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function aZ(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.reconciliationPeriodType)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let am=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"reconciliationPeriodType_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.reconciliationPeriodType=i.item})):t.formName&&t.formName.currentValue&&"reconciliationPeriodType_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadReconciliationPeriodTypeEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.reconciliationPeriodType=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(ba),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-reconciliation-period-type-form"]],inputs:{reconciliationPeriodType:"reconciliationPeriodType",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,aZ,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),rm=(()=>{class s{constructor(){this.autoHeight=!1,this.reconciliationPeriodTypes=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[,{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-reconciliation-period-type-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",reconciliationPeriodTypes:"reconciliationPeriodTypes"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.reconciliationPeriodTypes)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function rZ(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-reconciliation-period-type-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","reconciliationPeriodType_edit")("formControl",t.formControl)("reconciliationPeriodType",t.reconciliationPeriodType)}}const nZ=function(){return{}};function lZ(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-reconciliation-period-type-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","reconciliationPeriodType_create")("formControl",t.formControl)("reconciliationPeriodType",e.DdM(3,nZ))}}function cZ(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-reconciliation-period-type-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("reconciliationPeriodTypes",o.data.items)}let dZ=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadReconciliationPeriodTypesEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.reconciliationPeriodTypes$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(ba))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","reconciliationPeriodType","send","close"],[1,"w-full","h-full","bg-white",3,"reconciliationPeriodTypes","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,rZ,2,3,"ng-template",null,1,e.W1O),e.YNc(3,lZ,1,4,"ng-template",null,2,e.W1O),e.YNc(5,cZ,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,am,rm],encapsulation:2}),s})();function uZ(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-reconciliation-period-type-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","reconciliationPeriodType_edit")("reconciliationPeriodType",t.value)}}const mZ=function(){return{}};function pZ(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-reconciliation-period-type-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","reconciliationPeriodType_create")("reconciliationPeriodType",e.DdM(2,mZ))}function hZ(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-reconciliation-period-type-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("reconciliationPeriodTypes",t.items)}}let fZ=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","reconciliationPeriodType","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","reconciliationPeriodTypes","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,uZ,1,2,"ng-template",null,1,e.W1O),e.YNc(3,pZ,1,3,"ng-template",null,2,e.W1O),e.YNc(5,hZ,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,am,rm],encapsulation:2}),s})(),_Z=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[ba],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"reconciliation-period-type-select",component:dZ,wrappers:["form-field"]},{name:"reconciliation-period-type-grid",component:fZ}]})]}),s})(),gZ=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[_Z]}),s})();class ls extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class CZ extends ls{constructor(o,t,i){super("ValidateRequiredFieldExcelDataAction"),this.valid=!1,this.excelData=o,this.accidentTypes=t,this.medLevels=i}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name),this.validationContext.addRule(new f.mi(`accidentTypeName_${i}_is_valid}`,"Accident Type Is Not Valid","accidentType.name",t.accidentType,this.accidentTypes,!0)),this.validationContext.addRule(new f.mi(`medLevelName_${i}_is_valid}`,"Med Level Is Not Valid","medLevel.name",t.medLevel,this.medLevels,!0))}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class vZ extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class SZ extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new vZ("name","The requiredfield name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class bZ extends ls{constructor(o){super("CreateRequiredFieldAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new SZ("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateRequiredField({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class TZ extends ls{constructor(o){super("UpdateRequiredFieldsAction"),this.requiredFields=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.requiredFields,!0))}performAction(){this.response=this.businessProvider.data.userUpdateRequiredFields({input:{requiredFields:this.requiredFields}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class yZ extends ls{constructor(o,t){super("UpdateRequiredFieldAction"),this.requiredField=o,this.requiredFieldId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.requiredField,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.requiredFieldId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateRequiredField({requiredFieldId:this.requiredFieldId,input:this.requiredField}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let nm=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.RequiredFieldBusinessProviderService",t,a),this.data=i}createRequiredField(t){const i=new bZ(t);return i.Do(this),i.response}updateRequiredField(t,i){const a=new yZ(t,i);return a.Do(this),a.response}importRequiredFields(t){const i=new TZ(t);return i.Do(this),i.response}validateRequiredFieldExcelData(t,i,a){const l=new CZ(t,i,a);return l.Do(this),l.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),wZ=(()=>{class s extends I.nH{constructor(t,i,a){super("RequiredFieldService",a,t),this.businessProvider=i}createRequiredField(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createRequiredField(i)}updateRequiredField(t,i){return this.businessProvider.updateRequiredField(t,i)}importRequiredFields(t){return this.businessProvider.importRequiredFields(t)}validateRequiredFieldExcelData(t,i,a){return this.businessProvider.validateRequiredFieldExcelData(t,i,a)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(nm,8),e.LFG(nm),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),Ta=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){if(super({loading:!1,requiredFields:[],done:!1,searchQuery:"",formName:void 0,accidentTypeId:void 0,medLevelId:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.requiredFieldService=H,this.errors$=this.select(n=>n.errors),this.loading$=this.select(n=>n.loading),this.done$=this.select(n=>n.done),this.item$=this.select(n=>n.item),this.requiredFields$=this.select(n=>n.requiredFields),this.accidentTypes$=this.select(n=>n.accidentTypes||[]),this.medLevels$=this.select(n=>n.medLevels||[]),this.accidentTypeId$=this.select(n=>n.accidentTypeId),this.medLevelId$=this.select(n=>n.medLevelId),this.paging$=this.select(n=>n.paging),this.searchQuery$=this.select(n=>n.searchQuery),this.formName$=this.select(n=>n.formName),this.actionResult$=this.select(this.item$,this.done$,(n,r)=>({item:n,done:r}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.requiredFields$,this.accidentTypes$,this.medLevels$,(n,r,m,p,_,w,J)=>({errors:n,loading:r,item:m,formName:p,requiredFields:_,accidentTypes:w,medLevels:J}),{debounce:!0}),this.input$=this.select(this.paging$,this.accidentTypeId$,this.medLevelId$,this.searchQuery$,(n,r,m,p)=>({limit:n.limit,skip:n.skip,name:p,accidentTypeId:r,medLevelId:m,total:n.total})),this.setFormName=this.updater((n,r)=>Object.assign(Object.assign({},n),{formName:r})),this.setAccidentTypeId=this.updater((n,r)=>Object.assign(Object.assign({},n),{accidentTypeId:r})),this.setMedLevelId=this.updater((n,r)=>Object.assign(Object.assign({},n),{medLevelId:r})),this.filterAccidentTypes=n=>this.data.userSelectAccidentTypes({input:{name:n}}).pipe((0,g._b)(r=>{let m=r.data.items;return this.patchState({accidentTypes:m}),m},r=>this.patchState({errors:r.graphQLErrors?r.graphQLErrors:r})),(0,he.U)(r=>r.data.items)),this.filterMedLevels=n=>this.data.userSelectMedLevels({input:{name:n}}).pipe((0,g._b)(r=>{let m=r.data.items;return this.patchState({medLevels:m}),m},r=>this.patchState({errors:r.graphQLErrors?r.graphQLErrors:r})),(0,he.U)(r=>r.data.items)),this.addAccidentType=this.updater((n,r)=>Object.assign(Object.assign({},n),{accidentTypes:n.accidentTypes.concat(r)})),this.addMedLevel=this.updater((n,r)=>Object.assign(Object.assign({},n),{medLevels:n.medLevels.concat(r)})),this.setItem=this.updater((n,r)=>Object.assign(Object.assign({},n),{item:r})),this.addNewRequiredField=this.updater((n,r)=>Object.assign(Object.assign({},n),{requiredFields:[...n.requiredFields,r]})),this.updateRequiredField=this.updater((n,r)=>Object.assign(Object.assign({},n),{requiredFields:n.requiredFields.map(m=>m.id===r.id?r:m)})),this.addRequiredFields=this.updater((n,r)=>Object.assign(Object.assign({},n),{requiredFields:n.requiredFields.concat(r)})),this.updateRequiredFields=this.updater((n,r)=>Object.assign(Object.assign({},n),{requiredFields:n.requiredFields.map(m=>r.find(_=>_.id===m.id)||m)})),this.setSearchQuery=this.updater((n,r)=>Object.assign(Object.assign({},n),{searchQuery:r})),this.loadRequiredFieldEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(r=>this.data.userRequiredField({requiredFieldId:r}).pipe((0,g._b)(m=>{this.patchState({item:m.data.item,errors:m.errors,loading:!1})},m=>this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})))))),this.loadRequiredFieldsEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([r,m])=>this.data.userRequiredFields({input:m}).pipe((0,g._b)(p=>this.patchState({paging:{limit:m.limit,skip:m.skip,total:p.data.count.total},requiredFields:p.data.items,errors:p.errors,loading:!1}),p=>this.patchState({loading:!1,errors:p.graphQLErrors?p.graphQLErrors:p})))))),this.createRequiredFieldEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(r=>this.requiredFieldService.createRequiredField(Object.assign({},r)).pipe((0,g._b)(m=>{this.addNewRequiredField(m),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:m,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},m=>{m.graphQLErrors?(this.toast.error(m.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})):(this.toast.error(m.Message),this.formService.setErrors(m.Data))}))))),this.updateRequiredFieldEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([r,m])=>this.requiredFieldService.updateRequiredField(r,r.id).pipe((0,g._b)(p=>{this.updateRequiredField(p),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:p,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},p=>{p.graphQLErrors?(this.toast.error(p.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:p.graphQLErrors?p.graphQLErrors:p})):(this.toast.error(p.Message),this.formService.setErrors(p.Data))}))))),this.deleteRequiredFieldEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([r,m])=>this.data.userDeleteRequiredField({requiredFieldId:m.id}).pipe((0,g._b)(p=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:p.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},p=>{p.graphQLErrors?(this.toast.error(p.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:p.graphQLErrors?p.graphQLErrors:p})):(this.toast.error(p.Message),this.formService.setErrors(p.Data))}))))),this.importExcelEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(r=>this.requiredFieldService.importRequiredFields(r).pipe((0,ce.K)(m=>{var p;return this.toast.error(null!==(p=m.Message)&&void 0!==p?p:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(m=>{const p=JSON.parse(m.created),_=JSON.parse(m.updated),w=JSON.parse(m.failed),J=p.length+_.length+w.length;this.addRequiredFields(p),this.updateRequiredFields(_),this.toast.success(`${p.length} created, ${_.length} updated, ${w.length} failed of total ${J}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("requiredFieldId")?(this.route.snapshot.paramMap.get("requiredFieldId"),this.setFormName("requiredField_edit")):this.setFormName("requiredField_create"),this.route.snapshot.paramMap.has("accidentTypeId")){var c=this.route.snapshot.paramMap.get("accidentTypeId");this.setAccidentTypeId(c)}if(this.route.snapshot.paramMap.has("medLevelId")){var d=this.route.snapshot.paramMap.get("medLevelId");this.setMedLevelId(d)}}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.requiredFieldService.validateRequiredFieldExcelData(t,i.accidentTypes,i.medLevels)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(wZ))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function xZ(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.requiredField)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let lm=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"requiredField_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.requiredField=i.item})):t.formName&&t.formName.currentValue&&"requiredField_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadRequiredFieldEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.requiredField=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Ta),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-required-field-form"]],inputs:{requiredField:"requiredField",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,xZ,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),cm=(()=>{class s{constructor(){this.autoHeight=!1,this.requiredFields=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[{field:"accidentType.name",headerName:"Accident Type",filter:"agTextColumnFilter"},{field:"medLevel.name",headerName:"Med Level",filter:"agTextColumnFilter"},{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{field:"entityName",filter:"agTextColumnFilter"},{field:"accidentTypeId",filter:"agTextColumnFilter",hide:!0},{field:"medLevelId",filter:"agTextColumnFilter",hide:!0}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-required-field-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",requiredFields:"requiredFields"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.requiredFields)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function NZ(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-required-field-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","requiredField_edit")("formControl",t.formControl)("requiredField",t.requiredField)}}const AZ=function(){return{}};function FZ(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-required-field-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","requiredField_create")("formControl",t.formControl)("requiredField",e.DdM(3,AZ))}}function PZ(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-required-field-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("requiredFields",o.data.items)}let IZ=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadRequiredFieldsEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.requiredFields$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Ta))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","requiredField","send","close"],[1,"w-full","h-full","bg-white",3,"requiredFields","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,NZ,2,3,"ng-template",null,1,e.W1O),e.YNc(3,FZ,1,4,"ng-template",null,2,e.W1O),e.YNc(5,PZ,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,lm,cm],encapsulation:2}),s})();function DZ(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-required-field-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","requiredField_edit")("requiredField",t.value)}}const MZ=function(){return{}};function WZ(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-required-field-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","requiredField_create")("requiredField",e.DdM(2,MZ))}function EZ(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-required-field-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("requiredFields",t.items)}}let OZ=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","requiredField","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","requiredFields","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,DZ,1,2,"ng-template",null,1,e.W1O),e.YNc(3,WZ,1,3,"ng-template",null,2,e.W1O),e.YNc(5,EZ,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,lm,cm],encapsulation:2}),s})(),LZ=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[Ta],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"required-field-select",component:IZ,wrappers:["form-field"]},{name:"required-field-grid",component:OZ}]})]}),s})(),$Z=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[LZ]}),s})();var ya=Q(62336);function GZ(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.review)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let dm=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"review_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({id:null,name:""}),this.store.vm$.subscribe(i=>{this.review=i.item})):t.formName&&t.formName.currentValue&&"review_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadReviewEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.review=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(ya.J),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-review-form"]],inputs:{review:"review",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,GZ,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),um=(()=>{class s{constructor(){this.autoHeight=!1,this.reviews=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[{field:"clinicalProvider.name",headerName:"Clinical Provider",filter:"agTextColumnFilter"},{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{field:"patientId",filter:"agTextColumnFilter"},{field:"clinicalProviderId",filter:"agTextColumnFilter",hide:!0},{field:"comment",filter:"agTextColumnFilter"},{headerName:"Rating",field:"rating",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.rating,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{field:"reivewDateAndTime",filter:"agDateColumnFilter"},{field:"parentId",filter:"agTextColumnFilter"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-review-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",reviews:"reviews"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.reviews)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function RZ(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-review-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","review_edit")("formControl",t.formControl)("review",t.review)}}const QZ=function(){return{}};function VZ(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-review-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","review_create")("formControl",t.formControl)("review",e.DdM(3,QZ))}}function jZ(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-review-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("reviews",o.data.items)}let UZ=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadReviewsEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.reviews$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(ya.J))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","review","send","close"],[1,"w-full","h-full","bg-white",3,"reviews","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,RZ,2,3,"ng-template",null,1,e.W1O),e.YNc(3,VZ,1,4,"ng-template",null,2,e.W1O),e.YNc(5,jZ,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,dm,um],encapsulation:2}),s})();function JZ(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-review-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","review_edit")("review",t.value)}}const zZ=function(){return{}};function HZ(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-review-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","review_create")("review",e.DdM(2,zZ))}function qZ(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-review-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("reviews",t.items)}}let KZ=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:6,consts:[[3,"data","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","review","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","reviews","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,JZ,1,2,"ng-template",null,1,e.W1O),e.YNc(3,HZ,1,3,"ng-template",null,2,e.W1O),e.YNc(5,qZ,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,dm,um],encapsulation:2}),s})(),ZZ=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[ya.J],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"review-select",component:UZ,wrappers:["form-field"]},{name:"review-grid",component:KZ}]})]}),s})(),kZ=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[ZZ]}),s})();class cs extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class BZ extends cs{constructor(o){super("ValidateRoleExcelDataAction"),this.valid=!1,this.excelData=o}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name)}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class YZ extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class XZ extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new YZ("name","The role name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class ek extends cs{constructor(o){super("CreateRoleAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new XZ("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateRole({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class tk extends cs{constructor(o){super("UpdateRolesAction"),this.roles=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.roles,!0))}performAction(){this.response=this.businessProvider.data.userUpdateRoles({input:{roles:this.roles}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class ik extends cs{constructor(o,t){super("UpdateRoleAction"),this.role=o,this.roleId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.role,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.roleId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateRole({roleId:this.roleId,input:this.role}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let mm=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.RoleBusinessProviderService",t,a),this.data=i}createRole(t){const i=new ek(t);return i.Do(this),i.response}updateRole(t,i){const a=new ik(t,i);return a.Do(this),a.response}importRoles(t){const i=new tk(t);return i.Do(this),i.response}validateRoleExcelData(t){const i=new BZ(t);return i.Do(this),i.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),sk=(()=>{class s extends I.nH{constructor(t,i,a){super("RoleService",a,t),this.businessProvider=i}createRole(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createRole(i)}updateRole(t,i){return this.businessProvider.updateRole(t,i)}importRoles(t){return this.businessProvider.importRoles(t)}validateRoleExcelData(t){return this.businessProvider.validateRoleExcelData(t)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(mm,8),e.LFG(mm),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),wa=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){super({loading:!1,roles:[],done:!1,searchQuery:"",formName:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.roleService=H,this.errors$=this.select(c=>c.errors),this.loading$=this.select(c=>c.loading),this.done$=this.select(c=>c.done),this.item$=this.select(c=>c.item),this.roles$=this.select(c=>c.roles),this.paging$=this.select(c=>c.paging),this.searchQuery$=this.select(c=>c.searchQuery),this.formName$=this.select(c=>c.formName),this.actionResult$=this.select(this.item$,this.done$,(c,d)=>({item:c,done:d}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.roles$,(c,d,n,r,m)=>({errors:c,loading:d,item:n,formName:r,roles:m}),{debounce:!0}),this.input$=this.select(this.paging$,this.searchQuery$,(c,d)=>({limit:c.limit,skip:c.skip,name:d,total:c.total})),this.setFormName=this.updater((c,d)=>Object.assign(Object.assign({},c),{formName:d})),this.setItem=this.updater((c,d)=>Object.assign(Object.assign({},c),{item:d})),this.addNewRole=this.updater((c,d)=>Object.assign(Object.assign({},c),{roles:[...c.roles,d]})),this.updateRole=this.updater((c,d)=>Object.assign(Object.assign({},c),{roles:c.roles.map(n=>n.id===d.id?d:n)})),this.addRoles=this.updater((c,d)=>Object.assign(Object.assign({},c),{roles:c.roles.concat(d)})),this.updateRoles=this.updater((c,d)=>Object.assign(Object.assign({},c),{roles:c.roles.map(n=>d.find(m=>m.id===n.id)||n)})),this.setSearchQuery=this.updater((c,d)=>Object.assign(Object.assign({},c),{searchQuery:d})),this.loadRoleEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.data.userRole({roleId:d}).pipe((0,g._b)(n=>{this.patchState({item:n.data.item,errors:n.errors,loading:!1})},n=>this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})))))),this.loadRolesEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([d,n])=>this.data.userRoles({input:n}).pipe((0,g._b)(r=>this.patchState({paging:{limit:n.limit,skip:n.skip,total:r.data.count.total},roles:r.data.items,errors:r.errors,loading:!1}),r=>this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})))))),this.createRoleEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.roleService.createRole(Object.assign({},d)).pipe((0,g._b)(n=>{this.addNewRole(n),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:n,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},n=>{n.graphQLErrors?(this.toast.error(n.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})):(this.toast.error(n.Message),this.formService.setErrors(n.Data))}))))),this.updateRoleEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.roleService.updateRole(d,d.id).pipe((0,g._b)(r=>{this.updateRole(r),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:r,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.deleteRoleEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.data.userDeleteRole({roleId:n.id}).pipe((0,g._b)(r=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:r.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.importExcelEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.roleService.importRoles(d).pipe((0,ce.K)(n=>{var r;return this.toast.error(null!==(r=n.Message)&&void 0!==r?r:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(n=>{const r=JSON.parse(n.created),m=JSON.parse(n.updated),p=JSON.parse(n.failed),_=r.length+m.length+p.length;this.addRoles(r),this.updateRoles(m),this.toast.success(`${r.length} created, ${m.length} updated, ${p.length} failed of total ${_}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("roleId")?(this.route.snapshot.paramMap.get("roleId"),this.setFormName("role_edit")):this.setFormName("role_create")}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.roleService.validateRoleExcelData(t)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(sk))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function ok(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.role)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let pm=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"role_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.role=i.item})):t.formName&&t.formName.currentValue&&"role_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadRoleEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.role=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(wa),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-role-form"]],inputs:{role:"role",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,ok,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),hm=(()=>{class s{constructor(){this.autoHeight=!1,this.roles=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[,{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-role-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",roles:"roles"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.roles)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function ak(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-role-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","role_edit")("formControl",t.formControl)("role",t.role)}}const rk=function(){return{}};function nk(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-role-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","role_create")("formControl",t.formControl)("role",e.DdM(3,rk))}}function lk(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-role-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("roles",o.data.items)}let ck=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadRolesEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.roles$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(wa))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","role","send","close"],[1,"w-full","h-full","bg-white",3,"roles","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,ak,2,3,"ng-template",null,1,e.W1O),e.YNc(3,nk,1,4,"ng-template",null,2,e.W1O),e.YNc(5,lk,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,pm,hm],encapsulation:2}),s})();function dk(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-role-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","role_edit")("role",t.value)}}const uk=function(){return{}};function mk(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-role-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","role_create")("role",e.DdM(2,uk))}function pk(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-role-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("roles",t.items)}}let hk=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","role","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","roles","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,dk,1,2,"ng-template",null,1,e.W1O),e.YNc(3,mk,1,3,"ng-template",null,2,e.W1O),e.YNc(5,pk,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,pm,hm],encapsulation:2}),s})(),fk=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[wa],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"role-select",component:ck,wrappers:["form-field"]},{name:"role-grid",component:hk}]})]}),s})(),_k=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[fk]}),s})();var xa=Q(94214);function gk(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.service)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let fm=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"service_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({id:null,name:""}),this.store.vm$.subscribe(i=>{this.service=i.item})):t.formName&&t.formName.currentValue&&"service_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadServiceEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.service=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(xa.m),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-service-form"]],inputs:{service:"service",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,gk,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),_m=(()=>{class s{constructor(){this.autoHeight=!1,this.services=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[,{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-service-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",services:"services"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.services)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function Ck(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-service-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","service_edit")("formControl",t.formControl)("service",t.service)}}const vk=function(){return{}};function Sk(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-service-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","service_create")("formControl",t.formControl)("service",e.DdM(3,vk))}}function bk(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-service-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("services",o.data.items)}let Tk=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadServicesEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.services$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(xa.m))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","service","send","close"],[1,"w-full","h-full","bg-white",3,"services","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,Ck,2,3,"ng-template",null,1,e.W1O),e.YNc(3,Sk,1,4,"ng-template",null,2,e.W1O),e.YNc(5,bk,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,fm,_m],encapsulation:2}),s})();function yk(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-service-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","service_edit")("service",t.value)}}const wk=function(){return{}};function xk(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-service-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","service_create")("service",e.DdM(2,wk))}function Nk(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-service-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("services",t.items)}}let Ak=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:6,consts:[[3,"data","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","service","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","services","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,yk,1,2,"ng-template",null,1,e.W1O),e.YNc(3,xk,1,3,"ng-template",null,2,e.W1O),e.YNc(5,Nk,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,fm,_m],encapsulation:2}),s})(),Fk=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[xa.m],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"service-select",component:Tk,wrappers:["form-field"]},{name:"service-grid",component:Ak}]})]}),s})(),Pk=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[Fk]}),s})();class ds extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class Ik extends ds{constructor(o,t){super("ValidateSettingExcelDataAction"),this.valid=!1,this.excelData=o,this.users=t}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name),this.validationContext.addRule(new f.mi(`userName_${i}_is_valid}`,"User Is Not Valid","user.name",t.user,this.users,!0))}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class Dk extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class Mk extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new Dk("name","The setting name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class Wk extends ds{constructor(o){super("CreateSettingAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new Mk("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateSetting({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class Ek extends ds{constructor(o){super("UpdateSettingsAction"),this.settings=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.settings,!0))}performAction(){this.response=this.businessProvider.data.userUpdateSettings({input:{settings:this.settings}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class Ok extends ds{constructor(o,t){super("UpdateSettingAction"),this.setting=o,this.settingId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.setting,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.settingId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateSetting({settingId:this.settingId,input:this.setting}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let gm=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.SettingBusinessProviderService",t,a),this.data=i}createSetting(t){const i=new Wk(t);return i.Do(this),i.response}updateSetting(t,i){const a=new Ok(t,i);return a.Do(this),a.response}importSettings(t){const i=new Ek(t);return i.Do(this),i.response}validateSettingExcelData(t,i){const a=new Ik(t,i);return a.Do(this),a.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),Lk=(()=>{class s extends I.nH{constructor(t,i,a){super("SettingService",a,t),this.businessProvider=i}createSetting(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createSetting(i)}updateSetting(t,i){return this.businessProvider.updateSetting(t,i)}importSettings(t){return this.businessProvider.importSettings(t)}validateSettingExcelData(t,i){return this.businessProvider.validateSettingExcelData(t,i)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(gm,8),e.LFG(gm),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),Na=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){if(super({loading:!1,settings:[],done:!1,searchQuery:"",formName:void 0,userId:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.settingService=H,this.errors$=this.select(d=>d.errors),this.loading$=this.select(d=>d.loading),this.done$=this.select(d=>d.done),this.item$=this.select(d=>d.item),this.settings$=this.select(d=>d.settings),this.users$=this.select(d=>d.users||[]),this.userId$=this.select(d=>d.userId),this.paging$=this.select(d=>d.paging),this.searchQuery$=this.select(d=>d.searchQuery),this.formName$=this.select(d=>d.formName),this.actionResult$=this.select(this.item$,this.done$,(d,n)=>({item:d,done:n}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.settings$,this.users$,(d,n,r,m,p,_)=>({errors:d,loading:n,item:r,formName:m,settings:p,users:_}),{debounce:!0}),this.input$=this.select(this.paging$,this.userId$,this.searchQuery$,(d,n,r)=>({limit:d.limit,skip:d.skip,name:r,userId:n,total:d.total})),this.setFormName=this.updater((d,n)=>Object.assign(Object.assign({},d),{formName:n})),this.setUserId=this.updater((d,n)=>Object.assign(Object.assign({},d),{userId:n})),this.filterUsers=d=>this.data.userSelectUsers({input:{name:d}}).pipe((0,g._b)(n=>{let r=n.data.items;return this.patchState({users:r}),r},n=>this.patchState({errors:n.graphQLErrors?n.graphQLErrors:n})),(0,he.U)(n=>n.data.items)),this.addUser=this.updater((d,n)=>Object.assign(Object.assign({},d),{users:d.users.concat(n)})),this.setItem=this.updater((d,n)=>Object.assign(Object.assign({},d),{item:n})),this.addNewSetting=this.updater((d,n)=>Object.assign(Object.assign({},d),{settings:[...d.settings,n]})),this.updateSetting=this.updater((d,n)=>Object.assign(Object.assign({},d),{settings:d.settings.map(r=>r.id===n.id?n:r)})),this.addSettings=this.updater((d,n)=>Object.assign(Object.assign({},d),{settings:d.settings.concat(n)})),this.updateSettings=this.updater((d,n)=>Object.assign(Object.assign({},d),{settings:d.settings.map(r=>n.find(p=>p.id===r.id)||r)})),this.setSearchQuery=this.updater((d,n)=>Object.assign(Object.assign({},d),{searchQuery:n})),this.loadSettingEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(n=>this.data.userSetting({settingId:n}).pipe((0,g._b)(r=>{this.patchState({item:r.data.item,errors:r.errors,loading:!1})},r=>this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})))))),this.loadSettingsEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([n,r])=>this.data.userSettings({input:r}).pipe((0,g._b)(m=>this.patchState({paging:{limit:r.limit,skip:r.skip,total:m.data.count.total},settings:m.data.items,errors:m.errors,loading:!1}),m=>this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})))))),this.createSettingEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(n=>this.settingService.createSetting(Object.assign({},n)).pipe((0,g._b)(r=>{this.addNewSetting(r),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:r,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.updateSettingEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([n,r])=>this.settingService.updateSetting(n,n.id).pipe((0,g._b)(m=>{this.updateSetting(m),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:m,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},m=>{m.graphQLErrors?(this.toast.error(m.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})):(this.toast.error(m.Message),this.formService.setErrors(m.Data))}))))),this.deleteSettingEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([n,r])=>this.data.userDeleteSetting({settingId:r.id}).pipe((0,g._b)(m=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:m.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},m=>{m.graphQLErrors?(this.toast.error(m.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})):(this.toast.error(m.Message),this.formService.setErrors(m.Data))}))))),this.importExcelEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(n=>this.settingService.importSettings(n).pipe((0,ce.K)(r=>{var m;return this.toast.error(null!==(m=r.Message)&&void 0!==m?m:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(r=>{const m=JSON.parse(r.created),p=JSON.parse(r.updated),_=JSON.parse(r.failed),w=m.length+p.length+_.length;this.addSettings(m),this.updateSettings(p),this.toast.success(`${m.length} created, ${p.length} updated, ${_.length} failed of total ${w}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("settingId")?(this.route.snapshot.paramMap.get("settingId"),this.setFormName("setting_edit")):this.setFormName("setting_create"),this.route.snapshot.paramMap.has("userId")){var c=this.route.snapshot.paramMap.get("userId");this.setUserId(c)}}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.settingService.validateSettingExcelData(t,i.users)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(Lk))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function $k(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.setting)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let Cm=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"setting_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.setting=i.item})):t.formName&&t.formName.currentValue&&"setting_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadSettingEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.setting=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Na),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-setting-form"]],inputs:{setting:"setting",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,$k,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),vm=(()=>{class s{constructor(){this.autoHeight=!1,this.settings=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[{field:"user.name",headerName:"User",filter:"agTextColumnFilter"},{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{field:"value",filter:"agTextColumnFilter"},{field:"dateFormat",filter:"agTextColumnFilter"},{field:"timeFormat",filter:"agTextColumnFilter"},{field:"startWeekOn",filter:"agTextColumnFilter"},{field:"userId",filter:"agTextColumnFilter",hide:!0}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-setting-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",settings:"settings"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.settings)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function Gk(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-setting-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","setting_edit")("formControl",t.formControl)("setting",t.setting)}}const Rk=function(){return{}};function Qk(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-setting-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","setting_create")("formControl",t.formControl)("setting",e.DdM(3,Rk))}}function Vk(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-setting-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("settings",o.data.items)}let jk=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadSettingsEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.settings$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Na))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","setting","send","close"],[1,"w-full","h-full","bg-white",3,"settings","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,Gk,2,3,"ng-template",null,1,e.W1O),e.YNc(3,Qk,1,4,"ng-template",null,2,e.W1O),e.YNc(5,Vk,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,Cm,vm],encapsulation:2}),s})();function Uk(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-setting-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","setting_edit")("setting",t.value)}}const Jk=function(){return{}};function zk(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-setting-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","setting_create")("setting",e.DdM(2,Jk))}function Hk(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-setting-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("settings",t.items)}}let qk=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","setting","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","settings","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,Uk,1,2,"ng-template",null,1,e.W1O),e.YNc(3,zk,1,3,"ng-template",null,2,e.W1O),e.YNc(5,Hk,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,Cm,vm],encapsulation:2}),s})(),Kk=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[Na],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"setting-select",component:jk,wrappers:["form-field"]},{name:"setting-grid",component:qk}]})]}),s})(),Zk=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[Kk]}),s})();class us extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class kk extends us{constructor(o){super("ValidateSeverityExcelDataAction"),this.valid=!1,this.excelData=o}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name)}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class Bk extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class Yk extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new Bk("name","The severity name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class Xk extends us{constructor(o){super("CreateSeverityAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new Yk("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateSeverity({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class eB extends us{constructor(o){super("UpdateSeveritiesAction"),this.severities=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.severities,!0))}performAction(){this.response=this.businessProvider.data.userUpdateSeverities({input:{severities:this.severities}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class tB extends us{constructor(o,t){super("UpdateSeverityAction"),this.severity=o,this.severityId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.severity,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.severityId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateSeverity({severityId:this.severityId,input:this.severity}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let Sm=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.SeverityBusinessProviderService",t,a),this.data=i}createSeverity(t){const i=new Xk(t);return i.Do(this),i.response}updateSeverity(t,i){const a=new tB(t,i);return a.Do(this),a.response}importSeverities(t){const i=new eB(t);return i.Do(this),i.response}validateSeverityExcelData(t){const i=new kk(t);return i.Do(this),i.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),iB=(()=>{class s extends I.nH{constructor(t,i,a){super("SeverityService",a,t),this.businessProvider=i}createSeverity(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createSeverity(i)}updateSeverity(t,i){return this.businessProvider.updateSeverity(t,i)}importSeverities(t){return this.businessProvider.importSeverities(t)}validateSeverityExcelData(t){return this.businessProvider.validateSeverityExcelData(t)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(Sm,8),e.LFG(Sm),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),Aa=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){super({loading:!1,severities:[],done:!1,searchQuery:"",formName:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.severityService=H,this.errors$=this.select(c=>c.errors),this.loading$=this.select(c=>c.loading),this.done$=this.select(c=>c.done),this.item$=this.select(c=>c.item),this.severities$=this.select(c=>c.severities),this.paging$=this.select(c=>c.paging),this.searchQuery$=this.select(c=>c.searchQuery),this.formName$=this.select(c=>c.formName),this.actionResult$=this.select(this.item$,this.done$,(c,d)=>({item:c,done:d}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.severities$,(c,d,n,r,m)=>({errors:c,loading:d,item:n,formName:r,severities:m}),{debounce:!0}),this.input$=this.select(this.paging$,this.searchQuery$,(c,d)=>({limit:c.limit,skip:c.skip,name:d,total:c.total})),this.setFormName=this.updater((c,d)=>Object.assign(Object.assign({},c),{formName:d})),this.setItem=this.updater((c,d)=>Object.assign(Object.assign({},c),{item:d})),this.addNewSeverity=this.updater((c,d)=>Object.assign(Object.assign({},c),{severities:[...c.severities,d]})),this.updateSeverity=this.updater((c,d)=>Object.assign(Object.assign({},c),{severities:c.severities.map(n=>n.id===d.id?d:n)})),this.addSeverities=this.updater((c,d)=>Object.assign(Object.assign({},c),{severities:c.severities.concat(d)})),this.updateSeverities=this.updater((c,d)=>Object.assign(Object.assign({},c),{severities:c.severities.map(n=>d.find(m=>m.id===n.id)||n)})),this.setSearchQuery=this.updater((c,d)=>Object.assign(Object.assign({},c),{searchQuery:d})),this.loadSeverityEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.data.userSeverity({severityId:d}).pipe((0,g._b)(n=>{this.patchState({item:n.data.item,errors:n.errors,loading:!1})},n=>this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})))))),this.loadSeveritiesEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([d,n])=>this.data.userSeverities({input:n}).pipe((0,g._b)(r=>this.patchState({paging:{limit:n.limit,skip:n.skip,total:r.data.count.total},severities:r.data.items,errors:r.errors,loading:!1}),r=>this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})))))),this.createSeverityEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.severityService.createSeverity(Object.assign({},d)).pipe((0,g._b)(n=>{this.addNewSeverity(n),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:n,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},n=>{n.graphQLErrors?(this.toast.error(n.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})):(this.toast.error(n.Message),this.formService.setErrors(n.Data))}))))),this.updateSeverityEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.severityService.updateSeverity(d,d.id).pipe((0,g._b)(r=>{this.updateSeverity(r),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:r,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.deleteSeverityEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.data.userDeleteSeverity({severityId:n.id}).pipe((0,g._b)(r=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:r.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.importExcelEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.severityService.importSeverities(d).pipe((0,ce.K)(n=>{var r;return this.toast.error(null!==(r=n.Message)&&void 0!==r?r:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(n=>{const r=JSON.parse(n.created),m=JSON.parse(n.updated),p=JSON.parse(n.failed),_=r.length+m.length+p.length;this.addSeverities(r),this.updateSeverities(m),this.toast.success(`${r.length} created, ${m.length} updated, ${p.length} failed of total ${_}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("severityId")?(this.route.snapshot.paramMap.get("severityId"),this.setFormName("severity_edit")):this.setFormName("severity_create")}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.severityService.validateSeverityExcelData(t)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(iB))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function sB(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.severity)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let bm=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"severity_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({id:null,name:""}),this.store.vm$.subscribe(i=>{this.severity=i.item})):t.formName&&t.formName.currentValue&&"severity_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadSeverityEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.severity=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Aa),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-severity-form"]],inputs:{severity:"severity",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,sB,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),Tm=(()=>{class s{constructor(){this.autoHeight=!1,this.severities=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[,{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-severity-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",severities:"severities"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.severities)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function oB(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-severity-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","severity_edit")("formControl",t.formControl)("severity",t.severity)}}const aB=function(){return{}};function rB(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-severity-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","severity_create")("formControl",t.formControl)("severity",e.DdM(3,aB))}}function nB(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-severity-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("severities",o.data.items)}let lB=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadSeveritiesEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.severities$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Aa))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","severity","send","close"],[1,"w-full","h-full","bg-white",3,"severities","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,oB,2,3,"ng-template",null,1,e.W1O),e.YNc(3,rB,1,4,"ng-template",null,2,e.W1O),e.YNc(5,nB,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,bm,Tm],encapsulation:2}),s})();function cB(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-severity-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","severity_edit")("severity",t.value)}}const dB=function(){return{}};function uB(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-severity-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","severity_create")("severity",e.DdM(2,dB))}function mB(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-severity-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("severities",t.items)}}let pB=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:6,consts:[[3,"data","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","severity","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","severities","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,cB,1,2,"ng-template",null,1,e.W1O),e.YNc(3,uB,1,3,"ng-template",null,2,e.W1O),e.YNc(5,mB,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,bm,Tm],encapsulation:2}),s})(),hB=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[Aa],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"severity-select",component:lB,wrappers:["form-field"]},{name:"severity-grid",component:pB}]})]}),s})(),fB=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[hB]}),s})();var Fa=Q(53783);function _B(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.specialty)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let ym=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"specialty_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({id:null,name:""}),this.store.vm$.subscribe(i=>{this.specialty=i.item})):t.formName&&t.formName.currentValue&&"specialty_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadSpecialtyEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.specialty=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Fa.T),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-specialty-form"]],inputs:{specialty:"specialty",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,_B,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),wm=(()=>{class s{constructor(){this.autoHeight=!1,this.specialties=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[,{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{headerName:"Active",field:"active",filter:"agSetColumnFilter",cellRenderer:"checkboxRenderer"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-specialty-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",specialties:"specialties"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.specialties)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function gB(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-specialty-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","specialty_edit")("formControl",t.formControl)("specialty",t.specialty)}}const CB=function(){return{}};function vB(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-specialty-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","specialty_create")("formControl",t.formControl)("specialty",e.DdM(3,CB))}}function SB(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-specialty-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("specialties",o.data.items)}let bB=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadSpecialtiesEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.specialties$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Fa.T))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","specialty","send","close"],[1,"w-full","h-full","bg-white",3,"specialties","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,gB,2,3,"ng-template",null,1,e.W1O),e.YNc(3,vB,1,4,"ng-template",null,2,e.W1O),e.YNc(5,SB,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,ym,wm],encapsulation:2}),s})();function TB(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-specialty-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","specialty_edit")("specialty",t.value)}}const yB=function(){return{}};function wB(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-specialty-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","specialty_create")("specialty",e.DdM(2,yB))}function xB(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-specialty-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("specialties",t.items)}}let NB=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:6,consts:[[3,"data","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","specialty","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","specialties","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,TB,1,2,"ng-template",null,1,e.W1O),e.YNc(3,wB,1,3,"ng-template",null,2,e.W1O),e.YNc(5,xB,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,ym,wm],encapsulation:2}),s})(),AB=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[Fa.T],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"specialty-select",component:bB,wrappers:["form-field"]},{name:"specialty-grid",component:NB}]})]}),s})(),FB=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[AB]}),s})();class ms extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class PB extends ms{constructor(o){super("ValidateSurgicalPositionExcelDataAction"),this.valid=!1,this.excelData=o}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name)}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class IB extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class DB extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new IB("name","The surgicalposition name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class MB extends ms{constructor(o){super("CreateSurgicalPositionAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new DB("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateSurgicalPosition({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class WB extends ms{constructor(o){super("UpdateSurgicalPositionsAction"),this.surgicalPositions=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.surgicalPositions,!0))}performAction(){this.response=this.businessProvider.data.userUpdateSurgicalPositions({input:{surgicalPositions:this.surgicalPositions}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class EB extends ms{constructor(o,t){super("UpdateSurgicalPositionAction"),this.surgicalPosition=o,this.surgicalPositionId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.surgicalPosition,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.surgicalPositionId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateSurgicalPosition({surgicalPositionId:this.surgicalPositionId,input:this.surgicalPosition}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let xm=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.SurgicalPositionBusinessProviderService",t,a),this.data=i}createSurgicalPosition(t){const i=new MB(t);return i.Do(this),i.response}updateSurgicalPosition(t,i){const a=new EB(t,i);return a.Do(this),a.response}importSurgicalPositions(t){const i=new WB(t);return i.Do(this),i.response}validateSurgicalPositionExcelData(t){const i=new PB(t);return i.Do(this),i.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),OB=(()=>{class s extends I.nH{constructor(t,i,a){super("SurgicalPositionService",a,t),this.businessProvider=i}createSurgicalPosition(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createSurgicalPosition(i)}updateSurgicalPosition(t,i){return this.businessProvider.updateSurgicalPosition(t,i)}importSurgicalPositions(t){return this.businessProvider.importSurgicalPositions(t)}validateSurgicalPositionExcelData(t){return this.businessProvider.validateSurgicalPositionExcelData(t)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(xm,8),e.LFG(xm),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),Pa=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){super({loading:!1,surgicalPositions:[],done:!1,searchQuery:"",formName:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.surgicalPositionService=H,this.errors$=this.select(c=>c.errors),this.loading$=this.select(c=>c.loading),this.done$=this.select(c=>c.done),this.item$=this.select(c=>c.item),this.surgicalPositions$=this.select(c=>c.surgicalPositions),this.paging$=this.select(c=>c.paging),this.searchQuery$=this.select(c=>c.searchQuery),this.formName$=this.select(c=>c.formName),this.actionResult$=this.select(this.item$,this.done$,(c,d)=>({item:c,done:d}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.surgicalPositions$,(c,d,n,r,m)=>({errors:c,loading:d,item:n,formName:r,surgicalPositions:m}),{debounce:!0}),this.input$=this.select(this.paging$,this.searchQuery$,(c,d)=>({limit:c.limit,skip:c.skip,name:d,total:c.total})),this.setFormName=this.updater((c,d)=>Object.assign(Object.assign({},c),{formName:d})),this.setItem=this.updater((c,d)=>Object.assign(Object.assign({},c),{item:d})),this.addNewSurgicalPosition=this.updater((c,d)=>Object.assign(Object.assign({},c),{surgicalPositions:[...c.surgicalPositions,d]})),this.updateSurgicalPosition=this.updater((c,d)=>Object.assign(Object.assign({},c),{surgicalPositions:c.surgicalPositions.map(n=>n.id===d.id?d:n)})),this.addSurgicalPositions=this.updater((c,d)=>Object.assign(Object.assign({},c),{surgicalPositions:c.surgicalPositions.concat(d)})),this.updateSurgicalPositions=this.updater((c,d)=>Object.assign(Object.assign({},c),{surgicalPositions:c.surgicalPositions.map(n=>d.find(m=>m.id===n.id)||n)})),this.setSearchQuery=this.updater((c,d)=>Object.assign(Object.assign({},c),{searchQuery:d})),this.loadSurgicalPositionEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.data.userSurgicalPosition({surgicalPositionId:d}).pipe((0,g._b)(n=>{this.patchState({item:n.data.item,errors:n.errors,loading:!1})},n=>this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})))))),this.loadSurgicalPositionsEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([d,n])=>this.data.userSurgicalPositions({input:n}).pipe((0,g._b)(r=>this.patchState({paging:{limit:n.limit,skip:n.skip,total:r.data.count.total},surgicalPositions:r.data.items,errors:r.errors,loading:!1}),r=>this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})))))),this.createSurgicalPositionEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.surgicalPositionService.createSurgicalPosition(Object.assign({},d)).pipe((0,g._b)(n=>{this.addNewSurgicalPosition(n),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:n,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},n=>{n.graphQLErrors?(this.toast.error(n.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})):(this.toast.error(n.Message),this.formService.setErrors(n.Data))}))))),this.updateSurgicalPositionEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.surgicalPositionService.updateSurgicalPosition(d,d.id).pipe((0,g._b)(r=>{this.updateSurgicalPosition(r),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:r,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.deleteSurgicalPositionEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.data.userDeleteSurgicalPosition({surgicalPositionId:n.id}).pipe((0,g._b)(r=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:r.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.importExcelEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.surgicalPositionService.importSurgicalPositions(d).pipe((0,ce.K)(n=>{var r;return this.toast.error(null!==(r=n.Message)&&void 0!==r?r:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(n=>{const r=JSON.parse(n.created),m=JSON.parse(n.updated),p=JSON.parse(n.failed),_=r.length+m.length+p.length;this.addSurgicalPositions(r),this.updateSurgicalPositions(m),this.toast.success(`${r.length} created, ${m.length} updated, ${p.length} failed of total ${_}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("surgicalPositionId")?(this.route.snapshot.paramMap.get("surgicalPositionId"),this.setFormName("surgicalPosition_edit")):this.setFormName("surgicalPosition_create")}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.surgicalPositionService.validateSurgicalPositionExcelData(t)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(OB))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function LB(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.surgicalPosition)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let Nm=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"surgicalPosition_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.surgicalPosition=i.item})):t.formName&&t.formName.currentValue&&"surgicalPosition_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadSurgicalPositionEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.surgicalPosition=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Pa),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-surgical-position-form"]],inputs:{surgicalPosition:"surgicalPosition",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,LB,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),Am=(()=>{class s{constructor(){this.autoHeight=!1,this.surgicalPositions=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[,{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-surgical-position-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",surgicalPositions:"surgicalPositions"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.surgicalPositions)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function $B(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-surgical-position-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","surgicalPosition_edit")("formControl",t.formControl)("surgicalPosition",t.surgicalPosition)}}const GB=function(){return{}};function RB(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-surgical-position-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","surgicalPosition_create")("formControl",t.formControl)("surgicalPosition",e.DdM(3,GB))}}function QB(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-surgical-position-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("surgicalPositions",o.data.items)}let VB=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadSurgicalPositionsEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.surgicalPositions$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Pa))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","surgicalPosition","send","close"],[1,"w-full","h-full","bg-white",3,"surgicalPositions","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,$B,2,3,"ng-template",null,1,e.W1O),e.YNc(3,RB,1,4,"ng-template",null,2,e.W1O),e.YNc(5,QB,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,Nm,Am],encapsulation:2}),s})();function jB(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-surgical-position-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","surgicalPosition_edit")("surgicalPosition",t.value)}}const UB=function(){return{}};function JB(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-surgical-position-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","surgicalPosition_create")("surgicalPosition",e.DdM(2,UB))}function zB(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-surgical-position-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("surgicalPositions",t.items)}}let HB=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","surgicalPosition","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","surgicalPositions","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,jB,1,2,"ng-template",null,1,e.W1O),e.YNc(3,JB,1,3,"ng-template",null,2,e.W1O),e.YNc(5,zB,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,Nm,Am],encapsulation:2}),s})(),qB=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[Pa],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"surgical-position-select",component:VB,wrappers:["form-field"]},{name:"surgical-position-grid",component:HB}]})]}),s})(),KB=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[qB]}),s})();class ps extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class ZB extends ps{constructor(o){super("ValidateTagExcelDataAction"),this.valid=!1,this.excelData=o}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name)}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class kB extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class BB extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new kB("name","The tag name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class YB extends ps{constructor(o){super("CreateTagAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new BB("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateTag({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class XB extends ps{constructor(o){super("UpdateTagsAction"),this.tags=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.tags,!0))}performAction(){this.response=this.businessProvider.data.userUpdateTags({input:{tags:this.tags}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class e5 extends ps{constructor(o,t){super("UpdateTagAction"),this.tag=o,this.tagId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.tag,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.tagId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateTag({tagId:this.tagId,input:this.tag}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let Fm=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.TagBusinessProviderService",t,a),this.data=i}createTag(t){const i=new YB(t);return i.Do(this),i.response}updateTag(t,i){const a=new e5(t,i);return a.Do(this),a.response}importTags(t){const i=new XB(t);return i.Do(this),i.response}validateTagExcelData(t){const i=new ZB(t);return i.Do(this),i.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),t5=(()=>{class s extends I.nH{constructor(t,i,a){super("TagService",a,t),this.businessProvider=i}createTag(t){return this.businessProvider.createTag(t)}updateTag(t,i){return this.businessProvider.updateTag(t,i)}importTags(t){return this.businessProvider.importTags(t)}validateTagExcelData(t){return this.businessProvider.validateTagExcelData(t)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(Fm,8),e.LFG(Fm),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),hs=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){super({loading:!1,tags:[],done:!1,searchQuery:"",formName:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.tagService=H,this.errors$=this.select(c=>c.errors),this.loading$=this.select(c=>c.loading),this.done$=this.select(c=>c.done),this.item$=this.select(c=>c.item),this.tags$=this.select(c=>c.tags),this.paging$=this.select(c=>c.paging),this.searchQuery$=this.select(c=>c.searchQuery),this.formName$=this.select(c=>c.formName),this.actionResult$=this.select(this.item$,this.done$,(c,d)=>({item:c,done:d}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.tags$,(c,d,n,r,m)=>({errors:c,loading:d,item:n,formName:r,tags:m}),{debounce:!0}),this.input$=this.select(this.paging$,this.searchQuery$,(c,d)=>({limit:c.limit,skip:c.skip,name:d,total:c.total})),this.setFormName=this.updater((c,d)=>Object.assign(Object.assign({},c),{formName:d})),this.setItem=this.updater((c,d)=>Object.assign(Object.assign({},c),{item:d})),this.addNewTag=this.updater((c,d)=>Object.assign(Object.assign({},c),{tags:[...c.tags,d]})),this.updateTag=this.updater((c,d)=>Object.assign(Object.assign({},c),{tags:c.tags.map(n=>n.id===d.id?d:n)})),this.addTags=this.updater((c,d)=>Object.assign(Object.assign({},c),{tags:c.tags.concat(d)})),this.updateTags=this.updater((c,d)=>Object.assign(Object.assign({},c),{tags:c.tags.map(n=>d.find(m=>m.id===n.id)||n)})),this.setSearchQuery=this.updater((c,d)=>Object.assign(Object.assign({},c),{searchQuery:d})),this.loadTagEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.data.userTag({tagId:d}).pipe((0,g._b)(n=>{this.patchState({item:n.data.item,errors:n.errors,loading:!1})},n=>this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})))))),this.loadTagsEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([d,n])=>this.data.userTags({input:n}).pipe((0,g._b)(r=>this.patchState({paging:{limit:n.limit,skip:n.skip,total:r.data.count.total},tags:r.data.items,errors:r.errors,loading:!1}),r=>this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})))))),this.createTagEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.tagService.createTag(Object.assign({},d)).pipe((0,g._b)(n=>{this.addNewTag(n),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:n,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},n=>{n.graphQLErrors?(this.toast.error(n.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})):(this.toast.error(n.Message),this.formService.setErrors(n.Data))}))))),this.updateTagEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.tagService.updateTag(d,d.id).pipe((0,g._b)(r=>{this.updateTag(r),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:r,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.deleteTagEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.data.userDeleteTag({tagId:n.id}).pipe((0,g._b)(r=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:r.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.importExcelEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.tagService.importTags(d).pipe((0,ce.K)(n=>{var r;return this.toast.error(null!==(r=n.Message)&&void 0!==r?r:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(n=>{const r=JSON.parse(n.created),m=JSON.parse(n.updated),p=JSON.parse(n.failed),_=r.length+m.length+p.length;this.addTags(r),this.updateTags(m),this.toast.success(`${r.length} created, ${m.length} updated, ${p.length} failed of total ${_}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("tagId")?(this.route.snapshot.paramMap.get("tagId"),this.setFormName("tag_edit")):this.setFormName("tag_create")}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.tagService.validateTagExcelData(t)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(t5))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function i5(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.tag)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let Pm=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"tag_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({id:null,name:""}),this.store.vm$.subscribe(i=>{this.tag=i.item})):t.formName&&t.formName.currentValue&&"tag_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadTagEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.tag=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(hs),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-tag-form"]],inputs:{tag:"tag",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,i5,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),Im=(()=>{class s{constructor(){this.autoHeight=!1,this.tags=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[,{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-tag-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",tags:"tags"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","data","showSidebar","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("data",i.tags)("showSidebar",!1)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function s5(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-tag-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","tag_edit")("formControl",t.formControl)("tag",t.tag)}}const o5=function(){return{}};function a5(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-tag-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","tag_create")("formControl",t.formControl)("tag",e.DdM(3,o5))}}function r5(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-tag-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("tags",o.data.items)}let n5=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadTagsEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.tags$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(hs))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e._Bn([hs]),e.qOj],decls:7,vars:5,consts:[[3,"to","control","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","tag","send","close"],[1,"w-full","h-full","bg-white",3,"tags","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"ui-select-form",0),e.YNc(1,s5,2,3,"ng-template",null,1,e.W1O),e.YNc(3,a5,1,4,"ng-template",null,2,e.W1O),e.YNc(5,r5,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[W.JJ,W.oH,Z.$,Pm,Im],encapsulation:2}),s})();function l5(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-tag-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","tag_edit")("tag",t.value)}}const c5=function(){return{}};function d5(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-tag-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","tag_create")("tag",e.DdM(2,c5))}function u5(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-tag-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("tags",t.items)}}let m5=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:6,consts:[[3,"data","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","tag","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","tags","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,l5,1,2,"ng-template",null,1,e.W1O),e.YNc(3,d5,1,3,"ng-template",null,2,e.W1O),e.YNc(5,u5,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,Pm,Im],encapsulation:2}),s})(),p5=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[hs],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"tag-select",component:n5,wrappers:["form-field"]},{name:"tag-grid",component:m5}]})]}),s})(),h5=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[p5]}),s})(),f5=(()=>{class s extends g.m1{constructor(t){super({loading:!1,templates:[]}),this.data=t,this.errors$=this.select(i=>i.errors),this.loading$=this.select(i=>i.loading),this.templates$=this.select(i=>i.templates),this.vm$=this.select(this.errors$,this.loading$,this.templates$,(i,a,l)=>({errors:i,loading:a,templates:l}),{debounce:!0}),this.addNewTemplate=this.updater((i,a)=>({templates:[...i.templates,a]})),this.updateTemplate=this.updater((i,a)=>Object.assign(Object.assign({},i),{templates:i.templates.map(l=>l.id===a.id?a:l)})),this.createTemplateEffect=this.effect(i=>i.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(a=>this.data.userCreateTemplate({input:a.input}).pipe((0,g._b)(l=>{this.addNewTemplate(l.data.created),this.patchState({errors:l.errors,loading:!1}),a.resultEmitter.emit(l.data.created)},l=>this.patchState({loading:!1,errors:l.graphQLErrors?l.graphQLErrors:l})))))),this.updateTemplateEffect=this.effect(i=>i.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(a=>this.data.userUpdateTemplate({templateId:a.input.id,input:a.input}).pipe((0,g._b)(l=>{this.updateTemplate(l.data.updated),this.patchState({errors:l.errors,loading:!1}),a.resultEmitter.emit(l.data.updated)},l=>this.patchState({loading:!1,errors:l.graphQLErrors?l.graphQLErrors:l})))))),this.loadTemplatesEffect=this.effect(i=>i.pipe((0,S.b)(()=>{this.patchState({loading:!0})}),(0,h.w)(()=>this.data.userTemplates({input:{}}).pipe((0,g._b)(a=>{this.patchState({loading:!1,templates:a.data.items})},a=>{this.patchState({loading:!1})})))))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();class Ia extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class _5 extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class g5 extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new _5("name","The teamuser name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class C5 extends Ia{constructor(o){super("CreateTemplateAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new g5("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateTemplate({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class v5 extends Ia{constructor(o){super("UpdateTemplatesAction"),this.teamUsers=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.teamUsers,!0))}performAction(){}}class S5 extends Ia{constructor(o,t){super("UpdateTemplateAction"),this.teamUser=o,this.teamUserId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.teamUser,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.teamUserId,!0))}performAction(){}}let Dm=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.TemplateBusinessProviderService",t,a),this.data=i}createTemplate(t){const i=new C5(t);return i.Do(this),i.response}updateTemplate(t,i){const a=new S5(t,i);return a.Do(this),a.response}importTemplates(t){const i=new v5(t);return i.Do(this),i.response}validateTemplateExcelData(t,i,a,l){}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),b5=(()=>{class s extends I.nH{constructor(t,i,a){super("templateService",a,t),this.businessProvider=i}createTemplate(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createTemplate(i)}updateTemplate(t,i){return this.businessProvider.updateTemplate(t,i)}importTemplates(t){return this.businessProvider.importTemplates(t)}validateTemplateExcelData(t){}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(Dm,8),e.LFG(Dm),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),Da=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){super({loading:!1,templates:[],done:!1,searchQuery:"",formName:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.templateService=H,this.errors$=this.select(c=>c.errors),this.loading$=this.select(c=>c.loading),this.done$=this.select(c=>c.done),this.item$=this.select(c=>c.item),this.templates$=this.select(c=>c.templates),this.paging$=this.select(c=>c.paging),this.searchQuery$=this.select(c=>c.searchQuery),this.formName$=this.select(c=>c.formName),this.actionResult$=this.select(this.item$,this.done$,(c,d)=>({item:c,done:d}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.templates$,(c,d,n,r,m)=>({errors:c,loading:d,item:n,formName:r,templates:m}),{debounce:!0}),this.input$=this.select(this.paging$,this.searchQuery$,(c,d)=>({limit:c.limit,skip:c.skip,name:d,total:c.total})),this.setFormName=this.updater((c,d)=>Object.assign(Object.assign({},c),{formName:d})),this.setItem=this.updater((c,d)=>Object.assign(Object.assign({},c),{item:d})),this.addNewTemplate=this.updater((c,d)=>(console.log(c.templates),Object.assign(Object.assign({},c),{templates:[...c.templates,d]}))),this.updateTemplate=this.updater((c,d)=>Object.assign(Object.assign({},c),{templates:c.templates.map(n=>n.id===d.id?d:n)})),this.addTemplates=this.updater((c,d)=>Object.assign(Object.assign({},c),{templates:c.templates.concat(d)})),this.updateTemplates=this.updater((c,d)=>Object.assign(Object.assign({},c),{templates:c.templates.map(n=>d.find(m=>m.id===n.id)||n)})),this.setSearchQuery=this.updater((c,d)=>Object.assign(Object.assign({},c),{searchQuery:d})),this.loadTemplateEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.data.userTemplate({templateId:d}).pipe((0,g._b)(n=>{this.patchState({item:n.data.item,errors:n.errors,loading:!1})},n=>this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})))))),this.loadTemplatesEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([d,n])=>this.data.userTemplates({input:n}).pipe((0,g._b)(r=>this.patchState({paging:{limit:n.limit,skip:n.skip,total:r.data.count.total},templates:r.data.items,errors:r.errors,loading:!1}),r=>this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})))))),this.createTemplateEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.templateService.createTemplate(Object.assign({},d)).pipe((0,g._b)(n=>{this.addNewTemplate(n),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:n,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},n=>{n.graphQLErrors?(this.toast.error(n.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})):(this.toast.error(n.Message),this.formService.setErrors(n.Data))}))))),this.updateTemplateEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.templateService.updateTemplate(d,d.id).pipe((0,g._b)(r=>{this.updateTemplate(r),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:r,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.deleteTemplateEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.data.userDeleteTemplate({templateId:n.id}).pipe((0,g._b)(r=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:r.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.route.snapshot.paramMap.has("templateId")?(this.route.snapshot.paramMap.get("templateId"),this.setFormName("template_edit")):this.setFormName("template_create")}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(b5))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})(),T5=(()=>{class s{constructor(){this.templates=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.autoHeight=!1,this.columnDefs=[{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{field:"attachment",filter:"agTextColumnFilter"},{field:"encoding",filter:"agTextColumnFilter"},{field:"signatureFileType",filter:"agTextColumnFilter"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-template-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{templates:"templates",autoHeight:"autoHeight"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.templates)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})(),y5=(()=>{class s extends g.m1{constructor(t){super({loading:!1}),this.data=t,this.errors$=this.select(i=>i.errors),this.loading$=this.select(i=>i.loading),this.item$=this.select(i=>i.item),this.vm$=this.select(this.errors$,this.loading$,this.item$,(i,a,l)=>({errors:i,loading:a,item:l}),{debounce:!0}),this.createTemplateEffect=this.effect(i=>i.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(a=>this.data.userCreateTemplate({input:a}).pipe((0,g._b)(l=>{this.patchState({item:l.data.created,errors:l.errors,loading:!1})},l=>this.patchState({loading:!1,errors:l.graphQLErrors?l.graphQLErrors:l}))))))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function w5(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.template)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let x5=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"template_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.template=i.item})):t.formName&&t.formName.currentValue&&"template_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadTemplateEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.template=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Da),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-template-form"]],inputs:{template:"template",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e._Bn([y5]),e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,w5,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})();function N5(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-template-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","template_edit")("formControl",t.formControl)("template",t.template)}}const A5=function(){return{}};function F5(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-template-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","template_create")("formControl",t.formControl)("template",e.DdM(3,A5))}}function P5(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-template-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("templates",o.data.items)}let I5=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadTemplatesEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.templates$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Da))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","template","send","close"],[1,"w-full","h-full","bg-white",3,"templates","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,N5,2,3,"ng-template",null,1,e.W1O),e.YNc(3,F5,1,4,"ng-template",null,2,e.W1O),e.YNc(5,P5,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,T5,x5],encapsulation:2}),s})(),D5=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[f5,Da],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,q.h,k.G,R.X0.forChild({types:[{name:"template-select",component:I5,wrappers:["form-field"]}]})]}),s})(),M5=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[D5]}),s})();class fs extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class W5 extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class E5 extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new W5("name","The user name is not valid. Must be within 2 and 255 characters.",this.target.firstName,2,255))}}class O5 extends fs{constructor(o){super("CreateUserAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new E5("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateUser({input:this.input}).pipe((0,ce.K)(()=>(this.response=this.createFailResponse(),B.E)),(0,h.w)(o=>(0,de.of)(o.data.created)))}}class L5 extends fs{constructor(o){super("UpdateUsersAction"),this.users=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.users,!0))}performAction(){this.response=this.businessProvider.data.userUpdateUsers({input:{users:this.users}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class $5 extends fs{constructor(o,t){super("UpdateUserAction"),this.user=o,this.userId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.user,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.userId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateUser({userId:this.userId,input:this.user}).pipe((0,h.w)(()=>(0,F.of)(!0)))}}class G5 extends fs{constructor(o){super("ValidateUserExcelDataAction"),this.valid=!1,this.excelData=o}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name)}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}let Mm=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.UserBusinessProviderService",t,a),this.data=i}createUser(t){const i=new O5(t);return i.Do(this),i.response}updateUser(t,i){const a=new $5(t,i);return a.Do(this),a.response}importUsers(t){const i=new L5(t);return i.Do(this),i.response}validateUserExcelData(t){const i=new G5(t);return i.Do(this),i.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),R5=(()=>{class s extends I.nH{constructor(t,i,a){super("UserService",a,t),this.businessProvider=i}createUser(t){return this.businessProvider.createUser(t)}updateUser(t,i){return this.businessProvider.updateUser(t,i)}importUsers(t){return this.businessProvider.importUsers(t)}validateUserExcelData(t){return this.businessProvider.validateUserExcelData(t)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(Mm,8),e.LFG(Mm),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),Ma=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){super({loading:!1,users:[],done:!1}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.userService=H,this.errors$=this.select(A=>A.errors),this.loading$=this.select(A=>A.loading),this.done$=this.select(A=>A.done),this.item$=this.select(A=>A.item),this.users$=this.select(A=>A.users),this.actionResult$=this.select(this.item$,this.done$,(A,c)=>({item:A,done:c}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,(A,c,d)=>({errors:A,loading:c,item:d}),{debounce:!0}),this.initialize=this.updater(A=>Object.assign(Object.assign({},A),{item:null,done:!1})),this.addNewUser=this.updater((A,c)=>Object.assign(Object.assign({},A),{users:[...A.users,c]})),this.updateUser=this.updater((A,c)=>Object.assign(Object.assign({},A),{users:A.users.map(d=>d.id===c.id?c:d)})),this.loadUserEffect=this.effect(A=>A.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(c=>this.data.userUser({userId:c}).pipe((0,g._b)(d=>{this.patchState({item:d.data.item,errors:d.errors,loading:!1})},d=>this.patchState({loading:!1,errors:d.graphQLErrors?d.graphQLErrors:d})))))),this.loadUsersEffect=this.effect(A=>A.pipe((0,S.b)(()=>{this.patchState({loading:!0})}),(0,h.w)(()=>this.data.userUsers({input:{}}).pipe((0,g._b)(c=>{this.patchState({loading:!1,users:c.data.items})},c=>{this.patchState({loading:!1})}))))),this.updateUserEffect=this.effect(A=>A.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([c,d])=>this.userService.updateUser(c,c.id).pipe((0,g._b)(n=>{this.updateUser(n),this.toast.success("Changed Successfully"),this.patchState({done:!0,item:n})},n=>{this.toast.error(n.Message),this.formService.setErrors(n.Data),this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})}))))),this.createUserEffect=this.effect(A=>A.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(c=>this.userService.createUser(Object.assign({},c)).pipe((0,g._b)(d=>(this.patchState({item:d,loading:!1}),this.router.navigate(["..",d?.id],{relativeTo:this.route})),d=>{this.toast.error(d.Message),this.formService.setErrors(d.Data),this.patchState({loading:!1,errors:d.graphQLErrors?d.graphQLErrors:d})})))))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(R5))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();const Q5=function(){return{}};let V5=(()=>{class s{constructor(t){this.store=t,this.user={},this.send=new e.vpe,this.close=new e.vpe,this._unsubscribeAll=new Ie.x,this.store.initialize()}ngOnInit(){this.store.actionResult$.pipe((0,we.R)(this._unsubscribeAll)).subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){this._unsubscribeAll.next(null),this._unsubscribeAll.complete()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Ma))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-user-form"]],inputs:{user:"user"},outputs:{send:"send",close:"close"},decls:3,vars:5,consts:[[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"formName","showSubmitButton","model","componentStore","discard"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"ui-formly-json-form",2),e.NdJ("discard",function(){return i.close.emit()}),e.qZA()()()),2&t&&(e.xp6(2),e.Q6J("formName",i.user.id?"user_edit":"user_create")("showSubmitButton",!0)("model",i.user||e.DdM(4,Q5))("componentStore",i.store))},dependencies:[te.M],encapsulation:2}),s})(),j5=(()=>{class s{constructor(){this.users=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[,{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{headerName:"Developer",field:"developer",filter:"agSetColumnFilter",cellRenderer:"checkboxRenderer"},{field:"username",filter:"agTextColumnFilter"},{field:"password",filter:"agTextColumnFilter"},{field:"firstName",filter:"agTextColumnFilter"},{field:"lastName",filter:"agTextColumnFilter"},{field:"avatarUrl",filter:"agTextColumnFilter"},{field:"line1",filter:"agTextColumnFilter"},{field:"line2",filter:"agTextColumnFilter"},{field:"city",filter:"agTextColumnFilter"},{field:"state",filter:"agTextColumnFilter"},{field:"postalCode",filter:"agTextColumnFilter"},{field:"phone",filter:"agTextColumnFilter"},{field:"bio",filter:"agTextColumnFilter"},{field:"slug",filter:"agTextColumnFilter"},{field:"status",filter:"agTextColumnFilter"},{headerName:"Signup Status",field:"signupStatus",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.signupStatus,"",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{headerName:"Verified",field:"verified",filter:"agSetColumnFilter",cellRenderer:"checkboxRenderer"},{field:"customerId",filter:"agTextColumnFilter",hide:!0},{field:"planId",filter:"agTextColumnFilter",hide:!0},{field:"dateOfBirth",filter:"agDateColumnFilter"},{field:"cellPhone",filter:"agTextColumnFilter"},{field:"education",filter:"agTextColumnFilter"},{field:"officeName",filter:"agTextColumnFilter"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-user-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{users:"users"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:3,consts:[[1,"w-full","h-full",3,"data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("data",i.users)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();const U5=function(){return{}};function J5(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-user-form",3),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("user",o.data.value||e.DdM(1,U5))}function z5(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-user-select-table-view",4),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("users",o.data.items)}let H5=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadUsersEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.users$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Ma))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:5,vars:4,consts:[[3,"to","control","listTemplate","editTemplate"],["editTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"user","send","close"],[1,"w-full","h-full","bg-white",3,"users","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"ui-select-form",0),e.YNc(1,J5,1,2,"ng-template",null,1,e.W1O),e.YNc(3,z5,1,1,"ng-template",null,2,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4);e.Q6J("to",i.to)("control",i.formControl)("listTemplate",l)("editTemplate",a)}},dependencies:[Z.$,V5,j5],encapsulation:2}),s})(),q5=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[Ma],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,q.h,k.G,R.X0.forChild({types:[{name:"user-select",component:H5,wrappers:["form-field"]}]})]}),s})(),K5=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[q5]}),s})();class _s extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class Z5 extends _s{constructor(o,t,i){super("ValidateUserRoleExcelDataAction"),this.valid=!1,this.excelData=o,this.roles=t,this.users=i}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name),this.validationContext.addRule(new f.mi(`roleName_${i}_is_valid}`,"Role Is Not Valid","role.name",t.role,this.roles,!0)),this.validationContext.addRule(new f.mi(`userName_${i}_is_valid}`,"User Is Not Valid","user.name",t.user,this.users,!0))}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class k5 extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class B5 extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new k5("name","The userrole name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class Y5 extends _s{constructor(o){super("CreateUserRoleAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new B5("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateUserRole({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class X5 extends _s{constructor(o){super("UpdateUserRolesAction"),this.userRoles=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.userRoles,!0))}performAction(){this.response=this.businessProvider.data.userUpdateUserRoles({input:{userRoles:this.userRoles}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class eY extends _s{constructor(o,t){super("UpdateUserRoleAction"),this.userRole=o,this.userRoleId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.userRole,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.userRoleId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateUserRole({userRoleId:this.userRoleId,input:this.userRole}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let Wm=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.UserRoleBusinessProviderService",t,a),this.data=i}createUserRole(t){const i=new Y5(t);return i.Do(this),i.response}updateUserRole(t,i){const a=new eY(t,i);return a.Do(this),a.response}importUserRoles(t){const i=new X5(t);return i.Do(this),i.response}validateUserRoleExcelData(t,i,a){const l=new Z5(t,i,a);return l.Do(this),l.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),tY=(()=>{class s extends I.nH{constructor(t,i,a){super("UserRoleService",a,t),this.businessProvider=i}createUserRole(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createUserRole(i)}updateUserRole(t,i){return this.businessProvider.updateUserRole(t,i)}importUserRoles(t){return this.businessProvider.importUserRoles(t)}validateUserRoleExcelData(t,i,a){return this.businessProvider.validateUserRoleExcelData(t,i,a)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(Wm,8),e.LFG(Wm),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),Wa=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){if(super({loading:!1,userRoles:[],done:!1,searchQuery:"",formName:void 0,roleId:void 0,userId:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.userRoleService=H,this.errors$=this.select(n=>n.errors),this.loading$=this.select(n=>n.loading),this.done$=this.select(n=>n.done),this.item$=this.select(n=>n.item),this.userRoles$=this.select(n=>n.userRoles),this.roles$=this.select(n=>n.roles||[]),this.users$=this.select(n=>n.users||[]),this.roleId$=this.select(n=>n.roleId),this.userId$=this.select(n=>n.userId),this.paging$=this.select(n=>n.paging),this.searchQuery$=this.select(n=>n.searchQuery),this.formName$=this.select(n=>n.formName),this.actionResult$=this.select(this.item$,this.done$,(n,r)=>({item:n,done:r}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.userRoles$,this.roles$,this.users$,(n,r,m,p,_,w,J)=>({errors:n,loading:r,item:m,formName:p,userRoles:_,roles:w,users:J}),{debounce:!0}),this.input$=this.select(this.paging$,this.roleId$,this.userId$,this.searchQuery$,(n,r,m,p)=>({limit:n.limit,skip:n.skip,name:p,roleId:r,userId:m,total:n.total})),this.setFormName=this.updater((n,r)=>Object.assign(Object.assign({},n),{formName:r})),this.setRoleId=this.updater((n,r)=>Object.assign(Object.assign({},n),{roleId:r})),this.setUserId=this.updater((n,r)=>Object.assign(Object.assign({},n),{userId:r})),this.filterRoles=n=>this.data.userSelectRoles({input:{name:n}}).pipe((0,g._b)(r=>{let m=r.data.items;return this.patchState({roles:m}),m},r=>this.patchState({errors:r.graphQLErrors?r.graphQLErrors:r})),(0,he.U)(r=>r.data.items)),this.filterUsers=n=>this.data.userSelectUsers({input:{name:n}}).pipe((0,g._b)(r=>{let m=r.data.items;return this.patchState({users:m}),m},r=>this.patchState({errors:r.graphQLErrors?r.graphQLErrors:r})),(0,he.U)(r=>r.data.items)),this.addRole=this.updater((n,r)=>Object.assign(Object.assign({},n),{roles:n.roles.concat(r)})),this.addUser=this.updater((n,r)=>Object.assign(Object.assign({},n),{users:n.users.concat(r)})),this.setItem=this.updater((n,r)=>Object.assign(Object.assign({},n),{item:r})),this.addNewUserRole=this.updater((n,r)=>Object.assign(Object.assign({},n),{userRoles:[...n.userRoles,r]})),this.updateUserRole=this.updater((n,r)=>Object.assign(Object.assign({},n),{userRoles:n.userRoles.map(m=>m.id===r.id?r:m)})),this.addUserRoles=this.updater((n,r)=>Object.assign(Object.assign({},n),{userRoles:n.userRoles.concat(r)})),this.updateUserRoles=this.updater((n,r)=>Object.assign(Object.assign({},n),{userRoles:n.userRoles.map(m=>r.find(_=>_.id===m.id)||m)})),this.setSearchQuery=this.updater((n,r)=>Object.assign(Object.assign({},n),{searchQuery:r})),this.loadUserRoleEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(r=>this.data.userUserRole({userRoleId:r}).pipe((0,g._b)(m=>{this.patchState({item:m.data.item,errors:m.errors,loading:!1})},m=>this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})))))),this.loadUserRolesEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([r,m])=>this.data.userUserRoles({input:m}).pipe((0,g._b)(p=>this.patchState({paging:{limit:m.limit,skip:m.skip,total:p.data.count.total},userRoles:p.data.items,errors:p.errors,loading:!1}),p=>this.patchState({loading:!1,errors:p.graphQLErrors?p.graphQLErrors:p})))))),this.createUserRoleEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(r=>this.userRoleService.createUserRole(Object.assign({},r)).pipe((0,g._b)(m=>{this.addNewUserRole(m),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:m,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},m=>{m.graphQLErrors?(this.toast.error(m.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})):(this.toast.error(m.Message),this.formService.setErrors(m.Data))}))))),this.updateUserRoleEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([r,m])=>this.userRoleService.updateUserRole(r,r.id).pipe((0,g._b)(p=>{this.updateUserRole(p),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:p,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},p=>{p.graphQLErrors?(this.toast.error(p.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:p.graphQLErrors?p.graphQLErrors:p})):(this.toast.error(p.Message),this.formService.setErrors(p.Data))}))))),this.deleteUserRoleEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([r,m])=>this.data.userDeleteUserRole({userRoleId:m.id}).pipe((0,g._b)(p=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:p.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},p=>{p.graphQLErrors?(this.toast.error(p.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:p.graphQLErrors?p.graphQLErrors:p})):(this.toast.error(p.Message),this.formService.setErrors(p.Data))}))))),this.importExcelEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(r=>this.userRoleService.importUserRoles(r).pipe((0,ce.K)(m=>{var p;return this.toast.error(null!==(p=m.Message)&&void 0!==p?p:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(m=>{const p=JSON.parse(m.created),_=JSON.parse(m.updated),w=JSON.parse(m.failed),J=p.length+_.length+w.length;this.addUserRoles(p),this.updateUserRoles(_),this.toast.success(`${p.length} created, ${_.length} updated, ${w.length} failed of total ${J}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("userRoleId")?(this.route.snapshot.paramMap.get("userRoleId"),this.setFormName("userRole_edit")):this.setFormName("userRole_create"),this.route.snapshot.paramMap.has("roleId")){var c=this.route.snapshot.paramMap.get("roleId");this.setRoleId(c)}if(this.route.snapshot.paramMap.has("userId")){var d=this.route.snapshot.paramMap.get("userId");this.setUserId(d)}}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.userRoleService.validateUserRoleExcelData(t,i.roles,i.users)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(tY))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function iY(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.userRole)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let Em=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"userRole_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.userRole=i.item})):t.formName&&t.formName.currentValue&&"userRole_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadUserRoleEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.userRole=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Wa),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-user-role-form"]],inputs:{userRole:"userRole",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,iY,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),Om=(()=>{class s{constructor(){this.autoHeight=!1,this.userRoles=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[{field:"role.name",headerName:"Role",filter:"agTextColumnFilter"},{field:"user.name",headerName:"User",filter:"agTextColumnFilter"},{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{field:"roleId",filter:"agTextColumnFilter",hide:!0},{field:"userId",filter:"agTextColumnFilter",hide:!0}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-user-role-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",userRoles:"userRoles"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.userRoles)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function sY(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-user-role-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","userRole_edit")("formControl",t.formControl)("userRole",t.userRole)}}const oY=function(){return{}};function aY(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-user-role-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","userRole_create")("formControl",t.formControl)("userRole",e.DdM(3,oY))}}function rY(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-user-role-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("userRoles",o.data.items)}let nY=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadUserRolesEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.userRoles$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Wa))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","userRole","send","close"],[1,"w-full","h-full","bg-white",3,"userRoles","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,sY,2,3,"ng-template",null,1,e.W1O),e.YNc(3,aY,1,4,"ng-template",null,2,e.W1O),e.YNc(5,rY,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,Em,Om],encapsulation:2}),s})();function lY(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-user-role-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","userRole_edit")("userRole",t.value)}}const cY=function(){return{}};function dY(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-user-role-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","userRole_create")("userRole",e.DdM(2,cY))}function uY(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-user-role-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("userRoles",t.items)}}let mY=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","userRole","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","userRoles","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,lY,1,2,"ng-template",null,1,e.W1O),e.YNc(3,dY,1,3,"ng-template",null,2,e.W1O),e.YNc(5,uY,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,Em,Om],encapsulation:2}),s})(),pY=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[Wa],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"user-role-select",component:nY,wrappers:["form-field"]},{name:"user-role-grid",component:mY}]})]}),s})(),hY=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[pY]}),s})();class gs extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class fY extends gs{constructor(o,t,i){super("ValidateVendorLocationExcelDataAction"),this.valid=!1,this.excelData=o,this.locations=t,this.vendors=i}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name),this.validationContext.addRule(new f.mi(`locationName_${i}_is_valid}`,"Location Is Not Valid","location.name",t.location,this.locations,!0)),this.validationContext.addRule(new f.mi(`vendorName_${i}_is_valid}`,"Vendor Is Not Valid","vendor.name",t.vendor,this.vendors,!0))}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class _Y extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class gY extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new _Y("name","The vendorlocation name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class CY extends gs{constructor(o){super("CreateVendorLocationAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new gY("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateVendorLocation({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class vY extends gs{constructor(o){super("UpdateVendorLocationsAction"),this.vendorLocations=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.vendorLocations,!0))}performAction(){this.response=this.businessProvider.data.userUpdateVendorLocations({input:{vendorLocations:this.vendorLocations}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class SY extends gs{constructor(o,t){super("UpdateVendorLocationAction"),this.vendorLocation=o,this.vendorLocationId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.vendorLocation,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.vendorLocationId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateVendorLocation({vendorLocationId:this.vendorLocationId,input:this.vendorLocation}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let Lm=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.VendorLocationBusinessProviderService",t,a),this.data=i}createVendorLocation(t){const i=new CY(t);return i.Do(this),i.response}updateVendorLocation(t,i){const a=new SY(t,i);return a.Do(this),a.response}importVendorLocations(t){const i=new vY(t);return i.Do(this),i.response}validateVendorLocationExcelData(t,i,a){const l=new fY(t,i,a);return l.Do(this),l.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),bY=(()=>{class s extends I.nH{constructor(t,i,a){super("VendorLocationService",a,t),this.businessProvider=i}createVendorLocation(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createVendorLocation(i)}updateVendorLocation(t,i){return this.businessProvider.updateVendorLocation(t,i)}importVendorLocations(t){return this.businessProvider.importVendorLocations(t)}validateVendorLocationExcelData(t,i,a){return this.businessProvider.validateVendorLocationExcelData(t,i,a)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(Lm,8),e.LFG(Lm),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),Ea=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){if(super({loading:!1,vendorLocations:[],done:!1,searchQuery:"",formName:void 0,locationId:void 0,vendorId:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.vendorLocationService=H,this.errors$=this.select(n=>n.errors),this.loading$=this.select(n=>n.loading),this.done$=this.select(n=>n.done),this.item$=this.select(n=>n.item),this.vendorLocations$=this.select(n=>n.vendorLocations),this.locations$=this.select(n=>n.locations||[]),this.vendors$=this.select(n=>n.vendors||[]),this.locationId$=this.select(n=>n.locationId),this.vendorId$=this.select(n=>n.vendorId),this.paging$=this.select(n=>n.paging),this.searchQuery$=this.select(n=>n.searchQuery),this.formName$=this.select(n=>n.formName),this.actionResult$=this.select(this.item$,this.done$,(n,r)=>({item:n,done:r}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.vendorLocations$,this.locations$,this.vendors$,(n,r,m,p,_,w,J)=>({errors:n,loading:r,item:m,formName:p,vendorLocations:_,locations:w,vendors:J}),{debounce:!0}),this.input$=this.select(this.paging$,this.locationId$,this.vendorId$,this.searchQuery$,(n,r,m,p)=>({limit:n.limit,skip:n.skip,name:p,locationId:r,vendorId:m,total:n.total})),this.setFormName=this.updater((n,r)=>Object.assign(Object.assign({},n),{formName:r})),this.setLocationId=this.updater((n,r)=>Object.assign(Object.assign({},n),{locationId:r})),this.setVendorId=this.updater((n,r)=>Object.assign(Object.assign({},n),{vendorId:r})),this.filterLocations=n=>this.data.userSelectLocations({input:{name:n}}).pipe((0,g._b)(r=>{let m=r.data.items;return this.patchState({locations:m}),m},r=>this.patchState({errors:r.graphQLErrors?r.graphQLErrors:r})),(0,he.U)(r=>r.data.items)),this.filterVendors=n=>this.data.userSelectVendors({input:{name:n}}).pipe((0,g._b)(r=>{let m=r.data.items;return this.patchState({vendors:m}),m},r=>this.patchState({errors:r.graphQLErrors?r.graphQLErrors:r})),(0,he.U)(r=>r.data.items)),this.addLocation=this.updater((n,r)=>Object.assign(Object.assign({},n),{locations:n.locations.concat(r)})),this.addVendor=this.updater((n,r)=>Object.assign(Object.assign({},n),{vendors:n.vendors.concat(r)})),this.setItem=this.updater((n,r)=>Object.assign(Object.assign({},n),{item:r})),this.addNewVendorLocation=this.updater((n,r)=>Object.assign(Object.assign({},n),{vendorLocations:[...n.vendorLocations,r]})),this.updateVendorLocation=this.updater((n,r)=>Object.assign(Object.assign({},n),{vendorLocations:n.vendorLocations.map(m=>m.id===r.id?r:m)})),this.addVendorLocations=this.updater((n,r)=>Object.assign(Object.assign({},n),{vendorLocations:n.vendorLocations.concat(r)})),this.updateVendorLocations=this.updater((n,r)=>Object.assign(Object.assign({},n),{vendorLocations:n.vendorLocations.map(m=>r.find(_=>_.id===m.id)||m)})),this.setSearchQuery=this.updater((n,r)=>Object.assign(Object.assign({},n),{searchQuery:r})),this.loadVendorLocationEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(r=>this.data.userVendorLocation({vendorLocationId:r}).pipe((0,g._b)(m=>{this.patchState({item:m.data.item,errors:m.errors,loading:!1})},m=>this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})))))),this.loadVendorLocationsEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([r,m])=>this.data.userVendorLocations({input:m}).pipe((0,g._b)(p=>this.patchState({paging:{limit:m.limit,skip:m.skip,total:p.data.count.total},vendorLocations:p.data.items,errors:p.errors,loading:!1}),p=>this.patchState({loading:!1,errors:p.graphQLErrors?p.graphQLErrors:p})))))),this.createVendorLocationEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(r=>this.vendorLocationService.createVendorLocation(Object.assign({},r)).pipe((0,g._b)(m=>{this.addNewVendorLocation(m),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:m,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},m=>{m.graphQLErrors?(this.toast.error(m.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})):(this.toast.error(m.Message),this.formService.setErrors(m.Data))}))))),this.updateVendorLocationEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([r,m])=>this.vendorLocationService.updateVendorLocation(r,r.id).pipe((0,g._b)(p=>{this.updateVendorLocation(p),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:p,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},p=>{p.graphQLErrors?(this.toast.error(p.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:p.graphQLErrors?p.graphQLErrors:p})):(this.toast.error(p.Message),this.formService.setErrors(p.Data))}))))),this.deleteVendorLocationEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([r,m])=>this.data.userDeleteVendorLocation({vendorLocationId:m.id}).pipe((0,g._b)(p=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:p.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},p=>{p.graphQLErrors?(this.toast.error(p.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:p.graphQLErrors?p.graphQLErrors:p})):(this.toast.error(p.Message),this.formService.setErrors(p.Data))}))))),this.importExcelEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(r=>this.vendorLocationService.importVendorLocations(r).pipe((0,ce.K)(m=>{var p;return this.toast.error(null!==(p=m.Message)&&void 0!==p?p:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(m=>{const p=JSON.parse(m.created),_=JSON.parse(m.updated),w=JSON.parse(m.failed),J=p.length+_.length+w.length;this.addVendorLocations(p),this.updateVendorLocations(_),this.toast.success(`${p.length} created, ${_.length} updated, ${w.length} failed of total ${J}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("vendorLocationId")?(this.route.snapshot.paramMap.get("vendorLocationId"),this.setFormName("vendorLocation_edit")):this.setFormName("vendorLocation_create"),this.route.snapshot.paramMap.has("locationId")){var c=this.route.snapshot.paramMap.get("locationId");this.setLocationId(c)}if(this.route.snapshot.paramMap.has("vendorId")){var d=this.route.snapshot.paramMap.get("vendorId");this.setVendorId(d)}}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.vendorLocationService.validateVendorLocationExcelData(t,i.locations,i.vendors)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(bY))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function TY(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.vendorLocation)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let $m=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"vendorLocation_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({id:null,name:""}),this.store.vm$.subscribe(i=>{this.vendorLocation=i.item})):t.formName&&t.formName.currentValue&&"vendorLocation_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadVendorLocationEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.vendorLocation=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Ea),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-vendor-location-form"]],inputs:{vendorLocation:"vendorLocation",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,TY,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),Gm=(()=>{class s{constructor(){this.autoHeight=!1,this.vendorLocations=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[{field:"vendor.name",headerName:"Vendor",filter:"agTextColumnFilter"},{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{field:"locationId",filter:"agTextColumnFilter",hide:!0},{field:"vendorId",filter:"agTextColumnFilter",hide:!0}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-vendor-location-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",vendorLocations:"vendorLocations"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.vendorLocations)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function yY(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-vendor-location-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","vendorLocation_edit")("formControl",t.formControl)("vendorLocation",t.vendorLocation)}}const wY=function(){return{}};function xY(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-vendor-location-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","vendorLocation_create")("formControl",t.formControl)("vendorLocation",e.DdM(3,wY))}}function NY(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-vendor-location-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("vendorLocations",o.data.items)}let AY=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadVendorLocationsEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.vendorLocations$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Ea))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","vendorLocation","send","close"],[1,"w-full","h-full","bg-white",3,"vendorLocations","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,yY,2,3,"ng-template",null,1,e.W1O),e.YNc(3,xY,1,4,"ng-template",null,2,e.W1O),e.YNc(5,NY,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,$m,Gm],encapsulation:2}),s})();function FY(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-vendor-location-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","vendorLocation_edit")("vendorLocation",t.value)}}const PY=function(){return{}};function IY(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-vendor-location-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","vendorLocation_create")("vendorLocation",e.DdM(2,PY))}function DY(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-vendor-location-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("vendorLocations",t.items)}}let MY=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","vendorLocation","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","vendorLocations","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,FY,1,2,"ng-template",null,1,e.W1O),e.YNc(3,IY,1,3,"ng-template",null,2,e.W1O),e.YNc(5,DY,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,$m,Gm],encapsulation:2}),s})(),WY=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[Ea],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"vendor-location-select",component:AY,wrappers:["form-field"]},{name:"vendor-location-grid",component:MY}]})]}),s})(),EY=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[WY]}),s})();class Cs extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class OY extends Cs{constructor(o,t){super("ValidateVendorExcelDataAction"),this.valid=!1,this.excelData=o,this.vendorTypes=t}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name),this.validationContext.addRule(new f.mi(`vendorTypeName_${i}_is_valid}`,"Vendor Type Is Not Valid","vendorType.name",t.vendorType,this.vendorTypes,!0))}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class LY extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class $Y extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new LY("name","The vendor name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class GY extends Cs{constructor(o){super("CreateVendorAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new $Y("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){console.log("performAction"),this.response=this.businessProvider.data.userCreateVendor({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class RY extends Cs{constructor(o){super("UpdateVendorsAction"),this.vendors=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.vendors,!0))}performAction(){this.response=this.businessProvider.data.userUpdateVendors({input:{vendors:this.vendors}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class QY extends Cs{constructor(o,t){super("UpdateVendorAction"),this.vendor=o,this.vendorId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.vendor,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.vendorId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateVendor({vendorId:this.vendorId,input:this.vendor}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let Rm=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.VendorBusinessProviderService",t,a),this.data=i}createVendor(t){const i=new GY(t);return i.Do(this),i.response}updateVendor(t,i){const a=new QY(t,i);return a.Do(this),a.response}importVendors(t){const i=new RY(t);return i.Do(this),i.response}validateVendorExcelData(t,i){const a=new OY(t,i);return a.Do(this),a.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),VY=(()=>{class s extends I.nH{constructor(t,i,a){super("VendorService",a,t),this.businessProvider=i}createVendor(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createVendor(i)}updateVendor(t,i){return this.businessProvider.updateVendor(t,i)}importVendors(t){return this.businessProvider.importVendors(t)}validateVendorExcelData(t,i){return this.businessProvider.validateVendorExcelData(t,i)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(Rm,8),e.LFG(Rm),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),Oa=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){if(super({loading:!1,vendors:[],done:!1,searchQuery:"",formName:void 0,vendorTypeId:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.vendorService=H,this.errors$=this.select(d=>d.errors),this.loading$=this.select(d=>d.loading),this.done$=this.select(d=>d.done),this.item$=this.select(d=>d.item),this.vendors$=this.select(d=>d.vendors),this.vendorTypes$=this.select(d=>d.vendorTypes||[]),this.vendorTypeId$=this.select(d=>d.vendorTypeId),this.paging$=this.select(d=>d.paging),this.searchQuery$=this.select(d=>d.searchQuery),this.formName$=this.select(d=>d.formName),this.actionResult$=this.select(this.item$,this.done$,(d,n)=>({item:d,done:n}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.vendors$,this.vendorTypes$,(d,n,r,m,p,_)=>({errors:d,loading:n,item:r,formName:m,vendors:p,vendorTypes:_}),{debounce:!0}),this.input$=this.select(this.paging$,this.vendorTypeId$,this.searchQuery$,(d,n,r)=>({limit:d.limit,skip:d.skip,name:r,vendorTypeId:n,total:d.total})),this.setFormName=this.updater((d,n)=>Object.assign(Object.assign({},d),{formName:n})),this.setVendorTypeId=this.updater((d,n)=>Object.assign(Object.assign({},d),{vendorTypeId:n})),this.filterVendorTypes=d=>this.data.userSelectVendorTypes({input:{name:d}}).pipe((0,g._b)(n=>{let r=n.data.items;return this.patchState({vendorTypes:r}),r},n=>this.patchState({errors:n.graphQLErrors?n.graphQLErrors:n})),(0,he.U)(n=>n.data.items)),this.addVendorType=this.updater((d,n)=>Object.assign(Object.assign({},d),{vendorTypes:d.vendorTypes.concat(n)})),this.setItem=this.updater((d,n)=>Object.assign(Object.assign({},d),{item:n})),this.addNewVendor=this.updater((d,n)=>Object.assign(Object.assign({},d),{vendors:[...d.vendors,n]})),this.updateVendor=this.updater((d,n)=>Object.assign(Object.assign({},d),{vendors:d.vendors.map(r=>r.id===n.id?n:r)})),this.addVendors=this.updater((d,n)=>Object.assign(Object.assign({},d),{vendors:d.vendors.concat(n)})),this.updateVendors=this.updater((d,n)=>Object.assign(Object.assign({},d),{vendors:d.vendors.map(r=>n.find(p=>p.id===r.id)||r)})),this.setSearchQuery=this.updater((d,n)=>Object.assign(Object.assign({},d),{searchQuery:n})),this.loadVendorEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(n=>this.data.userVendor({vendorId:n}).pipe((0,g._b)(r=>{console.log(r.data.item),this.patchState({item:r.data.item,errors:r.errors,loading:!1})},r=>this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})))))),this.loadVendorsEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([n,r])=>this.data.userVendors({input:r}).pipe((0,g._b)(m=>this.patchState({paging:{limit:r.limit,skip:r.skip,total:m.data.count.total},vendors:m.data.items,errors:m.errors,loading:!1}),m=>this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})))))),this.createVendorEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(n=>this.vendorService.createVendor(Object.assign({},n)).pipe((0,g._b)(r=>{this.addNewVendor(r),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:r,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.updateVendorEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([n,r])=>this.vendorService.updateVendor(n,n.id).pipe((0,g._b)(m=>{this.updateVendor(m),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:m,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},m=>{m.graphQLErrors?(this.toast.error(m.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})):(this.toast.error(m.Message),this.formService.setErrors(m.Data))}))))),this.deleteVendorEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([n,r])=>this.data.userDeleteVendor({vendorId:r.id}).pipe((0,g._b)(m=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:m.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},m=>{m.graphQLErrors?(this.toast.error(m.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})):(this.toast.error(m.Message),this.formService.setErrors(m.Data))}))))),this.importExcelEffect=this.effect(d=>d.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(n=>this.vendorService.importVendors(n).pipe((0,ce.K)(r=>{var m;return this.toast.error(null!==(m=r.Message)&&void 0!==m?m:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(r=>{const m=JSON.parse(r.created),p=JSON.parse(r.updated),_=JSON.parse(r.failed),w=m.length+p.length+_.length;this.addVendors(m),this.updateVendors(p),this.toast.success(`${m.length} created, ${p.length} updated, ${_.length} failed of total ${w}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("vendorId")?(this.route.snapshot.paramMap.get("vendorId"),this.setFormName("vendor_edit")):this.setFormName("vendor_create"),this.route.snapshot.paramMap.has("vendorTypeId")){var c=this.route.snapshot.paramMap.get("vendorTypeId");this.setVendorTypeId(c)}}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.vendorService.validateVendorExcelData(t,i.vendorTypes)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(VY))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function jY(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.vendor)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let Qm=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"vendor_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({id:null,name:""}),this.store.vm$.subscribe(i=>{this.vendor=i.item})):t.formName&&t.formName.currentValue&&"vendor_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadVendorEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.vendor=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Oa),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-vendor-form"]],inputs:{vendor:"vendor",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,jY,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),Vm=(()=>{class s{constructor(){this.autoHeight=!1,this.vendors=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[{field:"vendorType.name",headerName:"Vendor Type",filter:"agTextColumnFilter"},{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{field:"taxId",filter:"agTextColumnFilter",hide:!0},{field:"line1",filter:"agTextColumnFilter"},{field:"city",filter:"agTextColumnFilter"},{field:"state",filter:"agTextColumnFilter"},{field:"postalCode",filter:"agTextColumnFilter"},{field:"emailAddress",filter:"agTextColumnFilter"},{field:"phoneNumber",filter:"agTextColumnFilter"},{field:"fax",filter:"agTextColumnFilter"},{field:"mailingAddress",filter:"agTextColumnFilter"},{field:"vendorTypeId",filter:"agTextColumnFilter",hide:!0},{field:"line2",filter:"agTextColumnFilter"},{field:"country",filter:"agTextColumnFilter"},{field:"office",filter:"agTextColumnFilter"},{field:"email",filter:"agTextColumnFilter"},{field:"website",filter:"agTextColumnFilter"},{field:"contactPerson",filter:"agTextColumnFilter"},{field:"owner",filter:"agTextColumnFilter"},{field:"bankRoutingNumber",filter:"agTextColumnFilter"},{field:"bankAccountNumber",filter:"agTextColumnFilter"},{field:"bankName",filter:"agTextColumnFilter"},{field:"bankCity",filter:"agTextColumnFilter"},{field:"bankState",filter:"agTextColumnFilter"},{field:"bankZip",filter:"agTextColumnFilter"},{field:"notes",filter:"agTextColumnFilter"},{field:"agreementDetails",filter:"agTextColumnFilter"},{field:"providerSearchNameDisplayType",filter:"agTextColumnFilter"},{field:"driversLicenseId",filter:"agTextColumnFilter",hide:!0},{field:"logoId",filter:"agTextColumnFilter",hide:!0},{field:"cellphone",filter:"agTextColumnFilter"},{field:"achCheckOrWire",filter:"agTextColumnFilter"},{field:"reductionNotes",filter:"agTextColumnFilter"},{headerName:"Latitude",field:"latitude",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.latitude,"",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{headerName:"Longitude",field:"longitude",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.longitude,"",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{field:"businessCentralName",filter:"agTextColumnFilter"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-vendor-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",vendors:"vendors"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.vendors)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function UY(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-vendor-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","vendor_edit")("formControl",t.formControl)("vendor",t.vendor)}}const JY=function(){return{}};function zY(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-vendor-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","vendor_create")("formControl",t.formControl)("vendor",e.DdM(3,JY))}}function HY(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-vendor-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("vendors",o.data.items)}let qY=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadVendorsEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.vendors$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Oa))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","vendor","send","close"],[1,"w-full","h-full","bg-white",3,"vendors","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,UY,2,3,"ng-template",null,1,e.W1O),e.YNc(3,zY,1,4,"ng-template",null,2,e.W1O),e.YNc(5,HY,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,Qm,Vm],encapsulation:2}),s})();function KY(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-vendor-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","vendor_edit")("vendor",t.value)}}const ZY=function(){return{}};function kY(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-vendor-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","vendor_create")("vendor",e.DdM(2,ZY))}function BY(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-vendor-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("vendors",t.items)}}let YY=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","vendor","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","vendors","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,KY,1,2,"ng-template",null,1,e.W1O),e.YNc(3,kY,1,3,"ng-template",null,2,e.W1O),e.YNc(5,BY,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,Qm,Vm],encapsulation:2}),s})(),XY=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[Oa],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"vendor-select",component:qY,wrappers:["form-field"]},{name:"vendor-grid",component:YY}]})]}),s})(),e7=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[XY]}),s})();class vs extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class t7 extends vs{constructor(o){super("ValidateVendorTypeExcelDataAction"),this.valid=!1,this.excelData=o}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name)}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class i7 extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class s7 extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new i7("name","The vendortype name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class o7 extends vs{constructor(o){super("CreateVendorTypeAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new s7("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateVendorType({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class a7 extends vs{constructor(o){super("UpdateVendorTypesAction"),this.vendorTypes=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.vendorTypes,!0))}performAction(){this.response=this.businessProvider.data.userUpdateVendorTypes({input:{vendorTypes:this.vendorTypes}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class r7 extends vs{constructor(o,t){super("UpdateVendorTypeAction"),this.vendorType=o,this.vendorTypeId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.vendorType,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.vendorTypeId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateVendorType({vendorTypeId:this.vendorTypeId,input:this.vendorType}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let jm=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.VendorTypeBusinessProviderService",t,a),this.data=i}createVendorType(t){const i=new o7(t);return i.Do(this),i.response}updateVendorType(t,i){const a=new r7(t,i);return a.Do(this),a.response}importVendorTypes(t){const i=new a7(t);return i.Do(this),i.response}validateVendorTypeExcelData(t){const i=new t7(t);return i.Do(this),i.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),n7=(()=>{class s extends I.nH{constructor(t,i,a){super("VendorTypeService",a,t),this.businessProvider=i}createVendorType(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createVendorType(i)}updateVendorType(t,i){return this.businessProvider.updateVendorType(t,i)}importVendorTypes(t){return this.businessProvider.importVendorTypes(t)}validateVendorTypeExcelData(t){return this.businessProvider.validateVendorTypeExcelData(t)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(jm,8),e.LFG(jm),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),La=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){super({loading:!1,vendorTypes:[],done:!1,searchQuery:"",formName:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.vendorTypeService=H,this.errors$=this.select(c=>c.errors),this.loading$=this.select(c=>c.loading),this.done$=this.select(c=>c.done),this.item$=this.select(c=>c.item),this.vendorTypes$=this.select(c=>c.vendorTypes),this.paging$=this.select(c=>c.paging),this.searchQuery$=this.select(c=>c.searchQuery),this.formName$=this.select(c=>c.formName),this.actionResult$=this.select(this.item$,this.done$,(c,d)=>({item:c,done:d}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.vendorTypes$,(c,d,n,r,m)=>({errors:c,loading:d,item:n,formName:r,vendorTypes:m}),{debounce:!0}),this.input$=this.select(this.paging$,this.searchQuery$,(c,d)=>({limit:c.limit,skip:c.skip,name:d,total:c.total})),this.setFormName=this.updater((c,d)=>Object.assign(Object.assign({},c),{formName:d})),this.setItem=this.updater((c,d)=>Object.assign(Object.assign({},c),{item:d})),this.addNewVendorType=this.updater((c,d)=>Object.assign(Object.assign({},c),{vendorTypes:[...c.vendorTypes,d]})),this.updateVendorType=this.updater((c,d)=>Object.assign(Object.assign({},c),{vendorTypes:c.vendorTypes.map(n=>n.id===d.id?d:n)})),this.addVendorTypes=this.updater((c,d)=>Object.assign(Object.assign({},c),{vendorTypes:c.vendorTypes.concat(d)})),this.updateVendorTypes=this.updater((c,d)=>Object.assign(Object.assign({},c),{vendorTypes:c.vendorTypes.map(n=>d.find(m=>m.id===n.id)||n)})),this.setSearchQuery=this.updater((c,d)=>Object.assign(Object.assign({},c),{searchQuery:d})),this.loadVendorTypeEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.data.userVendorType({vendorTypeId:d}).pipe((0,g._b)(n=>{this.patchState({item:n.data.item,errors:n.errors,loading:!1})},n=>this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})))))),this.loadVendorTypesEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([d,n])=>this.data.userVendorTypes({input:n}).pipe((0,g._b)(r=>this.patchState({paging:{limit:n.limit,skip:n.skip,total:r.data.count.total},vendorTypes:r.data.items,errors:r.errors,loading:!1}),r=>this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})))))),this.createVendorTypeEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.vendorTypeService.createVendorType(Object.assign({},d)).pipe((0,g._b)(n=>{this.addNewVendorType(n),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:n,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},n=>{n.graphQLErrors?(this.toast.error(n.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})):(this.toast.error(n.Message),this.formService.setErrors(n.Data))}))))),this.updateVendorTypeEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.vendorTypeService.updateVendorType(d,d.id).pipe((0,g._b)(r=>{this.updateVendorType(r),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:r,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.deleteVendorTypeEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.data.userDeleteVendorType({vendorTypeId:n.id}).pipe((0,g._b)(r=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:r.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.importExcelEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.vendorTypeService.importVendorTypes(d).pipe((0,ce.K)(n=>{var r;return this.toast.error(null!==(r=n.Message)&&void 0!==r?r:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(n=>{const r=JSON.parse(n.created),m=JSON.parse(n.updated),p=JSON.parse(n.failed),_=r.length+m.length+p.length;this.addVendorTypes(r),this.updateVendorTypes(m),this.toast.success(`${r.length} created, ${m.length} updated, ${p.length} failed of total ${_}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("vendorTypeId")?(this.route.snapshot.paramMap.get("vendorTypeId"),this.setFormName("vendorType_edit")):this.setFormName("vendorType_create")}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.vendorTypeService.validateVendorTypeExcelData(t)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(n7))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function l7(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.vendorType)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let Um=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"vendorType_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.vendorType=i.item})):t.formName&&t.formName.currentValue&&"vendorType_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadVendorTypeEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.vendorType=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(La),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-vendor-type-form"]],inputs:{vendorType:"vendorType",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,l7,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),Jm=(()=>{class s{constructor(){this.autoHeight=!1,this.vendorTypes=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[,{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-vendor-type-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",vendorTypes:"vendorTypes"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.vendorTypes)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function c7(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-vendor-type-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","vendorType_edit")("formControl",t.formControl)("vendorType",t.vendorType)}}const d7=function(){return{}};function u7(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-vendor-type-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","vendorType_create")("formControl",t.formControl)("vendorType",e.DdM(3,d7))}}function m7(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-vendor-type-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("vendorTypes",o.data.items)}let p7=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadVendorTypesEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.vendorTypes$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(La))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","vendorType","send","close"],[1,"w-full","h-full","bg-white",3,"vendorTypes","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,c7,2,3,"ng-template",null,1,e.W1O),e.YNc(3,u7,1,4,"ng-template",null,2,e.W1O),e.YNc(5,m7,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,Um,Jm],encapsulation:2}),s})();function h7(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-vendor-type-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","vendorType_edit")("vendorType",t.value)}}const f7=function(){return{}};function _7(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-vendor-type-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","vendorType_create")("vendorType",e.DdM(2,f7))}function g7(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-vendor-type-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("vendorTypes",t.items)}}let C7=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","vendorType","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","vendorTypes","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,h7,1,2,"ng-template",null,1,e.W1O),e.YNc(3,_7,1,3,"ng-template",null,2,e.W1O),e.YNc(5,g7,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,Um,Jm],encapsulation:2}),s})(),v7=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[La],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"vendor-type-select",component:p7,wrappers:["form-field"]},{name:"vendor-type-grid",component:C7}]})]}),s})(),S7=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[v7]}),s})();class Ss extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class b7 extends Ss{constructor(o){super("ValidateVisitKindExcelDataAction"),this.valid=!1,this.excelData=o}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name)}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class T7 extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class y7 extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new T7("name","The visitkind name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class w7 extends Ss{constructor(o){super("CreateVisitKindAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new y7("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateVisitKind({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class x7 extends Ss{constructor(o){super("UpdateVisitKindsAction"),this.visitKinds=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.visitKinds,!0))}performAction(){this.response=this.businessProvider.data.userUpdateVisitKinds({input:{visitKinds:this.visitKinds}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class N7 extends Ss{constructor(o,t){super("UpdateVisitKindAction"),this.visitKind=o,this.visitKindId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.visitKind,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.visitKindId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateVisitKind({visitKindId:this.visitKindId,input:this.visitKind}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let zm=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.VisitKindBusinessProviderService",t,a),this.data=i}createVisitKind(t){const i=new w7(t);return i.Do(this),i.response}updateVisitKind(t,i){const a=new N7(t,i);return a.Do(this),a.response}importVisitKinds(t){const i=new x7(t);return i.Do(this),i.response}validateVisitKindExcelData(t){const i=new b7(t);return i.Do(this),i.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),A7=(()=>{class s extends I.nH{constructor(t,i,a){super("VisitKindService",a,t),this.businessProvider=i}createVisitKind(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createVisitKind(i)}updateVisitKind(t,i){return this.businessProvider.updateVisitKind(t,i)}importVisitKinds(t){return this.businessProvider.importVisitKinds(t)}validateVisitKindExcelData(t){return this.businessProvider.validateVisitKindExcelData(t)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(zm,8),e.LFG(zm),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),$a=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){super({loading:!1,visitKinds:[],done:!1,searchQuery:"",formName:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.visitKindService=H,this.errors$=this.select(c=>c.errors),this.loading$=this.select(c=>c.loading),this.done$=this.select(c=>c.done),this.item$=this.select(c=>c.item),this.visitKinds$=this.select(c=>c.visitKinds),this.paging$=this.select(c=>c.paging),this.searchQuery$=this.select(c=>c.searchQuery),this.formName$=this.select(c=>c.formName),this.actionResult$=this.select(this.item$,this.done$,(c,d)=>({item:c,done:d}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.visitKinds$,(c,d,n,r,m)=>({errors:c,loading:d,item:n,formName:r,visitKinds:m}),{debounce:!0}),this.input$=this.select(this.paging$,this.searchQuery$,(c,d)=>({limit:c.limit,skip:c.skip,name:d,total:c.total})),this.setFormName=this.updater((c,d)=>Object.assign(Object.assign({},c),{formName:d})),this.setItem=this.updater((c,d)=>Object.assign(Object.assign({},c),{item:d})),this.addNewVisitKind=this.updater((c,d)=>Object.assign(Object.assign({},c),{visitKinds:[...c.visitKinds,d]})),this.updateVisitKind=this.updater((c,d)=>Object.assign(Object.assign({},c),{visitKinds:c.visitKinds.map(n=>n.id===d.id?d:n)})),this.addVisitKinds=this.updater((c,d)=>Object.assign(Object.assign({},c),{visitKinds:c.visitKinds.concat(d)})),this.updateVisitKinds=this.updater((c,d)=>Object.assign(Object.assign({},c),{visitKinds:c.visitKinds.map(n=>d.find(m=>m.id===n.id)||n)})),this.setSearchQuery=this.updater((c,d)=>Object.assign(Object.assign({},c),{searchQuery:d})),this.loadVisitKindEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.data.userVisitKind({visitKindId:d}).pipe((0,g._b)(n=>{this.patchState({item:n.data.item,errors:n.errors,loading:!1})},n=>this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})))))),this.loadVisitKindsEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([d,n])=>this.data.userVisitKinds({input:n}).pipe((0,g._b)(r=>this.patchState({paging:{limit:n.limit,skip:n.skip,total:r.data.count.total},visitKinds:r.data.items,errors:r.errors,loading:!1}),r=>this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})))))),this.createVisitKindEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.visitKindService.createVisitKind(Object.assign({},d)).pipe((0,g._b)(n=>{this.addNewVisitKind(n),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:n,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},n=>{n.graphQLErrors?(this.toast.error(n.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})):(this.toast.error(n.Message),this.formService.setErrors(n.Data))}))))),this.updateVisitKindEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.visitKindService.updateVisitKind(d,d.id).pipe((0,g._b)(r=>{this.updateVisitKind(r),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:r,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.deleteVisitKindEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.data.userDeleteVisitKind({visitKindId:n.id}).pipe((0,g._b)(r=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:r.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.importExcelEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.visitKindService.importVisitKinds(d).pipe((0,ce.K)(n=>{var r;return this.toast.error(null!==(r=n.Message)&&void 0!==r?r:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(n=>{const r=JSON.parse(n.created),m=JSON.parse(n.updated),p=JSON.parse(n.failed),_=r.length+m.length+p.length;this.addVisitKinds(r),this.updateVisitKinds(m),this.toast.success(`${r.length} created, ${m.length} updated, ${p.length} failed of total ${_}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("visitKindId")?(this.route.snapshot.paramMap.get("visitKindId"),this.setFormName("visitKind_edit")):this.setFormName("visitKind_create")}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.visitKindService.validateVisitKindExcelData(t)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(A7))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function F7(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.visitKind)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let Hm=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"visitKind_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.visitKind=i.item})):t.formName&&t.formName.currentValue&&"visitKind_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadVisitKindEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.visitKind=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36($a),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-visit-kind-form"]],inputs:{visitKind:"visitKind",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,F7,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),qm=(()=>{class s{constructor(){this.autoHeight=!1,this.visitKinds=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[,{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{field:"code",filter:"agTextColumnFilter"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-visit-kind-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",visitKinds:"visitKinds"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.visitKinds)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function P7(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-visit-kind-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","visitKind_edit")("formControl",t.formControl)("visitKind",t.visitKind)}}const I7=function(){return{}};function D7(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-visit-kind-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","visitKind_create")("formControl",t.formControl)("visitKind",e.DdM(3,I7))}}function M7(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-visit-kind-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("visitKinds",o.data.items)}let W7=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadVisitKindsEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.visitKinds$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36($a))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","visitKind","send","close"],[1,"w-full","h-full","bg-white",3,"visitKinds","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,P7,2,3,"ng-template",null,1,e.W1O),e.YNc(3,D7,1,4,"ng-template",null,2,e.W1O),e.YNc(5,M7,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,Hm,qm],encapsulation:2}),s})();function E7(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-visit-kind-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","visitKind_edit")("visitKind",t.value)}}const O7=function(){return{}};function L7(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-visit-kind-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","visitKind_create")("visitKind",e.DdM(2,O7))}function $7(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-visit-kind-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("visitKinds",t.items)}}let G7=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","visitKind","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","visitKinds","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,E7,1,2,"ng-template",null,1,e.W1O),e.YNc(3,L7,1,3,"ng-template",null,2,e.W1O),e.YNc(5,$7,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,Hm,qm],encapsulation:2}),s})(),R7=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[$a],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"visit-kind-select",component:W7,wrappers:["form-field"]},{name:"visit-kind-grid",component:G7}]})]}),s})(),Q7=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[R7]}),s})();class bs extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class V7 extends bs{constructor(o,t,i){super("ValidateWriteOffExcelDataAction"),this.valid=!1,this.excelData=o,this.accounts=t,this.writeOffStatuses=i}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name),this.validationContext.addRule(new f.mi(`accountName_${i}_is_valid}`,"Account Is Not Valid","account.name",t.account,this.accounts,!0)),this.validationContext.addRule(new f.mi(`writeOffStatusName_${i}_is_valid}`,"Write off Status Is Not Valid","writeOffStatus.name",t.writeOffStatus,this.writeOffStatuses,!0))}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class j7 extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class U7 extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new j7("name","The writeoff name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class J7 extends bs{constructor(o){super("CreateWriteOffAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new U7("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateWriteOff({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class z7 extends bs{constructor(o){super("UpdateWriteOffsAction"),this.writeOffs=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.writeOffs,!0))}performAction(){this.response=this.businessProvider.data.userUpdateWriteOffs({input:{writeOffs:this.writeOffs}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class H7 extends bs{constructor(o,t){super("UpdateWriteOffAction"),this.writeOff=o,this.writeOffId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.writeOff,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.writeOffId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateWriteOff({writeOffId:this.writeOffId,input:this.writeOff}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let Km=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.WriteOffBusinessProviderService",t,a),this.data=i}createWriteOff(t){const i=new J7(t);return i.Do(this),i.response}updateWriteOff(t,i){const a=new H7(t,i);return a.Do(this),a.response}importWriteOffs(t){const i=new z7(t);return i.Do(this),i.response}validateWriteOffExcelData(t,i,a){const l=new V7(t,i,a);return l.Do(this),l.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),q7=(()=>{class s extends I.nH{constructor(t,i,a){super("WriteOffService",a,t),this.businessProvider=i}createWriteOff(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createWriteOff(i)}updateWriteOff(t,i){return this.businessProvider.updateWriteOff(t,i)}importWriteOffs(t){return this.businessProvider.importWriteOffs(t)}validateWriteOffExcelData(t,i,a){return this.businessProvider.validateWriteOffExcelData(t,i,a)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(Km,8),e.LFG(Km),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),Ga=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){if(super({loading:!1,writeOffs:[],done:!1,searchQuery:"",formName:void 0,accountId:void 0,writeOffStatusId:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.writeOffService=H,this.errors$=this.select(n=>n.errors),this.loading$=this.select(n=>n.loading),this.done$=this.select(n=>n.done),this.item$=this.select(n=>n.item),this.writeOffs$=this.select(n=>n.writeOffs),this.caseAccounts$=this.select(n=>n.caseAccounts||[]),this.writeOffStatuses$=this.select(n=>n.writeOffStatuses||[]),this.accountId$=this.select(n=>n.accountId),this.writeOffStatusId$=this.select(n=>n.writeOffStatusId),this.paging$=this.select(n=>n.paging),this.searchQuery$=this.select(n=>n.searchQuery),this.formName$=this.select(n=>n.formName),this.actionResult$=this.select(this.item$,this.done$,(n,r)=>({item:n,done:r}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.writeOffs$,this.caseAccounts$,this.writeOffStatuses$,(n,r,m,p,_,w,J)=>({errors:n,loading:r,item:m,formName:p,writeOffs:_,caseAccounts:w,writeOffStatuses:J}),{debounce:!0}),this.input$=this.select(this.paging$,this.accountId$,this.writeOffStatusId$,this.searchQuery$,(n,r,m,p)=>({limit:n.limit,skip:n.skip,name:p,accountId:r,writeOffStatusId:m,total:n.total})),this.setFormName=this.updater((n,r)=>Object.assign(Object.assign({},n),{formName:r})),this.setAccountId=this.updater((n,r)=>Object.assign(Object.assign({},n),{accountId:r})),this.setWriteOffStatusId=this.updater((n,r)=>Object.assign(Object.assign({},n),{writeOffStatusId:r})),this.filterCaseAccounts=n=>this.data.userSelectCaseAccounts({input:{name:n}}).pipe((0,g._b)(r=>{let m=r.data.items;return this.patchState({caseAccounts:m}),m},r=>this.patchState({errors:r.graphQLErrors?r.graphQLErrors:r})),(0,he.U)(r=>r.data.items)),this.filterWriteOffStatuses=n=>this.data.userSelectWriteOffStatuses({input:{name:n}}).pipe((0,g._b)(r=>{let m=r.data.items;return this.patchState({writeOffStatuses:m}),m},r=>this.patchState({errors:r.graphQLErrors?r.graphQLErrors:r})),(0,he.U)(r=>r.data.items)),this.addCaseAccount=this.updater((n,r)=>Object.assign(Object.assign({},n),{caseAccounts:n.caseAccounts.concat(r)})),this.addWriteOffStatus=this.updater((n,r)=>Object.assign(Object.assign({},n),{writeOffStatuses:n.writeOffStatuses.concat(r)})),this.setItem=this.updater((n,r)=>Object.assign(Object.assign({},n),{item:r})),this.addNewWriteOff=this.updater((n,r)=>Object.assign(Object.assign({},n),{writeOffs:[...n.writeOffs,r]})),this.updateWriteOff=this.updater((n,r)=>Object.assign(Object.assign({},n),{writeOffs:n.writeOffs.map(m=>m.id===r.id?r:m)})),this.addWriteOffs=this.updater((n,r)=>Object.assign(Object.assign({},n),{writeOffs:n.writeOffs.concat(r)})),this.updateWriteOffs=this.updater((n,r)=>Object.assign(Object.assign({},n),{writeOffs:n.writeOffs.map(m=>r.find(_=>_.id===m.id)||m)})),this.setSearchQuery=this.updater((n,r)=>Object.assign(Object.assign({},n),{searchQuery:r})),this.loadWriteOffEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(r=>this.data.userWriteOff({writeOffId:r}).pipe((0,g._b)(m=>{this.patchState({item:m.data.item,errors:m.errors,loading:!1})},m=>this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})))))),this.loadWriteOffsEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([r,m])=>this.data.userWriteOffs({input:m}).pipe((0,g._b)(p=>this.patchState({paging:{limit:m.limit,skip:m.skip,total:p.data.count.total},writeOffs:p.data.items,errors:p.errors,loading:!1}),p=>this.patchState({loading:!1,errors:p.graphQLErrors?p.graphQLErrors:p})))))),this.createWriteOffEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(r=>this.writeOffService.createWriteOff(Object.assign({},r)).pipe((0,g._b)(m=>{this.addNewWriteOff(m),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:m,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},m=>{m.graphQLErrors?(this.toast.error(m.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:m.graphQLErrors?m.graphQLErrors:m})):(this.toast.error(m.Message),this.formService.setErrors(m.Data))}))))),this.updateWriteOffEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([r,m])=>this.writeOffService.updateWriteOff(r,r.id).pipe((0,g._b)(p=>{this.updateWriteOff(p),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:p,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},p=>{p.graphQLErrors?(this.toast.error(p.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:p.graphQLErrors?p.graphQLErrors:p})):(this.toast.error(p.Message),this.formService.setErrors(p.Data))}))))),this.deleteWriteOffEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([r,m])=>this.data.userDeleteWriteOff({writeOffId:m.id}).pipe((0,g._b)(p=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:p.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},p=>{p.graphQLErrors?(this.toast.error(p.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:p.graphQLErrors?p.graphQLErrors:p})):(this.toast.error(p.Message),this.formService.setErrors(p.Data))}))))),this.importExcelEffect=this.effect(n=>n.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(r=>this.writeOffService.importWriteOffs(r).pipe((0,ce.K)(m=>{var p;return this.toast.error(null!==(p=m.Message)&&void 0!==p?p:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(m=>{const p=JSON.parse(m.created),_=JSON.parse(m.updated),w=JSON.parse(m.failed),J=p.length+_.length+w.length;this.addWriteOffs(p),this.updateWriteOffs(_),this.toast.success(`${p.length} created, ${_.length} updated, ${w.length} failed of total ${J}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("writeOffId")?(this.route.snapshot.paramMap.get("writeOffId"),this.setFormName("writeOff_edit")):this.setFormName("writeOff_create"),this.route.snapshot.paramMap.has("accountId")){var c=this.route.snapshot.paramMap.get("accountId");this.setAccountId(c)}if(this.route.snapshot.paramMap.has("writeOffStatusId")){var d=this.route.snapshot.paramMap.get("writeOffStatusId");this.setWriteOffStatusId(d)}}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.writeOffService.validateWriteOffExcelData(t,i.caseAccounts,i.writeOffStatuses)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(q7))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function K7(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.writeOff)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let Zm=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"writeOff_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.writeOff=i.item})):t.formName&&t.formName.currentValue&&"writeOff_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadWriteOffEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.writeOff=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Ga),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-write-off-form"]],inputs:{writeOff:"writeOff",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,K7,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),km=(()=>{class s{constructor(){this.autoHeight=!1,this.writeOffs=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[{field:"account.name",headerName:"Account",filter:"agTextColumnFilter"},{field:"writeOffStatus.name",headerName:"Write off Status",filter:"agTextColumnFilter"},{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"},{field:"accountId",filter:"agTextColumnFilter",hide:!0},{field:"writeOffStatusId",filter:"agTextColumnFilter",hide:!0},{headerName:"Amount",field:"amount",valueFormatter:t=>{var i;return(0,C.oBD)(null===(i=t.data)||void 0===i?void 0:i.amount,"$",2)},filter:"agNumberColumnFilter",aggFunc:"sum"},{field:"createdBy",filter:"agTextColumnFilter"},{field:"dateCreated",filter:"agDateColumnFilter"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-write-off-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",writeOffs:"writeOffs"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.writeOffs)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function Z7(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-write-off-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","writeOff_edit")("formControl",t.formControl)("writeOff",t.writeOff)}}const k7=function(){return{}};function B7(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-write-off-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","writeOff_create")("formControl",t.formControl)("writeOff",e.DdM(3,k7))}}function Y7(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-write-off-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("writeOffs",o.data.items)}let X7=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadWriteOffsEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.writeOffs$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Ga))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","writeOff","send","close"],[1,"w-full","h-full","bg-white",3,"writeOffs","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,Z7,2,3,"ng-template",null,1,e.W1O),e.YNc(3,B7,1,4,"ng-template",null,2,e.W1O),e.YNc(5,Y7,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,Zm,km],encapsulation:2}),s})();function eX(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-write-off-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","writeOff_edit")("writeOff",t.value)}}const tX=function(){return{}};function iX(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-write-off-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","writeOff_create")("writeOff",e.DdM(2,tX))}function sX(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-write-off-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("writeOffs",t.items)}}let oX=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","writeOff","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","writeOffs","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,eX,1,2,"ng-template",null,1,e.W1O),e.YNc(3,iX,1,3,"ng-template",null,2,e.W1O),e.YNc(5,sX,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,Zm,km],encapsulation:2}),s})(),aX=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[Ga],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"write-off-select",component:X7,wrappers:["form-field"]},{name:"write-off-grid",component:oX}]})]}),s})(),rX=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[aX]}),s})();class Ts extends I.T_{constructor(o){super(),this.showRuleMessages=!0,this.hideRuleMessages=!1,this.actionName=o}Do(o){return this.businessProvider=o,this.serviceContext=o.serviceContext,this.loggingService=o.loggingService,this.execute(),this.response}}class nX extends Ts{constructor(o){super("ValidateWriteOffStatusExcelDataAction"),this.valid=!1,this.excelData=o}preValidateAction(){const o=[];this.excelData.map((t,i)=>{o.push(t.name)}),this.validationContext.addRule(new f.cL("nameIsUnique","Name should be unique",o,!0))}performAction(){}finish(){super.finish();const o={};let t=[];this.validationContext.hasRuleViolations()?(this.valid=!1,this.validationContext.rules.map(i=>{i instanceof f.mi?i.isValid||(o[i.columnName]?o[i.columnName].newNames.includes(i.newName)||o[i.columnName].newNames.push(i.newName):o[i.columnName]={options:i.possibleValueList.map(a=>a.name),newNames:[i.newName]}):i instanceof f.cL&&(i.isValid||(t=i.conflicts))})):this.valid=!0,this.response=(0,F.of)({valid:this.valid,excelData:this.excelData,conflictNames:t,unknownNames:o})}}class lX extends f.wS{constructor(o,t,i,a,l){super(o,t,i,a,l,!0)}}class cX extends f.ul{constructor(o,t,i,a=!1){super(o,t,a),this.displayToUser=!0,this.doNotDisplayToUser=!1,this.target=i,this.configureRules()}configureRules(){this.rules.push(new f.DJ("NotificationIsNotNull","The form message cannot be null or undefined.",this.target,this.doNotDisplayToUser)),this.rules.push(new lX("name","The writeoffstatus name is not valid. Must be within 2 and 255 characters.",this.target.name,2,255))}}class dX extends Ts{constructor(o){super("CreateWriteOffStatusAction"),this.input=o}preValidateAction(){this.validationContext.addRule(new cX("InputIsNotNull","The input information is not valid.",this.input,this.showRuleMessages))}performAction(){this.response=this.businessProvider.data.userCreateWriteOffStatus({input:this.input}).pipe((0,h.w)(o=>(0,de.of)(o.data.created)))}}class uX extends Ts{constructor(o){super("UpdateWriteOffStatusesAction"),this.writeOffStatuses=o}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.writeOffStatuses,!0))}performAction(){this.response=this.businessProvider.data.userUpdateWriteOffStatuses({input:{writeOffStatuses:this.writeOffStatuses}}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}class mX extends Ts{constructor(o,t){super("UpdateWriteOffStatusAction"),this.writeOffStatus=o,this.writeOffStatusId=t}preValidateAction(){this.validationContext.addRule(new f.DJ("Input","Input should have values",this.writeOffStatus,!0)).addRule(new f.xF("Id","Id should be a CUID and not null",this.writeOffStatusId,!0))}performAction(){this.response=this.businessProvider.data.userUpdateWriteOffStatus({writeOffStatusId:this.writeOffStatusId,input:this.writeOffStatus}).pipe((0,h.w)(o=>(0,F.of)(o.data.updated)))}}let Bm=(()=>{class s extends I.nH{constructor(t,i,a){super("NotificationService.WriteOffStatusBusinessProviderService",t,a),this.data=i}createWriteOffStatus(t){const i=new dX(t);return i.Do(this),i.response}updateWriteOffStatus(t,i){const a=new mX(t,i);return a.Do(this),a.response}importWriteOffStatuses(t){const i=new uX(t);return i.Do(this),i.response}validateWriteOffStatusExcelData(t){const i=new nX(t);return i.Do(this),i.response}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(U.ed),e.LFG(V.q),e.LFG(I.oI))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),pX=(()=>{class s extends I.nH{constructor(t,i,a){super("WriteOffStatusService",a,t),this.businessProvider=i}createWriteOffStatus(t){const i=Object.fromEntries(Object.entries(t).filter(([a,l])=>null!==l));return this.businessProvider.createWriteOffStatus(i)}updateWriteOffStatus(t,i){return this.businessProvider.updateWriteOffStatus(t,i)}importWriteOffStatuses(t){return this.businessProvider.importWriteOffStatuses(t)}validateWriteOffStatusExcelData(t){return this.businessProvider.validateWriteOffStatusExcelData(t)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(Bm,8),e.LFG(Bm),e.LFG(U.ed))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),Ra=(()=>{class s extends g.m1{constructor(t,i,a,l,u,H){super({loading:!1,writeOffStatuses:[],done:!1,searchQuery:"",formName:void 0,paging:{limit:1e4,skip:0}}),this.data=t,this.router=i,this.route=a,this.toast=l,this.formService=u,this.writeOffStatusService=H,this.errors$=this.select(c=>c.errors),this.loading$=this.select(c=>c.loading),this.done$=this.select(c=>c.done),this.item$=this.select(c=>c.item),this.writeOffStatuses$=this.select(c=>c.writeOffStatuses),this.paging$=this.select(c=>c.paging),this.searchQuery$=this.select(c=>c.searchQuery),this.formName$=this.select(c=>c.formName),this.actionResult$=this.select(this.item$,this.done$,(c,d)=>({item:c,done:d}),{debounce:!0}),this.vm$=this.select(this.errors$,this.loading$,this.item$,this.formName$,this.writeOffStatuses$,(c,d,n,r,m)=>({errors:c,loading:d,item:n,formName:r,writeOffStatuses:m}),{debounce:!0}),this.input$=this.select(this.paging$,this.searchQuery$,(c,d)=>({limit:c.limit,skip:c.skip,name:d,total:c.total})),this.setFormName=this.updater((c,d)=>Object.assign(Object.assign({},c),{formName:d})),this.setItem=this.updater((c,d)=>Object.assign(Object.assign({},c),{item:d})),this.addNewWriteOffStatus=this.updater((c,d)=>Object.assign(Object.assign({},c),{writeOffStatuses:[...c.writeOffStatuses,d]})),this.updateWriteOffStatus=this.updater((c,d)=>Object.assign(Object.assign({},c),{writeOffStatuses:c.writeOffStatuses.map(n=>n.id===d.id?d:n)})),this.addWriteOffStatuses=this.updater((c,d)=>Object.assign(Object.assign({},c),{writeOffStatuses:c.writeOffStatuses.concat(d)})),this.updateWriteOffStatuses=this.updater((c,d)=>Object.assign(Object.assign({},c),{writeOffStatuses:c.writeOffStatuses.map(n=>d.find(m=>m.id===n.id)||n)})),this.setSearchQuery=this.updater((c,d)=>Object.assign(Object.assign({},c),{searchQuery:d})),this.loadWriteOffStatusEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.data.userWriteOffStatus({writeOffStatusId:d}).pipe((0,g._b)(n=>{this.patchState({item:n.data.item,errors:n.errors,loading:!1})},n=>this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})))))),this.loadWriteOffStatusesEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.input$),(0,h.w)(([d,n])=>this.data.userWriteOffStatuses({input:n}).pipe((0,g._b)(r=>this.patchState({paging:{limit:n.limit,skip:n.skip,total:r.data.count.total},writeOffStatuses:r.data.items,errors:r.errors,loading:!1}),r=>this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})))))),this.createWriteOffStatusEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.writeOffStatusService.createWriteOffStatus(Object.assign({},d)).pipe((0,g._b)(n=>{this.addNewWriteOffStatus(n),this.toast.success("Created Successfully!"),setTimeout(()=>this.patchState({item:n,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},n=>{n.graphQLErrors?(this.toast.error(n.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:n.graphQLErrors?n.graphQLErrors:n})):(this.toast.error(n.Message),this.formService.setErrors(n.Data))}))))),this.updateWriteOffStatusEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.writeOffStatusService.updateWriteOffStatus(d,d.id).pipe((0,g._b)(r=>{this.updateWriteOffStatus(r),this.toast.success("Updated Successfully!"),setTimeout(()=>this.patchState({item:r,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.deleteWriteOffStatusEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,L.M)(this.item$),(0,h.w)(([d,n])=>this.data.userDeleteWriteOffStatus({writeOffStatusId:n.id}).pipe((0,g._b)(r=>{this.toast.success("Deleted successfully!",{duration:3e3}),setTimeout(()=>this.patchState({item:r.data.deleted,loading:!1,done:!0}),300),setTimeout(()=>this.patchState({done:!1,item:null}),600)},r=>{r.graphQLErrors?(this.toast.error(r.graphQLErrors[0].message,{duration:3e3}),this.patchState({loading:!1,errors:r.graphQLErrors?r.graphQLErrors:r})):(this.toast.error(r.Message),this.formService.setErrors(r.Data))}))))),this.importExcelEffect=this.effect(c=>c.pipe((0,S.b)(()=>this.patchState({loading:!0})),(0,h.w)(d=>this.writeOffStatusService.importWriteOffStatuses(d).pipe((0,ce.K)(n=>{var r;return this.toast.error(null!==(r=n.Message)&&void 0!==r?r:"Failed to save",{duration:3e3}),B.E}),(0,S.b)(n=>{const r=JSON.parse(n.created),m=JSON.parse(n.updated),p=JSON.parse(n.failed),_=r.length+m.length+p.length;this.addWriteOffStatuses(r),this.updateWriteOffStatuses(m),this.toast.success(`${r.length} created, ${m.length} updated, ${p.length} failed of total ${_}`,{duration:3e3})}))))),this.route.snapshot.paramMap.has("writeOffStatusId")?(this.route.snapshot.paramMap.get("writeOffStatusId"),this.setFormName("writeOffStatus_edit")):this.setFormName("writeOffStatus_create")}validateImportData(t){return this.vm$.pipe((0,h.w)(i=>this.writeOffStatusService.validateWriteOffStatusExcelData(t)))}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(V.q),e.LFG(E.F0),e.LFG(E.gz),e.LFG(ie.F),e.LFG(X.o),e.LFG(pX))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();function hX(s,o){if(1&s){const t=e.EpF();e.ynx(0,1),e.TgZ(1,"div",2)(2,"div",3)(3,"ui-formly-json-form",4),e.NdJ("discard",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.close.emit())})("formIsReady",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.formIsReady())}),e.qZA()()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("model",t.writeOffStatus)("formName",t.formName)("showSubmitButton",!0)("componentStore",t.store)}}let Ym=(()=>{class s{constructor(t,i){this.store=t,this.route=i,this.send=new e.vpe,this.close=new e.vpe,this.vm$=this.store.vm$}formIsReady(){}ngOnChanges(t){t.formName&&t.formName.currentValue&&"writeOffStatus_create"==t.formName.currentValue?(console.log(t.formName.currentValue),this.store.setItem({name:""}),this.store.vm$.subscribe(i=>{this.writeOffStatus=i.item})):t.formName&&t.formName.currentValue&&"writeOffStatus_edit"==t.formName.currentValue&&t.formControl&&t.formControl.currentValue&&(console.log(t.formControl.currentValue),this.store.loadWriteOffStatusEffect(t.formControl.currentValue.value),this.store.vm$.subscribe(i=>{this.writeOffStatus=i.item}))}ngOnInit(){this.subscriber=this.store.actionResult$.subscribe(({done:t,item:i})=>{t&&this.send.emit(i)})}ngOnDestroy(){var t;null===(t=this.subscriber)||void 0===t||t.unsubscribe()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Ra),e.Y36(E.gz))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-write-off-status-form"]],inputs:{writeOffStatus:"writeOffStatus",formName:"formName",formControl:"formControl"},outputs:{send:"send",close:"close"},features:[e.TTD],decls:2,vars:3,consts:[["class","absolute inset-0 flex flex-col overflow-y-hidden",4,"ngIf"],[1,"absolute","inset-0","flex","flex-col","overflow-y-hidden"],[1,"md:px-2","lg:px-0","lg:col-span-9","dark:bg-gray-800","bg-white","rounded-lg","shadow","p-4"],[1,"px-6","pt-6"],[3,"model","formName","showSubmitButton","componentStore","discard","formIsReady"]],template:function(t,i){1&t&&(e.YNc(0,hX,4,4,"ng-container",0),e.ALo(1,"async")),2&t&&e.Q6J("ngIf",e.lcZ(1,1,i.vm$))},dependencies:[x.O5,te.M,x.Ov],encapsulation:2}),s})(),Xm=(()=>{class s{constructor(){this.autoHeight=!1,this.writeOffStatuses=[],this.itemDidSelect=new e.vpe,this.rowItemsSelected=new e.vpe,this.columnDefs=[,{field:"id",filter:"agTextColumnFilter",hide:!0},{field:"createdAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.createdAt)},hide:!0},{field:"updatedAt",filter:"agDateColumnFilter",cellClass:"dateTime",valueFormatter:t=>{var i;return(0,C.vhO)(null===(i=t.data)||void 0===i?void 0:i.updatedAt)},hide:!0},{field:"name",filter:"agTextColumnFilter"}]}selectionDidChange(t){this.rowItemsSelected.emit(t)}setSelected(t){this.tableView.gridApi.forEachNode(i=>{var a;t.includes(null===(a=i.data)||void 0===a?void 0:a.id)?i.setSelected(!0):i.setSelected(!1)})}onSelected(t){this.itemDidSelect.emit(t)}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ui-write-off-status-select-table-view"]],viewQuery:function(t,i){if(1&t&&e.Gf(v.x,5),2&t){let a;e.iGM(a=e.CRH())&&(i.tableView=a.first)}},inputs:{autoHeight:"autoHeight",writeOffStatuses:"writeOffStatuses"},outputs:{itemDidSelect:"itemDidSelect",rowItemsSelected:"rowItemsSelected"},decls:1,vars:5,consts:[[1,"w-full","h-full",3,"autoHeight","showSidebar","data","suppressRowClickSelection","columnDefs","itemDidSelect","selectionDidChange"]],template:function(t,i){1&t&&(e.TgZ(0,"table-view",0),e.NdJ("itemDidSelect",function(l){return i.onSelected(l)})("selectionDidChange",function(l){return i.selectionDidChange(l)}),e.qZA()),2&t&&e.Q6J("autoHeight",i.autoHeight)("showSidebar",!1)("data",i.writeOffStatuses)("suppressRowClickSelection",!1)("columnDefs",i.columnDefs)},dependencies:[v.x],encapsulation:2}),s})();function fX(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-write-off-status-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e._uU(1," > "),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","writeOffStatus_edit")("formControl",t.formControl)("writeOffStatus",t.writeOffStatus)}}const _X=function(){return{}};function gX(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-write-off-status-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=e.oxw();e.Q6J("formName","writeOffStatus_create")("formControl",t.formControl)("writeOffStatus",e.DdM(3,_X))}}function CX(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-write-off-status-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(u.ref.close())}),e.qZA()}2&s&&e.Q6J("writeOffStatuses",o.data.items)}let vX=(()=>{class s extends R.fS{constructor(t){super(),this.store=t,this.store.loadWriteOffStatusesEffect()}ngOnInit(){this.to.source=this.getItems.bind(this),this.to.labelProp="name",this.to.valueProp="id"}getItems(t){return this.store.writeOffStatuses$.pipe((0,h.w)(i=>(0,F.of)(i)))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(Ra))},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"to","control","upModel","listTemplate","editTemplate","createTemplate","key","selectionChanged"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","formControl","writeOffStatus","send","close"],[1,"w-full","h-full","bg-white",3,"writeOffStatuses","itemDidSelect"]],template:function(t,i){if(1&t&&(e.TgZ(0,"ui-select-form",0),e.NdJ("selectionChanged",function(l){return i.formState[l.key]=l.value}),e.qZA(),e.YNc(1,fX,2,3,"ng-template",null,1,e.W1O),e.YNc(3,gX,1,4,"ng-template",null,2,e.W1O),e.YNc(5,CX,1,1,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("to",i.to)("control",i.formControl)("upModel",i.model)("listTemplate",u)("editTemplate",a)("createTemplate",l)("key",i.field.key)}},dependencies:[W.JJ,W.oH,Z.$,Ym,Xm],encapsulation:2}),s})();function SX(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-write-off-status-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("formName","writeOffStatus_edit")("writeOffStatus",t.value)}}const bX=function(){return{}};function TX(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-write-off-status-form",4),e.NdJ("send",function(a){const u=e.CHM(t).data;return u.onSave(a),e.KtG(u.ref.close())})("close",function(){const l=e.CHM(t).data;return e.KtG(l.ref.close())}),e.qZA()}2&s&&e.Q6J("formName","writeOffStatus_create")("writeOffStatus",e.DdM(2,bX))}function yX(s,o){if(1&s){const t=e.EpF();e.TgZ(0,"ui-write-off-status-select-table-view",5),e.NdJ("itemDidSelect",function(a){const u=e.CHM(t).data;return u.itemDidSelect(a),e.KtG(null==u.ref?null:u.ref.close())}),e.qZA()}if(2&s){const t=o.data;e.Q6J("autoHeight",!0)("writeOffStatuses",t.items)}}let wX=(()=>{class s extends pe{constructor(){super()}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["ng-component"]],features:[e.qOj],decls:7,vars:7,consts:[[3,"data","readOnly","title","onSave","listTemplate","editTemplate","createTemplate"],["editTemplate",""],["createTemplate",""],["listTemplate",""],[1,"flex-grow","flex","flex-col",3,"formName","writeOffStatus","send","close"],[1,"w-full","h-full","bg-white",3,"autoHeight","writeOffStatuses","itemDidSelect"]],template:function(t,i){if(1&t&&(e._UZ(0,"web-ui-grid",0),e.YNc(1,SX,1,2,"ng-template",null,1,e.W1O),e.YNc(3,TX,1,3,"ng-template",null,2,e.W1O),e.YNc(5,yX,1,2,"ng-template",null,3,e.W1O)),2&t){const a=e.MAs(2),l=e.MAs(4),u=e.MAs(6);e.Q6J("data",i.data)("readOnly",i.to.readOnly)("title",i.to.title)("onSave",i.onSave)("listTemplate",u)("editTemplate",a)("createTemplate",l)}},dependencies:[fe,Ym,Xm],encapsulation:2}),s})(),xX=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[Ra],imports:[x.ez,j.F,W.UX,K.o,se.u,$.P,G.t,me,q.h,k.G,R.X0.forChild({types:[{name:"write-off-status-select",component:vX,wrappers:["form-field"]},{name:"write-off-status-grid",component:wX}]})]}),s})(),NX=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[xX]}),s})();var AX=Q(17196);let FX=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[x.ez,W.u5,W.UX,g_,dp,Ip,kp,_h,Ph,Zh,Bh,uf,Df,Bf,$_,sg,yg,Ug,cC,PC,ZC,fv,Ov,tS,bS,VS,nb,Ab,qb,p0,W0,X0,vT,MT,YT,Cy,Gy,ow,ww,Jw,sx,_x,Lx,iN,TN,jN,lA,FA,KA,hF,EF,eP,SP,VP,nI,AI,QI,XI,vD,RD,a1,x1,z1,oM,wM,JM,dW,yW,UW,cE,PE,ZE,fO,OO,tL,bL,VL,n$,S$,Q$,rG,NG,VG,n3,A3,Q3,X3,vR,RR,a2,x2,z2,uQ,DQ,BQ,gV,$V,sj,yj,Uj,cU,PU,ZU,f6,O6,tJ,bJ,VJ,nz,Az,qz,pH,WH,XH,vq,Rq,aK,xK,zK,u4,D4,B4,gZ,$Z,kZ,_k,Pk,Zk,fB,FB,KB,h5,M5,K5,hY,EY,e7,S7,Q7,rX,NX,AX.h,x.ez,W.u5,W.UX]}),s})()}}]);